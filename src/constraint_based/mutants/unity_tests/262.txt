select request_at as day, round((sum(case when t.status <> 'completed' then 1 else 0 end) / count(*)), 2) as "cancellation rate" from trips as t join users as c on (t.client_id = c.users_id and c.banned = 'no') join users as d on (t.driver_id = d.users_id and d.banned = 'no') where request_at between '2013-10-01' and '2013-10-03' group by request_at;
select request_at as day, round((sum(case when t.status <> 'completed' then 1 else 0 end) / count(*)), 2) as "cancellation rate" from trips as t join users as c on (t.client_id = c.users_id or c.banned = 'no') join users as d on (t.driver_id = d.users_id and d.banned = 'no') where request_at between '2013-10-01' and '2013-10-03' group by request_at;
select request_at as day, round((sum(case when t.status <> 'completed' then 1 else 0 end) / count(*)), 2) as "cancellation rate" from trips as t join users as c on (t.client_id = c.users_id and c.banned = 'no') join users as d on (t.driver_id = d.users_id or d.banned = 'no') where request_at between '2013-10-01' and '2013-10-03' group by request_at;
select request_at as day, round((sum(case when t.status <> 'completed' then 1 else 0 end) / count(*)), 2) as "cancellation rate" from trips as t join users as c on (t.client_id = c.users_id and c.banned = 'no') join users as d on (t.driver_id = d.users_id and d.banned = 'no') where 1 = 1 group by request_at;
