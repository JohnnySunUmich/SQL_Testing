select department, employee, salary from (select d.name as department, e.name as employee, e.salary, dense_rank() over (partition by d.name order by e.salary desc) as salary_rank from employee as e join department as d on e.departmentid = d.id) as ed where salary_rank <= 3
select department, employee, salary from (select d.name as department, e.name as employee, e.salary, dense_rank() over (partition by d.name order by e.salary desc) as salary_rank from employee as e natural join department as d) as ed where salary_rank <= 3
select department, employee, salary from (select d.name as department, e.name as employee, e.salary, dense_rank() over (partition by d.name order by e.salary desc) as salary_rank from employee as e join department as d on e.departmentid = d.id) as ed where salary_rank < 3