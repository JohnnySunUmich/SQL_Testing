select round((sum(case when (temp.min_date + 1) = a.event_date then 1 else 0 end)::numeric / count(distinct temp.player_id)) :: numeric, 2) as fraction from (select player_id, min(event_date) as min_date from activity group by player_id) as temp join activity as a on temp.player_id = a.player_id;
select round((sum(case when (temp.min_date + 1) = a.event_date then 1 else 0 end)::numeric / count(distinct temp.player_id)) :: numeric, 2) as fraction from (select player_id, min(event_date) as min_date from activity group by player_id) as temp join activity as a on temp.player_id > a.player_id;