qid,psql_query
-1,"select a.product_id, round((sum((units * price)) / sum(units)), 2) as average_price from prices as a join unitssold as b on (a.product_id = b.product_id and b.purchase_date between a.start_date and a.end_date) group by a.product_id"
3,"select b.product_id, round((sum((b.units * a.price)) / sum(b.units)), 2) as average_price from unitssold as b left outer join prices as a on (a.product_id = b.product_id and a.start_date <= b.purchase_date and b.purchase_date <= a.end_date) group by 1;"
6,"select distinct u.product_id, round((sum((p.price * u.units)) / sum(u.units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date) group by u.product_id;"
31,"select a.product_id, round(cast((cast(sum((a.units * b.price)) as decimal(7, 2)) / cast(sum(a.units) as decimal(7, 2))) as numeric), 2) as average_price from unitssold as a left outer join prices as b on (a.product_id = b.product_id and a.purchase_date between b.start_date and b.end_date) group by a.product_id;"
33,"select a.product_id, round((sum((a.units * b.price)) / sum(a.units)), 2) as average_price from unitssold as a left outer join prices as b on (a.product_id = b.product_id and a.purchase_date between b.start_date and b.end_date) group by 1;"
47,"select p.product_id as product_id, round((sum((units * price)) / sum(units)), 2) as average_price from unitssold as us left outer join prices as p on (us.product_id = p.product_id and p.start_date <= us.purchase_date and p.end_date >= us.purchase_date) group by p.product_id order by p.product_id;"
91,"select u.product_id, round((sum((p.price * u.units)) / sum(u.units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date) group by u.product_id;"
94,"select u.product_id, round((sum((price * units)) / sum(units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and purchase_date between start_date and end_date) group by u.product_id;"
96,"select u.product_id, round((sum((u.units * p.price)) / sum(u.units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date) group by 1;"
100,"select u.product_id, round((sum((price * units)) / sum(units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and purchase_date between start_date and end_date) group by u.product_id;"
141,"select u.product_id, cast((sum((units * price)) / sum(units)) as decimal(36, 2)) as average_price from unitssold as u left outer join prices as p on (p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date) group by u.product_id;"
155,"select a.product_id, round((sum((a.units * b.price)) / sum(a.units)), 2) as average_price from unitssold as a left outer join prices as b on (a.product_id = b.product_id and start_date <= a.purchase_date and end_date >= a.purchase_date) group by a.product_id;"
162,"select b.product_id, round((sum((units * price)) / sum(units)), 2) as average_price from unitssold as b left outer join prices as a on (b.product_id = a.product_id and b.purchase_date between a.start_date and end_date) group by 1;"
186,"select p.product_id, round((sum((p.price * u.units)) / sum(u.units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date) group by p.product_id;"
191,"select p.product_id, round((sum((p.price * u.units)) / sum(u.units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and p.start_date <= u.purchase_date and p.end_date >= u.purchase_date) group by p.product_id;"
300,"select u.product_id, round((sum((u.units * p.price)) / sum(units)), 2) as average_price from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date) group by u.product_id;"
302,"select u.product_id, round((sum((units * p.price)) / sum(units)), 2) as ""average_price"" from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date) group by u.product_id;"
307,"select us.product_id, round((sum((p.price * us.units)) / sum(us.units)), 2) as average_price from unitssold as us left outer join prices as p on (p.product_id = us.product_id and us.purchase_date between p.start_date and p.end_date) group by us.product_id;"
339,"with temp_price as (select u.product_id, (p.price * u.units) as t_price, u.units from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date)) select product_id, round((sum(t_price) / sum(units)), 2) as average_price from temp_price group by product_id;"
341,"with total_dollar_step1 as (select u.product_id, (p.price * u.units) as total_lines from unitssold as u left outer join prices as p on (u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date)), total_dollar_step2 as (select product_id, sum(total_lines) as total_price from total_dollar_step1 group by product_id), units_total as (select product_id, sum(units) as total_u from unitssold group by product_id) select a.product_id, round(cast((a.total_price / b.total_u) as numeric), 2) as average_price from total_dollar_step2 as a join units_total as b on a.product_id = b.product_id;"
