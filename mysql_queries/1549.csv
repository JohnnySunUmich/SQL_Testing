SELECT P.product_name, O.product_id, O.order_id, O.order_date FROM Customers C LEFT JOIN Orders O ON C.customer_id = O.customer_id LEFT JOIN Products P ON O.product_id = P.product_id WHERE (P.product_name, O.order_date) IN (SELECT P.product_name, MAX(O.order_date) FROM Customers C LEFT JOIN Orders O ON C.customer_id = O.customer_id LEFT JOIN Products P ON O.product_id = P.product_id GROUP BY P.product_name HAVING MAX(O.order_date) IS NOT NULL) ORDER BY P.product_name,O.order_id
SELECT P.product_name, O.product_id, order_id, order_date FROM Products P JOIN Orders O on P.product_id = O.product_id WHERE (O.product_id, order_date) IN (SELECT product_id, MAX(order_date) FROM Orders GROUP BY product_id) ORDER BY product_name, product_id, order_id
SELECT P.product_name, T.product_id, T.order_id, T.order_date FROM( SELECT product_id, order_date, order_id, Dense_Rank() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS RNK FROM Orders) AS T JOIN Products AS P ON T.product_id = P.product_id WHERE T.RNK = 1 ORDER BY product_name, T.product_id, T.order_id
SELECT P.product_name,CTE.product_id,CTE.order_id,CTE.order_date FROM (SELECT order_id,product_id, order_date, DENSE_RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) AS 'ranking' FROM Orders) AS CTE JOIN Products P ON P.product_id = CTE.product_id WHERE CTE.ranking = 1 ORDER BY 1,2,3
SELECT T1.product_name, T1.product_id, T1.order_id, T1.order_date FROM (SELECT P.product_name, P.product_id, O.order_id, O.order_date, O.ranks FROM Products P RIGHT JOIN (SELECT *, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS ranks FROM Orders) O ON P.product_id=O.product_id) T1 WHERE T1.ranks=1 ORDER BY T1.product_name, T1.product_name, T1.order_id
SELECT T2.product_name, T2.product_id, T2.order_id, T2.order_date FROM ( SELECT T1.product_name, T1.product_id, T1.order_id, T1.order_date, RANK() OVER (PARTITION BY T1.product_id ORDER BY T1.order_date DESC) AS PRODUCT_ORDER_DATE_RANK FROM ( SELECT P.product_name, P.product_id, O.order_id, O.order_date FROM Products P INNER JOIN Orders O ON P.product_id = O.product_id GROUP BY 1,2,3,4 ) AS T1 ) AS T2 WHERE T2.PRODUCT_ORDER_DATE_RANK = 1 ORDER BY 1,2,3
SELECT a.product_name, a.product_id, a.order_id, a.order_date FROM( SELECT Products.product_name, Products.product_id, Orders.order_id, Orders.order_date, dense_rank() over(partition by Orders.product_id order by order_date DESC) as rk FROM Orders Join Products ON Orders.product_id = Products.product_id ) a WHERE a.rk =1 ORDER BY product_name, product_id, order_id
SELECT inb.product_name, inb.product_id, ina.order_id, ina.order_date FROM ( SELECT product_id, order_id, order_date, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS r_number FROM Orders ) AS ina, Products AS inb WHERE ina.r_number = 1 AND ina.product_id = inb.product_id ORDER BY inb.product_name, inb.product_id, ina.order_id
SELECT p. product_name, o.product_id, o.order_id, o.order_date FROM Orders o JOIN Products p ON o.product_id = p.product_id WHERE (o.product_id, o.order_date) IN (SELECT product_id, MAX(order_date) FROM Orders GROUP BY 1) ORDER BY 1, 2, 3
SELECT p.product_name as product_name,t1.product_id as product_id, t1.order_id as order_id,t1.order_date FROM (SELECT product_id,order_id,order_date,DENSE_RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) as rank_order FROM Orders ORDER BY product_id) t1 LEFT JOIN Products p ON t1.product_id=p.product_id WHERE t1.rank_order=1 ORDER BY 1,2,3
SELECT p.product_name product_name, o.product_id product_id, o.order_id order_id, o.order_date order_date FROM orders o JOIN products p ON o.product_id=p.product_id WHERE (o.product_id, o.order_date) IN (SELECT product_id, MAX(order_date) FROM orders GROUP BY product_id) ORDER BY product_name, product_id, order_id
SELECT p.product_name, p.product_id, o.order_id, o.order_date FROM Products p LEFT JOIN Orders o ON p.product_id = o.product_id WHERE (p.product_id, o.order_date) IN (SELECT product_id, MAX(order_date) FROM Orders GROUP BY product_id) ORDER BY 1, 2, 3
SELECT p.product_name, p.product_id, o.order_id, o.order_date FROM Products p RIGHT JOIN Orders o ON p.product_id=o.product_id WHERE (p.product_id, o.order_date) IN (SELECT product_id, MAX(order_Date) FROM Orders GROUP BY product_id) ORDER BY 1, 2, 3
SELECT p.product_name, p.product_id, o.order_id, o.order_date FROM orders o JOIN products p ON o.product_id = p.product_id WHERE (o.product_id, o.order_date) IN ( SELECT product_id, MAX(order_date) AS order_date FROM orders GROUP BY product_id) ORDER BY p.product_name, o.product_id, o.order_id
SELECT p.product_name, p.product_id, temp.order_id, temp.order_date FROM (SELECT * FROM (SELECT *, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) rnk FROM Orders) t WHERE rnk = 1) temp JOIN Products p ON temp.product_id = p.product_id ORDER BY p.product_name, p.product_id, temp.order_id
SELECT p.product_name,P.product_id , order_id , order_date FROM Orders o JOIN Products p ON o.product_id=p.product_id Where ( p.Product_id , order_date) in (SELECT product_id, MAX(order_date ) as dates FROM orders GROUP BY 1 ) ORDER BY 1,2,3
SELECT p.product_name,p.product_id,a.order_id,a.order_date FROM ( SELECT *,rank() over (partition by product_id order by order_date desc) as Ranks from orders order by product_id ) as a inner join products as p on a.product_id=p.product_id where ranks=1 order by p.product_name,a.order_id
SELECT p.product_name,p.product_id,o.order_id,o.order_date FROM Products p JOIN Orders o ON p.product_id = o.product_id JOIN ( SELECT product_id, MAX(order_date) AS first_order_date FROM Orders GROUP BY product_id ) t ON t.product_id = p.product_id AND t.first_order_date = o.order_date ORDER BY p.product_name,p.product_id,o.order_id
SELECT product_name, o.product_id, o.order_id, order_date FROM Products p JOIN Orders o ON p.product_id = o.product_id WHERE (o.product_id, order_date) IN (SELECT product_id, max(order_date) as mostRecent FROM Orders GROUP BY product_id) Order BY 1, 2, 3
SELECT product_name, o.product_id, order_id, order_date FROM (SELECT *, RANK() OVER(partition by product_id order by order_date desc) num FROM Orders) o, Customers c, Products p WHERE o.customer_id = c.customer_id AND o.product_id = p.product_id AND num < 2 ORDER BY product_name, product_id, order_id
SELECT product_name, o1.product_id as product_id, o1.order_id AS order_id, o1.order_date AS order_date FROM Orders o1 JOIN ( SELECT product_id, MAX(order_date) as order_date FROM Orders GROUP BY product_id ) o2 ON o1.product_id = o2.product_id AND o1.order_date = o2.order_date JOIN Products ON o1.product_id = Products.product_id ORDER BY product_name ASC, product_id ASC, order_id ASC
SELECT product_name, product_id as product_id, order_id, order_date FROM( SELECT product_name, orders.product_id, order_id, order_date, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) as rank_date FROM Orders JOIN Products USING (product_id) ) as rank_dated WHERE rank_date = 1 ORDER BY 1,2,3
SELECT product_name, product_id, order_id, order_date FROM ( SELECT p.product_id, p.product_name,o.order_id, o.order_date, DENSE_RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) ranks FROM Orders o LEFT JOIN Products p ON o.product_id = p.product_id )t WHERE ranks = 1 ORDER BY product_name, product_id, order_id
SELECT product_name, product_id, order_id, order_date FROM ( SELECT product_name, P.product_id, order_id, order_date, RANK() OVER (PARTITION BY product_name ORDER BY order_date DESC) rnk FROM Orders O JOIN Products P On O.product_id = P.product_id ) temp WHERE rnk = 1 ORDER BY product_name, product_id, order_id
SELECT product_name, product_id, order_id, order_date FROM (SELECT p.product_name, p.product_id, o.order_id, o.order_date, RANK() OVER(PARTITION BY p.product_id ORDER BY o.order_date DESC) AS rk FROM Products AS p JOIN Orders AS o ON p.product_id = o.product_id) AS t WHERE t.rk = 1 ORDER BY product_name, product_id, order_id
SELECT product_name, product_id, order_id, order_date FROM (SELECT product_name, p.product_id, order_id, order_date, RANK() OVER(PARTITION BY product_name ORDER BY order_date DESC) AS ranking FROM Orders o JOIN Products p ON o.product_id = p.product_id) a WHERE ranking = 1 ORDER BY 1, 2, 3
SELECT product_name, product_id, order_id, order_date FROM Orders JOIN Products USING(product_id) WHERE (product_id, order_date) IN ( SELECT product_id, MAX(order_date) FROM Orders GROUP BY product_id ) ORDER BY product_name, product_id, order_id
SELECT product_name, product_id, order_id, order_date FROM( SELECT Products.product_name, Products.product_id, Orders.order_id, Orders.order_date, dense_rank() over(partition by Products.product_id order by order_date DESC) as rk FROM Orders Join Products ON Orders.product_id = Products.product_id ) a WHERE rk =1 ORDER BY product_name, product_id, order_id
Select Products.product_name, Products.product_id, Orders_1.order_id, Orders_1.order_date From (Select *, RANK() OVER (PARTITION BY product_id ORDER BY order_date Desc) as order_date_rank From Orders) as Orders_1, Products Where Orders_1.order_date_rank = 1 And Orders_1.product_id = Products.product_id Order By product_name, product_id, order_id
Select p.product_name, p.product_id, o.order_id, o.order_date from orders o join products p on o.product_id = p.product_id where (o.product_id, o.order_date) in ( Select product_id, max(order_date) from Orders group by product_id ) order by p.product_name, p.product_id, o.order_id
Select product_name, A.product_id, A.order_id, A.order_date From (Select order_id, order_date, product_id, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) as ranking From Orders) A JOIN Products P On A.product_id=P.product_id where ranking=1 Order by product_name, A.product_id, A.order_id
Select product_name,product_id, order_id,order_date From(Select product_name,O.product_id, order_id, order_date, rank()over(partition by O.product_id order by order_date DESC)as rk From Orders O join Products P on O.product_id = P.product_id)t where rk = 1 Order by product_name, product_id, order_id
WITH CTE AS ( SELECT *, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) rk FROM orders ) SELECT b.product_name, a.product_id, a.order_id, a.order_date FROM CTE a JOIN products b USING(product_id) WHERE a.rk=1 ORDER BY product_name, product_id, order_id
WITH CTE AS ( SELECT product_id, MAX(order_date) AS max_date FROM Orders GROUP BY product_id ) SELECT p.product_name, p.product_id, o.order_id, o.order_date FROM Orders o LEFT JOIN Products p ON o.product_id = p.product_id WHERE (p.product_id, o.order_date) IN ( SELECT * FROM CTE) ORDER BY product_name, product_id, order_id
WITH CTE AS ( SELECT product_id, order_id, order_date, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS rk FROM Orders ) SELECT p.product_name, p.product_id, CTE.order_id, CTE.order_date FROM CTE JOIN Products p ON CTE.product_id = p.product_id WHERE CTE.rk = 1 ORDER BY p.product_name, p.product_id, CTE.order_id
WITH CTE AS (SELECT order_id, order_date, customer_id, product_id, RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) rnk FROM orders) SELECT product_name, c.product_id, order_id, order_date FROM CTE c LEFT JOIN products p ON c.product_id=p.product_id WHERE rnk=1 ORDER BY product_name, c.product_id, order_id
WITH MostRecentOrder AS(SELECT product_id ,MAX(order_date) AS MostRecent FROM Orders GROUP BY product_id) SELECT P.product_name ,P.product_id ,O.order_id ,O.order_date FROM Orders O INNER JOIN Products P ON P.product_id = O.product_id INNER JOIN MostRecentOrder MR ON O.product_id = MR.product_id AND O.order_date = MR.MostRecent ORDER BY 1 ASC, 2 ASC, 3 ASC
WITH OrderRanking AS (SELECT order_id ,order_date ,product_id ,RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS Rk FROM Orders) SELECT P.product_name ,P.product_id ,OdR.order_id ,OdR.order_date FROM Products P INNER JOIN OrderRanking OdR ON OdR.product_id = P.product_id AND OdR.Rk = 1 ORDER BY 1 ASC,2 ASC, 3 ASC
WITH RECENT_ORDERS AS ( Select order_id,order_date,product_id from (Select * , max(order_date ) Over(Partition By product_id ) As Recent_Order From Orders ) Orders_recent Where order_date = Recent_Order Group by order_id,order_date,product_id ) Select product_name, product_id, order_id, order_date From Products P Join RECENT_ORDERS using(product_id ) Order by product_name,product_id, order_id
WITH cte AS (SELECT order_id, product_id, order_date, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS rnk FROM Orders) SELECT product_name, product_id, order_id, order_date FROM cte JOIN Products USING (product_id) WHERE cte.rnk = 1 ORDER BY product_name, product_id, order_id
WITH cte AS (SELECT product_id, order_id, rank() OVER (partition by product_id order by order_date DESC) AS rnk, order_date FROM Orders) SELECT product_name, cte.product_id, order_id, order_date FROM cte JOIN products USING (product_id) WHERE rnk =1 ORDER BY product_name, product_id,order_id
WITH last_date as ( SELECT product_id, order_id, order_date, DENSE_RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) as rnk FROM orders ) SELECT p.product_name, p.product_id, l.order_id, l.order_date FROM products p LEFT JOIN last_date l ON p.product_id = l.product_id WHERE l.rnk = 1 ORDER BY p.product_name, p.product_id, l.order_id
WITH most_recent AS ( SELECT order_id, order_date, product_id FROM ( SELECT order_id, order_date, product_id, DENSE_RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS rn FROM orders ) AS orders_ranked WHERE rn = 1 ) SELECT products.product_name, most_recent.product_id, most_recent.order_id, most_recent.order_date FROM most_recent LEFT JOIN products ON most_recent.product_id = products.product_id ORDER BY 1, 2, 3
WITH most_recent_orders AS (SELECT p.product_name, o.product_id, o.order_id, o.order_date, DENSE_RANK() OVER(PARTITION BY o.product_id ORDER BY o.order_date DESC) as rn FROM orders o JOIN products p ON o.product_id = p.product_id ) SELECT product_name, product_id, order_id, order_date FROM most_recent_orders WHERE rn = 1 ORDER BY product_name, product_id, order_id
WITH r AS (SELECT *, DENSE_RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) AS rnk FROM Orders), recent AS (SELECT product_id, order_id, order_date FROM r WHERE rnk = 1) SELECT p.product_name, r.product_id, r.order_id, r.order_date FROM Products p JOIN recent r ON p.product_id = r.product_id ORDER BY p.product_name, r.product_id, r.order_id
WITH ranked_orders AS ( SELECT order_id , order_date , customer_id , product_id , RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) as order_rank FROM Orders ) SELECT p.product_name , p.product_id , o.order_id , o.order_date FROM Products as p INNER JOIN ranked_orders as o ON (o.product_id = p.product_id) WHERE o.order_rank = 1 ORDER BY p.product_name, p.product_id, o.order_id
WITH recent_orders AS ( SELECT product_id, order_id, order_date FROM ( SELECT *, RANK() OVER(PARTITION BY product_id ORDER BY order_date DESC) AS rank_date FROM Orders ) rank_by_product WHERE rank_date = 1 ) SELECT p.product_name, r.product_id, r.order_id, r.order_date FROM recent_orders r JOIN Products p ON r.product_id = p.product_id ORDER BY p.product_name ASC, r.product_id ASC, r.order_id ASC
WITH t AS ( SELECT product_id, MAX(order_date) order_date FROM orders GROUP BY product_id ) SELECT p.product_name product_name, o.product_id product_id, o.order_id order_id, o.order_date order_date FROM orders o JOIN t ON o.product_id=t.product_id AND o.order_date=t.order_date JOIN products p ON o.product_id=p.product_id ORDER BY product_name, product_id, order_id
WITH t1 AS( SELECT order_id, order_date, RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) AS rnk, product_id FROM Orders ) SELECT p.product_name, t.product_id, t.order_id, t.order_date FROM Products p INNER JOIN t1 t ON (p.product_id = t.product_id) WHERE rnk = 1 ORDER BY 1 ASC, 2 ASC, 3 ASC
WITH table1 AS( SELECT o.*, MAX(o.order_date) OVER(PARTITION BY o.product_id) AS max_date, p.product_name FROM Orders o INNER JOIN Products p USING(product_id) ) SELECT product_name, product_id, order_id, order_date FROM table1 WHERE order_date = max_date ORDER BY product_name ASC, product_id ASC, order_id ASC
WITH temp AS (SELECT product_id, MAX(order_date) AS recent_date FROM Orders GROUP BY product_id) SELECT product_name, o.product_id, order_id, order_date FROM Orders o JOIN Products p USING(product_id) WHERE (o.product_id, order_date) IN (SELECT product_id, recent_date FROM temp) ORDER BY product_name, o.product_id, order_id
WITH temp as ( select product_id,order_id ,order_date from Orders where (product_id, order_date) in (select product_id, max(order_date) as recent_date from Orders group by 1) order by 1 ) select P.product_name, T.product_id, T.order_id, T.order_date from TEMP T left join Products P ON T.product_id = P.product_id order by 1,2,3
With t1 as ( select p.product_name, p.product_id, o.order_id, o.order_date, rank() over (partition by p.product_id order by o.order_date desc) as my_rank from Products p inner join Orders o on o.product_id = p.product_id ) select product_name, product_id, order_id, order_date from t1 where my_rank = 1 order by product_name asc, product_id asc, order_id asc
select Products.product_name, Products.product_id, Orders.order_id, Orders.order_date from ( select product_id, max(order_date) as order_date from Orders group by product_id ) a left join Orders on Orders.order_date = a.order_date and Orders.product_id=a.product_id left join Products on Products.product_id = Orders.product_id order by product_name asc, product_id asc, order_id asc
select a.product_name as product_name, b.product_id, b.order_id, b.order_date from products a join ( select product_id, order_id, order_date, rank() over(partition by product_id order by order_date desc) as ranking from orders ) b on a.product_id = b.product_id where ranking = 1 order by a.product_name, a.product_id, b.order_id asc
select a.product_name, a.product_id, a.order_id, a.latest_order_Date as order_date from ( select p.product_id, p.product_name, o.order_id, o.order_date, max(o.order_date) over (partition by p.product_id) as latest_order_Date from Products p join Orders o on p.product_id = o.product_id ) a where a.order_date = a.latest_order_Date order by a.product_name asc, a.product_id asc , a.order_id asc
select a.product_name, t1.product_id, t1.order_id , t1.order_date from ( select rank() over(partition by t.product_id order by t.order_date desc) as rk, t.product_id,t.order_id,t.order_date from orders t ) t1 join products a on t1.product_id=a.product_id where t1.rk=1 order by a.product_name, t1.product_id,t1.order_id
select a.product_name,a.product_id,a.order_id,a.order_date from ( select d1.order_id,d2.product_id,d1.order_date,d2.product_name, rank() over (partition by d1.product_id order by d1.order_date desc) as rank_order from Orders d1 join products d2 on d1.product_id = d2.product_id) a where a.rank_order = 1 order by a.product_name, a.product_id, a.order_id
select agg.product_name , agg.product_id , agg.order_id , agg.order_date from ( select p.product_name , p.product_id , o.order_id , o.order_date , rank() over(partition by p.product_id order by o.order_date desc) as req_rank from orders o inner join products p on p.product_id = o.product_id ) AGG where agg.req_rank = 1 order by 1,2,3
select b.product_name, a.product_id, a.order_id, a.order_date from ( select product_id, order_id, order_date from Orders where (product_id, order_date) in ( select product_id, max(order_date) order_date from Orders group by product_id ) ) a join Products b on a.product_id = b.product_id order by product_name, product_id, order_id
select b.product_name, a.product_id, a.order_id, a.order_date from ( select product_id, order_id, order_date, rank() over(partition by product_id order by order_date desc) rnk from orders) a join products b on a.product_id = b.product_id where rnk = 1 ORDER BY product_name, product_id, order_id
select b.product_name, a.product_id, a.order_id, a.order_date from Orders a join Products b on a.product_id = b.product_id where (a.product_id, a.order_date) in ( select product_id, max(order_date) as order_date from Orders group by product_id) order by b.product_name, a.product_id, a.order_id
select c.product_name, c.product_id, c.order_id, c.order_date from (select a.product_name, a.product_id, b.order_id, b.order_date, rank() over(partition by product_id order by order_date desc) as rwn from products a left join Orders b on a.product_id = b.product_id) c where rwn = 1 and order_date is not null and order_id is not null order by product_name asc, product_id, order_id
select c.product_name,b.product_id, b.order_id, b.order_date from (select product_id, max(order_date) as recent_dt from orders group by product_id) a inner join orders b on a.product_id=b.product_id and a.recent_dt=b.order_date inner join products c on a.product_id=c.product_id order by c.product_name, b.product_id, b.order_id
select c1.product_name, c1.product_id, c1.order_id, c1.order_date from (select p.product_name,o.product_id, o.order_id, o.order_date, dense_rank() over(partition by o.product_id order by o.order_date desc) as d_rank from orders o left join products p on p.product_id = o.product_id) c1 where c1.d_rank = 1 order by c1.product_name, c1.product_id,c1.order_id
select p.product_name, O.product_id, O.order_id, O.order_date from Products p join( select product_id, order_id, order_date, rank() over(partition by product_id order by order_date desc) as recent_order from Orders ) O on O.product_id = p.product_id where O.recent_order = 1 order by p.product_name, O.product_id, O.order_id
select p.product_name, a.product_id, a.order_id ,a.order_date from (select product_id ,order_id,order_date ,rank() over (partition by product_id order by order_date desc) as rn from orders)a left join products p on a.product_id=p.product_id where rn<=1 order by p.product_name, a.product_id, a.order_id
select p.product_name, o.product_id, o.order_id, o.order_date from (select product_id, order_id, order_date, dense_rank()over(partition by product_id order by order_date desc) as rnk from orders) o join products p on o.product_id = p.product_id where o.rnk = 1 order by 1, 2, 3
select p.product_name, o.product_id, o.order_id, o.order_date from Orders o left join Products p on o.product_id = p.product_id join (select product_id, max(order_date) as 'recent_date' from Orders group by product_id) m on m.product_id = o.product_id and m.recent_date = o.order_date order by p.product_name, o.product_id, o.order_id
select p.product_name, o.product_id, o.order_id, o.order_date from Orders o left join Products p on o.product_id=p.product_id join (select product_id, max(order_date) as recent_date from Orders group by product_id)m on o.product_id=m.product_id and o.order_date=m.recent_date order by product_name,product_id, order_id
select p.product_name, o.product_id, o.order_id, o.order_date from products p join ( select order_id, product_id, order_date, rank() over (partition by product_id order by order_date desc) as rank_num from orders ) o on p.product_id = o.product_id where o.rank_num=1 order by p.product_name asc, o.product_id asc, o.order_id asc
select p.product_name, o.product_id, order_id, order_date from orders o join products p using(product_id) where (order_date,o.product_id) in (select max(order_date), product_id from orders group by product_id) order by product_name, o.product_id, order_id
select p.product_name, p.product_id, o.order_id, o.order_date from ( select product_id, max(order_date) as max_date from orders group by product_id ) t1 join orders o on o.product_id = t1.product_id and o.order_date = t1.max_date join products p on t1.product_id = p.product_id order by p.product_name, p.product_id, o.order_id
select p.product_name, p.product_id, o.order_id, o.order_date from Products p join Orders o using (product_id) where (product_id, order_date) in (select product_id, max(order_date) as order_date from Orders group by product_id) order by 1, 2, 3
select p.product_name, p.product_id, tmp.order_id, tmp.order_date from ( select product_id, order_id, order_date , rank() over(partition by product_id order by order_date desc) as rnk from orders ) tmp join products p on p.product_id=tmp.product_id where tmp.rnk=1 order by 1,2,3
select p.product_name, r.product_id, r.order_id, r.order_date from ( select order_id, customer_id, product_id, order_date, rank() over (partition by product_id order by order_date desc) ranking from Orders) r join products p on r.product_id = p.product_id where ranking = 1 order by product_name, product_id, order_id
select p.product_name,o.product_id,o.order_id,o.order_date from Orders o join Products p on p.product_id=o.product_id where (o.product_id, o.order_date)in (select product_id, max(order_date)as recentday from Orders group by 1 ) order by product_name,product_id,order_id
select p.product_name,p.product_id, o.order_id, o.order_date from orders o join products p on o.product_id=p.product_id where (o.product_id,o.order_date) in (select product_id, max(order_date) as max_date from Orders group by product_id) order by p.product_name asc, p.product_id asc, o.order_id asc
select p1.product_name, a1.product_id, a1.order_id, a1.order_date from ( select o1.product_id,o1.order_id, o1.order_date from orders o1, (select product_id,max(order_date) as od from orders group by 1) o2 where (o1.product_id,o1.order_date) = (o2.product_id,o2.od)) a1 inner join products p1 on a1.product_id = p1.product_id order by 1,2,3
select pr.product_name,pr.product_id,abc.order_id,abc.order_date from products pr inner join (select order_id, order_date, customer_id, product_id, rank() over(partition by product_id order by order_date desc) 'rnk' from orders order by product_id) abc on abc.product_id = pr.product_id where abc.rnk = 1 order by 1,2,3
select prod.product_name as product_name ,prod.product_id as product_id ,orderrank.order_id as order_id ,orderrank.order_date as order_date from ( select order_id ,product_id ,rank() over(partition by product_id order by order_date desc) as rk ,order_date from Orders ) orderrank join Products prod on orderrank.product_id = prod.product_id where orderrank.rk = 1 order by product_name ,product_id ,order_id
select prod.product_name, ord1.product_id, ord1.order_id, ord1.order_date from orders ord1 inner join (select distinct product_id, max(order_date) over(partition by product_id) as order_date from orders order by product_id) ord2 on ord1.product_id = ord2.product_id and ord1.order_date = ord2.order_date inner join products prod on ord2.product_id = prod.product_id order by prod.product_name,ord1.order_id
select product_name , product_id , order_id , order_date from ( select p.product_name , p.product_id , o.order_id , o.order_date , dense_rank() over(partition by product_id order by order_date desc) as seq from orders o left join products p on o.product_id = p.product_id ) x where seq = 1 order by 1, 2, 3
select product_name , product_id , order_id, order_date from (select p.product_name,p.product_id, order_id, order_date,dense_rank() over(partition by p.product_id order by order_date desc) as rnk from products as p inner join orders as o on p.product_id = o.product_id) t where rnk = 1 order by 1,2,3
select product_name , product_id, order_id , A.order_date as order_date from orders as A join products as B using(product_id) where (A.product_id, A.order_date ) in (select product_id ,max(order_date) from Orders group by product_id ) ORDER BY product_name, product_id, order_id
select product_name , product_id, order_id , order_date from Orders o inner join Products p using (product_id) group by 1, 2, 3 HAVING (product_id, order_date) IN (select product_id, MAX(order_date) from Orders group by 1) order by 1, 2
select product_name, Products.product_id, order_id, order_date from Products inner join (select *, rank() over (partition by product_id order by order_date desc) as date_rank from Orders) temp on Products.product_id=temp.product_id and temp.date_rank=1 order by product_name, product_id, order_id
select product_name, a.product_id, order_id, order_date from (select o.product_id ,order_id,order_date, dense_rank() over (partition by o.product_id order by order_date desc) as num, product_name from orders o join products p on o.product_id = p.product_id) a where num = 1 order by 1,2,3
select product_name, a.product_id, order_id, order_date from (select order_id, product_id, order_date from orders where (product_id, order_date) in (select product_id, max(order_date) from orders group by product_id)) a join products b on a.product_id = b.product_id order by 1, 2, 3
select product_name, a.product_id, order_id, order_date from (select product_id, order_id, order_date, first_value(order_date) over (partition by product_id order by order_date desc) as most_recent from Orders) a left join Products b on a.product_id = b.product_id where order_date = most_recent order by 1, 2, 3
select product_name, o.product_id, order_id, o.order_date from Products p inner join Orders o on p.product_id=o.product_id join (select product_id, max(order_date) as recent_date from Orders group by product_id) as t on t.product_id=o.product_id and order_date=recent_date order by p.product_name, o.product_id,order_id
select product_name, order_ranking.product_id, order_id, order_date from Products join (select order_id, order_date, product_id, rank() over(partition by product_id order by order_date desc) as order_rank from Orders) order_ranking on Products.product_id = order_ranking.product_id where order_rank = 1 order by product_name asc, product_id asc, order_id asc
select product_name, p.product_id, order_id, order_date from Products p join Orders o using (product_id) where (product_id, order_date) in (select product_id, max(order_date) over(partition by product_id) as recent from Orders ) order by 1, 2, 3
select product_name, p.product_id,order_id,od order_date from Products p, (select product_id,max(order_date)od from Orders group by product_id)t, Orders o where t.product_id = p.product_id and o.order_date = od and o.product_id = t.product_id order by product_name, p.product_id,order_id,od
select product_name, product_id, order_id , order_date from ( select rank() over(partition by t.product_id order by t.order_date desc) as rk, t.product_id,a.product_name,t.order_id,t.order_date from orders t join products a on t.product_id=a.product_id ) t1 where t1.rk=1 order by product_name, product_id,order_id
select product_name, product_id, order_id, order_date from ( select a.order_id, a.order_date, b.product_id, b.product_name, dense_rank() over(partition by b.product_id order by a.order_date desc) as rnk from orders a, products b where a.product_id = b.product_id ) x where rnk = 1 order by product_name, product_id, order_id
select product_name, product_id, order_id, order_date from ( select b.product_name, a.product_id, a.order_id, a.order_date, rank() over (partition by a.product_id order by order_date desc) as rnk from orders a join products b on a.product_id = b.product_id ) t where rnk = 1 order by 1, 2, 3
select product_name, product_id, order_id, order_date from ( select b.product_name, a.product_id, a.order_id, a.order_date, rank()over(partition by a.product_id order by a.order_date desc) as rnk from Orders a join Products b on a.product_id=b.product_id )a where rnk=1 order by product_name asc,product_id asc,order_id asc
select product_name, product_id, order_id, order_date from ( select o.product_id, product_name, order_id, order_date, dense_rank() over(partition by o.product_id order by order_date desc) as 'order_rank' from orders o left join products p on p.product_id = o.product_id) as A where order_rank = 1 order by product_name,product_id,order_id
select product_name, product_id, order_id, order_date from ( select order_id, order_date, o.product_id, product_name, dense_rank() over(partition by product_id order by order_date desc) as prod_rec_ord_rank from Orders o join Products p on o.product_id = p.product_id ) a where prod_rec_ord_rank = 1 order by product_name, order_id
select product_name, product_id, order_id, order_date from ( select p.product_name, o.product_id, o.order_id, o.order_date, rank() over (partition by product_id order by order_date desc) as rnk from orders o left join products p on o.product_id = p.product_id )src where rnk = 1 order by 1, 2, 3
select product_name, product_id, order_id, order_date from ( select p.product_name, p.product_id, o.order_id, o.order_date, rank() over(partition by p.product_id order by o.order_date desc) as rnk from products p join orders o on p.product_id = o.product_id) temp where rnk=1 order by product_name, order_id
select product_name, product_id, order_id, order_date from ( select p.product_name, p.product_id, o.order_id, o.order_date, rank() over(partition by p.product_name order by o.order_date desc) as flag from Products p, Orders o where p.product_id = o.product_id) tmp where flag=1 order by product_name, order_id
select product_name, product_id, order_id, order_date from ( select product_name, a.product_id, order_id, order_date, dense_rank() over (partition by product_name order by order_date desc) rnk from orders a join products b using (product_id) ) t where rnk = 1 order by 1,2,3
select product_name, product_id, order_id, order_date from ( select product_name, o.product_id, order_id, order_date, dense_rank() over(partition by o.product_id order by order_date desc) as ranked from orders o join products p on p.product_id = o.product_id ) f where ranked = 1 order by product_name, product_id, order_id
select product_name, product_id, order_id, order_date from ( select product_name, p.product_id, order_id, order_date, rank() over (partition by product_id order by order_date desc) as rk from Products p join Orders o on p.product_id = o.product_id) x where rk = 1 order by 1,2,3
select product_name, product_id, order_id, order_date from ( select product_name, product_id, order_id, rank() over (partition by product_id order by order_date desc) as ranking, order_date from orders o join products c using(product_id)) v where ranking = 1 order by product_name, product_id asc, order_id asc
select product_name, product_id, order_id, order_date from (select o.product_id, product_name, order_id, order_date, dense_rank() over (partition by o.product_id order by order_date desc) as rnk from orders o join products p on o.product_id = p.product_id) t where rnk = 1 order by 1,2,3
select product_name, product_id, order_id, order_date from (select order_id, order_date, o.product_id, p.product_name, rank() over(partition by o.product_id order by order_date desc) as rnk from orders o join products p on o.product_id = p.product_id) a where rnk=1 order by product_name, product_id, order_id
select product_name, product_id, order_id, order_date from (select p.product_id, p.product_name, o.order_id, o.order_date, dense_rank() over (partition by product_id order by order_date desc) as rnk from Products p join Orders o on p.product_id = o.product_id ) comb where rnk =1 order by 1,2,3
select product_name, product_id, order_id, order_date from (select p.product_id, p.product_name, o.order_id, o.order_date, rank() over(partition by product_id order by order_date desc) as ranking from orders as o left join products as p on o.product_id = p.product_id) as tmpt where ranking = 1 order by 1 asc, 2 asc, 3 asc
select product_name, product_id, order_id, order_date from (select p.product_name, p.product_id, o.order_id, o.order_date, max(o.order_date) over(PARTITION BY product_id) as ppp from Orders o join Products p on o.product_id = p.product_id order by product_name asc, product_id asc, order_id asc) aaa where order_date = ppp
select product_name, product_id, order_id, order_date from (select product_name, o.product_id, order_id, order_date, rank() over (partition by p.product_name order by order_date desc) as rnk from Orders o join Products p on o.product_id = p.product_id) tmp where rnk = 1 order by product_name asc, product_id asc, order_id asc
select product_name, product_id, order_id, order_date from (select product_name, p.product_id, order_id, order_date,dense_rank() over (partition by product_id order by order_date desc) as rnk from customers c inner join orders o using(customer_id) inner join products p using(product_id) ) tmp where rnk=1 ORDER BY product_name, product_id, order_id
select product_name, product_id, order_id, order_date from (select product_name,product_id, order_id, order_date, max(order_date) over (partition by product_id) as max_date from Orders inner join Products using (product_id))t where order_date = max_date order by 1,2,3
select product_name, product_id, order_id, order_date from( select p.product_name, o.product_id, o.order_id, o.order_date, rank()over(partition by o.product_id order by o.order_date DESC)rk from orders o left join products p on o.product_id=p.product_id) temp where rk=1 order by product_name, product_id, order_id
select product_name, product_id,order_id,order_date from (select p.product_name as product_name, p.product_id as product_id,o.order_id,o.order_date, rank() over (partition by o.product_id order by o.order_date desc) as "rnk" from orders o join products p on p.product_id = o.product_id ) result where rnk = 1 order by 1,2,3
select product_name, sub.product_id, sub.order_id, sub.order_date from (select product_id, order_date, order_id, rank() over (partition by product_id order by order_date desc) as rnk from Orders) sub left join Products p on sub.product_id = p.product_id where rnk = 1 order by 1, 2, 3
select product_name, t.product_id, order_id, order_date from ( select order_id, order_date, product_id, rank()over(partition by product_id order by order_Date desc) as ranking from orders) as t join products on products.product_id = t.product_id where ranking=1 order by 1,2,3
select product_name, t.product_id, order_id, order_date from (select product_id, order_id, order_date, rank() over (partition by product_id order by order_date desc) r from orders) t join products p on p.product_id = t.product_id where r = 1 order by 1, 2, 3
select product_name, tmp.product_id, tmp.order_id, order_date from( select product_id, order_id, order_date, rank() over(partition by product_id order by max(order_date) desc) as rnk from orders group by product_id, order_id ) tmp join products p on tmp.product_id = p.product_id where tmp.rnk = 1 group by order_id order by product_name asc, product_id asc, order_id asc
select product_name, y.product_id, order_id, order_date from (select order_id, order_date, product_id from (select order_id, order_date,product_id, rank()over(partition by product_id order by order_date desc) as r from orders )x where r=1)y left join products p on p.product_id=y.product_id order by product_name, product_id,order_id
select product_name,O.product_id,order_id,order_date from orders O join products P on O.product_id = P.product_id where (O.product_id,O.order_date) in (select product_id,max(order_date) from orders group by product_id ) order by product_name asc,product_id asc,order_id asc
select product_name,p.product_id,Order_id,order_Date from products p join ( select product_id,order_id,order_date,rank() over (partition by product_id order by order_date desc) rk from orders ) o on o.product_id=p.product_id where rk=1 order by 1,2,3
select product_name,product_id,order_id, order_date from ( select P.product_name, O.product_id, O.order_id, O.order_date, rank() over (partition by O.product_id order by O.order_date desc) as rnk from Orders O left join Products P on O.product_id = P.product_id) tbl where rnk = 1 order by product_name, product_id, order_id
select product_name,product_id,order_id, order_date from (select product_name,orders.product_id,order_id, order_date, dense_rank() over (partition by product_id order by order_date DESC) as rank1 from orders join products on orders.product_id=products.product_id) a where rank1=1 order by 1,2,3
select product_name,product_id,order_id,order_date from (select p.product_name,p.product_id,o.order_id,o.order_date, dense_rank() over(partition by p.product_id order by order_date desc) 'rank' from orders o, products p where o.product_id=p.product_id) a where a.rank=1 order by product_name, product_id, order_id
select product_name,product_id,order_id,order_date from (select p.product_name,p.product_id,o.order_id,o.order_date, rank() over(partition by p.product_id order by order_date desc)rnk from products p join orders o on p.product_id=o.product_id )tmp where tmp.rnk=1 order by product_name,product_id,order_id asc
select products.product_name , products.product_id, orders.order_id, orders.order_date from Orders join Products on Orders.product_id = Products.product_id where ( Orders.product_id , Orders.order_date ) in ( select Orders.product_id , MAX( Orders.order_date ) from Orders group by product_id ) order by product_name , order_id
select t.product_name, t.product_id, t.order_id, t.order_date from ( select o.order_id, o.order_date, o.product_id, p.product_name, dense_rank() over (partition by o.product_id order by o.order_date desc) as r from orders o left join products p on p.product_id =o.product_id) as t where t.r=1 order by t.product_name, t.product_id , t.order_id
select t1.product_name, t1.product_id , t1.order_id, t1.order_date from (select p.product_name, p.product_id , dense_rank() over(partition by product_id order by o.order_date desc)rnk, o.order_id, o.order_date from products p join orders o on p.product_id = o.product_id) t1 where t1.rnk = 1 order by product_name , order_id
select t2.product_name, t1.product_id, t1.order_id, t1.order_date from orders t1 join ( select t1.product_id, t1.product_name, max(t2.order_date) as most_recent_order_date from products t1 join orders t2 on t2.product_id = t1.product_id group by t1.product_id ) t2 on t2.product_id = t1.product_id where t1.order_date = t2.most_recent_order_date order by t2.product_name asc, t1.product_id asc, t1.order_id asc
select t4.product_name, t4.product_id, t5.order_id, t4.order_date from ( select * from ( select t2.product_id, t2.product_name, t1.order_date, rank() over (partition by t2.product_id order by t1.order_date desc) as ranks from Orders t1 left join Products t2 on t1.product_id = t2.product_id ) t3 where ranks = 1 ) t4 left join Orders t5 on t4.order_date = t5.order_date and t4.product_id = t5.product_id group by 1,2,3,4 order by 1,2,3,4
select tbl2.product_name, tbl2.product_id, tbl1.order_id, tbl1.order_date from ( select order_id, order_date, product_id, rank() over(partition by product_id order by order_date desc) as order_rank from Orders ) as tbl1 inner join Products tbl2 on tbl1.product_id = tbl2.product_id where tbl1.order_rank = 1 order by tbl2.product_name asc, tbl2.product_id asc, tbl1.order_id asc
with CTE as (select product_id, order_date, rank() over (partition by product_id order by order_date desc)as rk, order_id from Orders), cte2 as (select * from CTE where rk=1) select Products.product_name,cte2.product_id, cte2.order_id, cte2.order_date from cte2 JOIN Products ON cte2.product_id=Products.product_id order by product_name asc, product_id asc,order_id asc
with O as(select order_id,product_id,order_date,rank() over (partition by product_id order by order_date desc) as rnk from orders) select P.product_name,OD.* from (select product_id,order_id,order_date from O where rnk=1) OD JOIN products P on P.product_id=Od.product_id order by P.product_name,OD.product_id,OD.order_id
with a as(select product_id,order_id,order_date from( select order_id, order_date, product_id, dense_rank() over(partition by product_id order by order_date desc) as rnk from orders)t where rnk = 1) select p.product_name, a.product_id, a.order_id, a.order_date from a join products p on p.product_id = a.product_id order by 1,2,3
with cte AS( SELECT p.product_name, p.product_id, o.order_id, o.order_date, DENSE_RANK() OVER (PARTITION BY product_id ORDER BY order_date DESC) AS order_rank FROM Orders o LEFT JOIN Customers c ON o.customer_id = c.customer_id LEFT JOIN Products p ON o.product_id = p.product_id ) SELECT product_name, product_id, order_id, order_date FROM cte WHERE order_rank = 1 ORDER BY product_name, product_id, order_id
with cte as ( select order_id, product_name, p.product_id, order_date, dense_rank() over(partition by product_id order by order_date desc) as rn from Products p join Orders o on p.product_id = o.product_id) select product_name, product_id, order_id, order_date from cte where rn = 1 order by 1,2,3
with cte as ( select product_id, max(order_date) as recentorder from orders group by product_id) select product_name, p.product_id, order_id, order_date from orders as o join products as p using (product_id) join cte using (product_id) where order_date = recentorder order by product_name,order_id
with cte as (select p.product_name,o.product_id, o.order_id, o.order_date, dense_rank() over(partition by o.product_id order by o.order_date desc) as 'rank' from Orders o left join Products p on o.product_id = p.product_id) select product_name, product_id, order_id, order_date from cte where cte.rank = 1 order by product_name, order_id
with cte as( select product_id,order_id,order_date, dense_rank() over (partition by product_id order by order_date desc) rank1 from orders) select b.product_name,a.product_id,a.order_id,a.order_date from cte a join products b on a.product_id = b.product_id where a.rank1=1 order by b.product_name,a.product_id,a.order_id asc
with cte as(select product_id, max(order_date) as maxorder from orders group by product_id) select p.product_name, p.product_id, o.order_id, o.order_date from orders o join products p on o.product_id=p.product_id join cte c on o.product_id=c.product_id and o.order_date=c.maxorder order by 1 asc, 2 asc, 3 asc
with cte as(select product_id,order_id,order_date,rank()over(partition by product_id order by order_date desc)as rk from orders) select p.product_name,c.product_id,order_id,order_date from cte c join products p on c.product_id=p.product_id where rk=1 order by product_name,product_id,order_id
with cte1 as ( select Products.Product_name , Products.product_id , Orders.order_id , order_date , dense_rank() over (partition by product_id order by order_date desc) as rk from Customers join Orders USING(customer_id) join Products USING(product_id) ) select product_name , product_id , order_id , order_date from cte1 where rk = 1 order by 1, 2, 3
with dt as ( select product_id, max(order_date) as dt from orders group by 1) select p.product_name, o.product_id, o.order_id, o.order_date from orders o inner join dt d on o.product_id = d.product_id and o.order_date = d.dt inner join Products p on o.product_id = p.product_id order by 1,2,3
with last_date_product as ( select product_id, max(order_date) as last_date from orders group by product_id order by order_date ), product_join as ( select products.product_name,orders.product_id, orders.order_id,orders.order_date from orders join products on orders.product_id = products.product_id ) select product_join.product_name, product_join.product_id, product_join.order_id, product_join.order_date from product_join join last_date_product on product_join.product_id = last_date_product.product_id and product_join.order_date = last_date_product.last_date order by product_join.product_name asc, product_join.product_id asc, product_join. order_id asc
with most_recent_date as (SELECT product_id, MAX(order_date) as recent FROM Orders group by product_id ) SELECT p.product_name, m.product_id, o.order_id, o.order_date FROM Products As p JOIN most_recent_date as m on m.product_id = p.product_id JOIN Orders as o on o.order_date = m.recent and o.product_id = m.product_id Order by p.product_name ASC, m.product_id ASC, o.order_id ASC
with orders_table as ( select product_id, order_id, order_date from ( select product_id, order_id, order_date, max(order_date) over (partition by product_id) as max_order_date from Orders ) t1 where order_date = max_order_date ) select Products.product_name, orders_table.* from orders_table join Products on Products.product_id = orders_table.product_id order by product_name, product_id, order_id
with product_rank as ( select order_id, order_date, customer_id, product_id, rank() over(partition by product_id order by order_date desc) as recent_rank from Orders o ) select p.product_name, pr.product_id, pr.order_id, pr.order_date from product_rank pr inner join Products p on pr.product_id=p.product_id where pr.recent_rank=1 order by p.product_name,pr.product_id,pr.order_id
with r as ( select product_id, order_id, order_date, max(order_date) over(partition by product_id) as order_date_max from Orders ) select product_name, r.product_id, order_id, order_date from r inner join Products on r.product_id = Products.product_id and r.order_date_max = r.order_date order by 1, 2, 3
with rec as(select product_id, order_id, order_date, dense_rank() over(partition by product_id order by order_date desc) as r1 from Orders) select p.product_name, r.product_id, r.order_id, r.order_date from rec r join Products p on r.product_id=p.product_id where r.r1=1 order by 1 asc,2 asc,3 asc
with recent_orders as ( select max(order_date) as order_date, product_id from Orders o group by product_id ) select p.product_name, o.product_id, o.order_id, o.order_date from recent_orders ro inner join Orders o on ro.product_id = o.product_id and ro.order_date = o.order_date inner join Products p on p.product_id = ro.product_id order by p.product_name, o.order_id
with t as ( select order_id, order_date, orders.product_id, product_name, rank() over (partition by orders.product_id order by order_date desc) as latest_order_date from orders left join products on orders.product_id = products.product_id) select product_name, product_id, order_id, order_date from t where latest_order_date = 1 order by product_name asc, product_id asc, order_id asc
with t1 as ( select product_id, order_id, order_date, dense_rank() over (partition by product_id order by order_date desc) as recent from orders ) select p.product_name, t1.product_id, t1.order_id, t1.order_date from t1 join products p on t1.product_id = p.product_id where recent = 1 order by p.product_name, t1.product_id, t1.order_id
with temp as ( select product_id, order_id, order_date, rank() over (partition by product_id order by order_date DESC) as rk from Orders ) select p.product_name, t.product_id, t.order_id, t.order_date from temp t left join Products p on t.product_id = p.product_id where t.rk = 1 order by p.product_name ASC, t.product_id ASC, t.order_id ASC
with temp as (select p.product_name as product_name, o.product_id as product_id, o.order_id as order_id, o.order_date as order_date, dense_rank() over (partition by o.product_id order by o.order_date desc) as my_rank from Orders o join Products p using (product_id)) select product_name, product_id, order_id, order_date from temp where my_rank =1 order by product_name, product_id, order_id
with temp1 as( SELECT product_id, order_date, order_id, rank() over (PARTITION BY product_id ORDER BY order_date DESC) as rnk FROM Orders ) SELECT product_name, temp1.product_id, temp1.order_id, temp1.order_date FROM temp1 JOIN Products p ON temp1.product_id=p.product_id WHERE temp1.rnk=1 ORDER BY product_name, product_id, order_id
with tmp as( select product_id, max(order_date) as order_date from orders group by product_id ) select p.product_name, o.product_id, o.order_id, t.order_date from products p,orders o, tmp t where p.product_id = t.product_id and p.product_id = o.product_id and o.order_date = t.order_date order by 1,2,3
