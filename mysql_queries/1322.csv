SELECT AD_ID, IfNull(Round(Avg(Case when action = 'Clicked' then 1 when action = 'viewed' then 0 else null end)*100,2),0) as ctr from ads group by ad_id order by ctr desc, ad_id
SELECT B.ad_id, B.ctr FROM (SELECT A.ad_id, ROUND(A.ctr*100,2) ctr, ROW_NUMBER() OVER (PARTITION BY A.ad_id ORDER BY A.ranking DESC) ranking FROM (SELECT ad_id, COALESCE(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) OVER (PARTITION BY ad_id ORDER BY user_id)/SUM(CASE WHEN action != 'Ignored' THEN 1 ELSE 0 END) OVER (PARTITION BY ad_id ORDER BY user_id),0) ctr, ROW_NUMBER() OVER(PARTITION BY ad_id ORDER BY user_id) ranking FROM Ads) A) B WHERE B.ranking = 1 ORDER BY B.ctr DESC, B.ad_id ASC
SELECT DISTINCT(t1.ad_id), CASE WHEN clicked IS NULL AND viewed IS NULL THEN 0 WHEN clicked IS NULL AND viewed IS NOT NULL THEN 0 WHEN clicked IS NOT NULL AND viewed IS NULL THEN 100 ELSE ROUND(clicked/(clicked+viewed)*100,2) END AS ctr FROM ((SELECT ad_id FROM Ads) t1 LEFT JOIN (SELECT ad_id, COUNT(action) AS clicked FROM Ads WHERE action = 'Clicked' GROUP BY ad_id) t2 ON t1.ad_id = t2.ad_id LEFT JOIN (SELECT ad_id, COUNT(action) AS viewed FROM Ads WHERE action = 'Viewed' GROUP BY ad_id) t3 ON t2.ad_id = t3.ad_id) ORDER BY ctr DESC, ad_id
SELECT ad_id , CASE WHEN SUM(action = "Clicked" or action = "Viewed") = 0 THEN 0 ELSE ROUND(SUM(action = "Clicked")/SUM(action = "Clicked" or action = "Viewed") * 100 ,2) END AS ctr FROM Ads GROUP BY ad_id ORDER BY 2 DESC, 1 ASC
SELECT ad_id , IFNULL(ROUND((SUM(action = 'Clicked') /SUM(action != 'Ignored')*100),2),0.00) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC,ad_id ASC
SELECT ad_id , ifnull(round(sum(case when action = 'clicked' then 1 else 0 end)*100/sum(case when action in ('clicked','viewed') then 1 else 0 end),2),0) as ctr FROM Ads GROUP BY ad_id order by ctr desc, ad_id
SELECT ad_id ,ROUND(IFNULL(SUM(CASE WHEN action='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN action!='Ignored' THEN 1 ELSE 0 END)*100,0),2) AS ctr FROM Ads GROUP BY 1 ORDER BY ctr DESC, 1
SELECT ad_id ,ifnull(round((sum(action = 'Clicked')/sum(action!='Ignored'))*100,2),0) as ctr FROM Ads group by ad_id order by ctr DESC, ad_id ASC
SELECT ad_id AS ad_id, COALESCE(ROUND(100*(SUM(IF(action = 'Clicked', 1, 0)) / SUM(IF(action = 'Clicked' OR action = 'Viewed', 1 , 0))), 2),0) AS ctr FROM Ads GROUP BY 1 ORDER BY 2 DESC, ad_id ASC
SELECT ad_id as ad_id, IFNULL(ROUND(AVG(100 * (ACTION = 'Clicked') / (ACTION <> 'Ignored')), 2), 0) as ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_ID
SELECT ad_id, CASE WHEN SUM(CASE WHEN action IN ('Clicked', 'Viewed') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) / SUM(CASE WHEN action IN ('Clicked', 'Viewed') THEN 1 ELSE 0 END) * 100, 2) END AS ctr FROM ads GROUP BY 1 ORDER BY 2 DESC, 1
SELECT ad_id, CASE WHEN SUM(CASE WHEN action in ('Clicked', 'Viewed') THEN 1 else 0 END) =0 THEN 0 ELSE ROUND((SUM(CASE WHEN action in ('Clicked') THEN 1 else 0 END) / SUM(CASE WHEN action in ('Clicked', 'Viewed') THEN 1 else 0 END)) * 100, 2) END as ctr FROM Ads GROUP BY ad_id ORDER BY ctr desc, ad_id asc
SELECT ad_id, CASE WHEN SUM(IF(action IN ("Clicked", "Viewed"),1,0)) = 0 THEN 0.00 ELSE ROUND( 100*SUM(IF(action ="Clicked",1,0))/SUM(IF(action IN ("Clicked", "Viewed"),1,0)),2) END AS ctr FROM ads GROUP BY ad_id ORDER BY ctr desc, ad_id
SELECT ad_id, CASE WHEN action_click = 0 and action_view = 0 THEN 0 ELSE ROUND(100 * action_click / (action_click+action_view) , 2) END as ctr FROM ( SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) as action_click, SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END) as action_view FROM Ads GROUP BY 1) t ORDER BY 2 DESC, 1
SELECT ad_id, CASE WHEN sub_ctr is null then 0 ELSE sub_ctr end as ctr FROM (SELECT ad_id, ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) + SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END))*100, 2) as sub_ctr FROM Ads GROUP BY ad_id) as sub ORDER BY ctr DESC, ad_id
SELECT ad_id, COALESCE( ROUND( SUM(action = 'Clicked') / (SUM(action = 'Clicked') + SUM(action = 'Viewed'))*100 , 2) , 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, COALESCE( ROUND(SUM(action = 'Clicked') / (SUM(action = 'Clicked') + SUM(action = 'Viewed')) * 100, 2), 0 ) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, COALESCE(ROUND((SUM(action = "Clicked")/SUM(action != "Ignored"))*100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, COALESCE(ROUND(100* SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/ (SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) + SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END)),2),0) ctr FROM ads GROUP BY ad_id ORDER BY ctr DESC,ad_id
SELECT ad_id, COALESCE(ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) * 100 / SUM(CASE WHEN action = 'Clicked' OR action = 'Viewed' THEN 1 ELSE 0 END), 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, COALESCE(ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) /(SUM(CASE WHEN action IN ('Clicked', 'Viewed') THEN 1 ELSE 0 END))*100, 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, COALESCE(ROUND(SUM(action = 'Clicked')/(SUM(action = 'Clicked') + SUM(action = 'Viewed')) *100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IF((clicked+viewed=0), 0, ROUND(clicked/(clicked+viewed)*100,2)) as ctr FROM (SELECT ad_id, sum(action='Viewed') as viewed, sum(action='Clicked') as clicked, sum(action='Ignored') as ignored FROM Ads GROUP BY ad_id) as tmp ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL (ROUND(100 * AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'Viewed' THEN 0 ELSE NULL END), 2), 0) as ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL( ROUND( (SUM(action = 'Clicked')/SUM(action != 'Ignored')*100),2),0.00) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL( ROUND( (SUM(action = 'Clicked')/SUM(action <> 'Ignored')*100),2),0.00) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL( ROUND( 100 * COUNT(CASE WHEN action = 'Clicked' THEN user_id END) / COUNT(CASE WHEN action IN ('Clicked', 'Viewed') THEN user_id END), 2), 0) AS ctr FROM Ads GROUP BY 1 ORDER BY 2 DESC, 1 ASC
SELECT ad_id, IFNULL( ROUND( 100*SUM(IF(action = 'Clicked', 1, 0)) / SUM(IF(action = 'Clicked' OR action = 'Viewed', 1, 0)) , 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY 2 DESC, 1
SELECT ad_id, IFNULL(ROUND((SUM(action = 'Clicked') / SUM(action != 'Ignored') * 100), 2), 0.00) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC , ad_id ASC
SELECT ad_id, IFNULL(ROUND((SUM(action = 'Clicked') /SUM(action != 'Ignored')*100),2),0.00) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC,ad_id ASC
SELECT ad_id, IFNULL(ROUND((SUM(action = 'Clicked') /SUM(action != 'Ignored')*100),2),0.00) AS ctr from ads group by ad_id ORDER BY ctr DESC,ad_id ASC
SELECT ad_id, IFNULL(ROUND((click/(click+viewed)*100),2),0) as ctr FROM( SELECT ad_id, SUM(CASE WHEN action='Viewed' THEN 1 ELSE 0 END) AS 'viewed', SUM(CASE WHEN action='Clicked' THEN 1 ELSE 0 END) AS 'click' FROM Ads GROUP BY 1) T ORDER BY 2 DESC, 1
SELECT ad_id, IFNULL(ROUND(100*SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN action ='Clicked'or action='Viewed' THEN 1 ELSE 0 END),2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IFNULL(ROUND(100*click_count/ (click_count+view_count) ,2),0) AS ctr FROM( SELECT ad_id, SUM(CASE WHEN action="Clicked" THEN 1 ELSE 0 END) AS click_count, SUM(CASE WHEN action="Viewed" THEN 1 ELSE 0 END) AS view_count FROM Ads GROUP BY ad_id ) AS temp ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IFNULL(ROUND(AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'Viewed' THEN 0 ELSE NULL END) * 100, 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'Viewed' THEN 0 ELSE NULL END)*100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'Viewed' THEN 0 ELSE NULL END)*100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IFNULL(ROUND(AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'Viewed' THEN 0 ELSE NULL End)*100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(COUNT(CASE WHEN action='Clicked' THEN 1 END) / COUNT(CASE WHEN action='Clicked' OR action='Viewed' THEN 1 END)*100, 2), 0.00) as ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IFNULL(ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) * 100/ SUM(CASE WHEN action = 'Clicked' or action = 'Viewed' THEN 1 ELSE 0 END),2),0.00) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN action = 'Clicked' OR action = 'Viewed' THEN 1 ELSE 0 END) * 100, 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IFNULL(ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN action = 'Clicked' or action = 'Viewed' THEN 1 ELSE 0 END) * 100, 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, IFNULL(ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN action = 'Clicked' or action = 'Viewed' THEN 1 ELSE 0 END) *100,2),0) as ctr FROM ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(CASE action WHEN 'Clicked' THEN 1 END) / (SUM(CASE action WHEN 'Clicked' THEN 1 END) + SUM(CASE action WHEN 'Viewed' THEN 1 ELSE 0 END)) * 100.0, 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(IF(action='Clicked', 1, 0)) / SUM(IF(action != 'Ignored', 1, 0)) *100, 2),0) as ctr FROM ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(action = 'Clicked') / SUM(action = 'Clicked' OR action = 'Viewed') * 100, 2), 0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(action="Clicked")/(SUM(action="Clicked")+SUM(action="Viewed"))*100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(action='Clicked')/(SUM(action!='Ignored'))*100,2),0.00) ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(action='Clicked')/SUM(action='Clicked' or action='Viewed')*100, 2), 0) as ctr FROM Ads GROUP BY ad_id ORDER BY ctr desc, ad_id
SELECT ad_id, IFNULL(ROUND(SUM(action='Clicked')/SUM(action='Clicked' or action='Viewed')*100,2), 0) AS ctr FROM ads GROUP BY ad_id ORDER BY ctr desc, ad_id
SELECT ad_id, IFNULL(ROUND(c/(c+v)*100, 2), 0) AS ctr FROM (SELECT ad_id, SUM(CASE WHEN action = "Clicked" THEN 1 ELSE 0 END) AS c, SUM(CASE WHEN action = "Viewed" THEN 1 ELSE 0 END) AS v FROM Ads GROUP BY ad_id) t ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(clicked/(clicked + viewed) * 100, 2), 0.0) as ctr FROM ( SELECT SUM(CASE WHEN action = 'Clicked' THEN 1 else 0 END) AS clicked, SUM(CASE WHEN action = 'Viewed' THEN 1 else 0 END) AS viewed, ad_id FROM Ads GROUP BY ad_id ) xx ORDER BY ctr DESC, ad_id
SELECT ad_id, IFNULL(ROUND(total_clicks * 100 /(total_clicks + total_views),2),0) AS ctr FROM ( SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) AS total_clicks, SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END) AS total_views FROM Ads GROUP BY ad_id) a ORDER BY 2 DESC, 1
SELECT ad_id, IFNULL(Round(AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'viewed' THEN 0 ELSE NULL END)*100,2),0) AS ctr FROM Ads Group BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(CASE WHEN SUM(CASE When action='Clicked' or action='Viewed' Then 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE When action='Clicked' Then 1 ELSE 0 END)/SUM(CASE When action='Clicked' or action='Viewed' Then 1 ELSE 0 END)*100 END,2) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(CASE WHEN num_cliks + num_views = 0 THEN 0 ELSE num_cliks*100/(num_cliks + num_views) END,2) AS ctr FROM (SELECT ad_id, COUNT(CASE WHEN action = 'Clicked' THEN 1 END) AS num_cliks, COUNT(CASE WHEN action = 'Viewed' THEN 1 END) AS num_views FROM Ads GROUP BY ad_id) cliks_views ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, ROUND(COALESCE( 100*SUM(IF(action ="Clicked",1,0))/SUM(IF(action IN ("Clicked", "Viewed"),1,0)), 0), 2) AS ctr FROM ads GROUP BY ad_id ORDER BY ctr desc, ad_id
SELECT ad_id, ROUND(COALESCE(100 * SUM(IF(`action`='Clicked', 1, 0)) / SUM(IF(`action` IN ('Clicked', 'Viewed'), 1 , 0)), 0), 2) AS ctr FROM Ads WHERE 1=1 GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(COALESCE(count_clicks*100/(count_views+count_clicks),0),2) as ctr FROM ( SELECT ad_id, SUM(action="Viewed") as count_views, SUM(action="Clicked") as count_clicks FROM Ads GROUP BY ad_id ) sub ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(IF(ad_click+ad_view=0, 0, ad_click/(ad_click+ad_view))*100,2) AS ctr FROM ( SELECT ad_id, COUNT(IF(action='Clicked',user_id,null)) AS ad_click, COUNT(IF(action='Viewed',user_id,null)) AS ad_view FROM Ads GROUP BY ad_id ) temp ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, ROUND(IF(ad_click+ad_view=0, 0, ad_click/(ad_click+ad_view))*100,2) AS ctr FROM ( SELECT ad_id, SUM(IF(action='Clicked',1,0)) AS ad_click, SUM(IF(action='Viewed',1,0)) AS ad_view FROM Ads GROUP BY ad_id ) temp ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, ROUND(IFNULL((clicks/total)*100, 0), 2) ctr FROM (SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) clicks, SUM(CASE WHEN action = 'Clicked' OR action = 'Viewed' THEN 1 ELSE 0 END ) total FROM Ads GROUP BY ad_id) as table1 GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(IFNULL(100*(AVG(CASE WHEN action = "Clicked" THEN 1 WHEN action = "Viewed" THEN 0 ELSE NULL END)),0),2) AS ctr FROM Ads GROUP BY 1 ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(IFNULL(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) * 100/SUM(CASE WHEN action = 'Clicked' OR action = 'Viewed' THEN 1 ELSE 0 END), 0), 2) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(IFNULL(SUM(IF(action='clicked',1,0))/SUM(IF(action='clicked' OR action='viewed',1,0))*100,0),2) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(IFNULL(SUM(action = 'Clicked') / (SUM(action = 'Viewed')+ SUM(action = 'Clicked')), 0) * 100, 2) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(IFNULL(SUM(action = 'Clicked')/(SUM(action in ('Clicked', 'Viewed')))*100, 0), 2) AS 'ctr' FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, ROUND(IFNULL(SUM(action='clicked')/SUM(action='clicked' OR action='viewed')*100,0),2) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ROUND(ctr, 2) AS ctr FROM (SELECT ad_id, IFNULL(SUM(action='Clicked')/SUM(action!='Ignored')*100, 0) AS ctr FROM ads GROUP BY 1 ORDER BY 2 DESC, 1) a
SELECT ad_id, coalesce(ROUND(AVG(CASE WHEN action = 'Clicked' THEN 1 WHEN action = 'Viewed' THEN 0 ELSE NULL END)*100,2),0) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, coalesce(round(sum(case when action = 'Clicked' then 1 else 0 end)/sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end)*100,2),0) as ctr FROM Ads group by ad_id ORDER BY ctr desc, ad_id
SELECT ad_id, ifnull(ROUND((c*100/(c+v)),2),0) as ctr FROM (SELECT ad_id, SUM(case when action = "Clicked" then 1 else 0 end) as c, SUM(case when action = "Viewed" then 1 else 0 end) as v FROM Ads GROUP BY ad_id) as t GROUP BY ad_id ORDER BY ctr DESC, ad_id
SELECT ad_id, ifnull(round(sum(action = 'Clicked') / sum(action = 'Clicked' or action = 'Viewed') * 100,2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
SELECT ad_id, round((CASE WHEN c+v = 0 THEN 0 ELSE c * 100 / (c+v) END),2) as ctr FROM (SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) as c, SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END) as v FROM Ads GROUP BY ad_id) as A GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
SELECT ad_id, round(ifnull(sum(case when action='Clicked' then 1 else 0 end)/(sum(case when action='Clicked' then 1 else 0 end) +sum(case when action='Viewed' then 1 else 0 end))*100,0),2) as ctr from ads group by 1 order by ctr desc,ad_id
SELECT ad_id,ROUND(IFNULL(SUM(IF(action='Clicked',1,0))/SUM(IF(action!='Ignored',1,0))*100,0),2) AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC,ad_id
SELECT ad_id,ROUND(ctr,2) as ctr FROM ( select ad_id , case when sum(case when action = 'clicked' or action = 'Viewed' then 1.00 else 0.00 end) = 0.00 then 0.00 else (sum(case when action = 'clicked' then 1.0 else 0.0 end) / sum(case when action = 'clicked' or action = 'Viewed' then 1.0 else 0.0 end) ) *100 end as ctr FROM Ads group by ad_id ) a order by ctr desc ,ad_id
SELECT distinct ad_id, case when sum(case when action = 'Clicked'then 1 else 0 end) + sum(case when action = 'Viewed'then 1 else 0 end) <> 0 then round(sum(case when action = 'Clicked' then 1 else 0 end)/(sum(case when action = 'Clicked'then 1 else 0 end) + sum(case when action = 'Viewed'then 1 else 0 end))*100,2) else 0.00 end as ctr FROM Ads GROUP BY 1 ORDER BY 2 desc,1
Select C.ad_id,round(C.ctr,2) as ctr from ( Select B.ad_id, case when B.Ad_total_clicks+ B.Ad_Total_views = 0 then 0 else (B.Ad_total_clicks/(B.Ad_total_clicks+ B.Ad_Total_views))*100 end as ctr from ( Select A.ad_id, sum(A.Ad_clicks) as Ad_total_clicks, sum(A.Ad_views) as Ad_total_views from ( Select ad_id,user_id,case when action = "Clicked" then 1 else 0 end as Ad_clicks, case when action = "Viewed" then 1 else 0 end as Ad_views from Ads ) A group by A.ad_id )B order by ctr desc, ad_id )C
Select ad_id , Coalesce ( Round( Sum(Case when action = 'Clicked' then 1 else 0 end) / (Sum(Case when action = 'Clicked' then 1 else 0 end) + Sum(Case when action = 'Viewed' then 1 else 0 end)) *100 ,2) ,0)AS ctr From ads Group By ad_id Order by 2 Desc , 1
Select ad_id, ROund((CASE when SUM(Case when action like 'Clicked' or action = 'Viewed' then 1 else 0 end) = 0 then 0 ELSE SUM(Case when action like 'Clicked' then 1 else 0 end)*100/SUM(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end) End),2) as ctr from ads group by ad_id order by ctr desc,ad_id
Select ad_id, ifnull(round(count(case when action = 'Clicked' then 1 else null end)*100/ count(case when action = 'Clicked' or action = 'Viewed' then 1 else null end), 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
Select ad_id, round((case when clicked+viewed = 0 then 0 else clicked/(clicked+viewed) end)*100,2) as ctr from ( Select ad_id, SUM(Case when action = 'Clicked' then 1 else 0 end) as clicked, SUM(Case when action = 'Viewed' then 1 else 0 end) as viewed from Ads group by 1 ) t order by 2 desc, 1
WITH CTE_CV AS ( Select ad_id as ad_id, SUM(CASE WHEN action = 'Clicked' then 1 else 0 END) as cl_cnt, SUM(CASE WHEN action = 'Viewed' then 1 else 0 END) as vw_cnt from Ads group by ad_id ) Select ad_id , IFNULL(ROUND((cl_cnt/(cl_cnt+vw_cnt))*100,2),0) as ctr from CTE_CV order by 2 desc,1 asc
WITH T1 AS ( SELECT ad_id, CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END AS 'Clicks', CASE WHEN action = 'Viewed' OR action = 'Clicked' THEN 1 ELSE 0 END AS 'Total_actions' FROM ads) SELECT ad_id, IFNULL(ROUND(SUM(Clicks)/SUM(Total_actions)*100,2),0) ctr FROM T1 GROUP BY 1 ORDER BY ctr DESC, ad_id ASC
WITH a1 AS (SELECT ad_id, SUM(CASE WHEN action='Clicked' THEN 1 WHEN action='Viewed' THEN 1 ELSE 0 END) as total FROM Ads GROUP BY ad_id), a2 AS (SELECT ad_id, SUM(CASE WHEN action='Clicked' THEN 1 ELSE 0 END) as n_clicks FROM Ads GROUP BY ad_id) SELECT a1.ad_id, CASE WHEN total>0 THEN ROUND(n_clicks*100/total, 2) ELSE 0 END as ctr FROM a1 JOIN a2 USING(ad_id) ORDER BY ctr DESC, a1.ad_id ASC
WITH action_count as ( SELECT DISTINCT a.ad_id, SUM(CASE WHEN a.action = 'Clicked' THEN 1 ELSE 0 END) AS total_clicks, SUM(CASE WHEN a.action = 'Viewed' THEN 1 ELSE 0 END) AS total_views FROM Ads a GROUP BY a.ad_id ) SELECT DISTINCT ad_id, CASE WHEN total_clicks + total_views = 0 THEN 0 ELSE ROUND((total_clicks *100/ (total_clicks + total_views)),2) END AS ctr FROM action_count ORDER BY ctr DESC,ad_id
WITH ads_totals AS ( SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) AS clicked, SUM(CASE WHEN action IN ('Clicked', 'Viewed') THEN 1 ELSE 0 END) AS clicked_or_viewed FROM Ads GROUP BY ad_id ) SELECT ad_id, COALESCE(ROUND(100*(clicked/clicked_or_viewed),2),0) AS ctr FROM ads_totals ORDER BY ctr DESC, ad_id ASC
WITH click_view AS ( SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 else 0 END) as clicked, SUM(CASE WHEN action = 'Viewed' THEN 1 else 0 END) as viewed FROM Ads GROUP BY ad_id) SELECT ad_id, IFNULL( ROUND( 100*clicked/(clicked+viewed), 2), 0 ) as ctr FROM click_view ORDER BY ctr DESC, ad_id
WITH cte AS ( SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) AS clicks, SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END) AS views FROM Ads GROUP BY ad_id) SELECT ad_id, CASE WHEN clicks + views = 0 THEN 0 ELSE ROUND(clicks*100/(clicks+views),2) END AS ctr FROM cte GROUP BY ad_id ORDER BY ctr DESC, ad_id
WITH cte AS(SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) AS clicking, SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END) AS viewing FROM Ads GROUP BY ad_id) SELECT ad_id, CASE WHEN clicking + viewing = 0 THEN 0.00 ELSE ROUND(clicking/(clicking+viewing)*100,2) END AS ctr FROM cte ORDER BY ctr DESC,ad_id ASC
WITH firstTable as( SELECT ad_id, count(CASE WHEN action = 'Clicked' THEN 1 END) as total_clicks, count(CASE WHEN action='Viewed' THEN 1 END) as total_views FROM Ads GROUP BY ad_id ) SELECT ad_id, CASE WHEN total_clicks+total_views=0 THEN 0 ELSE round((total_clicks/(total_clicks+total_views))*100,2) END AS ctr FROM firstTable ORDER BY ctr DESC,ad_id
WITH stats AS (SELECT ad_id, SUM(CASE WHEN action='Clicked' THEN 1 ELSE 0 END) AS click, SUM(CASE WHEN action='Clicked' OR action='Viewed' THEN 1 ELSE 0 END) AS click_view FROM Ads GROUP BY ad_id) SELECT ad_id, ROUND(CASE WHEN click_view>0 THEN 100*click/click_view ELSE 0 END,2) AS ctr FROM stats ORDER BY ctr DESC, ad_id ASC
WITH t AS ( SELECT ad_id, SUM(action='Clicked') as n_click, SUM(action='Viewed') as n_view FROM Ads GROUP BY 1 ) SELECT ad_id, COALESCE(ROUND((n_click/(n_click+n_view))*100, 2), 0) AS ctr FROM t ORDER BY ctr DESC, ad_id ASC
WITH table1 AS ( SELECT ad_id, CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END AS is_clicked, CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END AS is_viewed FROM ads ) SELECT ad_id, ROUND(100*COALESCE(SUM(is_clicked) / (SUM(is_clicked) + SUM(is_viewed)),0),2) AS ctr FROM table1 GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
WITH table1 AS ( SELECT ad_id, CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END AS is_clicked, CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END AS is_viewed, CASE WHEN action = 'Ignored' THEN 1 ELSE 0 END AS is_ignored FROM ads ) SELECT ad_id, ROUND(100*COALESCE(SUM(is_clicked) / (SUM(is_clicked) + SUM(is_viewed)),0),2) AS ctr FROM table1 GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
WITH temp AS (SELECT ad_id, SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) AS 'Clickedcount', SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END) AS 'Viewedcount', SUM(CASE WHEN action = 'Ignored' THEN 0 ELSE 0 END) AS 'Ignoredcount' FROM Ads GROUP BY ad_id) SELECT ad_id, IFNULL(ROUND(Clickedcount*100/(Clickedcount+Viewedcount),2),0) AS 'ctr' FROM temp ORDER BY ctr DESC, ad_id ASC
WITH temp AS (SELECT ad_id, SUM(CASE WHEN action='Clicked' THEN 1 ELSE 0 END) AS num_clicked, SUM(CASE WHEN action='Viewed' THEN 1 ELSE 0 END) AS num_viewed FROM Ads GROUP BY 1) SELECT ad_id, IFNULL(ROUND(num_clicked/(num_clicked+num_viewed)*100,2),0) AS ctr FROM temp ORDER BY 2 DESC, 1 ASC
select a.ad_id, round(Case when a.tot_cnt=0 then 0 else a.clk_cnt/a.tot_cnt*100 end ,2) as ctr from ( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clk_cnt, sum(Case when action='Clicked' or action='Viewed' then 1 else 0 end) as tot_cnt from Ads group by ad_id) a order by ctr desc,ad_id
select aa.ad_id, round(ifnull(100*aa.clk/(aa.clk+aa.view),0),2) as 'ctr' from (select *, sum(case when a.action = 'Clicked' then 1 else 0 end) as 'clk', sum(case when a.action = 'Viewed' then 1 else 0 end) as 'view' from Ads a group by a.ad_id ) aa order by ctr desc,ad_id asc
select ad_id , round(ifnull(sum(action ='Clicked') /( sum(action <>'Ignored') ),0) * 100, 2) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id ,if(sum(case when action != 'Ignored' then 1 else 0 end),round(sum(case when action = 'Clicked' then 1 else 0 end)*100/sum(case when action != 'Ignored' then 1 else 0 end),2),0) as ctr from Ads ads group by ad_id order by ctr desc, ad_id asc
select ad_id, (case when (clicks + views) =0 then 0 else round(clicks/(clicks+views) *100,2) end) as ctr from (select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicks, sum(case when action = 'Viewed' then 1 else 0 end) as views from Ads group by ad_id) as Ads2 order by ctr desc, ad_id
select ad_id, (case when clicks+views = 0 then 0 else round(clicks/(clicks+views)*100, 2) end) as ctr from (select ad_id, sum(case when action='Clicked' then 1 else 0 end) as clicks, sum(case when action='Viewed' then 1 else 0 end) as views from Ads group by ad_id) as t order by ctr desc, ad_id asc
select ad_id, (case when round(sum(case when action = 'clicked' then 1 else 0 end)/(sum(case when action = 'clicked' then 1 else 0 end) + sum(case when action = 'viewed' then 1 else 0 end))*100,2) is null then 0.00 else round(sum(case when action = 'clicked' then 1 else 0 end)/(sum(case when action = 'clicked' then 1 else 0 end) + sum(case when action = 'viewed' then 1 else 0 end))*100,2) end) as ctr from ads group by ad_id order by (case when round(sum(case when action = 'clicked' then 1 else 0 end)/(sum(case when action = 'clicked' then 1 else 0 end) + sum(case when action = 'viewed' then 1 else 0 end))*100,2) is null then 0.00 else round(sum(case when action = 'clicked' then 1 else 0 end)/(sum(case when action = 'clicked' then 1 else 0 end) + sum(case when action = 'viewed' then 1 else 0 end))*100,2) end) desc, ad_id
select ad_id, CASE WHEN SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) <> 0 THEN ROUND(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) + SUM(CASE WHEN action = 'Viewed' THEN 1 ELSE 0 END))*100,2) ELSE 0.00 END AS ctr FROM Ads GROUP BY ad_id ORDER BY ctr DESC, ad_id ASC
select ad_id, COALESCE( round( sum(case when action = 'Clicked' then 1 else 0 end) /sum(case when action='Clicked' or action ='viewed' then 1 else 0 end)*100 ,2) ,0)as ctr from ads group by ad_id order by ctr desc, ad_id asc
select ad_id, Case when sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end) <>0 then round(sum(case when action = 'Clicked' then 1 else 0 end)*100.00/sum(case when action = 'Clicked' or action = 'Viewed' then 1 end),2) Else 0.00 end as ctr from Ads group by ad_id order by ctr desc,ad_id
select ad_id, Coalesce(Round(sum(action='Clicked')/(sum(action ='Clicked')+ sum(action ='Viewed'))*100,2),0) as ctr from Ads group by ad_id order by ctr desc,ad_id asc
select ad_id, IFNULL(ROUND(((SUM(case when action = 'Clicked' then 1 else 0 end)) / ((SUM(case when action = 'Clicked' then 1 else 0 end)) + (SUM(case when action = 'Viewed' then 1 else 0 end))))* 100,2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, IFNULL(ROUND(AVG(CASE WHEN action = 'Clicked' Then 1 WHEN action = 'Viewed' Then 0 ELSE NULL END) * 100, 2), 0) AS ctr FROM Ads Group By ad_id Order By ctr DESC, ad_id
select ad_id, IFNULL(Round(click_sum/total_sum*100, 2), 0) as ctr from (Select ad_id, sum(case when action='Clicked' then 1 else 0 end) as click_sum, sum(case when action='Clicked' or action='Viewed' then 1 else 0 end) as total_sum from Ads group by ad_id) as inner_ads order by ctr desc, ad_id
select ad_id, IFNULL(round(count( case when action = 'Clicked' then user_id end) / count( case when action = 'Clicked' or action = 'Viewed' then user_id end)*100,2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, IFNULL(round(sum(action = 'Clicked')/sum(action != 'Ignored')*100,2),0.00) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, IFNULL(round(sum(action='clicked') / sum(action='clicked' || action='viewed') * 100, 2), 0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, IFNUll(round ((sum(action='Clicked') / sum(action!='Ignored'))*100, 2),0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ROUND(IFNULL(SUM(action = 'Clicked') * 100.0 / SUM(action = 'Clicked' or action = 'Viewed'), 0), 2) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, Round(IFNULL(100.0*sum(action = 'Clicked')/sum(action = 'Clicked' or action = 'Viewed'), 0), 2) as ctr from ads group by ad_id Order by ctr desc, ad_id
select ad_id, case when (clicked + viewed = 0) then 0 else round((clicked * 100 / (clicked + viewed)),2) end as ctr from(select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicked, sum(case when action = 'Viewed' then 1 else 0 end) as viewed from Ads group by ad_id) as abc order by ctr desc, ad_id asc
select ad_id, case when (clicked+viewed) = 0 then 0 else round(100*clicked/(clicked+viewed),2) end ctr from (select ad_id, sum(case when action='Clicked' then 1 else 0 end) clicked, sum(case when action='Viewed' then 1 else 0 end) viewed from Ads group by 1) temp order by ctr desc, 1
select ad_id, case when (clicked+viewed) = 0 then 0 else round(clicked*100.00/(clicked+viewed), 2) end as ctr from ( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicked, sum(case when action = 'Viewed' then 1 else 0 end) as viewed from ads group by ad_id ) a order by 2 desc, 1
select ad_id, case when (round(sum(case when a.action = 'Clicked' then 1 else 0 end)/(sum(case when a.action = 'Clicked' then 1 else 0 end) + sum(case when a.action = 'Viewed' then 1 else 0 end))*100, 2)) is not null then (round(sum(case when a.action = 'Clicked' then 1 else 0 end)/(sum(case when a.action = 'Clicked' then 1 else 0 end) + sum(case when a.action = 'Viewed' then 1 else 0 end))*100, 2)) else 0 end as ctr from Ads a group by ad_id order by ctr desc, ad_id
select ad_id, case when (total_views = 0 and clicked = 0) then 0 else round(clicked * 100/ (total_views ),2) end as ctr from(select ad_id, sum(case when action in ('Viewed','Clicked') then 1 else 0 end) as total_views, sum(case when action = 'Clicked' then 1 else 0 end) as clicked from Ads group by 1) x order by ctr desc, ad_id asc
select ad_id, case when clicked_count + viewed_count = 0 then 0.00 else round((clicked_count/(clicked_count + viewed_count))*100, 2) end as ctr from (select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicked_count, sum(case when action = 'Viewed' then 1 else 0 end) as viewed_count from ads group by ad_id) as tempt order by ctr desc, ad_id
select ad_id, case when clicks+views=0 then 0 else round((clicks/(clicks+views))*100, 2) end as ctr from (select ad_id, sum(case when action='Clicked' then 1 else 0 end) as clicks, sum(case when action='Viewed' then 1 else 0 end) as views from ads group by ad_id) as t order by ctr desc, ad_id asc
select ad_id, case when count(case when action='Clicked' then 1 end) = 0 then 0.00 else round(count(case when action='Clicked' then 1 end) / (count(case when action != 'Ignored' then 1 end)) * 100,2) end as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, case when count(if(action in ('Clicked', 'Viewed'), user_id, null)) = 0 then 0 else round(count(if(action in ('Clicked'), user_id, null)) / count(if(action in ('Clicked', 'Viewed'), user_id, null)) * 100, 2) end as ctr from Ads group by 1 order by 2 desc, 1 asc
select ad_id, case when count_click =0 and count_view = 0 then 0 else round((count_click*100/(count_click+count_view)), 2) end as ctr from (select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as count_click, sum(case when action = 'Viewed' then 1 else 0 end) as count_view from Ads group by ad_id) new order by ctr desc, ad_id
select ad_id, case when sum(action != 'Ignored') = 0 then 0 else round(sum(action='Clicked')*100 / sum(action != 'Ignored'),2) end as ctr from ads GROUP BY ad_id ORDER BY ctr DESC,ad_id ASC
select ad_id, case when sum(case when action = 'Clicked' then 1 else 0 end) <> 0 then round(sum(case when action = 'Clicked' then 1 else 0 end) / (sum(case when action = 'Clicked' then 1 else 0 end)+sum(case when action = 'Viewed' then 1 else 0 end)) *100, 2) else 0.00 end as ctr from ads group by ad_id order by ctr desc, ad_id asc
select ad_id, case when total_clicks+total_views = 0 then 0.00 else round(total_clicks/(total_clicks+total_views)*100,2) end ctr from(select distinct ad_id, sum(case when action = 'Clicked' then 1 else 0 end) over(partition by ad_id) total_clicks, sum(case when action = 'Viewed' then 1 else 0 end) over(partition by ad_id) total_views from Ads) a order by ctr desc, ad_id
select ad_id, case when viewedClicked = 0 then 0 else round(totalClicks*100/viewedClicked,2) end ctr from (select ad_id, sum(case when action = 'clicked' then 1 else 0 end) totalClicks, sum(case when action = 'clicked' or action = 'viewed' then 1 else 0 end) viewedClicked from ads group by ad_id) t order by ctr desc, ad_id
select ad_id, coalesce( cast( ( sum(case when action = 'clicked' then 1 else 0 end)/ sum(case when action='clicked' or action = 'viewed' then 1 else 0 end) )* 100 as decimal(5,2) ), 0.00 )as ctr from ads group by 1 order by ctr desc, ad_id
select ad_id, coalesce(round((sum(if(action = 'Clicked', 1, 0))/sum(if(action = 'Clicked' or action= 'Viewed',1, 0)))*100, 2), 0) as ctr from ads group by ad_id order by ctr desc, ad_id asc
select ad_id, coalesce(round(count(case when action = 'Clicked' then 1 else null end)/ ((count(case when action = 'Viewed' then 1 else null end))+ (count(case when action = 'Clicked' then 1 else null end)))*100,2),0) as ctr from Ads group by 1 order by 2 desc, 1
select ad_id, coalesce(round(sum(action = 'Clicked') / sum(action = 'Clicked' or action = 'Viewed') * 100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, coalesce(round(sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action in ('Clicked', 'Viewed') then 1 else 0 end) * 100, 2), 0) as ctr from Ads group by ad_id order by 2 desc, 1
select ad_id, coalesce(round(sum(case when action = 'Clicked' then 1 else 0 end)*100.0/sum(case when action = 'Clicked'or action='Viewed' then 1 else 0 end),2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, coalesce(round(sum(case when action = 'Clicked' then 1 else 0 end)/sum(case when action = 'Ignored' then 0 else 1 end) * 100, 2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, if(cl+vi = 0, 0, round(100 * cl/(cl+vi),2)) as ctr from ( select ad_id, sum(case when action= 'Clicked' then 1 else 0 end) as cl, sum(case when action = 'Viewed' then 1 else 0 end) as vi from ads group by ad_id) dudu order by ctr desc, ad_id asc
select ad_id, if(sum_click =0,0,round(100*sum_click/(sum_click+sum_view),2)) as ctr from (select ad_id, sum(action_click) as sum_click, sum(action_view) as sum_view from (select ad_id, case when action = 'Clicked' then 1 else 0 end as action_click, case when action = 'Viewed' then 1 else 0 end as action_view from Ads)a group by ad_id)b order by ctr desc, ad_id
select ad_id, ifNULL(round(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else NULL end) * 100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull (round (sum(case when action='Clicked' then 1 else 0 end)/ sum(case when action='Clicked' or action= 'Viewed' then 1 else 0 end)*100,2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round( sum(case when action = 'Clicked' then 1 else 0 end) * 100 / sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end), 2 ), 0.00) as ctr from ads group by ad_id order by 2 desc, 1
select ad_id, ifnull(round( sum(case when action='Clicked' then 1 else 0 end)*100 / sum( case when action = 'Clicked' or action='Viewed' then 1 else 0 end ),2) ,0.00) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round((1.*sum(action='Clicked')/sum(action='Clicked' or action='Viewed'))*100, 2), 0.) as 'ctr' from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round((c*100/(c+v)),2),0) as ctr from ( select ad_id, sum(case when action="Clicked" then 1 else 0 end) as c,sum(case when action="Viewed" then 1 else 0 end) as v from ads group by ad_id ) as t order by 2 desc, 1
select ad_id, ifnull(round((c*100/(c+v)),2),0) ctr from ( select ad_id, sum(case when action="Clicked" then 1 else 0 end) c,sum(case when action="Viewed" then 1 else 0 end) v from ads group by ad_id ) t order by 2 desc,1
select ad_id, ifnull(round((clicked / (clicked+viewed)*100),2),0) as ctr from(select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicked,sum(case when action = 'Viewed' then 1 else 0 end) as viewed from ads group by ad_id) b order by ctr desc, ad_id
select ad_id, ifnull(round((sum(case when `action`='Clicked' then 1 else 0 end)/(sum(case when `action`='Clicked' then 1 else 0 end)+sum(case when `action`='Viewed' then 1 else 0 end)) * 100),2),0.00) ctr from ads group by 1 order by 2 desc,1
select ad_id, ifnull(round((sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action = 'Clicked' then 1 when action = 'Viewed' then 1 else 0 end))*100,2), 0) as ctr from Ads group by ad_id order by ctr DESC, ad_id ASC
select ad_id, ifnull(round((sum(case when action = 'Clicked' then 1 else 0 end)/(sum(case when action = 'Clicked' then 1 else 0 end)+ sum(case when action = 'Viewed' then 1 else 0 end)))*100,2),0) as ctr from ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round((sum(case when action='Clicked' then 1 else 0 end) /sum(case when action='Clicked' or action='Viewed' then 1 else 0 end) )*100,2),0) as ctr from ads group by ad_id order by ctr desc,ad_id
select ad_id, ifnull(round((sum(if(action="Clicked",1*100,0)))/(sum(case when action="Viewed" then 1 when action="Clicked" then 1 else 0 end)),2),0.00) as ctr from Ads group by ad_id order by ctr desc,ad_id
select ad_id, ifnull(round(100* sum(if(action="Clicked",1,0))/ sum(if(action="Clicked" OR action="Viewed" ,1,0)),2),0) as ctr from Ads group by 1 order by ctr desc,1
select ad_id, ifnull(round(100*(sum(case when action = 'Clicked' then 1 else 0 end)/(sum(case when action = 'Clicked' then 1 else 0 end) + sum(case when action = 'Viewed' then 1 else 0 end))), 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(100*avg((action = "Clicked") / (action = "Clicked" or action = "Viewed")),2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(100*avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end), 2), 0.00) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(100*count(case when action='clicked' then action else null end) / count(case when action='clicked' or action='viewed' then action else null end), 2), 0) ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(100*sum(action = 'Clicked')/sum(action <> 'Ignored'),2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(100*sum(action='Clicked') / sum(action<>'Ignored'),2),0) ctr from Ads group by 1 order by 2 desc, 1
select ad_id, ifnull(round(100*sum(case when action = 'Clicked' then 1 else 0 end)/(sum(case when action = 'Clicked' then 1 else 0 end) + sum(case when action = 'Viewed' then 1 else 0 end)), 2), 0) as ctr from ads group by 1 order by 2 desc, 1
select ad_id, ifnull(round(AVG (case when action ='clicked' then 1 when action ='viewed' then 0 else null end)*100,2),0) as ctr from ads group by ad_id order by 2 desc, 1 asc
select ad_id, ifnull(round(avg(CASE WHEN action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end)*100,2),0.00) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end )*100,2),0.00) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end) * 100, 2), 0) as ctr from ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end)*100, 2), 0) as ctr from Ads group by ad_id order by ctr DESC, ad_id
select ad_id, ifnull(round(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end)*100,2) ,0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end)*100,2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(avg(case when action='Clicked' then 1 when action = 'Viewed' then 0 ELSE NULL END)*100,2),0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(c*100/(c+v),2),0) as ctr from ( select ad_id , sum((case when action='Clicked' then 1 else 0 end)) c, sum((case when action='Viewed' then 1 else 0 end)) v from ads group by ad_id) a order by 2 desc ,1
select ad_id, ifnull(round(c/(c+v)*100,2) ,0) as ctr from (select ad_id, sum(case when action = 'Clicked' then 1 Else 0 end) as c, sum(case when action = 'Viewed' then 1 else 0 end) as v from Ads group by ad_id) temp order by ctr DESC, ad_id ASC
select ad_id, ifnull(round(clicked/total*100, 2), 0) as ctr from ( select ad_id, sum(case when action = 'clicked' then 1 else 0 end ) as clicked, sum(case when action = 'clicked' or action = 'Viewed' then 1 else 0 end) as total from Ads group by ad_id ) t order by ctr desc, ad_id asc
select ad_id, ifnull(round(count(case when action= 'Clicked' then 1 end)/(count(case when action= 'Clicked' then 1 end)+count(case when action= 'Viewed' then 1 end))*100,2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(action = 'Clicked') / sum(action = 'Clicked' or action = 'Viewed') * 100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(action = 'Clicked') / sum(action = 'Clicked' or action = 'Viewed') * 100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(sum(action = 'Clicked') / sum(action = 'Clicked' or action = 'Viewed') * 100, 2),0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(action = 'Clicked')/ sum(action!='Ignored') * 100,2),0) as ctr from Ads group by ad_id order by ctr desc,ad_id asc
select ad_id, ifnull(round(sum(action ='Clicked')/sum(action !='ignored') *100,2),0) ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(action="Clicked") / (sum(action="Clicked") + sum(action="Viewed"))*100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(action='Clicked') / sum(action='Clicked' or action = 'Viewed')*100,2),0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(action='Clicked')*100/ (sum(action='Viewed')+sum(action='Clicked')),2),00) as ctr from Ads group by 1 order by 2 desc, 1
select ad_id, ifnull(round(sum(case when action = "Clicked" then 1 else 0 end) / sum(case when action in ("Clicked", "Viewed") then 1 else 0 end ) * 100, 2 ), 0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action != 'Ignored' then 1 else 0 end) *100,2),0.00) as ctr from ads group by ad_id ORDER BY ctr DESC,ad_id ASC
select ad_id, ifnull(round(sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end) * 100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end) * 100, 2), 0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end)*100,2),0) as ctr from ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(sum(case when action = 'Clicked' then 1 else 0 end)/sum(case when action = 'Ignored' then 0 else 1 end) * 100,2),0.00) as ctr from ads group by 1 order by 2 desc, 1
select ad_id, ifnull(round(sum(case when action = 'clicked' then 1 else 0 end)*100 / (sum(case when action = 'viewed' then 1 else 0 end ) + sum(case when action = 'clicked' then 1 else 0 end)), 2), 0) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(case when action ='Clicked' then 1 else 0 end )*100/(sum(case when action ='Clicked' then 1 else 0 end) + sum(case when action ='Viewed' then 1 else 0 end)),2),0) as ctr from ads group by ad_id order by 2 desc, 1 asc
select ad_id, ifnull(round(sum(case when action= 'Clicked' then 1 else 0 end)/sum(case when action='Viewed' or action= 'Clicked' then 1 else 0 end)*100,2),0) ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(case when action='Clicked' then 1 else 0 end) / sum(case when action='Clicked' or action = 'Viewed' then 1 else 0 end)*100,2),0) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, ifnull(round(sum(case when action='Clicked' then 1 else 0 end)/ (sum(case when action='Clicked' then 1 else 0 end)+ sum(case when action='Viewed' then 1 else 0 end) )*100,2),0.00) ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(case when action='Clicked' then 1 else 0 end)/ sum(case when action='Ignored'then 0 else 1 end)*100,2),0) as ctr from ads group by 1 order by 2 desc, 1 asc
select ad_id, ifnull(round(sum(case when action='Clicked' then 1 else 0 end)/(sum(case when action='Clicked' then 1 else 0 end)+sum(case when action='Viewed'then 1 else 0 end))*100 ,2),0)as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, ifnull(round(sum(case when action='Clicked' then 1 else 0 end)/sum(case when action in('Clicked','Viewed') then 1 else 0 end)*100,2),0) as ctr from Ads group by 1 order by 2 desc,1
select ad_id, ifnull(round(sum(click_only) / sum(click_or_view) * 100,2), 0) as ctr from (select ad_id, (case when action = 'Clicked' then 1 else 0 end) as click_only, (case when action = 'Ignored' then 0 else 1 end) as click_or_view from ads) as temp1 group by ad_id order by ctr desc, ad_id asc
select ad_id, round (ifnull(clicks/total *100 , 0),2) ctr from ( SELECT ad_id, Sum(CASE WHEN action = 'Clicked' THEN 1 ELSE 0 END) clicks, Sum(CASE WHEN action = 'Clicked' OR action = 'Viewed' THEN 1 ELSE 0 END) AS total FROM ads GROUP BY ad_id ) tb2 GROUP BY ad_id order by ctr desc, ad_id
select ad_id, round( case when click_cnt + view_cnt = 0 then 0 else click_cnt*100/(click_cnt + view_cnt) end, 2) as ctr from ( select ad_id, sum(case when action = 'clicked' then 1 else 0 end) as click_cnt, sum(case when action = 'Viewed' then 1 else 0 end) as view_cnt from ads group by ad_id ) x order by ctr desc, ad_id
select ad_id, round( coalesce( sum(case when action = 'Clicked' then 1 else 0 end) / (sum(case when action = 'Clicked' then 1 else 0 end) + sum(case when action = 'Viewed' then 1 else 0 end)) * 100, 0 ) ,2) as ctr from Ads group by ad_id order by 2 desc,1 asc
select ad_id, round( ifnull( 100 * sum(case when action in ('Clicked') then 1 else 0 end) / sum(case when action in ('Clicked', 'Viewed') then 1 else 0 end) ,0) ,2) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, round( ifnull( 100*avg( case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else null end ) ,0) ,2) as ctr from ads group by 1 order by ctr desc, ad_id
select ad_id, round((case when sum(case when action in ('Clicked','Viewed') then 1 else 0 end)=0 then 0 else sum(case when action ='Clicked' then 1 else 0 end)/sum(case when action in ('Clicked','Viewed') then 1 else 0 end) *100 end),2) as ctr from Ads group by 1 order by 2 desc, 1
select ad_id, round((case when total_click = 0 and total_view = 0 then 0 else 100*total_click / (total_click+total_view) end),2) as ctr from (select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as total_click, sum(case when action = 'Viewed' then 1 else 0 end) as total_view from Ads group by ad_id) as a order by ctr desc, ad_id asc
select ad_id, round(100*coalesce(sum(case when action = 'Clicked' then 1 else 0 end)/sum(case when action ='Clicked' or action = 'Viewed' then 1 else 0 end), 0), 2) as ctr from ads group by 1 order by 2 desc,1
select ad_id, round(case when sum(case when action in ('Clicked','Viewed') then 1 else 0 end)=0 then 0 else sum(case when action in ('Clicked') then 1 else 0 end)/sum(case when action in ('Clicked','Viewed') then 1 else 0 end)*100 end,2) as ctr from ads group by ad_id order by 2 desc,1
select ad_id, round(case when total_clicks + total_views = 0 then 0 else (total_clicks*100) / (total_clicks + total_views) end,2) as ctr from (select ad_id , sum(case when action = 'Clicked' then 1 else 0 end) total_clicks , sum(case when action = 'Viewed' then 1 else 0 end) total_views from ads group by 1) a order by 2 desc, ad_id asc
select ad_id, round(coalesce((sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end)), 0), 4) * 100 as ctr from Ads group by 1 order by 2 desc, 1 asc
select ad_id, round(coalesce((sum(case when action ='Clicked' then 1 else 0 end)/ (sum(case when action ='Clicked' then 1 else 0 end)+ sum(case when action ='Viewed' then 1 else 0 end)))*100,0),2) as ctr From Ads group by ad_id order by ctr desc, ad_id
select ad_id, round(coalesce((sum(case when action='Clicked' then 1 else 0 end)/(sum(case when action='Clicked' then 1 else 0 end) + sum(case when action='Viewed' then 1 else 0 end)) * 100),0),2) as ctr from Ads group by ad_id order by 2 desc, 1
select ad_id, round(coalesce((sum(case when action='Clicked' then 1 else 0 end)/(sum(case when action='Clicked' then 1 else 0 end) + sum(case when action='Viewed' then 1 else 0 end)) * 100),0),2) as ctr from Ads group by ad_id order by ctr desc,ad_id asc
select ad_id, round(coalesce((total_clicks/(total_clicks+total_views))*100, 0), 2) as CTR from( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as total_clicks, sum(case when action ='Viewed' then 1 else 0 end) as total_views from ads group by ad_id ) c group by ad_id order by ctr desc, ad_id
select ad_id, round(coalesce(avg(case when action = 'Clicked' then 1 when action = 'Viewed' then 0 else NULL end), 0) * 100, 2) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, round(coalesce(clickedSum/viewedSum*100,0),2) as ctr from ( select distinct ad_id, sum(case when action = "Clicked" then 1 else 0 end) over(partition by ad_id) as clickedSum, sum(case when action = "Clicked" or action = "Viewed" then 1 else 0 end) over(partition by ad_id) as viewedSum from Ads )sub order by ctr desc, ad_id
select ad_id, round(coalesce(sum(Clicked)*100/(sum(Clicked)+sum(Viewed)),0),2) as ctr from (select ad_id, case when action = 'Clicked' then 1 else 0 end as Clicked, case when action = 'Viewed' then 1 else 0 end as Viewed, case when action = 'Ignored' then 1 else 0 end as Ignored from Ads) sub group by ad_id order by ctr desc, ad_id asc
select ad_id, round(coalesce(sum(case when action = 'Clicked' then 1 else 0 end) / (sum(case when action = 'Clicked' then 1 else 0 end) + sum(case when action = 'Viewed' then 1 else 0 end))*100, 0), 2) as ctr from Ads group by ad_id order by ctr DESC, ad_id ASC
select ad_id, round(coalesce(sum(if(action='Clicked', 1, 0))*100/(sum(action='Clicked')+sum(action='Viewed')), 0.00), 2) as ctr from Ads group by ad_id order by round(coalesce(sum(action='Clicked')*100/(sum(action='Clicked')+sum(action='Viewed')), 0.00), 2) desc, ad_id asc
select ad_id, round(if((num_clicked + num_viewed) = 0, 0.00, 100.0*num_clicked/(num_clicked + num_viewed)),2) as ctr from( select ad_id, sum(if(action = 'Clicked', 1, 0)) as num_clicked, sum(if(action = 'Viewed', 1, 0)) as num_viewed from Ads group by 1) as a order by ctr desc, ad_id asc
select ad_id, round(ifnull( 100.0 * sum(case when `action` = 'Clicked' then 1 else 0 end) / sum(case when `action` = 'Clicked' or `action` = 'Viewed' then 1 else 0 end), 0), 2) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, round(ifnull((sum(case when action = 'Clicked' then 1 else 0 end)/ sum(case when action in ('Viewed','Clicked') then 1 else 0 end)*100),0),2) ctr from ads group by ad_id order by 2 desc, 1 asc
select ad_id, round(ifnull(count(case when action in ('Clicked') then user_id end)/ count(case when action in ('Clicked', 'Viewed') then user_id end),0)*100,2) as ctr from Ads group by ad_id order by 2 desc, ad_id
select ad_id, round(ifnull(round(sum(case when action = 'Clicked' then 1 else 0 end) / sum(case when action in ('Clicked','Viewed') then 1 else 0 end),4)*100,0),5) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, round(ifnull(sum(action = "Clicked")/(sum(action = "Clicked") + sum(action = "Viewed")), 0)*100, 2) as ctr from Ads group by ad_id order by ctr desc, ad_id asc
select ad_id, round(ifnull(sum(action="Clicked")/(sum(action="Clicked")+sum(action="Viewed"))*100,0),2) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, round(ifnull(sum(action='Clicked')/ sum(action='Clicked' or action='Viewed'),0) *100,2) as ctr from Ads group by ad_id order by ctr desc, ad_id
select ad_id, round(ifnull(sum(case when action like 'Clicked' then 1 else 0 end)/sum(case when action like 'Clicked' or action like 'Viewed' then 1 else 0 end)*100, 0) ,2) as ctr from ads group by ad_id order by ctr desc, ad_id
select ad_id, round(ifnull(sum(case when action='Clicked' then 1 else 0 end) / sum(case when action='Viewed' then 1 when action='Clicked' then 1 else 0 end)*100,0),2) as ctr from Ads group by 1 order by 2 desc, ad_id asc
select ad_id, round(ifnull(sum(case when action='Clicked' then 1 else 0 end)*100/sum(case when action='Clicked' or action="Viewed" then 1 else 0 end),0),2) as ctr from ads group by ad_id order by 2 desc,1 asc
select ad_id, round(ifnull(sum(case when action='Clicked' then 1 else 0 end)/(sum(case when action='Clicked' then 1 else 0 end) + sum(case when action='Viewed' then 1 else 0 end)) * 100,0),2) as ctr from Ads group by ad_id order by 2 desc, 1
select ad_id, round(ifnull(sum(case when action='Clicked' then 1 else 0 end)/sum(case when action='Clicked'or action='Viewed'then 1 else 0 end)*100,0),2)as ctr from Ads group by ad_id order by ctr DESC, ad_id ASC
select ad_id,if(clicked+viewed=0,0,round((clicked/(clicked+viewed))*100,2)) as CTR from (select ad_id, sum(if(action="Clicked",1,0)) as clicked, sum(if(action="Viewed",1,0)) as viewed , sum(if(action="Ignored",1,0)) as ignored from Ads group by ad_id) a order by CTR desc,ad_id
select ad_id,ifnull(round( (sum(case when action='Clicked' then 1 else 0 end) *100)/ (sum(case when action='Clicked' or action ='viewed' then 1 else 0 end)),2),0) as ctr from ads group by ad_id order by ctr desc ,ad_id asc
select ad_id,round(coalesce((total_clicked / (total_clicked + total_viewed)) * 100,0.00),2) ctr from ( select ad_id,sum(case when action='Clicked' then 1 else 0 end) total_clicked, sum(case when action='Viewed' then 1 else 0 end) total_viewed from Ads group by ad_id ) a order by ctr desc,ad_id asc
select distinct ad_id, round(ifnull((sum(case when action = "Clicked" then 1 else 0 end)*100/sum(case when action = "Clicked" then 1 when action="Viewed" then 1 else 0 end)),0),2) as ctr from Ads group by ad_id order by ctr desc, ad_id
select distinct ads.ad_id, ifnull(summary.ctr,0) as ctr from ads left join( select ad_id, round(sum(case when action = 'Clicked' then 1 else 0 end)/ count(action) * 100, 2) as ctr from ads where action != 'Ignored' group by ad_id)summary on ads.ad_id = summary.ad_id order by ctr desc, ad_id
select distinct e.ad_id, round(ifnull(c/d*100,0),2) as ctr from ads e left join (select ad_id, count(user_id) as c from ads where action = 'Clicked' group by ad_id) a on e.ad_id = a.ad_id left join (select ad_id, count(user_id) as d from ads where action = 'Clicked' or action = 'Viewed' group by ad_id) b on a.ad_id = b.ad_id order by ctr desc, ad_id
select distinct f1.ad_id, round((case when c_num is null and v_num is null then 0 when c_num is null and v_num is not null then 0 when c_num is not null and v_num is null then 1 else c_num/(c_num+v_num) end *100),2) ctr from ( select ad_id from ads) f1 left join ( select ad_id, count(action) c_num from ads group by ad_id, action having action = 'clicked') f2 on f1.ad_id = f2.ad_id left join ( select ad_id, count(action) v_num from ads group by ad_id, action having action = 'viewed') f3 on f1.ad_id = f3.ad_id order by ctr desc, ad_id
select distinct t1.ad_id, case when t2.action is null and t3.action is null then 0.00 when t2.action is not null and t3.action is null then 100.00 when t2.action is null and t3.action is not null then 0.00 else round(t2.ct/(t2.ct+t3.ct)*100,2) end as ctr from Ads t1 left join (select ad_id, action, count(user_id) as ct from Ads where action='Clicked' group by ad_id, action) t2 on t1.ad_id = t2.ad_id left join (select ad_id, action, count(user_id) as ct from Ads where action='Viewed' group by ad_id, action) t3 on t1.ad_id = t3.ad_id order by ctr desc, t1.ad_id asc
select otr.ad_id, ROUND(ifnull((otr.cnt/(otr.cnt+otr.v_cnt)*100),0),2) as ctr from( SELECT c.ad_id,c.cnt,IFNULL(v.cnt,0) as v_cnt from (select ad_id ,action,count(*) as cnt from Ads where action in ('Clicked') group by ad_id ,action order by ad_id ) as c left join (select ad_id ,action,count(*) as cnt from Ads where action in ('Viewed') group by ad_id ,action order by ad_id )as v on c.ad_id=v.ad_id union SELECT v.ad_id,0 as cnt,0 as v_cnt from (select ad_id ,action,count(*) as cnt from Ads where action in ('Clicked') group by ad_id ,action order by ad_id ) as c right join (select ad_id ,action,count(*) as cnt from Ads where action in ('Viewed') group by ad_id ,action order by ad_id )as v on c.ad_id=v.ad_id where c.ad_id is null )as otr UNION SELECT ad_id,round(0,2) from Ads where action in ('Ignored') and ad_id not in (SELECT ad_id from Ads where action ='Clicked' or( action='Clicked' and action='Viewed' )) order by ctr desc,ad_id
select t.ad_id, case when t.num_of_clicks+t.num_of_views=0 then 0 else round((t.num_of_clicks*100/(t.num_of_clicks+t.num_of_views)),2) end as ctr from (select ad_id, sum(case when action='Clicked' then 1 else 0 end) as num_of_clicks, sum(case when action='Viewed' then 1 else 0 end) as num_of_views from ads group by ad_id )t order by case when t.num_of_clicks+t.num_of_views=0 then 0 else round((t.num_of_clicks*100/(t.num_of_clicks+t.num_of_views)),2) end desc, ad_id
select t3.ad_id, round(ifnull(total_click/total_view*100,0),2) as ctr from (select distinct ad_id from ads) t3 left join (select ad_id, ifnull(count(*),0) as total_view from ads where action in ('Clicked','Viewed') group by 1) t1 on t3.ad_id = t1.ad_id left join (select ad_id, ifnull(count(*),0) as total_click from ads where action = 'Clicked' group by 1) t2 on t1.ad_id = t2.ad_id order by ctr desc, 1
select tb.ad_id , round(case when clicks = 0 then 0 else clicks / impressions end * 100, 2) as ctr from ( select ad_id , sum(case when action = 'Clicked' then 1 else 0 end) as clicks , sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end) as impressions from Ads group by ad_id ) tb order by round(case when clicks = 0 then 0 else clicks / impressions end * 100, 2) desc, ad_id
select x.ad_id, case when sum(den) = 0 then 0 else round((sum(num)*100.0/sum(den)),2) end as ctr from (select ad_id, case when action = 'Clicked' then 1 else 0 end as num, case when action = 'Clicked' then 1 when action = 'Viewed' then 1 else 0 end as den from ads) as x group by ad_id order by ctr desc, ad_id asc
with ad as ( select ad_id, sum( case when action = 'Clicked' then 1 else 0 end) as clicked, sum( case when action = 'Viewed' then 1 else 0 end ) as viewed from ads group by 1 ) select ad_id, coalesce(round((clicked/(clicked+viewed) * 100), 2),0) as ctr from ad order by ctr desc, ad_id asc
with ad as ( select ad_id,sum( case when action='Clicked' then 1 else 0 end ) clicked, sum( case when action='Viewed' then 1 else 0 end )viewed from ads group by 1 ) select ad_id,coalesce(round((clicked/(clicked+viewed)*100),2),0) ctr from ad order by ctr desc, ad_id asc
with ad_click_view as ( select a.ad_id, sum(case when a.action = "Clicked" then 1 else 0 end) as total_clicked, sum(case when a.action = "Viewed" then 1 else 0 end) as total_viewed from Ads a group by a.ad_id ) select ad_id, case when total_clicked + total_viewed = 0 then 0 else (round((total_clicked/(total_clicked+total_viewed)*100),2)) end as ctr from ad_click_view order by ctr desc, ad_id asc
with ad_cte as( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as total_clicks, sum(case when action = 'Viewed' then 1 else 0 end) as total_views from Ads group by ad_id ) select ad_id, ifnull(round((total_clicks/(total_views+total_clicks) * 100),2),0) as ctr from ad_cte group by ad_id order by ctr desc, ad_id
with ad_ids as ( select distinct(ad_id) as ad_id from Ads ), ad_ctr as ( select ad_id, action, round(action_count/total_count*100,2) as ctr from ( select ad_id, action, action_count, sum(action_count) over (partition by ad_id) as total_count from ( select Ads.ad_id, Ads.action, count(distinct(user_id)) as action_count from Ads where action = "Viewed" or action = "Clicked" group by ad_id, Ads.action ) t1 ) t2 where action = "Clicked" group by ad_id, ctr ) select ad_ids.ad_id, coalesce(ctr, 0.00) as ctr from ad_ids left join ad_ctr on ad_ids.ad_id = ad_ctr.ad_id order by ctr DESC, ad_id ASC
with ads_pivot as (select ad_id, user_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicked, sum(case when action = 'Viewed' then 1 else 0 end) as viewed, sum(case when action = 'Ignored' then 1 else 0 end) as ignored from Ads group by ad_id, user_id) select ad_id, round(case when sum(clicked) + sum(viewed) = 0 then 0 else (sum(clicked) /(sum(clicked) + sum(viewed))) * 100 end, 2) as ctr from ads_pivot group by ad_id order by 2 desc, 1
with base as ( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as click_count, sum(case when action in ('Viewed', 'Clicked') then 1 else 0 end) as total_count from ads group by ad_id ) select ad_id, coalesce(round((click_count / total_count) * 100, 2), 0) as ctr from base order by ctr desc, ad_id
with base as ( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as total_clicks, sum(case when action = 'Clicked' then 1 when action = 'Viewed' then 1 else 0 end) as total_exposure from Ads group by 1 ) select ad_id, round(case when total_exposure = 0 then 0 else (total_clicks/total_exposure)*100 end, 2) as ctr from base order by 2 desc, 1
with c as (select ad_id, (count(*)) as tc from ads where action = 'clicked' group by ad_id), v as (select ad_id, count(action) as tv from ads where action = 'Viewed' group by ad_id) select distinct a.ad_id, case when (c.tc is not null and v.tv is not null) then round(c.tc/(c.tc+v.tv)*100,2) when c.tc is null then 0.00 when v.tv is null then 100.00 else 0.00 end as ctr from ads a left join c using (ad_id) left join v using (ad_id) order by 2 desc, 1 asc
with click_view as( select ad_id, sum(case when action = 'clicked' or action = 'viewed' then 1 else 0 end) as click_view from ads group by ad_id), click as( select ad_id, sum(case when action = 'clicked' then 1 else 0 end) as clicked from ads group by ad_id) select click.ad_id, round(ifnull(clicked/click_view*100,0),2) as ctr from click_view join click on click_view.ad_id = click.ad_id group by click.ad_id order by ctr desc, ad_id
with clicked_and_viewed_per_ad as ( select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicked, sum(case when action = 'Viewed' then 1 else 0 end) as viewed from Ads group by ad_id ) select ad_id, case when clicked + viewed = 0 then 0 else round(clicked * 100.0 / (clicked + viewed),2) end as ctr from clicked_and_viewed_per_ad order by ctr desc, ad_id
with cte as ( select ad_id, round(100* sum(if(action="Clicked",1,0))/ count(*),2) as ctr from Ads where action in ("Clicked","Viewed") group by 1 order by ctr desc ) select a.ad_id, ifnull(avg(b.ctr),0) as ctr from Ads a left join cte b on a.ad_id = b.ad_id group by 1 order by ctr desc, ad_id
with cte as ( select ad_id, round(case when sum(ccount+vcount) = 0 then 0 else ((ccount/(ccount+vcount))*100) end,2) as ctr from (select ad_id, sum(case when action='Clicked' then 1 else 0 end) as ccount, sum(case when action='Viewed' then 1 else 0 end) as vcount from Ads group by ad_id) sq group by ad_id ) select ad_id, ctr from cte order by ctr desc, ad_id
with cte as ( select ad_id, sum(case when action='Clicked' then 1 else 0 end) tot_clicks, sum(case when action='Viewed' then 1 else 0 end) tot_views from Ads group by ad_id) select ad_id,round(ifnull(tot_clicks/(tot_clicks+tot_views)*100,0),2) as ctr from cte order by ctr desc, ad_id asc
with cte as ( select ad_id, sum(if(action='Clicked',1,0)) as click_num, sum(if(action='Viewed' or action='Clicked',1,0)) as total_num from ads group by 1) select ad_id, round(if(total_num=0,0,click_num/total_num)*100,2) as ctr from cte order by 2 desc, 1 asc
with cte as (select *, case when action = 'Clicked' then 1 else 0 end as clicks, case when action = 'Viewed' then 1 else 0 end as views from ads) select ad_id, ifnull(round(sum(clicks) / (sum(clicks) + sum(views)) * 100 , 2),0) as ctr from cte group by 1 order by 2 desc, 1
with cte as (select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as clicks, sum(case when action = 'CLicked' or action = 'Viewed' then 1 else 0 end) as clickView from ads group by ad_id) select ad_id, case when clickView = 0 then 0.00 else round(clicks*100/clickView, 2) end as ctr from cte order by case when clickView = 0 then 0.00 else round(clicks*100/clickView, 2) end desc, ad_id asc
with cte as (select ad_id, sum(case when action = 'Clicked' then 1 else 0 end) as numerator, sum(case when action = 'Clicked' or action = 'Viewed' then 1 else 0 end) as denominator from ads group by ad_id ) select ad_id, ifnull(round(((numerator/denominator)*100),2),0.00) as ctr from cte order by ctr desc, ad_id
with cte as (select ad_id,sum(case when action = 'Clicked' then 1 else 0 end) as Clicked, sum(case when action = 'Viewed' then 1 else 0 end) as Viewed from Ads group by 1) select ad_id, round(case when Clicked + Viewed = 0 then 0 else 100 * Clicked/(Clicked + Viewed) end,2) as ctr from cte order by 2 desc, 1 asc
with cte as( select *, (case when action = 'Clicked' then 1 else 0 end) as click_no, (case when action = 'Viewed' then 1 else 0 end) as view_no from Ads ) select ad_id, (case when (sum(click_no) + sum(view_no)) = 0 then 0 else ROUND(sum(click_no) / (sum(click_no) + sum(view_no)) * 100, 2) end) as ctr from cte group by ad_id order by ctr DESC, ad_id
with cte as( select ad_id, sum(case when action='Clicked' then 1 else 0 end) as ClickCnt, sum(case when action='Viewed' then 1 else 0 end) as ViewCnt from Ads group by ad_id ) , cte1 as ( select ad_id, case when ClickCnt+ViewCnt=0 then 0 else round(100*ClickCnt/(ClickCnt+ViewCnt), 2) end as ctr from cte ) select * from cte1 order by ctr desc, ad_id
with cte as( select ad_id, sum(case when action='Clicked' then 1 else 0 end) clk, sum(case when action='Viewed' then 1 else 0 end) vw from ads group by ad_id) select ad_id, case when clk+vw !=0 then round((clk/(clk+vw))*100,2) else 0 end as ctr from cte order by ctr desc,ad_id asc
with cte as(select ad_id, count(*) as cnt, sum(case when action = 'Clicked' then 1 else 0 end) as num_click from Ads where action = 'Clicked' or action = 'Viewed' group by ad_id) , cte1 as( select distinct ad_id from Ads group by ad_id) select a.ad_id, round(ifnull(b.num_click/b.cnt*100,0),2) as ctr from cte1 a left join cte b using (ad_id) order by 2 desc,1
with cte1 as ( select ad_id, count(*) as c1 from Ads where action = 'Clicked' or action = 'Viewed' group by ad_id), cte2 as ( select ad_id, count(*) as c2 from Ads where action = 'Clicked' group by ad_id) select distinct b.ad_id, ifnull(ctr, 0) as ctr from (select cte1.ad_id, round(100*c2/c1, 2) as ctr from cte1 join cte2 on cte1.ad_id = cte2.ad_id) a right join ( select distinct ad_id from Ads) b using(ad_id) order by ctr desc, ad_id asc
with cte1 as ( select ad_id, sum(case when action="Clicked" then 1 else 0 end) total_clicked, sum(case when action="Viewed" then 1 else 0 end) total_viewed from Ads group by ad_id ) ,cte2 as( select ad_id, round(((total_clicked / (total_clicked + total_viewed)) * 100),2) as ctr from cte1 ) Select distinct a.ad_id, coalesce(ctr, 0) ctr from Ads a left join cte2 on a.ad_id = cte2.ad_id order by coalesce(ctr, 0) desc, ad_id
with ctr as ( select ad_id, round(case when sum(case when action='Clicked' then 1 else 0 end)+sum(case when action='Viewed' then 1 else 0 end) = 0 then 0 else sum(case when action='Clicked' then 1 else 0 end)/(sum(case when action='Clicked' then 1 else 0 end)+sum(case when action='Viewed' then 1 else 0 end))*100 end, 2) as ctr from ads group by ad_id order by 2 desc, ad_id ) select * from ctr
with foo as ( select ad_id , sum(case when action = 'Clicked' then 1 else 0 end) as cnt_clicks , sum(case when action = 'Viewed' then 1 else 0 end) as cnt_views , round(avg(case when action = 'Clicked' then 1 else 0 end) * 100, 2) as ctr2 from Ads group by ad_id ) select ad_id , if(cnt_clicks + cnt_views = 0, 0, round(cnt_clicks / (cnt_clicks + cnt_views) * 100, 2)) as ctr from foo order by ctr desc , ad_id asc
with nt as( select ad_id, sum(case when action='clicked' then 1 else 0 end) as 'Clicked', sum(case when action='viewed' then 1 else 0 end) as 'Viewed' from ads group by 1) select ad_id, ifnull(round(clicked*100/(clicked+viewed),2),0) as ctr from nt order by ctr desc, ad_id
with t as ( select ad_id, sum(case when action='Clicked' then 1 else 0 end) as clicked, sum(case when action='Viewed' then 1 else 0 end) as viewed from Ads group by ad_id ) select ad_id, round(COALESCE(clicked/(clicked+viewed)*100,0),2) as ctr from t order by ctr desc, ad_id asc
with t as ( select ad_id, sum(case when action='Clicked' then 1 else 0 end) as clk_num, sum(case when action='Viewed' then 1 else 0 end) as view_num from Ads group by ad_id ) select ad_id, round((case when clk_num+view_num=0 then 0 else clk_num/(clk_num+view_num) end)*100,2) as ctr from t order by ctr desc, ad_id
with t1 as ( select ad_id, sum(if(action = 'Clicked', 1, 0)) as total_clicks, sum(if(action = 'Viewed', 1, 0)) as total_views from Ads group by ad_id ) select ad_id, case when total_clicks + total_views = 0 then 0 else round(total_clicks / (total_clicks + total_views) * 100, 2) end as ctr from t1 order by ctr desc, ad_id
with table1 as (select ad_id, sum(case when action='Clicked' then 1 else 0 end) as clicksc, sum(case when action='Viewed' then 1 else 0 end) as viewsc from ads group by ad_id) select ad_id, (case clicksc+viewsc when 0 then 0 else round(clicksc*100/(clicksc+viewsc),2) end) as ctr from table1 order by ctr desc,ad_id
with tb as (select ad_id, sum(case when action='Clicked' then 1 else 0 end) as clicked, sum(case when action='Viewed' then 1 else 0 end) as viewed from ads group by ad_id) select ad_id, ifnull(round(clicked / (clicked + viewed)*100,2),0) as ctr from tb order by ctr desc, ad_id
with temp as ( select ad_id, user_id, case when action='Clicked' then 1 else 0 end as clicked, case when action='Viewed' then 1 else 0 end as viewed from Ads ) select ad_id, round(ifnull(sum(clicked)/(sum(clicked)+sum(viewed)),0)*100,2) as ctr from temp group by ad_id order by ctr desc, ad_id asc
with temp as (select ad_id, sum(case when action!="Ignored" then 1 else 0 end ) as denumerator, sum(case when action ="Clicked" then 1 else 0 end ) as numerator from Ads group by ad_id) select temp.ad_id, case when denumerator=0 then 0.00 else round(100.00*numerator/denumerator,2) end as ctr from temp order by 2 DESC, temp.ad_id
with temp as (select ad_id,count(user_id) count1 from Ads where action!="Ignored" group by 1), temp2 as (select ad_id,count(distinct user_id)count2 from Ads where action="Clicked" group by 1) select a.ad_id,round(ifnull((temp2.count2/temp.count1)*100,0),2) as ctr from Ads a left join temp using(ad_id) left join temp2 using(ad_id) group by 1 order by ctr desc,1
with temp as( select ad_id, sum(case when action = 'Clicked' then 1 else 0 END) as clicked, sum(case when action = 'Viewed' then 1 else 0 END) as viewed from ads group by ad_id ) select ad_id, case when clicked + viewed = 0 then 0 else round((clicked/(clicked+viewed))*100,2) end as ctr from temp order by ctr desc, ad_id asc
with tmp as (select ad_id , sum(case when action = 'clicked' then 1 else 0 end) as clicked, sum(case when action = 'Viewed' then 1 else 0 end) as viewed from Ads group by ad_id) select ad_id, coalesce(round(clicked / (clicked + viewed)*100,2),0) as ctr from tmp order by ctr desc, ad_id
with tmp as (select ad_id , sum(case when action = 'clicked' then 1 else 0 end) as clicked, sum(case when action = 'Viewed' then 1 else 0 end) as viewed from Ads group by ad_id) select ad_id, ifnull(round(clicked / (clicked + viewed)*100,2),0) as ctr from tmp order by ctr desc, ad_id
with tmp as (select ad_id, action, count(*) as num from ads where action!='Ignored' group by 1,2 ), cte as (select *, sum(num) over (partition by ad_id) as total from tmp), cte1 as (select ad_id,num,total from cte where action='Clicked'), unique_id as (select distinct ad_id from ads), cte2 as (select ad_id,round(num*100/total,2) as ctr from cte1), res as (select a.ad_id,b.ctr from unique_id a left join cte2 b on a.ad_id=b.ad_id) select ad_id, case when ctr is not null then ctr else 0.00 end as ctr from res order by ctr desc, ad_id
