FROM ( SELECT SUM(B.apple_count) AS ba, SUM(B.orange_count) AS bo, SUM(IFNULL(C.apple_count,0)) AS ca, SUM(IFNULL(C.orange_count,0)) AS co FROM Boxes B LEFT OUTER JOIN Chests C ON (B.chest_id = C.chest_id) ) AS t1
SELECT (SUM(b.apple_count) + IFNULL(SUM(c.apple_count),0)) AS apple_count, (SUM(b.orange_count) + IFNULL(SUM(c.orange_count),0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON c.chest_id = b.chest_id
SELECT COALESCE(SUM(b.apple_count),0)+coalesce(SUM(c.apple_count),0) apple_count,COALESCE(SUM(b.orange_count),0)+COALESCE(SUM(c.orange_count),0) orange_count FROM Boxes b LEFT JOIN Chests c USING(chest_id)
SELECT D.apple_count, D.orange_count FROM (SELECT SUM(A.A_count) OVER (ORDER BY A_count) apple_count, SUM(A.O_count) OVER (ORDER BY A_count) orange_count FROM (SELECT COALESCE(B.apple_count + C.apple_count, B.apple_count) A_count, COALESCE(B.orange_count + C.orange_count, B.orange_count) O_count FROM Boxes B LEFT JOIN Chests C ON B.chest_id = C.chest_id) A) D ORDER BY D.apple_count DESC LIMIT 1
SELECT IFNULL(SUM(B.apple_count), 0) + IFNULL(SUM(C.apple_count), 0) AS apple_count, IFNULL(SUM(B.orange_count), 0) + IFNULL(SUM(C.orange_count), 0) AS orange_count FROM Boxes AS B LEFT JOIN Chests AS C ON B.chest_id = C.chest_id
SELECT IFNULL(SUM(b.apple_count), 0) + IFNULL(SUM(c.apple_count), 0) AS apple_count, IFNULL(SUM(b.orange_count), 0) + IFNULL(SUM(c.orange_count), 0) AS orange_count FROM Boxes b LEFT JOIN Chests c USING (chest_id)
SELECT SUM( b.apple_count + COALESCE( c.apple_count, 0) ) apple_count ,SUM( b.orange_count + COALESCE( c.orange_count, 0) ) orange_count FROM Boxes b LEFT JOIN Chests c USING(chest_id)
SELECT SUM( b.apple_count + IF(c.chest_id, c.apple_count, 0) ) AS apple_count, SUM( b.orange_count + IF(c.chest_id, c.orange_count, 0) ) AS orange_count FROM Boxes as b LEFT JOIN Chests as c ON b.chest_id=c.chest_id
SELECT SUM( b.apple_count + IFNULL(c.apple_count, 0) ) apple_count, SUM( b.orange_count + IFNULL(c.orange_count, 0) ) orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM((COALESCE(b.apple_count, 0) + COALESCE(c.apple_count, 0))) AS apple_count, SUM((COALESCE(b.orange_count, 0) + COALESCE(c.orange_count, 0))) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM((IFNULL(b.apple_count, 0) + IFNULL(c.apple_count, 0))) AS apple_count, SUM((IFNULL(b.orange_count, 0) + IFNULL(c.orange_count, 0))) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM((b.apple_count + IFNULL(c.apple_count,0))) as apple_count,SUM((b.orange_count +IFNULL(c.orange_count,0))) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id=c.chest_id
SELECT SUM((b.apple_count) + IFNULL(c.apple_count,0)) AS apple_count, SUM((b.orange_count) + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON (B.CHEST_ID = C.CHEST_ID)
SELECT SUM(B.apple_count + IFNULL(C.apple_count,0)) AS apple_count, SUM(B.orange_count + IFNULL(C.orange_count,0)) AS orange_count FROM Boxes B LEFT JOIN Chests C ON B.chest_id = C.chest_id
SELECT SUM(B.apple_count + IFNULL(C.apple_count,0)) apple_count, SUM(B.orange_count + IFNULL(C.orange_count,0)) orange_count FROM Boxes AS B LEFT JOIN Chests AS C ON B.chest_id = C.chest_id
SELECT SUM(B.apple_count) + COALESCE(SUM(C.apple_count),0) AS apple_count, SUM(B.orange_count)+ COALESCE(SUM(C.orange_count),0) AS orange_count FROM Boxes B LEFT JOIN Chests C ON B.chest_id = C.chest_id
SELECT SUM(Boxes.apple_count + IFNULL(Chests.apple_count, 0)) AS apple_count, SUM(Boxes.orange_count + IFNULL(Chests.orange_count, 0)) AS orange_count FROM Boxes LEFT JOIN Chests ON Boxes.chest_id = Chests.chest_id
SELECT SUM(Boxes.apple_count)+SUM(IFNULL(Chests.apple_count,0)) AS apple_count, SUM(Boxes.orange_count)+SUM(IFNULL(Chests.orange_count,0)) AS orange_count FROM Boxes LEFT JOIN Chests ON Boxes.chest_id=Chests.chest_id
SELECT SUM(CASE WHEN b.chest_id IS NULL THEN b.apple_count ELSE b.apple_count + c.apple_count END) AS apple_count, SUM(CASE WHEN b.chest_id IS NULL THEN b.orange_count ELSE b.orange_count + c.orange_count END) AS orange_count FROM Boxes AS b LEFT JOIN Chests AS c ON b.chest_id = c.chest_id
SELECT SUM(CASE WHEN b.chest_id IS NULL THEN b.apple_count ELSE b.apple_count+c.apple_count END) AS apple_count, SUM(CASE WHEN b.chest_id IS NULL THEN b.orange_count ELSE b.orange_count+c.orange_count END) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id=c.chest_id
SELECT SUM(CASE WHEN b_ac+c_ac IS NULL THEN b_ac ELSE b_ac+c_ac END) AS apple_count, SUM(CASE WHEN b_oc+c_oc IS NULL THEN b_oc ELSE b_oc+c_oc END) as orange_count FROM( SELECT box_id, b.apple_count as b_ac, b.orange_count as b_oc, c.apple_count as c_ac, c.orange_count as c_oc FROM Boxes as b LEFT JOIN Chests as c ON b.chest_id = c.chest_id ) AS T
SELECT SUM(CASE WHEN c.apple_count IS NULL THEN b.apple_count ELSE b.apple_count+c.apple_count END) AS apple_count, SUM(CASE WHEN c.orange_count IS NULL THEN b.orange_count ELSE b.orange_count+c.orange_count END) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(CASE WHEN c.chest_id is null THEN b.apple_count ELSE c.apple_count+b.apple_count END) AS apple_count, SUM(CASE WHEN c.chest_id is null THEN b.orange_count ELSE c.orange_count+b.orange_count END) AS orange_count FROM boxes b LEFT JOIN chests c ON c.chest_id = b.chest_id
SELECT SUM(COALESCE(c.apple_count, 0) + b.apple_count) AS apple_count , SUM(COALESCE(c.orange_count, 0) + b.orange_count) AS orange_count FROM Boxes b LEFT JOIN Chests c USING(chest_id)
SELECT SUM(COALESCE(c.apple_count, 0)) + SUM(b.apple_count) as apple_count, SUM(COALESCE(c.orange_count, 0)) + SUM(b.orange_count) as orange_count FROM boxes as b left join chests as c on c.chest_id = b.chest_id
SELECT SUM(IFNULL(B1.apple_count,0)) + SUM(IFNULL(C1.apple_count,0)) apple_count, SUM(IFNULL(B1.orange_count,0)) + SUM(IFNULL(C1.orange_count,0)) orange_count FROM Boxes B1 LEFT JOIN Chests C1 ON B1.chest_id = C1.chest_id
SELECT SUM(IFNULL(b.apple_count, 0) + IFNULL(c.apple_count, 0)) AS apple_count, SUM(IFNULL(b.orange_count, 0) + IFNULL(c.orange_count, 0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(IFNULL(b.apple_count, 0)) + SUM(IFNULL(c.apple_count, 0)) AS apple_count, SUM(IFNULL(b.orange_count, 0)) + SUM(IFNULL(c.orange_count, 0)) AS orange_count FROM Boxes b LEFT JOIN Chests c on b.chest_id=c.chest_id
SELECT SUM(IFNULL(b.apple_count,0) + IFNULL(c.apple_count,0)) AS apple_count ,SUM(IFNULL(b.orange_count,0) + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c USING (chest_id)
SELECT SUM(IFNULL(b.apple_count,0)) + SUM(IFNULL(c.apple_count,0)) as apple_count, SUM(IFNULL(b.orange_count,0)) + SUM(IFNULL(c.orange_count,0)) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(IFNULL(c.apple_count,0) + b.apple_count) apple_count, SUM(IFNULL(c.orange_count,0)+b.orange_count) orange_count FROM boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(a.apple_count + IFNULL(b.apple_count,0)) AS apple_count, SUM(a.orange_count + IFNULL(b.orange_count,0)) AS orange_count FROM Boxes a LEFT JOIN Chests b ON a.chest_id = b.chest_id
SELECT SUM(apple_count) AS apple_count , SUM(orange_count) AS orange_count FROM (SELECT apple_count, orange_count FROM Boxes UNION ALL SELECT C.apple_count AS apple_count, C.orange_count AS orange_count FROM Chests C JOIN Boxes B ON C.chest_id=B.chest_id) Temp
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM ( SELECT (Boxes.apple_count + COALESCE(Chests.apple_count,0)) AS apple_count, (Boxes.orange_count + COALESCE(Chests.orange_count,0)) AS orange_count FROM Boxes LEFT OUTER JOIN Chests ON Boxes.chest_id = Chests.chest_id ORDER BY 1,2 )tbl
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM ( SELECT b.box_id, SUM(c.apple_count) AS apple_count, SUM(c.orange_count) AS orange_count FROM Boxes b INNER JOIN Chests c ON c.chest_id = b.chest_id UNION ALL SELECT box_id, SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM Boxes b ) xx
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM ( SELECT b.box_id, b.chest_id, (IFNULL(b.apple_count, 0) + IFNULL(c.apple_count, 0)) AS apple_count, (IFNULL(b.orange_count, 0) + IFNULL(c.orange_count, 0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id) sub
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM ( SELECT box_id, b.chest_id, SUM(c.apple_count) AS apple_count, SUM(c.orange_count) AS orange_count FROM Boxes b JOIN Chests c ON b.chest_id = c.chest_id GROUP BY box_id, b.chest_id UNION ALL SELECT box_id, b.chest_id, SUM(apple_count), SUM(orange_count) FROM Boxes b GROUP BY box_id, b.chest_id ) tmp
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM (SELECT SUM(Boxes.apple_count) AS apple_count, SUM(Boxes.orange_count) AS orange_count FROM Boxes UNION ALL SELECT SUM(Chests.apple_count) AS apple_count, SUM(Chests.orange_count) AS orange_count FROM Boxes LEFT JOIN Chests ON Boxes.chest_id = Chests.chest_id) temp1
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM (SELECT apple_count, orange_count FROM Boxes UNION ALL SELECT b.apple_count, b.orange_count FROM Boxes a LEFT JOIN Chests b ON a.chest_id = b.chest_id WHERE a.chest_id IS NOT NULL) a
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM (SELECT b.apple_count + IFNULL(c.apple_count, 0) AS apple_count, b.orange_count + IFNULL(c.orange_count, 0) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id) t
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM (SELECT box_id, (b.apple_count + IFNULL(c.apple_count, 0)) AS apple_count, (b.orange_count + IFNULL(c.orange_count, 0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON c.chest_id = b.chest_id GROUP BY box_id) a
SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM( SELECT * FROM Boxes UNION ALL SELECT b.box_id, c.chest_id, c.apple_count, c.orange_count FROM Boxes b JOIN Chests c ON b.chest_id = c.chest_id) ac
SELECT SUM(apple_count) apple_count, SUM(orange_count) orange_count FROM (SELECT SUM(apple_count) apple_count, SUM(orange_count) orange_count FROM Boxes UNION SELECT SUM(c.apple_count) apple_count, SUM(c.orange_count) orange_count FROM Boxes x LEFT JOIN Chests c ON x.chest_id = c.chest_id WHERE x.chest_id IS NOT NULL) x1
SELECT SUM(apple_count) as apple_count, SUM(orange_count) as orange_count FROM (SELECT b.chest_id, SUM(b.apple_count + IFNULL(c.apple_count,0)) as apple_count, SUM(b.orange_count + IFNULL(c.orange_count, 0)) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id GROUP BY chest_id)t
SELECT SUM(b.apple_count + + coalesce(c.apple_count,0)) as apple_count , SUM(b.orange_count + coalesce(c.orange_count,0)) as orange_count FROM Boxes b LEFT JOIN Chests c on b.chest_id = c.chest_id
SELECT SUM(b.apple_count + COALESCE(c.apple_count, 0)) AS apple_count, SUM(b.orange_count + COALESCE(c.orange_count, 0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + COALESCE(c.apple_count,0)) as apple_count, SUM(b.orange_count + COALESCE(c.orange_count,0)) as orange_count FROM boxes b LEFT JOIN chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count, 0)) AS apple_count, SUM(b.orange_count + IFNULL(c.orange_count, 0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count, 0)) as apple_count, SUM(b.orange_count + IFNULL(c.orange_count, 0)) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count ,SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes AS b LEFT JOIN Chests AS c USING(chest_id)
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id=c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c USING (chest_id)
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM boxes b LEFT JOIN chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count,SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes AS b LEFT JOIN Chests AS c ON b.chest_id=c.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count,SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes AS b LEFT JOIN Chests AS c USING(chest_id)
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) AS apple_count,SUM(b.orange_count + IFNULL(c.orange_count,0)) AS orange_count FROM Boxes AS b LEFT JOIN Chests AS c on c.chest_id = b.chest_id
SELECT SUM(b.apple_count + IFNULL(c.apple_count,0)) as apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + coalesce(c.apple_count,0)) as apple_count, SUM(b.orange_count + coalesce(c.orange_count,0)) as orange_count FROM boxes b LEFT JOIN chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count + ifnull(c.apple_count,0)) as apple_count, SUM(b.orange_count + ifnull(c.orange_count,0) ) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count) + COALESCE(SUM(c.apple_count),0) apple_count, SUM(b.orange_count) + COALESCE(SUM(c.orange_count),0) orange_count FROM Boxes b LEFT JOIN Chests c ON c.chest_id = b.chest_id
SELECT SUM(b.apple_count) + IFNULL(SUM(c.apple_count), 0) AS apple_count, SUM(b.orange_count) + IFNULL(SUM(c.orange_count), 0) AS orange_count FROM Boxes b LEFT JOIN Chests c USING (chest_id)
SELECT SUM(b.apple_count) + IFNULL(SUM(c.apple_count),0) AS apple_count, SUM(b.orange_count) + IFNULL(SUM(c.orange_count),0) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count)+coalesce(SUM(c.apple_count),0) apple_count,SUM(b.orange_count)+COALESCE(SUM(c.orange_count),0) orange_count FROM Boxes b LEFT JOIN Chests c USING(chest_id)
SELECT SUM(b.apple_count+ IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count+ IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count+IFNULL(c.apple_count, 0)) as apple_count, SUM(b.orange_count+IFNULL(c.orange_count, 0)) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count+IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count+IFNULL(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c USING(chest_id)
SELECT SUM(b.apple_count+IFNULL(c.apple_count,0)) apple_count, SUM(b.orange_count+IFNULL(c.orange_count,0)) orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT SUM(b.apple_count+ifnull(c.apple_count, 0)) AS apple_count, SUM(b.orange_count+ifnull(c.orange_count, 0)) AS orange_count FROM Boxes AS b LEFT JOIN Chests as c ON b.chest_id = c.chest_id
SELECT SUM(box_apple_count + chest_apple_count) AS apple_count, SUM(box_orange_count + chest_orange_count) AS orange_count FROM ( SELECT box_id, b.apple_count AS box_apple_count, b.orange_count AS box_orange_count, COALESCE(c.apple_count, 0) AS chest_apple_count, COALESCE(c.orange_count, 0) AS chest_orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id ) a
SELECT SUM(c.apple_count) AS apple_count, SUM(c.orange_count) AS orange_count FROM ( SELECT box_id, SUM(c.apple_count) AS apple_count, SUM(c.orange_count) AS orange_count FROM Boxes b INNER JOIN Chests c ON b.chest_id = c.chest_id GROUP BY box_id UNION ALL SELECT box_id, apple_count, orange_count FROM Boxes b ) c
SELECT SUM(total_apples) AS 'apple_count' ,SUM(total_oranges) AS 'orange_count' FROM ( SELECT a.box_id ,a.apple_count + IFNULL(b.apple_count,0) AS 'total_apples' ,a.orange_count + IFNULL(b.orange_count,0) AS 'total_oranges' FROM Boxes a LEFT JOIN Chests b ON a.chest_id=b.chest_id ) a
SELECT SUM(total_apples) as apple_count, SUM(total_oranges) as orange_count FROM (SELECT b.apple_count + COALESCE(c.c_apple_count, 0) as total_apples, b.orange_count + COALESCE(c.c_orange_count, 0) as total_oranges FROM Boxes b LEFT JOIN (SELECT chest_id, apple_count as c_apple_count, orange_count as c_orange_count FROM Chests) c ON b.chest_id = c.chest_id) t
SELECT ba + ca AS apple_count, bo + co AS orange_count FROM ( SELECT SUM(B.apple_count) AS ba, SUM(B.orange_count) AS bo, SUM(IFNULL(C.apple_count,0)) AS ca, SUM(IFNULL(C.orange_count,0)) AS co FROM Boxes B LEFT OUTER JOIN Chests C ON (B.chest_id = C.chest_id) ) AS t1
SELECT sum(a.apple_count+ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count+ifnull(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id=b.chest_id
SELECT sum(a.total_apple_count) as apple_count,sum(a.total_orange_count) as orange_count from ( Select COALESCE(b.apple_count,0)+COALESCE(c.apple_count,0) as total_apple_count,COALESCE(b.orange_count,0)+COALESCE(c.orange_count,0) as total_orange_count from boxes b left join chests c on b.chest_id = c.chest_id ) as a
SELECT sum(b.apple_count + IFNULL(c.apple_count,0)) as apple_count, sum(b.orange_count + IFNULL(c.orange_count,0)) as orange_count FROM Boxes as b LEFT JOIN Chests as c ON b.chest_id = c.chest_id
SELECT sum(b.apple_count + coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count,0)) as orange_count FROM boxes as b LEFT JOIN chests as c ON b.chest_id = c.chest_id
SELECT sum(b.apple_count+ coalesce(c.apple_count,0))as apple_count, sum(b.orange_count+coalesce(c.orange_count,0)) as orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id
SELECT sum(b.apple_count+ifnull(c.apple_count,0)) AS apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) AS orange_count FROM Boxes b LEFT JOIN Chests c USING(chest_id)
SELECT sum(ifnull(b.apple_count,0) + ifnull(c.apple_count,0)) as apple_count, sum(ifnull(b.orange_count,0) + ifnull(c.orange_count,0)) as orange_count FROM boxes as b LEFT JOIN chests as c ON b.chest_id = c.chest_id
Select SUM(b.apple_count + IFNULL(c.apple_count,0)) as apple_count, SUM(b.orange_count + IFNULL(c.orange_count,0)) as orange_count FROM Boxes as b LEFT JOIN Chests as c ON c.chest_id = b.chest_id
Select SUM(b.apple_count+IFNULL(c.apple_count,0))as apple_count, SUM(b.orange_count+IFNULL(c.orange_count,0))as orange_count From Boxes b LEFT JOIN Chests c ON b.chest_id=c.chest_id
Select Sum(Boxes.apple_count) + Sum(coalesce(Chests.apple_count, 0)) as apple_count, Sum(Boxes.orange_count) + Sum(coalesce(Chests.orange_count, 0)) as orange_count From Boxes Left Join Chests On Boxes.chest_id = Chests.chest_id
Select ifnull(sum(b.apple_count),0) + ifnull(sum(c.apple_count),0) as apple_count, ifnull(sum(b.orange_count),0) + ifnull(sum(c.orange_count),0) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
Select sum(a.apple_count+ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count+ifnull(b.orange_count,0)) as orange_count From Boxes as a Left Join Chests as b On a.chest_id = b.chest_id
Select sum(apple_count) as apple_count, sum(orange_count) as orange_count From (Select Case when b.chest_id is not null then sum(b.apple_count+ c.apple_count) over (partition by box_id) Else b.apple_count End as apple_count, Case when b.chest_id is not null then sum(b.orange_count+ c.orange_count) over (partition by box_id) Else b.orange_count End as orange_count From Boxes b Left join Chests c on b.chest_id = c.chest_id) d
Select sum(b.apple_count + coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count,0))as orange_count from Boxes b left join chests c on c.chest_id = b.chest_id
Select sum(s.a_count) as 'apple_count',sum(s.o_count) as 'orange_count' from( Select b.box_id, b.chest_id, b.apple_count+ifnull(c.apple_count,0) as 'a_count', b.orange_count +ifnull(c.orange_count ,0) as 'o_count' from boxes b left join chests c on b.chest_id=c.chest_id ) s
WITH AllFruits AS (SELECT B.box_id ,IFNULL(C.apple_count,0)+B.apple_count AS apple_count ,IFNULL(C.orange_count,0)+B.orange_count AS orange_count FROM Boxes B LEFT JOIN Chests C ON C.chest_id = B.chest_id) SELECT SUM(apple_count) AS apple_count ,SUM(orange_count) AS orange_count FROM AllFruits
WITH BoxTotal AS (SELECT B.box_id ,IFNULL(C.apple_count,0)+B.apple_count AS apple_count ,IFNULL(C.orange_count,0)+B.orange_count AS orange_count FROM Boxes B LEFT JOIN Chests C ON C.chest_id = B.chest_id) SELECT SUM(apple_count) AS apple_count ,SUM(orange_count) AS orange_count FROM BoxTotal
WITH BoxedFruits AS (SELECT B.box_id ,IFNULL(C.apple_count,0)+B.apple_count AS apple_count ,IFNULL(C.orange_count,0)+B.orange_count AS orange_count FROM Boxes B LEFT JOIN Chests C ON C.chest_id = B.chest_id) SELECT SUM(apple_count) AS apple_count ,SUM(orange_count) AS orange_count FROM BoxedFruits
WITH BoxesAndChests AS ( SELECT box_id, B.apple_count + IFNULL(SUM(C.apple_count),0) AS apple_count, B.orange_count + IFNULL(SUM(C.orange_count),0) AS orange_count FROM Boxes B LEFT OUTER JOIN Chests C ON B.chest_id = C.chest_id GROUP BY box_id ) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM BoxesAndChests
WITH CTE AS ( SELECT A.box_id, B.chest_id, (A.apple_count+IFNULL(B.apple_count,0)) apple_count, (A.orange_count+IFNULL(B.orange_count,0)) orange_count FROM Boxes A LEFT JOIN Chests B ON A.chest_id=B.chest_id ) SELECT SUM(apple_count) apple_count,SUM(orange_count) orange_count FROM CTE
WITH CTE AS ( SELECT box_id, a.chest_id, a.apple_count, a.orange_count, COALESCE(b.apple_count,0) as chest_apple, COALESCE(b.orange_count,0) as chest_orange FROM boxes a LEFT JOIN chests b ON a.chest_id = b.chest_id ) SELECT SUM(apple_count+chest_apple) as apple_count, SUM(orange_count+chest_orange) as orange_count FROM CTE
WITH CTE AS ( select b.box_id, b.chest_id, b.apple_count + ifnull(c.apple_count,0) as 'apple_count', b.orange_count + ifnull(c.orange_count,0) as 'orange_count' from Boxes b left join Chests c on b.chest_id = c.chest_id group by b.box_id, b.chest_id ) select sum(cte.apple_count) as 'apple_count', sum(cte.orange_count) as 'orange_count' from cte
WITH CTE AS (SELECT box_id, IFNULL(B.apple_count, 0) as B_apple, IFNULL(B.orange_count, 0) as B_orange, IFNULL(C.apple_count, 0) as C_apple, IFNULL(C.orange_count, 0) as C_orange FROM Boxes B LEFT JOIN Chests C ON B.chest_id = C.chest_id) SELECT SUM(B_apple) + SUM(C_apple) AS apple_count, SUM(B_orange) + SUM(C_orange) AS orange_count FROM CTE
WITH CTE1 AS ( SELECT B.box_id, B.apple_count+IFNULL(C.apple_count, 0) AS apple_count, B.orange_count+IFNULL(C.orange_count, 0) AS orange_count FROM Boxes AS B LEFT JOIN Chests AS C ON B.chest_id = C.chest_id) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM CTE1
WITH D AS( SELECT B.APPLE_COUNT, B.ORANGE_COUNT, C.APPLE_COUNT AS A, C.ORANGE_COUNT AS O FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT ifnull(SUM(APPLE_COUNT),0)+ifnull(SUM(A),0) AS APPLE_COUNT, ifnull(SUM(ORANGE_COUNT),0)+ifnull(SUM(O),0) AS ORANGE_COUNT FROM D
WITH D AS( SELECT IFNULL(B.APPLE_COUNT,0) AS APPLE_cOUNT, IFNULL(B.ORANGE_COUNT,0) AS ORANGE_COUNT, IFNULL(C.APPLE_COUNT,0) AS A, IFNULL(C.ORANGE_COUNT,0) AS O FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT)+SUM(A) AS APPLE_COUNT, SUM(ORANGE_COUNT)+SUM(O) AS ORANGE_COUNT FROM D
WITH S0 AS (SELECT box_id, Boxes.chest_id, IFNULL(Boxes.apple_count,0) + IFNULL(Chests.apple_count,0) AS apples, IFNULL(Boxes.orange_count,0) + IFNULL(Chests.orange_count,0) AS oranges FROM Boxes LEFT JOIN Chests ON Boxes.chest_id = Chests.chest_id) SELECT SUM(apples) AS apple_count, SUM(oranges) AS orange_count FROM S0
WITH T1 AS (SELECT A.*, B.apple_count AS apple2, B.orange_count AS orange2 FROM Boxes A LEFT JOIN Chests B ON A.chest_id = B.chest_id), T2 AS (SELECT box_id, chest_id, COALESCE(apple_count, 0) + COALESCE(apple2, 0) AS apple, COALESCE(orange_count, 0) + COALESCE(orange2, 0) AS orange FROM T1) SELECT SUM(apple) AS apple_count, SUM(orange) AS orange_count FROM T2
WITH TEMP AS (SELECT B.BOX_ID AS BOX_ID, B.APPLE_COUNT AS BOX_APPLE_COUNT, B.ORANGE_COUNT AS BOX_ORANGE_COUNT, C.APPLE_COUNT AS CHEST_APPLE_COUNT, C.ORANGE_COUNT AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) SELECT SUM(COALESCE(BOX_ORANGE_COUNT, 0) + COALESCE(CHEST_ORANGE_COUNT, 0)) AS ORANGE_COUNT, SUM(COALESCE(BOX_APPLE_COUNT,0) + COALESCE(CHEST_APPLE_COUNT,0)) AS APPLE_COUNT FROM TEMP
WITH box_contain AS ( SELECT B.box_id, B.chest_id, (B.apple_count + IFNULL(C.apple_count,0)) AS apple_count, (B.orange_count + IFNULL(C.orange_count,0)) AS orange_count FROM Boxes AS B LEFT JOIN Chests AS C ON B.chest_id = C.chest_id ) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM box_contain
WITH c1 AS (SELECT b.apple_count AS apple_count_b, b.orange_count AS orange_count_b , c.apple_count AS apple_count_c, c.orange_count AS orange_count_c FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id) SELECT SUM(apple_count_b + COALESCE(apple_count_c, 0) ) AS apple_count , SUM(orange_count_b + COALESCE(orange_count_c, 0) ) AS orange_count FROM c1
WITH chest_cte as ( SELECT b.box_id, c.chest_id, COALESCE(c.apple_count, 0) AS chest_apple_count, COALESCE(c.orange_count, 0) AS chest_orange_count FROM Boxes b LEFT JOIN Chests c ON b.chest_id = c.chest_id ) SELECT SUM(sub.apple_count) + SUM(sub.chest_apple_count) AS apple_count, SUM(sub.orange_count) + SUM(sub.chest_orange_count) AS orange_count FROM ( SELECT b.apple_count, b.orange_count, cc.chest_apple_count, cc.chest_orange_count FROM Boxes b LEFT JOIN chest_cte cc ON b.box_id = cc.box_id ) sub
WITH count_in_boxes AS ( SELECT box_id, chest_id, SUM(apple_count) AS apples, SUM(orange_count) AS oranges FROM boxes GROUP BY box_id, chest_id), count_in_chests AS ( SELECT chest_id, SUM(apple_count) AS apples, SUM(orange_count) AS oranges FROM chests GROUP BY chest_id ) SELECT SUM(IFNULL(b.apples,0)) + SUM(IFNULL(c.apples,0)) AS apple_count, SUM(IFNULL(b.oranges,0)) + SUM(IFNULL(c.oranges,0)) AS orange_count FROM count_in_boxes b LEFT JOIN count_in_chests c ON b.chest_id = c.chest_id
WITH cte AS ( SELECT b.box_id, c.chest_id, c.apple_count, c.orange_count FROM Chests c INNER JOIN Boxes b USING (chest_id) ), cte1 AS( SELECT * FROM cte UNION ALL SELECT * FROM Boxes b ) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM cte1
WITH cte AS ( SELECT box_id, SUM(Boxes.apple_count)+SUM(IFNULL(Chests.apple_count,0)) AS apples, SUM(Boxes.orange_count)+SUM(IFNULL(Chests.orange_count,0)) AS oranges FROM Boxes LEFT JOIN Chests ON Boxes.chest_id = Chests.chest_id GROUP BY box_id ) SELECT SUM(apples) AS apple_count, SUM(oranges) AS orange_count FROM cte
WITH cte AS (SELECT box_id, CASE WHEN b.chest_id = c.chest_id THEN b.apple_count+c.apple_count ELSE b.apple_count END AS apple, CASE WHEN b.chest_id = c.chest_id THEN b.orange_count + c.orange_count ELSE b.orange_count END AS orange FROM boxes b LEFT JOIN Chests c USING (chest_id)) SELECT sum(apple) AS apple_count, sum(orange) AS orange_count FROM cte
WITH cte1 AS( SELECT box_id, b.chest_id, b.apple_count AS app1, b.orange_count AS ora1, COALESCE(c.apple_count,0) As app2, COALESCE(c.orange_count,0) As ora2 FROM boxes b LEFT JOIN chests c ON b.chest_id=c.chest_id ), cte2 AS ( SELECT app1+app2 AS total_app, ora1+ora2 AS total_ora FROM cte1 ) SELECT SUM(total_app) AS apple_count, SUM(total_ora) AS orange_count FROM cte2
WITH main (apple_count, orange_count) AS ( SELECT SUM(apple_count), SUM(orange_count) FROM Boxes UNION ALL SELECT SUM(C.apple_Count), SUM(C.orange_count) FROM Boxes B INNER JOIN Chests C USING(chest_id) ) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM main
WITH t AS( SELECT Boxes.apple_count,Boxes.orange_count, Chests.apple_count chest_a, Chests.orange_count chest_o FROM Boxes LEFT JOIN Chests ON Boxes.chest_id = Chests.chest_id ) SELECT SUM(apple_count)+ IfNULL(SUM(chest_a),0) apple_count, SUM(orange_count)+ IFNULL(SUM(chest_o),0) orange_count FROM t
WITH t_box AS (SELECT box_id, chest_id, apple_count as apples_box, orange_count as orange_box FROM Boxes), t_chests AS (SELECT chest_id, apple_count as apples_ch, orange_count as orange_ch FROM Chests), t_all AS (SELECT apples_box, orange_box, apples_ch, orange_ch FROM t_box t1 LEFT JOIN t_chests t2 ON t1.chest_id = t2.chest_id) SELECT SUM(apples_box) + COALESCE(SUM(apples_ch),0) as apple_count, SUM(orange_box) + COALESCE(SUM(orange_ch), 0) as orange_count FROM t_all
WITH table1 AS (SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM Boxes), table2 AS (SELECT SUM(IFNULL(c.apple_count,0)) AS apple_count, SUM(IFNULL(c.orange_count,0)) AS orange_count FROM Boxes AS b LEFT JOIN Chests AS c ON b.chest_id = c.chest_id) SELECT SUM(A.apple_count) AS apple_count, SUM(A.orange_count) AS orange_count FROM (SELECT * FROM table1 UNION ALL SELECT * FROM table2) AS A
WITH table1 AS( SELECT apple_count, orange_count FROM Boxes UNION ALL SELECT c.apple_count, c.orange_count FROM Chests c INNER JOIN Boxes b USING(chest_id) ) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM table1
WITH tmp AS (SELECT COALESCE(apple_count, 0) AS apple_count, COALESCE(orange_count, 0) AS orange_count FROM Boxes UNION ALL SELECT COALESCE(c.apple_count, 0) AS apple_count, COALESCE(c.orange_count, 0) AS orange_count FROM Chests AS c JOIN Boxes USING(chest_id)) SELECT SUM(apple_count) AS apple_count, SUM(orange_count) AS orange_count FROM tmp
select (COALESCE(bSum.apple_count,0) + COALESCE(cSum.apple_count,0)) as apple_count, (COALESCE(bSum.orange_count,0) + COALESCE(cSum.orange_count,0)) as orange_count from (Select sum(Chests.apple_count) as apple_count, sum(Chests.orange_count) as orange_count from Boxes left join Chests on Boxes.chest_id = Chests.chest_id) as cSum, (Select sum(apple_count) as apple_count , sum(orange_count) as orange_count from Boxes) as bSum
select (sum(a.apple_count) + ifnull(sum(b.apple_count),0)) as apple_count, (sum(a.orange_count) + ifnull(sum(b.orange_count),0)) as orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select (sum(b.apple_count) + sum(case when c.apple_count is null then 0 else c.apple_count end)) as apple_count, (sum(b.orange_count) + sum(case when c.orange_count is null then 0 else c.orange_count end)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select (sum(b.apple_count) + sum(ifnull(c.apple_count,0))) apple_count, (sum(b.orange_count) + sum(ifnull(c.orange_count, 0))) orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select (sum(b.apple_count)+sum(coalesce(c.apple_count,0))) as apple_count, (sum(b.orange_count)+sum(coalesce(c.orange_count,0))) as orange_count from boxes b left outer join chests c on b.chest_id = c.chest_id
select (sum(coalesce(b.apple_count,0))+sum(coalesce(c.apple_count,0))) as apple_count, (sum(coalesce(b.orange_count,0))+sum(coalesce(c.orange_count,0))) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select (sum(ifnull(b.apple_count, 0)) + sum(ifnull(c.apple_count, 0)))as apple_count, (sum(ifnull(b.orange_count, 0)) + sum(ifnull(c.orange_count, 0))) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select * from (select sum(b.apple_count + coalesce(c.apple_count, 0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count, 0)) as orange_count from Boxes as b left join Chests as c on b.chest_id = c.chest_id ) as a
select SUM(B.apple_count + (case when B.chest_id is null then 0 ELSE C.apple_count END )) as apple_count, SUM(B.orange_count + (case when B.chest_id is null then 0 ELSE C.orange_count END )) as orange_count from Boxes B LEFT JOIN Chests C on B.chest_id = C.chest_id
select SUM(CASE WHEN Boxes.chest_id is null THEN Boxes.apple_count ELSE Boxes.apple_count + Chests.apple_count END) apple_count, SUM(CASE WHEN Boxes.chest_id is null THEN Boxes.orange_count ELSE Boxes.orange_count + Chests.orange_count END) orange_count FROM Boxes LEFT JOIN Chests ON Boxes.chest_id = Chests.chest_id
select SUM(CASE WHEN b.chest_id IS NULL then b.apple_count ELSE (b.apple_count + c.apple_count) END) as apple_count, SUM(CASE WHEN b.chest_id IS NULL then b.orange_count ELSE (b.orange_count + c.orange_count) END) as orange_count from boxes b LEFT JOIN chests c ON b.chest_id = c.chest_id
select SUM(CASE WHEN b.chest_id is null THEN b.apple_count ELSE b.apple_count + c.apple_count END) apple_count, SUM(CASE WHEN b.chest_id is null THEN b.orange_count ELSE b.orange_count + c.orange_count END) orange_count from boxes b LEFT JOIN Chests c on b.chest_id = c.chest_id
select SUM(COALESCE(b.apple_count,0) + COALESCE(c.apple_count,0)) 'apple_count', SUM(COALESCE(b.orange_count,0) + COALESCE(c.orange_count,0)) 'orange_count' from boxes b left join chests c on b.chest_id = c.chest_id
select SUM(a.apple_count+Ifnull(b.apple_count,0)) as apple_count,SUM(a.orange_count+ifnull(b.orange_count,0)) as orange_count from Boxes a LEFT JOIN Chests b ON a.chest_id = b.chest_id
select SUM(b.apple_count + COALESCE(c.apple_count, 0)) apple_count, SUM(b.orange_count + COALESCE(c.orange_count, 0)) orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select SUM(b.apple_count + IFNULL(c.apple_count, 0)) as apple_count, SUM(b.orange_count + IFNULL(c.orange_count, 0)) as orange_count from Boxes b LEFT JOIn Chests c ON b.chest_id = c.chest_id
select SUM(b.apple_count+COALESCE(c.apple_count,0)) as apple_count, SUM(b.orange_count+COALESCE(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select coalesce(sum(b.apple_count), 0) + coalesce(sum(c.apple_count), 0) as apple_count, coalesce(sum(b.orange_count), 0) + coalesce(sum(c.orange_count), 0) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select coalesce(sum(b.apple_count),0) + coalesce(sum(c.apple_count),0) as apple_count, coalesce(sum(b.orange_count),0) + coalesce(sum(c.orange_count),0) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select ifnull(sum(acnt1),0)+ifnull(sum(acnt2),0) as apple_count, ifnull(sum(ocnt1),0)+ifnull(sum(ocnt2),0) as orange_count from( select box_id, b.chest_id, b.apple_count as acnt1, c.apple_count as acnt2, b.orange_count as ocnt1, c.orange_count as ocnt2 from boxes b left join chests c on b.chest_id=c.chest_id) t
select ifnull(sum(b.apple_count),0) + ifnull(sum(c.apple_count), 0) as apple_count, ifnull(sum(b.orange_count), 0) + ifnull(sum(c.orange_count), 0) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select ifnull(sum(b.apple_count),0)+ifnull(sum(c.apple_count),0) apple_count, ifnull(sum(b.orange_count),0)+ifnull(sum(c.orange_count),0) orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select ifnull(sum(b.apple_count),0)+ifnull(sum(c.apple_count),0) as apple_count , ifnull(sum(b.orange_count),0)+ifnull(sum(c.orange_count),0) as orange_count from Boxes b left join Chests c on b.chest_id=c.chest_id
select ifnull(sum(b.apple_count),0)+ifnull(sum(c.apple_count),0) as apple_count, ifnull(sum(b.orange_count),0)+ifnull(sum(c.orange_count),0) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum( case when b.chest_id is NULL then b.apple_count else b.apple_count + c.apple_count end) as apple_count, sum(case when b.chest_id is NULL then b.orange_count else b.orange_count + c.orange_count end) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum((B.apple_count)+ifnull((C.apple_count),0)) as apple_count , sum((B.orange_count)+ifnull((C.orange_count),0)) as orange_count from Boxes B left join Chests C on B.chest_id = C.chest_id
select sum((a.apple_count + ifnull(b.apple_count, 0))) apple_count, sum((a.orange_count + ifnull(b.orange_count, 0))) orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select sum(A.apple_count) apple_count, sum(A.orange_count) orange_count from ( select box_id , case when c.apple_count is null then b.apple_count else (c.apple_count+b.apple_count) end as apple_count, case when c.orange_count is null then b.orange_count else (c.orange_count+b.orange_count) end as orange_count from boxes b left join chests c on b.chest_id=c.chest_id) A
select sum(B.apple_count + ifnull(C.apple_count, 0)) as apple_count, sum(B.orange_count + ifnull(C.orange_count, 0)) as orange_count from Boxes as B left join Chests as C using(chest_id)
select sum(B.apple_count + ifnull(C.apple_count,0)) as apple_count, sum(B.orange_count + ifnull(C.orange_count,0)) as orange_count from Boxes B left join Chests C on B.chest_id = C.chest_id
select sum(B.apple_count) + ifnull(sum(C.apple_count),0) as apple_count, sum(B.orange_count) + ifnull(sum(C.orange_count),0) as orange_count from Boxes B left join Chests C on B.chest_id = C.chest_id
select sum(B.apple_count+ifnull(C.apple_count,0)) as apple_count, sum(B.orange_count+ifnull(C.orange_count,0)) as orange_count from Boxes B left join Chests C on B.chest_id = C.chest_id
select sum(Boxes.apple_count) + sum(IFNULL(Chests.apple_count,0)) as apple_count, sum(Boxes.orange_count) + sum(IFNULL(Chests.orange_count,0)) as orange_count from Boxes left join Chests on Boxes.chest_id = Chests.chest_id
select sum(Boxes.apple_count+coalesce(Chests.apple_count,0)) as apple_count, sum(Boxes.orange_count+coalesce(Chests.orange_count,0)) as orange_count from Boxes left join Chests on Boxes.chest_id= Chests.chest_id
select sum(COALESCE(b.apple_count,0)+ COALESCE(c.apple_count,0)) as apple_count, sum(COALESCE(c.orange_count,0)+ COALESCE(b.orange_count,0)) as orange_count from boxes b left join chests c on c.chest_id = b.chest_id
select sum(IFNULL(b.apple_count,0))+sum(IFNULL(c.apple_count, 0)) as apple_count, sum(IFNULL(b.orange_count,0) )+sum(IFNULL(c.orange_count,0)) as orange_count from boxes b left join chests as c on b.chest_id = c.chest_id
select sum(a.apple_count + case when b.apple_count is null then 0 else b.apple_count end) as apple_count, sum(a.orange_count + case when b.orange_count is null then 0 else b.orange_count end) as orange_count from boxes a left join chests b on a.chest_id = b.chest_id
select sum(a.apple_count + ifnull(b.apple_count,0)) apple_count, sum(a.orange_count+ ifnull(b.orange_count,0)) orange_count from boxes a left join chests b using (chest_id)
select sum(a.apple_count + ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count + ifnull(b.orange_count,0)) as orange_count from boxes a left join chests b on a.chest_id = b.chest_id
select sum(a.apple_count + ifnull(b.apple_count,0)) as apple_count, sum(ifnull(b.orange_count, 0) + a.orange_count) as orange_count from boxes a left join chests b on a.chest_id = b.chest_id
select sum(a.apple_count) + sum(ifnull(b.apple_count,0) )as apple_count, sum(a.orange_count) + sum(ifnull(b.orange_count,0)) as orange_count from boxes as a left join chests as b on a.chest_id = b.chest_id
select sum(a.apple_count) + sum(ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count) + sum(ifnull(b.orange_count,0)) as orange_count from boxes a left join chests b on a.chest_id = b.chest_id
select sum(a.apple_count)+sum(ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count)+sum(ifnull(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select sum(a.apple_count+coalesce(b.apple_count,0)) as apple_count, sum(a.orange_count+coalesce(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select sum(a.apple_count+ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count + ifnull(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select sum(a.apple_count+ifnull(b.apple_count,0)) as apple_count, sum(a.orange_count+ifnull(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id=b.chest_id
select sum(a1+a2) as apple_count,sum(o1+o2) as orange_count from ( select box_id, boxes.chest_id, boxes.apple_count as a1,boxes.orange_count as o1,ifnull(chests.apple_count,0) as a2,ifnull(chests.orange_count,0) as o2 from boxes left join chests on boxes.chest_id=chests.chest_id) a
select sum(aaa.as) 'apple_count', sum(aaa.os) 'orange_count' from (select b.*, ifnull(c.apple_count,0)+b.apple_count 'as', ifnull(c.orange_count,0)+b.orange_count 'os' from boxes b left join chests c on b.chest_id=c.chest_id) aaa
select sum(ac) as apple_count, sum(oc) as orange_count from ( select box_id, b.apple_count + ifnull(sum(c.apple_count),0) as ac, b.orange_count+ifnull(sum(c.orange_count),0) as oc from boxes b left join chests c on b.chest_id = c.chest_id group by box_id) as total
select sum(app) as apple_count, sum(or2) as orange_count from( select app1+app2 as app, or1+or2 as or2 from( select b.apple_count as app1, b.orange_count as or1, ifnull(c.apple_count,0) as app2, ifnull(c.orange_count,0) as or2 from boxes b left join chests c on b.chest_id=c.chest_id) as temp1) as temp2
select sum(apple_count + b_apple_count) as apple_count, sum(orange_count + b_orange_count) as orange_count from (select box_id, a.apple_count, a.orange_count, case when b.apple_count is null then 0 else b.apple_count end as b_apple_count, case when b.orange_count is null then 0 else b.orange_count end as b_orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id) a
select sum(apple_count + ifnull(c_app,0)) apple_count, sum(orange_count + ifnull(c_org,0)) orange_count from ( select b.box_id, b.apple_count, c.apple_count c_app, b.orange_count, c.orange_count c_org from boxes b left join chests c on b.chest_id = c.chest_id ) a
select sum(apple_count + ifnull(chest_apple, 0)) as apple_count, sum(orange_count + ifnull(chest_orange, 0)) as orange_count from ( select b.box_id, b.chest_id, b.apple_count, b.orange_count, c.apple_count as chest_apple, c.orange_count as chest_orange from Boxes b left join Chests c on b.chest_id = c.chest_id ) a
select sum(apple_count) as apple_count , sum(orange_count) as orange_count from ( select box_id, apple_count, orange_count from Boxes union all select case when a.chest_id is null then null else a.chest_id end as id , b.apple_count ,b.orange_count from Boxes as a left join Chests as b on a.chest_id =b.chest_id ) as a
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from ( (select box_id, apple_count, orange_count from boxes) union all (select a.box_id, b.apple_count, b.orange_count from boxes a join chests b on a.chest_id = b.chest_id) ) v
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from ( select (ifnull(b.apple_count,0)+ifnull(c.apple_count,0)) as apple_count, (ifnull(b.orange_count,0)+ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id )a
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from ( select b.box_id,c.apple_count,c.orange_count from boxes as b left join chests as c on b.chest_id = c.chest_id UNION ALL SELECT box_id, apple_count, orange_count from boxes ) as t
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from ( select sum(apple_count) as apple_count, sum(orange_count) as orange_count from ( select a.chest_id, b.apple_count, b.orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id where a.chest_id is not null) A union select sum(apple_count) as apple_count, sum(orange_count) as orange_count from Boxes) B
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from (select a.box_id, (a.apple_count+coalesce(b.apple_count,0)) as apple_count, (a.orange_count+coalesce(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id=b.chest_id )a
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from (select apple_count, orange_count from boxes union all select c.apple_count, c.orange_count from boxes b left join chests c on b.chest_id = c.chest_id)a
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from (select b.apple_count + IFNULL(c.apple_count, 0) as apple_count, b.orange_count + IFNULL(c.orange_count, 0) as orange_count from boxes b left join chests c using (chest_id)) a
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from (select box_id, b.chest_id, b.apple_count + c.apple_count as apple_count, b.orange_count + c.orange_count as orange_count from boxes b join chests c on b.chest_id = c.chest_id union all select * from boxes where chest_id is null) a
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from (select box_id, case when b.chest_id is NULL then b.apple_count else b.apple_count + sum(c.apple_count) end as apple_count, case when b.chest_id is NULL then b.orange_count else b.orange_count + sum(c.orange_count) end as orange_count from Boxes as b left join Chests as c on b.chest_id = c.chest_id group by box_id) as t
select sum(apple_count) as apple_count, sum(orange_count) as orange_count from( select apple_count, orange_count from boxes union all select c.apple_count, c.orange_count from boxes b left join chests c on b.chest_id = c.chest_id) tb1
select sum(apple_count) as apple_count,sum(orange_count) as orange_count from ( select case when b.chest_id is null then b.apple_count when b.chest_id is not null then b.apple_count+c.apple_count end as apple_count, case when b.chest_id is null then b.orange_count when b.chest_id is not null then b.orange_count+c.orange_count end as orange_count from boxes b left join chests c on b.chest_id=c.chest_id ) a
select sum(apple_count)+sum(apple) as apple_count,sum(orange_count)+sum(orange) as orange_count from (select a.*, ifnull(b.apple_count,0) as apple,ifnull(b.orange_count,0) as orange from Boxes a left join Chests b on a.chest_id=b.chest_id)a
select sum(apple_count)apple_count,sum(orange_count)orange_count from (select box_id,b.chest_id ,(b.apple_count + ifnull(c.apple_count,0)) apple_count, b.orange_count + ifnull(c.orange_count,0) orange_count from boxes b left join chests c on b.chest_id = c.chest_id)l
select sum(apple_count+chest_apple) as apple_count,sum(orange_count+chest_orange) as orange_count from( select a.*, ifnull(b.apple_count,0) as chest_apple, ifnull(b.orange_count,0) as chest_orange from boxes a left join chests b on a.chest_id=b.chest_id) t
select sum(apples_count) as apple_count, sum(oranges_count) as orange_count from ( select b.box_id, b.chest_id, b.apple_count + coalesce(c.apple_count,0) as apples_count, b.orange_count + coalesce(c.orange_count,0) as oranges_count from boxes b left outer join chests c on b.chest_id = c.chest_id ) asd
select sum(b.apple_count + (case when c.apple_count is null then 0 else c.apple_count end)) apple_count, sum(b.orange_count + (case when c.orange_count is null then 0 else c.orange_count end)) orange_count from Boxes b left join chests c on c.chest_id = b.chest_id
select sum(b.apple_count + COALESCE(ch.apple, 0)) as apple_count, sum(b.orange_count + COALESCE(ch.orange, 0) ) as orange_count from Boxes b left join (select c.chest_id, sum(c.apple_count) as apple, sum(c.orange_count) as orange from Chests c group by c.chest_id) ch on b.chest_id = ch.chest_id
select sum(b.apple_count + IFNULL(c.apple_count, 0)) apple_count, sum(b.orange_count + IFNULL(c.orange_count, 0)) orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + IFNULL(c.apple_count,0)) as apple_count, sum(b.orange_count + IFNULL(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + IFNULL(ch.apple, 0)) as apple_count, sum(b.orange_count + IFNULL(ch.orange, 0) ) as orange_count from Boxes b left join (select c.chest_id, sum(c.apple_count) as apple, sum(c.orange_count) as orange from Chests c group by c.chest_id) ch on b.chest_id = ch.chest_id
select sum(b.apple_count + coalesce(c.apple_count, 0)) "apple_count", sum(b.orange_count + coalesce(c.orange_count, 0)) "orange_count" from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + coalesce(c.apple_count, 0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count, 0)) as orange_count from Boxes b left join Chests c using(chest_id)
select sum(b.apple_count + coalesce(c.apple_count, 0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count, 0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count,0)) as orange_count from boxes as b left join chests as c on c.chest_id = b.chest_id
select sum(b.apple_count + coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count,0)) as orange_count from boxes b left join chests c using(chest_id)
select sum(b.apple_count + coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count + coalesce(c.orange_count,0)) as orange_count from boxes b left outer join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + coalesce(c.apple_count,0))as apple_count, sum(b.orange_count+ coalesce(c.orange_count,0))as orange_count from boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count + if(b.chest_id is null, 0, c.apple_count)) as apple_count, sum(b.orange_count + if(b.chest_id is null, 0, c.orange_count))as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull((c.apple_count),0))as apple_count , sum(b.orange_count + ifnull((c.orange_count),0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count, 0)) apple_count, sum(b.orange_count + ifnull(c.orange_count, 0)) orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count, 0)) apple_count, sum(b.orange_count + ifnull(c.orange_count, 0)) orange_count from Boxes b left join chests c on c.chest_id = b.chest_id
select sum(b.apple_count + ifnull(c.apple_count, 0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count, 0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count, 0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count, 0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count , sum(b.orange_count + ifnull(c.orange_count ,0)) as orange_count from Boxes as b left join Chests as c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count , sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from Boxes as b left outer join Chests as c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count , sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count ,sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c on c.chest_id = b.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count, 0)) as orange_count from Boxes b left join Chests c using(chest_id)
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count, 0)) as orange_count from boxes b left join chests c on c.chest_id = b.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from boxes as b left join chests as c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_Id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count, sum(ifnull(c.orange_count,0) + b.orange_count) as orange_count from boxes b left join chests c using(chest_id)
select sum(b.apple_count + ifnull(c.apple_count,0)) as apple_count,sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from Boxes as b left join Chests as c on b.chest_id = c.chest_id
select sum(b.apple_count + ifnull(c.apple_count,0))as apple_count, sum(b.orange_count + ifnull(c.orange_count,0)) as orange_count from Boxes as b left join Chests as c on b.chest_id = c.chest_id
select sum(b.apple_count +IFNULL(c.apple_count, 0)) as apple_count, sum(b.orange_count +IFNULL(c.orange_count, 0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + ifnull(sum(c.apple_count),0) apple_count, sum(b.orange_count) + ifnull(sum(c.orange_count),0) orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + ifnull(sum(c.apple_count),0) as apple_count, sum(b.orange_count) + ifnull(sum(c.orange_count),0) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + sum( coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count) + sum( coalesce(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + sum(IFNULL(c.apple_count,0)) as apple_count, sum(b.orange_count) + sum(IFNULL(c.orange_count,0)) as orange_count from Boxes b LEFT JOIN Chests c on c.chest_id = b.chest_id
select sum(b.apple_count) + sum(case when c.apple_count is null then 0 else c.apple_count end)as apple_count, sum(b.orange_count) + sum(case when c.orange_count is null then 0 else c.orange_count end)as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + sum(ifnull(c.apple_count, 0)) apple_count, sum(b.orange_count) + sum(ifnull(c.orange_count, 0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + sum(ifnull(c.apple_count, 0)) as apple_count, sum(b.orange_count) + sum(ifnull(c.orange_count, 0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count) + sum(ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count) + sum(ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c using(chest_id)
select sum(b.apple_count) as apple_count, sum(b.orange_count) as orange_count from (select box_id, (case when Chests.apple_count is null then Boxes.apple_count else Boxes.apple_count + Chests.apple_count end) as apple_count, (case when Chests.orange_count is null then Boxes.orange_count else Boxes.orange_count + Chests.orange_count end) as orange_count from Boxes left join Chests on Boxes.chest_id = Chests.chest_id) b
select sum(b.apple_count)+ifnull(sum(c.apple_count),0) apple_count, sum(b.orange_count)+ifnull(sum(c.orange_count),0) orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count)+sum(ifnull(c.apple_count, 0)) apple_count, sum(b.orange_count)+sum(ifnull(c.orange_count, 0)) orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count)+sum(ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count)+sum(ifnull(c.orange_count,0)) as orange_count from Boxes as b left join Chests as c on b.chest_id = c.chest_id
select sum(b.apple_count)+sum(ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count)+sum(ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count+ ifnull(c.apple_count,0)) apple_count, sum(b.orange_count+ ifnull(c.orange_count,0)) orange_count from boxes b left join chests c using (chest_id)
select sum(b.apple_count+COALESCE(c.apple_count, 0)) apple_count,sum(b.orange_count+COALESCE(c.orange_count, 0)) orange_count from Boxes b left join Chests c on b.chest_id=c.chest_id
select sum(b.apple_count+COALESCE(c.apple_count,0)) as apple_count, sum(b.orange_count+COALESCE(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count+coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count +coalesce(c.orange_count ,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count+coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count+coalesce(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count+coalesce(c.apple_count,0)) as apple_count, sum(b.orange_count+coalesce(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id=c.chest_id
select sum(b.apple_count+coalesce(c.apple_count,0)) as apple_count,sum(b.orange_count+coalesce(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count+coalesce(c.apple_count,0)) as apple_count,sum(b.orange_count+coalesce(c.orange_count,0)) as orange_count from boxes b left join chests c on coalesce(b.chest_id,0)=c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0) )as apple_count, sum(b.orange_count+ifnull(c.orange_count,0))as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id=c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c using(chest_id)
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from boxes b left join Chests c on b.chest_id=c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count, sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0)) as apple_count,sum(b.orange_count+ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(b.apple_count+ifnull(c.apple_count,0))as apple_count, sum(b.orange_count+ifnull(c.orange_count,0))as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(box_apple_cnt+chest_apple_cnt) as apple_count, sum(box_orange_cnt+chest_orange_cnt) as orange_count from (select t1.apple_count as box_apple_cnt, ifnull(t2.apple_count,0) as chest_apple_cnt, t1.orange_count as box_orange_cnt, ifnull(t2.orange_count,0) as chest_orange_cnt from Boxes t1 left join Chests t2 on t1.chest_id = t2.chest_id) t
select sum(boxes.apple_count + COALESCE(Chests.apple_count, 0)) as apple_count, sum(boxes.orange_count + COALESCE(Chests.orange_count, 0)) as orange_count from boxes left join Chests on boxes.chest_id = chests.chest_id
select sum(boxes.apple_count + coalesce(chests.apple_count,0)) as apple_count, sum(boxes.orange_count + coalesce(chests.orange_count,0)) as orange_count from boxes left join Chests on boxes.chest_id = chests.chest_id
select sum(boxes.apple_count + ifnull(Chests.apple_count, 0)) as apple_count, sum(boxes.orange_count + ifnull(Chests.orange_count, 0)) as orange_count from boxes left join Chests on boxes.chest_id = chests.chest_id
select sum(boxes.apple_count + ifnull(chests.apple_count, 0)) as apple_count, sum(boxes.orange_count + ifnull(chests.orange_count,0)) as orange_count from Boxes left Join Chests on Boxes.chest_id = Chests.chest_id
select sum(boxes.apple_count) + sum(ifnull(chests.apple_count,0)) as apple_count, sum(boxes.orange_count) + sum(ifnull(chests.orange_count,0)) as orange_count from boxes left join chests using (chest_id)
select sum(c.apple1) as apple_count, sum(c.orange1) as orange_count from (select a.box_id, a.chest_id, a.apple_count+ifnull(b.apple_count,0) as apple1, a.orange_count+ifnull(b.orange_count,0) as orange1 from boxes a left join chests b on a.chest_id=b.chest_id )c
select sum(case when a.chest_id is Not NUll then (a.apple_count+b.apple_count) else a.apple_count end) as apple_count, sum(case when a.chest_id is not null then (a.orange_count+b.orange_count) else a.orange_count end) as orange_count from Boxes a left join chests b on a.chest_id = b.chest_id
select sum(case when a.chest_id is null then a.apple_count else a.apple_count + b.apple_count end) as apple_count, sum(case when a.chest_id is null then a.orange_count else a.orange_count + b.orange_count end) as orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select sum(case when b.apple_count is null then 0 else b.apple_count end)+ sum(case when c.apple_count is null then 0 else c.apple_count end) as apple_count, sum(case when b.orange_count is null then 0 else b.orange_count end)+ sum(case when c.orange_count is null then 0 else c.orange_count end) as orange_count from boxes b left join chests c on b.chest_id=c.chest_id
select sum(case when b.chest_id is not null then (b.apple_count + c.apple_count) else b.apple_count end) as apple_count, sum(case when b.chest_id is not null then (b.orange_count + c.orange_count) else b.orange_count end) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(case when b.chest_id is not null then (b.apple_count+c.apple_count) else b.apple_count end) as apple_count, sum(case when b.chest_id is not null then (b.orange_count + c.orange_count) else b.orange_count end) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(case when b.chest_id is not null then (b.apple_count+ch.apple_count) else b.apple_count end) apple_count, sum(case when b.chest_id is not null then (b.orange_count+ch.orange_count) else b.orange_count end) orange_count from boxes b left join chests ch on b.chest_id=ch.chest_id
select sum(case when b.chest_id is not null then b.apple_count + a.apple_count else b.apple_count end) as apple_count, sum(case when b.chest_id is not null then b.orange_count + a.orange_count else b.orange_count end) as orange_count from boxes b left join chests a on b.chest_id= a.chest_id
select sum(case when b.chest_id is not null then b.apple_count+c.apple_count else b.apple_count end) as apple_count, sum(case when b.chest_id is not null then b.orange_count+c.orange_count else b.orange_count end) as orange_count from boxes b left join chests c on c.chest_id=b.chest_id
select sum(case when b.chest_id is null then b.apple_count else (b.apple_count + c.apple_count) end) as apple_count, sum(case when b.chest_id is null then b.orange_count else (b.orange_count + c.orange_count) end) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(case when b.chest_id is null then b.apple_count else b.apple_count + c.apple_count end) as apple_count, sum(case when b.chest_id is null then b.orange_count else b.orange_count + c.orange_count end) as orange_count from boxes as b left join chests as c on b.chest_id = c.chest_id
select sum(case when b.chest_id is null then b.apple_count else b.apple_count+c.apple_count end) as apple_count, sum(case when b.chest_id is null then b.orange_count else b.orange_count+c.orange_count end) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id
select sum(case when b.chest_id is null then b.apple_count else b.apple_count+c.apple_count end) as apple_count, sum(case when b.chest_id is null then b.orange_count else b.orange_count+c.orange_count end) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(case when chest_id is null then tmp.apple_count else tmp.apple_count+tmp.c_apple_count end) as apple_count, sum(case when chest_id is null then tmp.orange_count else tmp.orange_count+tmp.c_orange_count end) as orange_count from ( select b.*, c.apple_count as c_apple_count, c.orange_count as c_orange_count from boxes b left join chests c on b.chest_id = c.chest_id )tmp
select sum(case when t1.chest_id is not null then t1.apple_count+ifnull(t2.apple_count,0) else t1.apple_count end) as apple_count, sum(case when t1.chest_id is not null then t1.orange_count+ifnull(t2.orange_count,0) else t1.orange_count end) as orange_count from boxes t1 left join chests t2 on t1.chest_id = t2.chest_id
select sum(coalesce(a.apple_count,0) + coalesce(b.apple_count,0)) as apple_count, sum(coalesce(a.orange_count,0) + coalesce(b.orange_count,0)) as orange_count from Boxes a left join Chests b on a.chest_id = b.chest_id
select sum(coalesce(c.apple_count,0)+b.apple_count) as apple_count, sum(coalesce(c.orange_count,0)+b.orange_count) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(if(a.chest_id in (select chest_id from Chests),a.apples_box+c.apple_count,a.apples_box)) as apple_count, sum(if(a.chest_id in (select chest_id from Chests),a.orange_box+c.orange_count,a.orange_box)) as orange_count from (select box_id, chest_id,sum(apple_count) as apples_box,sum(orange_count)as orange_box from Boxes group by box_id)a left join Chests c on a.chest_id=c.chest_id
select sum(ifnull(a.apple_count,0)+ ifnull(b.apple_count,0)) as apple_count, sum(ifnull(a.orange_count,0) + ifnull(b.orange_count,0)) as orange_count from boxes a left join chests b on a.chest_id = b.chest_id
select sum(ifnull(b.apple_count, 0) + a.apple_count) as apple_count, sum(ifnull(b.orange_count, 0) + a.orange_count) as orange_count from boxes a left join chests b on a.chest_id = b.chest_id
select sum(ifnull(b.apple_count, 0) + ifnull(c.apple_count, 0)) as apple_count, sum(ifnull(b.orange_count, 0) + ifnull(c.orange_count, 0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(ifnull(b.apple_count,0) + ifnull(c.apple_count,0)) as apple_count, sum(ifnull(b.orange_count,0) + ifnull(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(ifnull(b.apple_count,0)) + sum(ifnull(c.apple_count,0)) as apple_count, sum(ifnull(b.orange_count,0)) + sum(ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests C on b.chest_id = c.chest_id
select sum(ifnull(b.apple_count,0))+sum(ifnull(c.apple_count,0)) as apple_count, sum(ifnull(b.orange_count,0))+sum(ifnull(c.orange_count,0)) as orange_count from Boxes b left join Chests c on b.chest_id=c.chest_id
select sum(ifnull(c.apple_count, 0)+ b.apple_count) as apple_count, sum(ifnull(c.orange_count, 0)+ b.orange_count) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(ifnull(c.apple_count,0) + (b.apple_count)) as apple_count, sum(ifnull(c.orange_count,0) + (b.orange_count)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(ifnull(c.apple_count,0)) + sum(ifnull(b.apple_count,0)) as apple_count, sum(ifnull(c.orange_count,0)) + sum(ifnull(b.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id
select sum(t.apple_count) + sum(if(t.ap2, t.ap2, 0)) as apple_count, sum(t.orange_count) + sum(if(t.or2, t.or2, 0)) as orange_count from (select b.box_id, b.apple_count, b.orange_count, c.apple_count as ap2, c.orange_count as or2 from boxes b left join chests c using (chest_id) ) as t
select sum(total_apples) "apple_count", sum(total_oranges) "orange_count" from (select b.box_id, (b.apple_count + coalesce(c.apple_count, 0)) "total_apples", (b.orange_count + coalesce(c.orange_count, 0)) "total_oranges" from boxes b left join chests c on b.chest_id = c.chest_id) ct
select sum_cac+sum_bac as apple_count, sum_coc+sum_boc as orange_count from ( select sum(cac) as sum_cac, sum(coc) as sum_coc, sum(boc) as sum_boc, sum(bac) as sum_bac from ( select ifnull(Chests.apple_count, 0) as cac, ifnull(Chests.orange_count, 0) as coc, ifnull(Boxes.apple_count, 0) as bac, ifnull(Boxes.orange_count, 0) as boc from Boxes left join Chests on Chests.chest_id = Boxes.chest_id ) t ) f
select x+t1.z as apple_count,y+t1.v as orange_count from (select coalesce(sum(c.apple_count),0) as z,coalesce(sum(c.orange_count),0) as v from Chests c left join Boxes b using(chest_id) where box_id is not null) as t1,(select sum(apple_count) as x,sum(orange_count) as y from Boxes) as t2
with BC as ( select B.box_id, B.apple_count+ifnull(C.apple_count,0) as apples, B.orange_count+ifnull(C.orange_count,0) as oranges from Boxes as B left join Chests as C on B.chest_id=C.chest_id ) select sum(apples) as apple_count, sum(oranges) as orange_count from BC
with CTE as ( Select (b.apple_count + IFNULL(c.apple_count,0)) as apple_count, (b.orange_count + IFNULL(c.orange_count,0)) as orange_count from Boxes b left join chests c on b.chest_id = c.chest_id ) Select sum(apple_count) as apple_count, sum(orange_count) as orange_count from CTE
with a as (select box_id, chest_id, b.apple_count as ba, b.orange_count as bo, c.apple_count as ca, c.orange_count as co from boxes b left join chests c using(chest_id) ) select sum(ba) + sum(if(chest_id is not null, ca ,0)) as apple_count, sum(bo) + sum(if(chest_id is not null, co ,0)) as orange_count from a
with a as( Select b.*, c.apple_count as a, c.orange_count as c from Boxes b left join Chests c on b.chest_id = c.chest_id ), t as ( Select sum(ifnull(apple_count,0)) as ac, sum(ifnull(orange_count,0)) as oc from a union Select sum(ifnull(a,0)), sum(ifnull(c,0)) from a ) Select sum(ac) as apple_count, sum(oc) as orange_count from t
with aa as (select sum(apple_count) as apple_count, sum(orange_count) as orange_count from boxes), bb as (select a.apple_count*count(b.box_id) as apple_count, a.orange_count*count(b.box_id) as orange_count from Chests as a join boxes as b on a.chest_id=b.chest_id group by a.chest_id) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from (select * from aa union all select * from bb) as cc
with box_cnts as ( select sum(apple_count) as apple_count, sum(orange_count) as orange_count from Boxes ) , chest_cnts as ( select sum(c.apple_count), sum(c.orange_count) from Boxes b left join Chests c on b.chest_id = c.chest_id ) , box_chest_cnts as ( select * from box_cnts union all select * from chest_cnts ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from box_chest_cnts
with boxcount as (select sum(apple_count) as apple_count, sum(orange_count) as orange_count from boxes), chestcount as (select sum(c.apple_count) as apple_count, sum(c.orange_count) as orange_count from chests c, boxes b where c.chest_id = b.chest_id) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from ((select * from boxcount) union all (select * from chestcount)) as A
with cnt as( select box_id, b.chest_id, (b.apple_count+c.apple_count) as total_apple_cnt, (b.orange_count+c.orange_count) as total_orange_cnt from boxes as b left join chests as c on b.chest_id = c.chest_id) select sum(case when c.chest_id is null then apple_count else total_apple_cnt end) as apple_count, sum(case when c.chest_id is null then orange_count else total_orange_cnt end) as orange_count from cnt as c join boxes as b on c.box_id = b.box_id
with cte as ( Select b.chest_id,b.apple_count,b.orange_count,ifnull(c.apple_count,0) as 'chest_apple',ifnull(c.orange_count,0) as 'chest_orange' from Boxes b left join Chests c on b.chest_id = c.chest_id ) Select sum(apple_count+chest_apple) as apple_count, sum(orange_count+chest_orange) as orange_count from cte
with cte as ( select b.apple_count as apple_1,b.orange_count as orange_1, c.apple_count as apple_2, c.orange_count as orange_2 from boxes b left join chests c on b.chest_id = c.chest_id) select sum(coalesce(apple_1,0) + coalesce(apple_2,0)) as apple_count, sum(coalesce(orange_1,0) + coalesce(orange_2,0)) as orange_count from cte
with cte as ( select b.box_id, b.chest_id, b.apple_count as apple_box, b.orange_count as orange_box, ifnull(c.apple_count,0) as apple_chest, ifnull(c.orange_count,0) as orange_chest from boxes b left join chests c on b.chest_id=c.chest_id ) select sum(apple_box+apple_chest) as apple_count, sum(orange_box+orange_chest) as orange_count from cte
with cte as ( select b.box_id,b.chest_id,(b.apple_count+coalesce(c.apple_count,0)) as apple_count, (b.orange_count+coalesce(c.orange_count,0)) as orange_count from boxes as b left join chests as c on b.chest_id=c.chest_id ) select sum(apple_count) as apple_count,sum(orange_count) as orange_count from cte
with cte as ( select box_id as id, apple_count, orange_count from boxes union all select b.chest_id as id, c.apple_count, c.orange_count from boxes b left join chests c on b.chest_id = c.chest_id ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from cte
with cte as ( select box_id, b.chest_id, (b.apple_count + ifnull(c.apple_count, 0) ) as apple_count, (b.orange_count + ifnull(c.orange_count, 0) ) as orange_count from Boxes b left join Chests c on b.chest_id = c.chest_id ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from cte
with cte as ( select box_id, b.chest_id, b.apple_count as a1, c.apple_count as a2, b.orange_count as o1, c.orange_count as o2 from boxes b left join chests c on b.chest_id = c.chest_id ) select sum(coalesce(a1, 0) + coalesce(a2, 0)) as apple_count, sum(coalesce(o1, 0) + coalesce(o2, 0)) as orange_count from cte
with cte as ( select box_id, ifnull(b.chest_id,0) as chest_id, b.apple_count,ifnull(c.apple_count,0) as newa,b.orange_count,ifnull(c.orange_count,0) as newo from boxes as b left join chests as c on b.chest_id = c.chest_id) select sum(apple_count + newa) as apple_count, sum(orange_count + newo) as orange_count from cte
with cte as ( select box_id,t1.chest_id,t1.apple_count as a1,t2.apple_count a2, t1.orange_count as o1, t2.orange_count as o2 from boxes t1 left join chests t2 on t1.chest_id=t2.chest_id ), cte2 as ( select box_id,case when chest_id is null then a1 else a1+a2 end as total_apple_cnt, case when chest_id is null then o1 else o1+o2 end as orange_cnt from cte ) select sum(total_apple_cnt) as apple_count,sum(orange_cnt) as orange_count from cte2
with cte as (select a.*,b.apple_count as c_app_cnt, b.orange_count as c_org_cnt from boxes a left join chests b on a.chest_id=b.chest_id) select sum(apple_count+ifnull(c_app_cnt,0)) as apple_count, sum(orange_count+ifnull(c_org_cnt,0)) as orange_count from cte
with cte as (select b.apple_count a1, ifnull(c.apple_count,0) a2, b.orange_count o1, ifnull(c.orange_count,0) o2 from boxes b left join chests c using(chest_id)) select sum(a1)+sum(a2) apple_count, sum(o1)+sum(o2) orange_count from cte
with cte as (select box_id, (apple_count + capple_count) as apple_count, (orange_count+corange_count) as orange_count from (select b.box_id,b.apple_count,b.orange_count,ifnull(c.apple_count,0) as capple_count, ifnull(c.orange_count,0) as corange_count from Boxes b left join Chests c on b.chest_id = c.chest_id) x) select SUM(apple_count) as apple_count, SUM(orange_count) as orange_count from cte
with cte as (select sum((case when a.chest_id is not null then (a.apple_count + b.apple_count) else a.apple_count end)) as apple_count1, sum((case when a.chest_id is not null then (a.orange_count + b.orange_count) else a.orange_count end)) as orange_count1 from Boxes a left join Chests b on a.chest_id = b.chest_id) select apple_count1 as apple_count, orange_count1 as orange_count from cte
with cte as( select box_id 'box', apple_count, orange_count from boxes union all (select b.chest_id 'box', b.apple_count 'apple_count', b.orange_count 'orange_count' from boxes a join chests b on a.chest_id = b.chest_id) ) select sum(apple_count) 'apple_count', sum(orange_count) 'orange_count' from cte
with cte as( select box_id, (case when b.chest_id is null then b.apple_count else b.apple_count+c.apple_count end) as apple_count, (case when b.chest_id is null then b.orange_count else b.orange_count+c.orange_count end) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from cte
with cte as( select sum(apple_count) apple_count,sum(orange_count) orange_count from boxes union select sum(c.apple_count) apple_count,sum(c.orange_count) orange_count from chests c join boxes b on c.chest_id=b.chest_id where b.chest_id is not null ) select sum(apple_count) as apple_count,sum(orange_count) as orange_count from cte
with cte1 as ( select b.box_id, b.chest_id, case when b.chest_id is not null then b.apple_count+c.apple_count end as apple_count, case when b.chest_id is not null then b.orange_count+c.orange_count end as orange_count from Boxes b join Chests c on c.chest_id = b.chest_id union all select box_id, chest_id, apple_count, orange_count from Boxes where chest_id is null ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from cte1
with demo as (select b.box_id, b.chest_id, b.apple_count, b.orange_count, ifnull(c.apple_count, 0) as chestapple, ifnull(c.orange_count, 0) as chestorange from Boxes b left join Chests c using(chest_id)) select sum(apple_count)+sum(chestapple) as apple_count, sum(orange_count)+ sum(chestorange) as orange_count from demo
with step1 as ( select a.apple_count + ifnull(b.apple_count,0) as apple, a.orange_count + ifnull(b.orange_count,0) as orange from boxes as a left join chests as b on a.chest_id = b.chest_id ) select sum(apple) as apple_count, sum(orange) as orange_count from step1
with t as ( select b.apple_count a1, b.orange_count o1, c.apple_count a2, c.orange_count o2 from boxes b left join chests c on b.chest_id=c.chest_id ) select sum(if(a2 is null, a1, a1+a2)) apple_count, sum(if(o2 is null, o1, o1+o2)) orange_count from t
with t as (SELECT b.*, IFNULL(c.apple_count,0) as chest_apple_count, IFNULL(c.orange_count,0) as chest_orange_count FROM boxes b LEFT JOIN chests c ON b.chest_id=c.chest_id) SELECT SUM(apple_count+chest_apple_count) as apple_count, SUM(orange_count+chest_orange_count) as orange_count from t
with t as (select b.box_id, b.apple_count+ifnull(c.apple_count,0) as apple_count, b.orange_count+ifnull(c.orange_count,0) as orange_count from Boxes b left join Chests c on b.chest_id=c.chest_id) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from t
with tbC as ( select b.box_id, (coalesce(b.apple_count,0) + coalesce(c.apple_count,0)) as apple_count, (coalesce(b.orange_count,0) + coalesce(c.orange_count,0)) as orange_count from boxes as b left join chests as c on b.chest_id = c.chest_id ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from tbC
with temp as (select SUM(B.apple_count + CASE WHEN B.chest_id is NULL THEN 0 ELSE C.apple_count END) as apple_counts, SUM(B.orange_count + CASE WHEN B.chest_id is NULL THEN 0 ELSE C.orange_count END) as orange_counts from Boxes B LEFT JOIN Chests C ON B.chest_id = C.chest_id group by B.box_id) select sum(apple_counts) as apple_count, sum(orange_counts) as orange_count from temp
with temp as(select sum(B.apple_count + case when C.chest_id is null then 0 else C.apple_count end) as apples, SUM(B.orange_count + case when C.chest_id is null then 0 else C.orange_count end) as oranges from Boxes B LEFT JOIN Chests C ON B.chest_id = C.chest_id group by B.box_id) select sum(apples) as apple_count, sum(oranges) as orange_count from temp
with tmp as ( select 'a' as dummy, apple_count, orange_count from Boxes union all select 'a' as dummy, c.apple_count as apple_count, c.orange_count as orange_count from Boxes b join Chests c on b.chest_id = c.chest_id ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from tmp group by dummy
with tmp as ( select box_id, apple_count, orange_count from Boxes union all select b.box_id as box_id, c.apple_count as apple_count, c.orange_count as orange_count from Boxes b join Chests c on b.chest_id = c.chest_id ), tmp2 as ( select box_id, sum(apple_count) as apple_count, sum(orange_count) as orange_count from tmp group by box_id WITH ROLLUP ) select apple_count, orange_count from tmp2 where box_id is null
with tmp as (select box_id, b.chest_id, (b.apple_count+coalesce(c.apple_count,0)) as apple_count, (b.orange_count+coalesce(c.orange_count,0)) as orange_count from boxes b left join chests c on b.chest_id = c.chest_id) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from tmp
with tmp as (select t1.box_id, t2.chest_id, t1.apple_count + coalesce(t2.apple_count,0) as apple_count, t1.orange_count + coalesce(t2.orange_count,0) as orange_count from Boxes t1 left join Chests t2 on t1.chest_id = t2.chest_id ) select sum(apple_count) as apple_count, sum(orange_count) as orange_count from tmp
with total as ( select b.apple_count + (case when c.apple_count is null then 0 else c.apple_count end) as c_a, b.orange_count + (case when c.orange_count is null then 0 else c.orange_count end) as c_o from Boxes b left join Chests c on b.chest_id = c.chest_id) select sum(c_a) as apple_count, sum(c_o) as orange_count from total
with x as(select b.*,c.chest_id ccid , coalesce(c.apple_count,0) ca, coalesce(c.orange_count,0) co FROM boxes b left join chests c on b.chest_id = c.chest_id ) , y as(select (apple_count+ ca )apple_count, (orange_count + co )orange_count from x) select sum(apple_count)apple_count ,sum(orange_count)orange_count from y
