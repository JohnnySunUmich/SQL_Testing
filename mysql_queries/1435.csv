(SELECT "[0-5>" bin, COUNT(session_id) total FROM Sessions WHERE duration/60 >=0 AND duration/60 <5) UNION (SELECT "[5-10>" bin, COUNT(session_id) total FROM Sessions WHERE duration/60 >=5 AND duration/60 <10) UNION (SELECT "[10-15>" bin, COUNT(session_id) total FROM Sessions WHERE duration/60 >=10 AND duration/60 <15) UNION (SELECT "15 or more" bin, COUNT(session_id) total FROM Sessions WHERE duration/60 >=15)
(SELECT '[0-5>' AS bin, SUM(CASE WHEN duration/60 >= 0 AND duration/60 < 5 THEN 1 ELSE 0 END) AS total FROM Sessions) UNION (SELECT '[5-10>' AS bin, SUM(CASE WHEN duration/60 >= 5 AND duration/60 < 10 THEN 1 ELSE 0 END) AS total FROM Sessions) UNION (SELECT '[10-15>' AS bin, SUM(CASE WHEN duration/60 >= 10 AND duration/60 < 15 THEN 1 ELSE 0 END) AS total FROM Sessions) UNION (SELECT '15 or more' AS bin, SUM(CASE WHEN duration/60 >= 15 THEN 1 ELSE 0 END) AS total FROM Sessions)
(select '[0-5>' as BIN, sum(case when duration >=0 and duration < 300 then 1 else 0 end) as TOTAL from sessions) UNION (select '[5-10>' as BIN, sum(case when duration >=300 and duration < 600 then 1 else 0 end) as TOTAL from sessions) UNION (select '[10-15>' as BIN, sum(case when duration >=600 and duration < 900 then 1 else 0 end) as TOTAL from sessions) UNION (select '15 or more' as BIN, sum(case when duration >=900 then 1 else 0 end) as TOTAL from sessions)
(select '[0-5>' as bin, sum(case when duration/60 < 5 then 1 else 0 end) as total from sessions) union (select '[5-10>' as bin, sum(case when ((duration/60 >= 5) and (duration/60 < 10)) then 1 else 0 end) as total from sessions) union (select '[10-15>' as bin, sum(case when ((duration/60 >= 10) and (duration/60 < 15)) then 1 else 0 end) as total from sessions) union (select '15 or more' as bin, sum(case when duration/60 >= 15 then 1 else 0 end) as total from sessions)
SELECT "[0-5>" AS bin, COUNT( CASE WHEN (duration / 60) BETWEEN 0 AND 4.99 THEN session_id END) AS total FROM Sessions UNION SELECT "[5-10>" AS bin, COUNT( CASE WHEN (duration / 60) BETWEEN 5.00 AND 9.99 THEN session_id END) AS total FROM Sessions UNION SELECT "[10-15>" AS bin, COUNT( CASE WHEN (duration / 60) BETWEEN 10.00 AND 14.99 THEN session_id END) AS total FROM Sessions UNION SELECT "15 or more" AS bin, COUNT( CASE WHEN (duration / 60) >= 15.00 THEN session_id END) AS total FROM Sessions
SELECT "[0-5>" AS bin, SUM(CASE WHEN 0<= (duration / 60) and (duration / 60) < 5 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT "[5-10>" AS bin, SUM(CASE WHEN 5<= (duration / 60) and (duration / 60) < 10 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT "[10-15>" AS bin, SUM(CASE WHEN 10<= (duration / 60) and (duration / 60) < 15 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT "15 or more" AS bin, SUM(CASE WHEN (duration / 60) > 15 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT "[0-5>" AS bin, SUM(CASE WHEN duration < 300 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT "[5-10>" AS bin, SUM(CASE WHEN duration >= 300 AND duration < 600 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT "[10-15>" AS bin, SUM(CASE WHEN duration >= 600 AND duration < 900 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT "15 or more" AS bin, SUM(CASE WHEN duration >= 900 THEN 1 ELSE 0 END) AS total FROM sessions
SELECT "[0-5>" AS bin, SUM(CASE WHEN duration >= 0 AND duration < 300 THEN 1 ELSE 0 END) AS total FROM Sessions GROUP BY 1 UNION SELECT "[5-10>" AS bin, SUM(CASE WHEN duration >= 300 AND duration < 600 THEN 1 ELSE 0 END) AS total FROM Sessions GROUP BY 1 UNION SELECT "[10-15>" AS bin, SUM(CASE WHEN duration >= 600 AND duration < 900 THEN 1 ELSE 0 END) AS total FROM Sessions GROUP BY 1 UNION SELECT "15 or more" AS bin, SUM(CASE WHEN duration > 900 THEN 1 ELSE 0 END) AS total FROM Sessions GROUP BY 1
SELECT "[0-5>" AS bin, SUM(CASE WHEN duration/60 < 5 THEN 1 ELSE 0 END) AS total FROM Sessions UNION ALL SELECT "[5-10>" AS bin, SUM(CASE WHEN duration/60 >= 5 AND duration/60 < 10 THEN 1 ELSE 0 END) AS total FROM Sessions UNION ALL SELECT "[10-15>" AS bin, SUM(CASE WHEN duration/60 >= 10 AND duration/60 < 15 THEN 1 ELSE 0 END) AS total FROM Sessions UNION ALL SELECT "15 or more" AS bin, SUM(CASE WHEN duration/60 > 15 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT "[0-5>" AS bin, SUM(IF(duration/60<5, 1, 0)) AS total FROM Sessions UNION SELECT "[5-10>" AS bin, SUM(IF(duration/60>= 5 AND duration/60<10, 1, 0)) AS total FROM Sessions UNION SELECT "[10-15>" AS bin, SUM(IF(duration/60>= 10 AND duration/60<15, 1, 0)) AS total FROM Sessions UNION SELECT "15 or more" AS bin, SUM(IF(duration/60>= 15, 1, 0)) AS total FROM Sessions
SELECT '[0-5>' AS 'bin', COUNT(session_id) AS 'total' FROM Sessions WHERE duration BETWEEN 0 and 299 UNION SELECT '[5-10>' AS 'bin', COUNT(session_id) AS 'total' FROM Sessions WHERE duration BETWEEN 300 and 599 UNION SELECT '[10-15>' AS 'bin', COUNT(session_id) AS 'total' FROM Sessions WHERE duration BETWEEN 600 and 899 UNION SELECT '15 or more' AS 'bin', COUNT(session_id) AS 'total' FROM Sessions WHERE duration >= 900
SELECT '[0-5>' AS 'bin', SUM(duration/60 < 5) AS 'total' FROM Sessions UNION SELECT '[5-10>' AS 'bin', SUM(duration/60 >= 5 AND duration/60 < 10) AS 'total' FROM Sessions UNION SELECT '[10-15>' AS 'bin', SUM(duration/60 >= 10 AND duration/60 < 15) AS 'total' FROM Sessions UNION SELECT '15 or more' AS 'bin', SUM(duration/60 >= 15) AS 'total' FROM Sessions
SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 0 AND 299 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 300 AND 599 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 600 AND 899 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS
SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN
SELECT '[0-5>' AS BIN, SUM(CASE WHEN duration / 60 >= 0 AND duration / 60 < 5 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN duration / 60 >= 5 AND duration / 60 < 10 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN duration / 60 >= 10 AND duration / 60 < 15 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN duration / 60 >= 15 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT '[0-5>' AS BIN, SUM(duration/60<5) AS TOTAL FROM sessions UNION SELECT '[5-10>' AS BIN, SUM(duration/60>=5 AND duration/60<10) AS TOTAL FROM sessions UNION SELECT '[10-15>' AS BIN, SUM(duration/60>=10 AND duration/60<15) AS TOTAL FROM sessions UNION SELECT '15 or more' AS BIN, SUM(duration/60>=15) AS TOTAL FROM sessions
SELECT '[0-5>' AS bin, COUNT(*) AS total FROM Sessions WHERE duration/60 <5 UNION SELECT '[5-10>' AS bin, COUNT(*) AS total FROM Sessions WHERE duration/60 <10 AND duration/60 >= 5 UNION SELECT '[10-15>' AS bin, COUNT(*) AS total FROM Sessions WHERE duration/60 <15 AND duration/60 >=10 UNION SELECT '15 or more' AS bin, COUNT(*) AS total FROM Sessions WHERE duration/60 >=15
SELECT '[0-5>' AS bin, COUNT(CASE WHEN duration/60 BETWEEN 0 AND 5 THEN session_id END) AS total FROM Sessions UNION SELECT '[5-10>' AS bin, COUNT(CASE WHEN duration/60 BETWEEN 5 AND 10 THEN session_id END) AS total FROM Sessions UNION SELECT '[10-15>' AS bin, COUNT(CASE WHEN duration/60 BETWEEN 10 AND 15 THEN session_id END) AS total FROM Sessions UNION SELECT '15 or more' AS bin, COUNT(CASE WHEN duration/60 > 15 THEN session_id END) AS total FROM Sessions
SELECT '[0-5>' AS bin, COUNT(IF((duration / 60) < 5, 1, NULL)) AS total FROM sessions UNION SELECT '[5-10>' AS bin, COUNT(IF((duration / 60) < 10 and (duration / 60) >= 5, 1, NULL)) AS total FROM sessions UNION SELECT '[10-15>' AS bin, COUNT(IF((duration / 60) < 15 and (duration / 60) >= 10, 1, NULL)) AS total FROM sessions UNION SELECT '15 or more' AS bin, COUNT(IF((duration / 60) >= 15, 1, NULL)) AS total FROM sessions
SELECT '[0-5>' AS bin, COUNT(IF(duration / 60 < 5 AND duration / 60 >= 0, 1, NULL)) AS total FROM Sessions UNION SELECT '[5-10>' AS bin, COUNT(IF(duration / 60 < 10 AND duration / 60 >= 5, 1, NULL)) AS total FROM Sessions UNION SELECT '[10-15>' AS bin, COUNT(IF(duration / 60 < 15 AND duration / 60 >= 10, 1, NULL)) AS total FROM Sessions UNION SELECT '15 or more' AS bin, COUNT(IF(duration / 60 >= 15, 1, NULL)) AS total FROM Sessions
SELECT '[0-5>' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration / 60 >= 0 AND duration / 60 < 5 UNION SELECT '[5-10>' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration / 60 >= 5 AND duration / 60 < 10 UNION SELECT '[10-15>' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration / 60 >= 10 AND duration / 60 < 15 UNION SELECT '15 or more' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration / 60 >= 15
SELECT '[0-5>' AS bin, SUM(CASE WHEN (duration/60<5) THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN (duration/60>=5 AND duration/60<10 ) THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[10-15>' AS bin, SUM(CASE WHEN (duration/60>=10 AND duration/60<15 ) THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '15 or more' AS bin, SUM(CASE WHEN (duration/60>=15) THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT '[0-5>' AS bin, SUM(CASE WHEN duration < 5*60 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN duration < 10*60 AND duration >= 5*60 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT '[10-15>' AS bin, SUM(CASE WHEN duration < 15*60 AND duration >= 10*60 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT '15 or more' AS bin, SUM(CASE WHEN duration >= 15*60 THEN 1 ELSE 0 END) AS total FROM sessions
SELECT '[0-5>' AS bin, SUM(CASE WHEN duration >= 0 AND duration < 300 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN duration >= 300 AND duration < 600 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[10-15>' AS bin, SUM(CASE WHEN duration >= 600 AND duration < 900 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '15 or more' AS bin, SUM(CASE WHEN duration >= 900 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT '[0-5>' AS bin, SUM(CASE WHEN duration/60 < 5 THEN 1 ELSE 0 END) AS total FROM Sessions UNION ALL SELECT '[5-10>' AS bin, SUM(CASE WHEN duration/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) AS total FROM Sessions UNION ALL SELECT '[10-15>' AS bin, SUM(CASE WHEN duration/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) AS total FROM Sessions UNION ALL SELECT '15 or more' AS bin, SUM(CASE WHEN duration/60 > 15 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT '[0-5>' AS bin, SUM(CASE WHEN duration/60 < 5 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN duration/60 >= 5 AND duration/60 < 10 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[10-15>' AS bin, SUM(CASE WHEN duration/60 >= 10 AND duration/60 < 15 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '15 or more' AS bin, SUM(CASE WHEN duration/60 >= 15 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT '[0-5>' AS bin, SUM(CASE WHEN duration/60 >=0 AND duration/60 < 5 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN duration/60 >=5 AND duration/60 < 10 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT '[10-15>', SUM(CASE WHEN duration/60 >=10 AND duration/60 < 15 THEN 1 ELSE 0 END) AS total FROM sessions UNION SELECT '15 or more', SUM(CASE WHEN duration/60 >=15 THEN 1 ELSE 0 END) AS total FROM sessions
SELECT '[0-5>' AS bin, SUM(CASE WHEN duration>=0 AND duration<5*60 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN duration>=5*60 AND duration<10*60 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '[10-15>' AS bin, SUM(CASE WHEN duration>=10*60 AND duration<15*60 THEN 1 ELSE 0 END) AS total FROM Sessions UNION SELECT '15 or more' AS bin, SUM(CASE WHEN duration>=15*60 THEN 1 ELSE 0 END) AS total FROM Sessions
SELECT '[0-5>' AS bin, SUM(IF(duration/60 < 5, 1, 0)) AS total FROM Sessions UNION ALL SELECT '[5-10>' AS bin, SUM(IF(duration/60 > 5 AND duration/60 < 10, 1, 0)) AS total FROM Sessions UNION ALL SELECT '[10-15>' AS bin, SUM(IF(duration/60 > 10 AND duration/60 < 15, 1, 0)) AS total FROM Sessions UNION ALL SELECT '15 or more' AS bin, SUM(IF(duration/60 > 15, 1, 0)) AS total FROM Sessions
SELECT '[0-5>' AS bin, Sum(CASE WHEN duration * 1.0 / 60 < 5 THEN 1 ELSE 0 END) total FROM sessions UNION ALL SELECT '[5-10>' AS bin, Sum(CASE WHEN duration * 1.0 / 60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) total FROM sessions UNION ALL SELECT '[10-15>' AS bin, Sum(CASE WHEN duration * 1.0 / 60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) total FROM sessions UNION ALL SELECT '15 or more' AS bin, Sum(CASE WHEN duration * 1.0 / 60 >= 15 THEN 1 ELSE 0 END) total FROM sessions
SELECT '[0-5>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION < 300 UNION ALL SELECT '[5-10>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 600 UNION ALL SELECT '[10-15>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 900 UNION ALL SELECT '15 or more' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION > 900
SELECT '[0-5>' BIN, Count(session_id) TOTAL FROM Sessions where duration > 0 and duration <300 union SELECT '[5-10>', Count(session_id) TOTAL FROM Sessions where duration > 300 and duration <600 union SELECT '[10-15>', Count(session_id) TOTAL FROM Sessions where duration > 600 and duration <900 union SELECT '15 or more', Count(session_id) TOTAL FROM Sessions where duration > 900
SELECT '[0-5>' as BIN, SUM(CASE WHEN duration < 300 THEN 1 ELSE 0 END) as TOTAL FROM Sessions UNION SELECT '[5-10>', SUM(CASE WHEN duration >= 300 and duration < 600 THEN 1 ELSE 0 END) FROM Sessions UNION SELECT '[10-15>', SUM(CASE WHEN duration >= 600 and duration < 900 THEN 1 ELSE 0 END) FROM Sessions UNION SELECT '15 or more', SUM(CASE WHEN duration >= 900 THEN 1 ELSE 0 END) FROM Sessions
SELECT '[0-5>' as BIN, SUM(case when duration/60 < 5 then 1 else 0 end) as TOTAL FROM Sessions union SELECT '[5-10>' as bin, SUM(case when duration/60 between 5 and 10 then 1 else 0 end) FROM Sessions union SELECT '[10-15>' as bin, SUM(case when duration/60 between 10 and 15 then 1 else 0 end) FROM Sessions union SELECT '15 or more', SUM(case when duration/60 >= 15 then 1 else 0 end) FROM Sessions
SELECT '[0-5>' as bin ,SUM(CASE WHEN duration/60 between 0 and 5 then 1 ELSE 0 END) total FROM Sessions UNION SELECT '[5-10>' as bin ,SUM(CASE WHEN duration/60 between 5 and 10 then 1 ELSE 0 END) total FROM Sessions UNION SELECT '[10-15>' as bin ,SUM(CASE WHEN duration/60 between 10 and 15 then 1 ELSE 0 END) total FROM Sessions UNION SELECT '15 or more' as bin ,SUM(CASE WHEN duration/60 >15 then 1 ELSE 0 END) total FROM Sessions
SELECT '[0-5>' as bin, COUNT(IF(duration < 300, 1, null)) as total FROM Sessions UNION SELECT '[5-10>' as bin, COUNT(IF(duration >= 300 AND duration < 600, 1, null)) as total FROM Sessions UNION SELECT '[10-15>' as bin, COUNT(IF(duration >= 600 AND duration < 900, 1, null)) as total FROM Sessions UNION SELECT '15 or more' as bin, COUNT(IF(duration > 900, 1, null)) as total FROM Sessions
SELECT B.bin, IFNULL(COUNT(A.session_id), 0) AS 'total' FROM (SELECT session_id, CASE WHEN duration / 60 < 5 THEN '[0-5>' WHEN duration / 60 >= 5 AND duration / 60 < 10 THEN '[5-10>' WHEN duration / 60 >= 10 AND duration / 60 < 15 THEN '[10-15>' ELSE '15 or more' END AS bin FROM sessions) A RIGHT JOIN (SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin) B ON A.bin = B.bin GROUP BY bin
SELECT BIN, SUM(TOTAL) AS TOTAL FROM( SELECT '[10-15>' AS BIN, 0 AS TOTAL UNION SELECT '15 or more' AS BIN, 0 AS TOTAL UNION SELECT '[5-10>' AS BIN, 0 AS TOTAL UNION SELECT '[0-5>' AS BIN, 0 AS TOTAL UNION SELECT BIN, COUNT(*) AS TOTAL FROM( SELECT *, (CASE WHEN duration/60 >= 15 THEN '15 or more' WHEN duration/60 < 15 AND duration/60 >= 10 THEN '[10-15>' WHEN duration/60 < 10 AND duration/60 >= 5 THEN '[5-10>' ELSE '[0-5>' END) AS BIN FROM Sessions ) tmp GROUP BY BIN ) tmp GROUP BY BIN
SELECT BIN, SUM(TOTAL) as total FROM ( SELECT '[0-5>' AS BIN, CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS ) A GROUP BY BIN
SELECT Options.bin, IFNULL(ResWithoutNull.total, 0) total FROM ( SELECT "[0-5>" bin UNION SELECT "[5-10>" bin UNION SELECT "[10-15>" bin UNION SELECT "15 or more" bin ) Options LEFT JOIN ( SELECT bin, COUNT(*) total FROM ( SELECT (CASE WHEN duration < 300 THEN "[0-5>" WHEN duration < 600 THEN "[5-10>" WHEN duration < 900 THEN "[10-15>" ELSE "15 or more" END) bin FROM Sessions ) ResWithoutGroup GROUP BY bin ) ResWithoutNull ON Options.bin = ResWithoutNull.bin
SELECT S.bin, IFNULL(COUNT(S.duration),0) AS total FROM (SELECT T2.bin, T1.duration FROM (SELECT CASE WHEN duration>=0 and duration<60*5 THEN '[0-5>' WHEN duration>=60*5 and duration<60*10 THEN '[5-10>' WHEN duration>=60*10 and duration<60*15 THEN '[10-15>' WHEN duration>=60*15 THEN '15 or more' END AS bin, duration FROM Sessions) T1 RIGHT JOIN (select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin) T2 ON T1.bin=T2.bin) S GROUP BY S.bin
SELECT T2.bin AS BIN, IFNULL(COUNT(session_id),0) AS TOTAL FROM (SELECT CASE WHEN (duration/60) < 5 THEN '[0-5>' WHEN (duration/60) >= 5 AND (duration/60) <10 THEN '[5-10>' WHEN (duration/60) >= 10 AND (duration/60) <15 THEN '[10-15>' WHEN (duration/60) >=15 THEN '15 or more' END AS bin, session_id FROM Sessions) T1 RIGHT JOIN( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ) T2 ON T1.bin=T2.bin GROUP BY T2.bin
SELECT a.bin, COALESCE(total, 0) as total FROM ( SELECT "[0-5>" as bin UNION ALL SELECT "[5-10>" as bin UNION ALL SELECT "[10-15>" as bin UNION ALL SELECT "15 or more" as bin ) a LEFT JOIN (SELECT bin, COUNT(*) as total FROM ( SELECT *, CASE WHEN duration < 300 THEN "[0-5>" WHEN duration < 600 THEN "[5-10>" WHEN duration < 900 THEN "[10-15>" ELSE "15 or more" END AS bin FROM sessions) a GROUP BY bin) b ON a.bin = b.bin
SELECT b.bin AS BIN, COALESCE((c.total),0) AS TOTAL FROM (SELECT '[0-5>' AS bin UNION SELECT '[5-10>' AS bin UNION SELECT '[10-15>' AS bin UNION SELECT '15 or more' AS bin) b LEFT JOIN (SELECT d.bin, COUNT(d.bin) AS total FROM (SELECT CASE WHEN (duration/60) >= 0 AND (duration/60) < 5 THEN '[0-5>' WHEN (duration/60) >= 5 AND (duration/60) < 10 THEN '[5-10>' WHEN (duration/60) >= 10 AND (duration/60) < 15 THEN '[10-15>' ELSE '15 or more' END bin FROM Sessions) d GROUP BY bin) c ON b.bin = c.bin GROUP BY b.bin
SELECT b.bin AS BIN, COALESCE(SUM(c.total),0) AS TOTAL FROM (SELECT '[0-5>' AS bin UNION SELECT '[5-10>' AS bin UNION SELECT '[10-15>' AS bin UNION SELECT '15 or more' AS bin) b LEFT JOIN (SELECT d.bin, COUNT(d.bin) AS total FROM (SELECT CASE WHEN (duration/60) >= 0 AND (duration/60) < 5 THEN '[0-5>' WHEN (duration/60) >= 5 AND (duration/60) < 10 THEN '[5-10>' WHEN (duration/60) >= 10 AND (duration/60) < 15 THEN '[10-15>' ELSE '15 or more' END bin FROM Sessions) d GROUP BY bin) c ON b.bin = c.bin GROUP BY b.bin
SELECT b.bin, IFNULL(COUNT(s.session_id),0) AS total FROM ( select session_id, CASE WHEN duration/60<5 THEN '[0-5>' WHEN duration/60>=5 AND duration/60<10 THEN '[5-10>' WHEN duration/60>=10 AND duration/60<15 THEN '[10-15>' ELSE '15 or more' END AS bin from sessions ) s RIGHT JOIN ( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ) b ON b.bin=s.bin GROUP BY bin
SELECT b.bin, IFNULL(COUNT(s.session_id),0) AS total FROM (SELECT session_id, CASE WHEN duration/60<5 THEN '[0-5>' WHEN duration/60>=5 AND duration/60<10 THEN '[5-10>' WHEN duration/60>=10 AND duration/60<15 THEN '[10-15>' ELSE '15 or more' END AS bin FROM sessions) s RIGHT JOIN (SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin) b ON b.bin=s.bin GROUP BY bin
SELECT b.bin, IFNULL(count(a.session_id), 0) AS total FROM( SELECT '[0-5>' as bin UNION SELECT '[5-10>' as bin UNION SELECT '[10-15>' as bin UNION SELECT '15 or more' as bin )b LEFT JOIN( SELECT session_id, CASE WHEN duration/60<5 THEN '[0-5>' WHEN duration/60<10 THEN '[5-10>' WHEN duration/60<15 THEN '[10-15>' ELSE '15 or more' END AS bin FROM Sessions )a ON b.bin=a.bin GROUP BY b.bin
SELECT bins.bin, COALESCE(t.total, 0) as total FROM (SELECT CASE WHEN duration < 5*60 AND duration >= 0 THEN '[0-5>' WHEN duration < 10*60 AND duration >= 5*60 THEN '[5-10>' WHEN duration < 15*60 AND duration >= 10*60 THEN '[10-15>' ELSE '15 or more' END AS bin, COUNT(*) as total FROM Sessions GROUP BY 1) t RIGHT JOIN (SELECT '[0-5>' as bin UNION ALL SELECT '[5-10>' as bin UNION ALL SELECT '[10-15>' as bin UNION ALL SELECT '15 or more' as bin) bins ON t.bin = bins.bin
SELECT bins.bin,coalesce(a.total, 0) as total FROM (SELECT "[0-5>" AS bin UNION ALL SELECT "[5-10>" As bin UNION ALL SELECT "[10-15>" AS bin UNION ALL SELECT "15 or more" As bin)AS bins LEFT JOIN (SELECT (CASE WHEN s.duration/60 <5 THEN "[0-5>" WHEN s.duration/60>=5 and s.duration/60<10 THEN "[5-10>" WHEN s.duration/60>=10 and s.duration/60 <15 THEN "[10-15>" ELSE "15 or more" END)AS bin,count(s.duration/60)as total FROM Sessions as s GROUP BY 1)as a on bins.bin=a.bin GROUP BY 1
SELECT x.bins as BIN, COALESCE(SUM(total),0) as TOTAL FROM (SELECT "[0-5>" as bins UNION ALL SELECT "[5-10>" as bins UNION ALL SELECT "[10-15>" as bins UNION ALL SELECT "15 or more" as bins ) x LEFT JOIN (SELECT bins, COUNT(*) as total FROM (SELECT case when duration < 300 then "[0-5>" when duration < 600 then "[5-10>" when duration < 900 then "[10-15>" when duration >= 900 then "15 or more" else 0 END as bins FROM Sessions ) y GROUP BY 1) z ON x.bins = z.bins GROUP BY 1
Select "[0-5>" as bin, count(if(duration <=300,1,null)) as total from sessions UNION ALL Select "[5-10>" as bin,count(if (duration>300 and duration <=600,1,null)) as total from sessions UNION ALL Select "[10-15>" as bin,count(if(duration>600 and duration <=900,1,null)) as total from sessions UNION ALL Select "15 or more" as bin,count(if (duration>900,1,null)) as total from sessions
Select '[0-5>' BIN, count(case when duration/60 >= 0 and duration/60 < 5 then session_id end) TOTAL from Sessions UNION Select '[5-10>' BIN, count(case when duration/60 >= 5 and duration/60 < 10 then session_id end) TOTAL from Sessions UNION Select '[10-15>' BIN, count(case when duration/60 >= 10 and duration/60 < 15 then session_id end) TOTAL from Sessions UNION Select '15 or more' BIN, count(case when duration/60 >= 15 then session_id end) TOTAL from Sessions
Select '[0-5>' as 'bin', sum(case when duration/60>=0 and duration/60 <5 Then 1 Else 0 End) as 'total' From Sessions Union Select '[5-10>' as "bin", sum(case when duration/60>=5 and duration/60 <10 Then 1 Else 0 End) as 'total' From Sessions Union Select '[10-15>' as 'bin', sum(case when duration/60>=10 and duration/60 <15 Then 1 Else 0 End) as 'total' From Sessions Union Select '15 or more' as bin, sum(case when duration/60>=15 Then 1 Else 0 End) as total From Sessions
Select '[0-5>' as BIN, Sum(duration < 300) as TOTAL from Sessions Union Select '[5-10>' as BIN, Sum(duration >= 300 and duration < 600) as TOTAL from Sessions Union Select '[10-15>' as BIN, Sum(duration >= 600 and duration < 900 ) as TOTAL from Sessions Union Select '15 or more' as BIN, Sum(duration >= 900) as TOTAL from Sessions
WITH C as (SELECT "[0-5>" as bin UNION ALL SELECT "[5-10>" as bin UNION ALL SELECT "[10-15>" as bin UNION ALL SELECT "15 or more" as bin), B AS( SELECT (CASE WHEN duration/60<5 THEN '[0-5>' WHEN duration/60<10 and duration/60>=5 THEN '[5-10>' WHEN duration/60<15 and duration/60>=10 THEN '[10-15>' WHEN duration/60<20 and duration/60>=15 THEN '15 or more' END) as 'bin', count(session_id) as total FROM Sessions GROUP BY 1) SELECT C.bin,ifnull(B.total,0) as 'total' FROM C LEFT JOIN B USING (bin)
WITH CTE AS ( SELECT (CASE WHEN (duration / 60) BETWEEN 0 AND 4.99 THEN '[0-5>' WHEN (duration / 60) BETWEEN 5.00 AND 9.99 THEN '[5-10>' WHEN (duration / 60) BETWEEN 10.00 AND 14.99 THEN '[10-15>' WHEN (duration / 60) >= 15.00 THEN '15 or more' ELSE NULL END) AS bin, COALESCE(COUNT(*), 0) AS total FROM Sessions GROUP BY (CASE WHEN (duration / 60) BETWEEN 0 AND 4.99 THEN '[0-5>' WHEN (duration / 60) BETWEEN 5.00 AND 9.99 THEN '[5-10>' WHEN (duration / 60) BETWEEN 10.00 AND 14.99 THEN '[10-15>' WHEN (duration / 60) >= 15.00 THEN '15 or more' ELSE NULL END) ), CTE2 AS ( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ) SELECT c2.bin AS bin, COALESCE(c.total, 0) AS total FROM CTE2 c2 LEFT JOIN CTE c ON c2.bin = c.bin
WITH CTE1 AS ( SELECT '[0-5>' as bin union SELECT '[5-10>' as bin union SELECT '[10-15>' as bin union SELECT '15 or more' as bin ) , CTE2 AS ( select agg.bin , count(*) as total from ( select session_id ,case when ROUND(duration/60, 3) between 0 and 4.999 then '[0-5>' when ROUND(duration/60, 3) between 5 and 9.999 then '[5-10>' when ROUND(duration/60, 3) between 10 and 14.999 then '[10-15>' ELSE '15 or more' END as bin , ROUND(duration/60, 3) from sessions ) AGG group by 1 ) select cte1.bin , IFNULL(CTE2.total,0) as total from cte1 left join cte2 on cte1.bin = cte2.bin
WITH CTE1 AS ( SELECT session_id, (CASE WHEN duration<5*60 THEN 1 ELSE 0 END) AS bin5, (CASE WHEN duration>=5*60 AND duration<10*60 THEN 1 ELSE 0 END) AS bin10, (CASE WHEN duration>=10*60 AND duration<15*60 THEN 1 ELSE 0 END) AS bin15, (CASE WHEN duration>=15*60 THEN 1 ELSE 0 END) AS bin20 FROM Sessions) SELECT '[0-5>' AS bin, SUM(bin5) AS total FROM CTE1 UNION ALL SELECT '[5-10>' AS bin, SUM(bin10) AS total FROM CTE1 UNION ALL SELECT '[10-15>' AS bin, SUM(bin15) AS total FROM CTE1 UNION ALL SELECT '15 or more' AS bin, SUM(bin20) AS total FROM CTE1
WITH R AS ( SELECT '[0-5>' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration >= 0 AND duration < 300 UNION SELECT '[5-10>' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration >= 300 AND duration < 600 UNION SELECT '[10-15>' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration >= 600 AND duration < 900 UNION SELECT '15 or more' AS bin, COUNT(session_id) AS total FROM Sessions WHERE duration >= 900 ) SELECT * FROM R
WITH all_bin AS (SELECT '[0-5>' AS bin UNION SELECT '[5-10>' AS bin UNION SELECT '[10-15>' AS bin UNION SELECT '15 or more' AS bin) SELECT all_bin.bin, coalesce(c.total, 0) AS total FROM all_bin LEFT JOIN( SELECT bin, count(*) AS total FROM ( SELECT session_id, case when duration/60 < 5 then '[0-5>' when duration/60 < 10 then '[5-10>' when duration/60 < 15 then '[10-15>' else '15 or more' end AS bin FROM Sessions) a GROUP BY 1) c USING (bin)
WITH bin_def AS ( select '[0-5>' as bin, 0 as min_sec, 5*60 as max_sec UNION select '[5-10>' as bin, 5*60 as min_sec, 10*60 as max_sec UNION select '[10-15>' as bin, 10*60 as min_sec, 15*60 as max_sec UNION select '15 or more' as bin, 15*60 as min_sec, null as max_sec ) SELECT b.bin , count(s.session_id) as total FROM bin_def b LEFT JOIN Sessions s on s.duration >= b.min_sec and s.duration < coalesce(b.max_sec,s.duration+1) GROUP BY b.bin
WITH bins AS ( SELECT "[0-5>" AS bin FROM DUAL UNION SELECT "[5-10>" AS bin FROM DUAL UNION SELECT "[10-15>" AS bin FROM DUAL UNION SELECT "15 or more" AS bin FROM DUAL ) SELECT b.bin, COUNT(s.session_id) AS total FROM bins b LEFT JOIN (SELECT ( CASE WHEN duration/60 >= 15 THEN "15 or more" WHEN duration/60 < 15 AND duration/60 >= 10 THEN "[10-15>" WHEN duration/60 < 10 AND duration/60 >= 5 THEN "[5-10>" WHEN duration/60 < 5 AND duration/60 >= 0 THEN "[0-5>" END ) AS bin, session_id FROM Sessions) s ON b.bin = s.bin GROUP BY b.bin
WITH cte AS ( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ) select cte.bin as BIN,IFNULL(b.total,0) as TOTAL from cte left join (select bin, count(*) as total from (select case when duration between 0 and 299 then '[0-5>' when duration between 300 and 599 then '[5-10>' when duration between 600 and 899 then '[10-15>' else "15 or more" end as bin from Sessions) as t group by bin) as b on cte.bin = b.bin
WITH cte AS ( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ), SessionsWithBins AS ( SELECT (CASE WHEN duration < 5*60 THEN '[0-5>' WHEN duration < 10*60 THEN '[5-10>' WHEN duration < 15*60 THEN '[10-15>' ELSE '15 or more' END) AS bin, COUNT(session_id) AS total FROM Sessions GROUP BY bin ) SELECT C.bin AS BIN, IFNULL(S.total,0) AS TOTAL FROM cte C LEFT OUTER JOIN SessionsWithBins S On C.bin = S.bin
WITH cte AS ( SELECT '[0-5>' AS bin, 0 AS min_duration, 5*60 AS max_duration UNION ALL SELECT '[5-10>' AS bin, 5*60 AS min_duration, 10*60 AS max_duration UNION ALL SELECT '[10-15>' AS bin, 10*60 AS min_duration, 15*60 AS max_duration UNION ALL SELECT '15 or more' AS bin, 15*60 AS min_duration, 2147483647 AS max_duration ) SELECT cte.bin, COUNT(s.session_id) AS TOTAL FROM Sessions s RIGHT JOIN cte ON s.duration >= min_duration AND s.duration < max_duration GROUP BY cte.bin
WITH cte AS ( SELECT '[0-5>' AS bin, 0 AS min_duration, 5*60 AS max_duration UNION ALL SELECT '[5-10>' AS bin, 5*60 AS min_duration, 10*60 AS max_duration UNION ALL SELECT '[10-15>' AS bin, 10*60 AS min_duration, 15*60 AS max_duration UNION ALL SELECT '15 or more' AS bin, 15*60 as min_duration, 10000000 AS max_duration ) SELECT a.bin, ifnull(COUNT(b.session_id),0) AS total FROM cte a left JOIN sessions b ON b.duration >= a.min_duration AND b.duration < a.max_duration GROUP BY 1
WITH cte AS ( SELECT '[0-5>' AS bin, 0 AS min_duration, 5*60 AS max_duration UNION ALL SELECT '[5-10>' AS bin, 5*60 AS min_duration, 10*60 AS max_duration UNION ALL SELECT '[10-15>' AS bin, 10*60 AS min_duration, 15*60 AS max_duration UNION ALL SELECT '15 or more' AS bin, 15*60 as min_duration, 2147483647 AS max_duration ) SELECT cte.bin, COUNT(s.session_id) AS total FROM Sessions s RIGHT JOIN cte ON s.duration >= min_duration AND s.duration < max_duration GROUP BY cte.bin
WITH cte AS ( SELECT '[0-5>' AS bin, 0 as low, 60*5 AS high UNION ALL SELECT '[5-10>' AS bin, 60*5 as low, 60*10 AS high UNION ALL SELECT '[10-15>' AS bin, 60*10 as low, 60*15 AS high UNION ALL SELECT '15 or more' AS bin, 60*15 AS low, (SELECT MAX(duration)+1 AS high FROM Sessions) ), SessionsWithBins AS ( SELECT c.bin, IFNULL(COUNT(S.session_id),0) AS total FROM cte C LEFT OUTER JOIN Sessions S ON S.duration >= C.low AND S.duration < C.high GROUP BY bin ) SELECT * FROM SessionsWithBins
WITH cte AS ( SELECT duration/60 AS mins FROM sessions ) SELECT '[0-5>' AS bin, SUM(CASE WHEN mins<5 THEN 1 ELSE 0 END) AS total FROM cte UNION ALL SELECT '[5-10>' AS bin, SUM(CASE WHEN mins>=5 AND mins<10 THEN 1 ELSE 0 END) AS total FROM cte UNION ALL SELECT '[10-15>' AS bin, SUM(CASE WHEN mins>=10 AND mins<15 THEN 1 ELSE 0 END) AS total FROM cte UNION ALL SELECT '15 or more' AS bin, SUM(CASE WHEN mins>=15 THEN 1 ELSE 0 END) AS total FROM cte
WITH cte AS ( SELECT session_id, CASE WHEN duration/60 >= 0 AND duration/60 < 5 THEN '[0-5>' WHEN duration/60 >= 5 AND duration/60 < 10 THEN '[5-10>' WHEN duration/60 >= 10 AND duration/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS bin FROM Sessions), cte2 AS (select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin) SELECT cte2.bin AS BIN, COUNT(cte.session_id) AS TOTAL FROM cte2 LEFT JOIN cte ON cte2.bin = cte.bin GROUP BY cte2.bin
WITH cte AS(SELECT duration/60 AS mins FROM Sessions) SELECT '[0-5>' AS bin, SUM(CASE WHEN mins >= 0 AND mins < 5 THEN 1 ELSE 0 END) AS total FROM cte UNION SELECT '[5-10>' AS bin, SUM(CASE WHEN mins >= 5 AND mins < 10 THEN 1 ELSE 0 END) AS total FROM cte UNION SELECT '[10-15>' AS bin, SUM(CASE WHEN mins >= 10 AND mins < 15 THEN 1 ELSE 0 END) AS total FROM cte UNION SELECT '15 or more' AS bin, SUM(CASE WHEN mins >= 15 THEN 1 ELSE 0 END) AS total FROM cte
WITH cte1 as (SELECT "[0-5>" as bin, SUM(duration <5*60) as total FROM Sessions UNION ALL SELECT "[5-10>" as bin, SUM(duration >= 5*60 AND duration <10*60) as total FROM Sessions UNION ALL SELECT "[10-15>" as bin, SUM(duration >= 10*60 AND duration <15*60) as total FROM Sessions UNION ALL SELECT "15 or more" as bin, SUM(duration >= 15*60) as total FROM Sessions) SELECT * FROM cte1
WITH cte_session(BIN, minduration, maxduration) AS( SELECT '[0-5>', 0, 5*60 UNION ALL SELECT '[5-10>', 5*60, 10*60 UNION ALL SELECT '[10-15>', 10*60, 15*60 UNION ALL SELECT '15 or more', 15*60, 214748 ) SELECT cte_session.bin, count(s.session_id) as TOTAL from Sessions s right join cte_session on s.duration >= minduration and s.duration < maxduration Group BY cte_session.bin
WITH sessiontable AS( SELECT '[0-5>' as bin UNION ALL SELECT '[5-10>' as bin UNION ALL SELECT '[10-15>' as bin UNION ALL SELECT '15 or more' as bin ) SELECT s.bin, COUNT(session_id) AS total FROM sessiontable as s LEFT JOIN( SELECT session_id, CASE WHEN duration/60<5 THEN '[0-5>' WHEN duration/60<10 THEN '[5-10>' WHEN duration/60<15 THEN '[10-15>' ELSE '15 or more' END as bin FROM sessions )a using (bin) GROUP BY s.bin
WITH t1 AS ( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ), t2 AS( SELECT CASE WHEN (duration/60) >=0 AND (duration/60) <5 THEN '[0-5>' WHEN (duration/60) >=5 AND (duration/60) <10 THEN '[5-10>' WHEN (duration/60) >=10 AND (duration/60) <15 THEN '[10-15>' ELSE '15 or more' END AS bin, IFNULL(COUNT(DISTINCT session_id),0) AS total FROM Sessions GROUP BY bin ) SELECT t1.bin, IFNULL(t2.total,0) AS total FROM t1 LEFT JOIN t2 ON t1.bin = t2.bin
WITH temp1 AS ( SELECT session_id, duration / 60 AS minute FROM sessions ), temp2 AS ( SELECT CASE WHEN minute < 5 THEN '[0-5>' WHEN minute < 10 THEN '[5-10>' WHEN minute < 15 THEN '[10-15>' ELSE '15 or more' END AS bin FROM temp1 ), cte AS ( SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin ) SELECT cte.BIN, COUNT(temp2.bin) AS TOTAL FROM cte LEFT JOIN temp2 ON cte.bin = temp2.bin GROUP BY bin
WITH temp_data as ( SELECT DISTINCT session_id, CASE WHEN (duration/60) >= 0 AND (duration/60) < 5 THEN '[0-5>' WHEN (duration/60) >= 5 AND (duration/60) < 10 THEN '[5-10>' WHEN (duration/60) >= 10 AND (duration/60) < 15 THEN '[10-15>' WHEN (duration/60) >=15 THEN '15 or more' END AS bin FROM SESSIONS ) ,lookup_table as ( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) SELECT lt.BIN, IFNULL(TOTAL,0) AS TOTAL FROM ( SELECT BIN, COUNT(session_id) as TOTAL FROM temp_data GROUP BY BIN ) a RIGHT JOIN lookup_table lt ON a.BIN = lt.BIN
With bins as (Select "[0-5>" as bin UNION ALL Select "[5-10>" as bin UNION ALL Select "[10-15>" as bin UNION ALL Select "15 or more" as bin ), aggr_bins as ( Select b.bin as BIN, count(s.session_id) as TOTAL from bins b left join sessions s on b.bin = (case when duration/60 >= 0 and duration/60 < 5 then "[0-5>" when duration/60 >= 5 and duration/60 < 10 then "[5-10>" when duration/60 >= 10 and duration/60 < 15 then "[10-15>" else "15 or more" end ) group by 1 ) Select * from aggr_bins
select "[0-5>" as "bin", count(duration) "total" from sessions where duration < 300 union select "[5-10>" as "bin", count(duration) "total" from sessions where duration between 300 and 599 union select "[10-15>" as "bin", count(duration) "total" from sessions where duration between 600 and 899 union select "15 or more" as "bin", count(duration) "total" from sessions where duration > 899
select "[0-5>" as BIN ,sum( case when duration /60 <5 then 1 else 0 end) as TOTAL from Sessions union select "[5-10>" as BIN ,sum( case when duration /60 >5 and duration/60 < 10 then 1 else 0 end) as TOTAL from Sessions union select "[5-10>" as BIN ,sum( case when duration /60 >5 and duration/60 < 10 then 1 else 0 end) as TOTAL from Sessions union select "[10-15>" as BIN ,sum( case when duration /60 >10 and duration/60 < 15 then 1 else 0 end) as TOTAL from Sessions union select "15 or more" as BIN ,sum( case when duration /60 >15 then 1 else 0 end) as TOTAL from Sessions
select "[0-5>" as BIN, count( case when duration>=0 and duration<300 then "[0-5>" end ) as TOTAL from Sessions group by BIN union all select "[5-10>" as BIN, count( case when duration>=300 and duration<600 then "[5-10>" end ) as TOTAL from Sessions group by BIN union all select "[10-15>" as BIN, count( case when duration>=600 and duration<900 then "[10-15>" end ) as TOTAL from Sessions group by BIN union all select "15 or more" as BIN, count( case when duration>=900 then "15 or more" end ) as TOTAL from Sessions group by BIN
select "[0-5>" as BIN, count(case when duration/60 < 5 and duration/60 >=0 then session_id end) as TOTAL from Sessions union select "[5-10>" as BIN, count(case when duration/60 < 10 and duration/60 >=5 then session_id end) as TOTAL from Sessions union select "[10-15>" as BIN, count(case when duration/60 < 15 and duration/60 >=10 then session_id end) as TOTAL from Sessions union select "15 or more" as BIN, count(case when duration/60 >=15 then session_id end) as TOTAL from Sessions
select "[0-5>" as BIN, count(case when duration/60 >=0 and duration/60 < 5 then session_id end) as TOTAL from Sessions union select "[5-10>" as BIN, count(case when duration/60 >=5 and duration/60 < 10 then session_id end) as TOTAL from Sessions union select "[10-15>" as BIN, count(case when duration/60 >= 10 and duration/60 < 15 then session_id end) as TOTAL from Sessions union select "15 or more" as BIN, count(case when duration/60 >=15 then session_id end) as TOTAL from Sessions
select "[0-5>" as BIN, count(session_id) as TOTAL from Sessions where duration/60>=0 and duration/60<5 union select "[5-10>" as BIN, count(session_id) as TOTAL from Sessions where duration/60>=5 and duration/60<10 union select "[10-15>" as BIN, count(session_id) as TOTAL from Sessions where duration/60>=10 and duration/60<15 union select "15 or more" as BIN, count(session_id) as TOTAL from Sessions where duration/60>=15
select "[0-5>" as bin , count(case when duration < 300 then session_id end) as total from Sessions UNION select "[5-10>" as bin , count(case when duration >= 300 and duration < 600 then session_id end) as total from Sessions UNION select "[10-15>" as bin , count(case when duration >= 600 and duration < 900 then session_id end) as total from Sessions UNION select "15 or more" as bin , count(case when duration >= 900 then session_id end) as total from Sessions
select "[0-5>" as bin, count(case when duration/60 >= 0 and duration/60 < 5 then session_id end) as total from sessions union all select "[5-10>" as bin, count(case when duration/60 >= 5 and duration/60 < 10 then session_id end) as total from sessions union all select "[10-15>" as bin, count(case when duration/60 >= 10 and duration/60 < 15 then session_id end) as total from sessions union all select "15 or more" as bin, count(case when duration/60 >= 15 then session_id end) as total from sessions
select "[0-5>" as bin, count(session_id) as total from Sessions where duration / 60 < 5 and duration / 60 >= 0 union select "[5-10>" as bin, count(session_id) as total from Sessions where duration / 60 < 10 and duration / 60 >= 5 union select "[10-15>" as bin, count(session_id) as toal from Sessions where duration / 60 < 15 and duration / 60 >= 10 union select "15 or more" as bin, count(session_id) as total from Sessions where duration / 60 >=15
select "[0-5>" as bin, ifnull(sum(case when duration/60 >=0 and duration/60 < 5 then 1 end),0) as total from sessions union (select "[5-10>" as bin, ifnull(sum(case when duration/60 >=5 and duration/60 < 10 then 1 end),0) as total from sessions) union (select "[10-15>" as bin, ifnull(sum(case when duration/60 >=10 and duration/60 < 15 then 1 end),0) as total from sessions) union (select "15 or more" as bin, ifnull(sum(case when duration/60 >=15 then 1 end),0) as total from sessions)
select "[0-5>" as bin, sum(duration/60 <5) as total from sessions union select "[5-10>" as bin, sum(duration/60>=5 and duration/60<10) as total from sessions union select "[10-15>" as bin, sum(duration/60>=10 and duration/60<15) as total from sessions union select "15 or more" as bin, sum(duration/60>=15) as total from sessions
select "[0-5>" as bin,count(case when duration/60 < 5 and duration/60 >=0 then session_id end)as total from sessions union select "[5-10>" as bin,count(case when duration/60 < 10 and duration/60 >=5 then session_id end)as total from sessions union select "[10-15>" as bin,count(case when duration/60 < 15 and duration/60 >=10 then session_id end)as total from sessions union select "15 or more" as bin,count(case when duration/60 > 15 then session_id end)as total from sessions
select "[0-5>" as bin,sum(case when duration/60 between 0 and 5 then 1 else 0 end) total from sessions union select "[5-10>" ,sum(case when duration/60 between 5 and 10 then 1 else 0 end) from sessions union select "[10-15>",sum(case when duration/60 between 10 and 15 then 1 else 0 end) from sessions union select "15 or more" ,sum(case when duration/60 >15 then 1 else 0 end) from sessions
select "[0-5>" as bin,sum(case when duration/60 between 0 and 5 then 1 else 0 end)Total from sessions union select "[5-10>" ,sum(case when duration/60 between 5 and 10 then 1 else 0 end) from sessions union select "[10-15>",sum(case when duration/60 between 10 and 15 then 1 else 0 end) from sessions union select "15 or more" ,sum(case when duration/60 >15 then 1 else 0 end) from sessions
select "[0-5>" as bin,sum(duration/60<5) as total from Sessions union select "[5-10>" as bin,sum(duration/60>5 and duration/60<10) as total from Sessions union select "[10-15>" as bin,sum(duration/60>10 and duration/60<15) as total from Sessions union select "15 or more" as bin,sum(duration/60>15) as total from Sessions
select '[0-5>' as 'bin', count(session_id) as 'total' from Sessions where duration between 0 and (5*60-1) union select '[5-10>' as 'bin', count(session_id) as 'total' from Sessions where duration between 5*60 and (10*60-1) union select '[10-15>' as 'bin', count(session_id) as 'total' from Sessions where duration between 10*60 and (15*60-1) union select '15 or more' as 'bin', count(session_id) as 'total' from Sessions where duration >= 15*60
select '[0-5>' as BIN, count((duration/60)) as TOTAL from sessions where (duration/60)>=0 and (duration/60) <5 union select '[5-10>' as BIN, count((duration/60)) as TOTAL from sessions where (duration/60)>=5 and (duration/60) <10 union select '[10-15>' as BIN, count((duration/60)) as TOTAL from sessions where (duration/60)>=10 and (duration/60) <15 union select '15 or more' as BIN, count((duration/60)) as TOTAL from sessions where (duration/60) >= 15
select '[0-5>' as BIN, count(case when duration/60 < 5 then session_id end ) as Total from sessions union select '[5-10>' as BIN, count(case when duration/60>=5 and duration/60<10 then session_id end ) as Total from sessions union select '[10-15>' as BIN, count(case when duration/60>=10 and duration/60<15 then session_id end ) as Total from sessions union select '15 or more' as BIN, count(case when duration/60>=15 then session_id end ) as Total from sessions
select '[0-5>' as BIN, count(case when duration/60 <=5 then session_id end) TOTAL from sessions union select '[5-10>' as BIN, count(case when duration/60 <=10 and duration/60 >5 then session_id end) TOTAL from sessions union select '[10-15>' as BIN, count(case when duration/60 <=15 and duration/60 >10 then session_id end) TOTAL from sessions union select '15 or more' as BIN, count(case when duration/60 > 15 then session_id end) TOTAL from sessions
select '[0-5>' as BIN, count(case when((duration/60)<5 and (duration/60)>=0) then session_id END)as TOTAL from sessions union select '[5-10>' as BIN, count(case when((duration/60)>=5 and (duration/60)<10)then session_id END)as TOTAL from sessions union select '[10-15>' as BIN, count(case when((duration/60)>=10 and (duration/60)<15)then session_id END)as TOTAL from sessions union select '15 or more' as BIN, count(case when((duration/60)>=15)then session_id END)as TOTAL from sessions
select '[0-5>' as BIN, sum(duration/60 <5 and duration/60 >=0) as TOTAL from Sessions union all select '[5-10>' as bin, sum(duration/60 <10 and duration/60 >=5) as total from Sessions union all select '[10-15>' as bin, sum(duration/60 >=10 and duration/60 <15) as total from Sessions union all select '15 or more' as bin, sum(duration/60 >= 15) as total from Sessions
select '[0-5>' as BIN,count(session_id) as TOTAL from sessions where duration < 300 union select '[5-10>' as BIN,count(session_id) as TOTAL from sessions where duration between 300 and 599 union select '[10-15>' as BIN,count(session_id) as TOTAL from sessions where duration between 600 and 899 union select '15 or more' as BIN,count(session_id) as TOTAL from sessions where duration >= 900
select '[0-5>' as bin , sum(case when duration/60 >=0 and duration/60 <5 then 1 else 0 end) as total from Sessions union select '[5-10>' as bin , sum(case when duration/60 >=5 and duration/60 <10 then 1 else 0 end) as total from Sessions union select '[10-15>' as bin , sum(case when duration/60 >=10 and duration/60 <15 then 1 else 0 end) as total from Sessions union select '15 or more' as bin , sum(case when duration/60 >=15 then 1 else 0 end) as total from Sessions
select '[0-5>' as bin ,count(case when (duration)/60 >= 0 and (duration)/60 < 5 then session_id end) as total from sessions union select '[5-10>' as bin , count(case when (duration)/60 >= 5 and (duration)/60 < 10 then session_id end) as total from sessions union select '[10-15>' as bin , count(case when (duration)/60 >= 10 and (duration)/60 < 15 then session_id end) as total from sessions union select '15 or more' as bin ,count(case when (duration)/60 >= 15 then session_id end) as total from Sessions
select '[0-5>' as bin, (select count(session_id) as total from Sessions where duration <300) as total union select '[5-10>' as bin, (select count(session_id) as total from Sessions where duration >=300 and duration < 600) as total union select '[10-15>' as bin, (select count(session_id) as total from Sessions where duration >=600 and duration < 900) as total union select '15 or more' as bin, (select count(session_id) as total from Sessions where duration >=900) as total
select '[0-5>' as bin, (select count(session_id) from Sessions where (duration/60)<5) as total from Sessions union select '[5-10>' as bin, (select count(session_id) from Sessions where (duration/60)<10 and (duration/60)>5) as total from Sessions union select '[10-15>' as bin, (select count(session_id) from Sessions where (duration/60)>10 and (duration/60)<15) as total from Sessions union select '15 or more' as bin, (select count(session_id) from Sessions where (duration/60)>15) as total from Sessions
select '[0-5>' as bin, (select count(session_id) from sessions where duration < 300) as total union select '[5-10>' as bin, (select count(session_id) from sessions where duration >= 300 and duration < 600 )as total union select '[10-15>' as bin, (select count(session_id) from sessions where duration >=600 and duration < 900)as total union select '15 or more' as bin, (select count(session_id) from sessions where duration >=900)
select '[0-5>' as bin, count(*) as total from Sessions where duration < 300 union select '[5-10>' as bin, count(*) as total from Sessions where duration > 300 and duration < 600 union select '[10-15>' as bin, count(*) as total from Sessions where duration > 600 and duration <900 union select '15 or more' as bin, count(*) as total from Sessions where duration > 900
select '[0-5>' as bin, count(*) as total from Sessions where duration>=0 and duration < 300 union select '[5-10>' as bin, count(*) as total from Sessions where duration>=300 and duration < 600 union select '[10-15>' as bin, count(*) as total from Sessions where duration>=600 and duration < 900 union select '15 or more' as bin, count(*) as total from Sessions where duration >= 900
select '[0-5>' as bin, count(*) as total from sessions where duration/60<5 union all select '[5-10>' as bin, count(*) as total from sessions where duration/60 between 5 and 10 union all select '[10-15>' as bin, count(*) as total from sessions where duration/60 between 10 and 15 union all select '15 or more' as bin, count(*) as total from sessions where duration/60>=15
select '[0-5>' as bin, count(*) as total from sessions where duration<300 union select '[5-10>' as bin, count(*) as total from sessions where duration >= 300 and duration < 600 union select '[10-15>' as bin, count(*) as total from sessions where duration >= 600 and duration < 900 union select '15 or more' as bin, count(*) as total from sessions where duration >= 900
select '[0-5>' as bin, count(case when (duration/60) >= 0 and (duration/60) < 5 then session_id end) as total from Sessions s union all select '[5-10>' as bin, count(case when (duration/60) >= 5 and (duration/60) < 10 then session_id end) as total from Sessions s union all select '[10-15>' as bin, count(case when (duration/60) >= 10 and (duration/60) < 15 then session_id end) as total from Sessions s union all select '15 or more' as bin, count(case when (duration/60) >= 15 then session_id end) as total from Sessions s
select '[0-5>' as bin, count(case when duration < 300 then 1 else null end) as total from sessions union select '[5-10>' as bin, count(case when duration >= 300 and duration < 600 then 1 else null end) as total from sessions union select '[10-15>' as bin, count(case when duration >= 600 and duration < 900 then 1 else null end) as total from sessions union select '15 or more' as bin, count(case when duration >= 900 then 1 else null end) as total from sessions
select '[0-5>' as bin, count(case when duration <300 then session_id end) as total from Sessions union all select '[5-10>' as bin, count(case when duration >=300 and duration<600 then session_id end) as total from Sessions union all select '[10-15>' as bin, count(case when duration >=600 and duration<900 then session_id end) as total from Sessions union all select '15 or more' as bin, count(case when duration >=900 then session_id end) as total from Sessions
select '[0-5>' as bin, count(case when duration/60 < 5 and duration/60 >=0 then session_id end) as total from Sessions union select '[5-10>' as bin, count(case when duration/60 < 10 and duration/60 >=5 then session_id end) as total from Sessions union select '[10-15>' as bin, count(case when duration/60 < 15 and duration/60 >=10 then session_id end) as total from Sessions union select '15 or more' as bin, count(case when duration/60 >=15 then session_id end) as total from Sessions
select '[0-5>' as bin, count(case when duration/60 >=0 and duration/60<5 then session_id end) total from Sessions union select '[5-10>' as bin, count(case when duration/60 >=5 and duration/60<10 then session_id end) total from Sessions union select '[10-15>' as bin , count(case when duration/60 >=10 and duration/60<15 then session_id end) total from Sessions union select '15 or more' as bin , count(case when duration/60 >=15 then session_id end) total from Sessions
select '[0-5>' as bin, count(case when duration/60<5 and duration/60>=0 then session_id end) as 'total' from Sessions union all select '[5-10>' as bin, count(case when duration/60>=5 and duration/60<10 then session_id end) as 'total' from Sessions union all select '[10-15>' as bin, count(case when duration/60>=10 and duration/60<15 then session_id end)as 'total' from Sessions union all select '15 or more' as bin, count(case when duration/60>=15 then session_id end)as 'total' from Sessions
select '[0-5>' as bin, count(case when duration>=0 and duration <300 then 1 end) as total from Sessions union select '[5-10>' as bin, count(case when duration>=301 and duration <600 then 1 end) as total from Sessions union select '[10-15>' as bin, count(case when duration>=601 and duration <900 then 1 end) as total from Sessions union select '15 or more' as bin, count(case when duration>=901 then 1 end) as total from Sessions
select '[0-5>' as bin, count(if(duration < 300,1,null)) as total from sessions union select '[5-10>' as bin, count(if(duration >= 300 and duration < 600,1,null)) as total from sessions union select '[10-15>' as bin, count(if(duration >= 600 and duration < 900,1,null)) as total from sessions union select '15 or more' as bin, count(if(duration >= 900,1,null)) as total from sessions
select '[0-5>' as bin, count(session_id) as total from sessions where duration < 300 UNION select '[5-10>' as bin, count(session_id) as total from sessions where duration >= 300 and duration < 600 UNION select '[10-15>' as bin, count(session_id) as total from sessions where duration >= 600 and duration < 900 UNION select '15 or more' as bin, count(session_id) as total from sessions where duration >= 900
select '[0-5>' as bin, count(session_id) as total from sessions where duration <300 UNION select '[5-10>' as bin, count(session_id) as total from sessions where duration >=300 and duration <600 UNION select '[10-15>' as bin, count(session_id) as total from sessions where duration >=600 and duration <900 UNION select '15 or more' as bin, count(session_id) as total from sessions where duration >=900
select '[0-5>' as bin, sum(case when duration < 300 then 1 else 0 end ) as total from sessions union select '[5-10>' as bin, sum(case when duration >= 300 and duration < 600 then 1 else 0 end ) as total from sessions union select '[10-15>' as bin, sum(case when duration >= 600 and duration < 900 then 1 else 0 end ) as total from sessions union select '15 or more' as bin, sum(case when duration >= 900 then 1 else 0 end ) as total from sessions
select '[0-5>' as bin, sum(case when duration < 300 then 1 else 0 end) as total from sessions union all select '[5-10>' as bin, sum(case when duration < 600 and duration >= 300 then 1 else 0 end) as total from sessions union all select '[10-15>' as bin, sum(case when duration < 900 and duration >= 600 then 1 else 0 end) as total from sessions union all select '15 or more' as bin, sum(case when duration >= 900 then 1 else 0 end) as total from sessions
select '[0-5>' as bin, sum(case when duration <= 300 and duration > 0 then 1 else 0 end) as total from sessions union select '[5-10>' as bin, sum(case when duration <= 600 and duration > 300 then 1 else 0 end) as total from sessions union select '[10-15>' as bin, sum(case when duration <= 900 and duration > 600 then 1 else 0 end) as total from sessions union select '15 or more' as bin, sum(case when duration > 900 then 1 else 0 end) as total from sessions
select '[0-5>' as bin, sum(case when duration/60 >=0 and duration/60 < 5 then 1 else 0 end) as total from Sessions union select '[5-10>' as bin, sum(case when duration/60 >=5 and duration/60 < 10 then 1 else 0 end) as total from Sessions union select '[10-15>' as bin, sum(case when duration/60 >=10 and duration/60 < 15 then 1 else 0 end) as total from Sessions union select '15 or more' as bin, sum(case when duration/60 >=15 then 1 else 0 end) as total from Sessions
select '[0-5>' as bin, sum(duration/60 < 5) as total from Sessions union select '[5-10>' as bin, sum(duration/60 >= 5 and duration/60 < 10) as total from Sessions union select '[10-15>' as bin, sum(duration/60 >= 10 and duration/60 < 15) as total from Sessions union select '15 or more' as bin, sum(duration/60 >= 15) as total from Sessions
select '[0-5>' as bin, sum(duration/60<5) as 'total' from Sessions Union select '[5-10>' as bin, sum(duration/60 >=5 and duration/60<10) as 'total' from Sessions Union select '[10-15>' as bin, sum(duration/60>=10 and duration/60<15) as 'total' from Sessions Union select '15 or more' as bin, sum(duration/60>=15) as 'total' from Sessions
select '[0-5>' as bin, sum(if(duration<300 and duration>=0,1,0)) as total from sessions union select '[5-10>' as bin, sum(if(duration<600 and duration>=300,1,0)) as total from sessions union select '[10-15>' as bin, sum(if(duration<900 and duration>=600,1,0)) as total from sessions union select '15 or more' as bin, sum(if(duration>=900,1,0)) as total from sessions
select '[0-5>' as bin,count(*) as total from sessions where duration / 60 >= 0 and duration / 60 < 5 union select '[5-10>' as bin, count(*) as total from sessions where duration / 60 >= 5 and duration / 60 < 10 union select '[10-15>' as bin,count(*) as total from sessions where duration / 60 >= 10 and duration / 60 < 15 union select '15 or more' as bin,count(*) as total from sessions where duration / 60 >= 15
select '[0-5>' as bin,count(*) total from sessions where duration <5*60 union select '[5-10>' as bin,count(*) total from sessions where duration >=5*60 and duration <=10*60 union select '[10-15>' as bin,count(*) total from sessions where duration >=10*60 and duration <=15*60 union select '15 or more' as bin,count(*) total from sessions where duration >=15*60
select '[0-5>' as bin,count(case when duration/60 < 5 and duration/60 >= 0 then 1 end) as total from Sessions union select '[5-10>' as bin,count(case when duration/60 < 10 and duration/60 >= 5 then 1 end) as total from Sessions union select '[10-15>' as bin,count(case when duration/60 < 15 and duration/60 >= 10 then 1 end) as total from Sessions union select '15 or more' as bin,count(case when duration/60 >= 15 then 1 end) as total from Sessions
select '[0-5>' bin, COUNT(IF(duration < 300, 1, null)) total from Sessions union select '[5-10>' bin, count(if (duration >= 300 and duration < 600, 1, null)) total from Sessions union select '[10-15>' bin, count(if (duration >= 600 and duration < 900, 1, null)) total from Sessions union select '15 or more' bin, count(if (duration > 900, 1, null)) total from Sessions
select '[0-5>' bin, sum(case when duration/60 between 0 and 5 then 1 else 0 end) total from Sessions union select '[5-10>' bin, sum(case when duration/60 between 5 and 10 then 1 else 0 end) total from Sessions union select '[10-15>' bin, sum(case when duration/60 between 10 and 15 then 1 else 0 end) total from Sessions union select '15 or more' bin, sum(case when duration/60 >=15 then 1 else 0 end) total from Sessions
select A.bin ,ifnull(B.total,0) as total from( select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as boin ) A left join( select case when duration >=0 and duration < 5*60 then '[0-5>' when duration >=5*60 and duration < 10*60 then '[5-10>' when duration >=10*60 and duration < 15*60 then '[10-15>' else '15 or more' end as bin ,count(session_id) as total from Sessions group by bin ) B on A.bin = B.bin
select T2.bin, ifnull(T1.total,0) as total from (select case when duration/60 >= 15 then '15 or more' when duration/60 >=10 and duration/60 < 15 then '[10-15>' when duration/60 >=5 and duration/60 < 10 then '[5-10>' when duration/60 >=0 and duration/60 < 5 then '[0-5>' end as bin ,count(session_id) as total from Sessions group by bin) T1 right join ( select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin ) T2 on T1.bin=T2.bin
select T_top.bin, ifnull(T2.total,0) as total from ( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) as T_top left join ( select T.bin, ifnull(count(*),0) as total from ( select session_id, case when duration/60 >= 0 and duration/60 < 5 then "[0-5>" when duration/60 >= 5 and duration/60 < 10 then "[5-10>" when duration/60 >= 10 and duration/60 < 15 then "[10-15>" else "15 or more" end as bin from Sessions ) as T group by T.bin ) as T2 on T_top.bin = T2.bin
select X.bin, coalesce(tot,0) as total from (select "[0-5>" as bin from sessions union select "[5-10>" as bin from sessions union select "[10-15>" as bin from sessions union select "15 or more" as bin from sessions) as X left join (select case when duration>0 and duration<300 then "[0-5>" when duration>=300 and duration<600 then "[5-10>" when duration>=600 and duration<900 then "[10-15>" else "15 or more" end as bin, count(*) as tot from sessions group by bin) as Y on X.bin = Y.bin
select a.bin as BIN, ifnull(count(session_id),0) as TOTAL from (select session_id, case when duration/60 >=0 and duration/60 <5 then '[0-5>' when duration/60 between 5 and 10 then '[5-10>' when duration/60 between 10 and 15 then '[10-15>' else '15 or more' end as bin from sessions) sq right join ( select bin from (select '[0-5>' as bin union all select '[5-10>' as bin union all select '[10-15>' as bin union all select '15 or more' as bin) d ) a on a.bin = sq.bin group by a.bin
select a.bin, coalesce(b.total,0) as total from (Select '[0-5>' as bin union select '[5-10>' union select '[10-15>' union select '15 or more') a left join (select case when duration < 5*60 then '[0-5>' when duration >=5*60 and duration<10*60 then '[5-10>' when duration >=10*60 and duration<15*60 then '[10-15>' else '15 or more' end bin, count(*) total from sessions group by 1)b on a.bin = b.bin
select a.bin, coalesce(b.total,0) total from ( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) a left join (select a.bin, count(*) as total from (select (case when duration/60<5 then '[0-5>' when duration/60<10 then '[5-10>' when duration/60<15 then '[10-15>' else '15 or more' end) bin, session_id from Sessions) a group by bin) b on a.bin=b.bin
select a.bin, ifnull(total,0) as total from (select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin) as a left join (select case when (duration/60)<5 then '[0-5>' when (duration/60)<10 then '[5-10>' when (duration/60)<15 then '[10-15>' else '15 or more' end as bin, count(1) as total from Sessions group by case when (duration/60)<5 then '[0-5>' when (duration/60)<10 then '[5-10>' when (duration/60)<15 then '[10-15>' else '15 or more' end) as b on a.bin=b.bin
select b.bin, coalesce(t.total,0) as total from (select '[0-5>' as bin union all select '[5-10>' as bin union all select '[10-15>' as bin union all select '15 or more') b left join (select bin, count(bin) as total from (select case when duration/60 <5 then '[0-5>' when duration/60 >= 5 and duration/60 <10 then '[5-10>' when duration/60 >= 10 and duration/60 <15 then '[10-15>' else '15 or more' end as bin from Sessions ) bt group by bin) t on b.bin = t.bin
select b.bin, count(a.session_id) as total from (select session_id, case when duration/60 < 5 then '[0-5>' when 5 <= duration/60 and duration/60 < 10 then '[5-10>' when 10 <= duration/60 and duration/60 < 15 then '[10-15>' else '15 or more' end as bin from Sessions) as a RIGHT JOIN (SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin) as b ON a.bin = b.bin group by b.bin
select b.bin, count(distinct session_id) as total from Sessions s right join (select "[0-5>" as bin, "0" as begin, "300" as finish union all select "[5-10>" as bin, "300" as begin, "600" as finish union all select "[10-15>" as bin, "600" as begin, "900" as finish union all select "15 or more" as bin, "900" as begin, "10000000000" as finish) as b on s.duration >= b.begin and s.duration < b.finish group by b.bin
select b.bin, count(s.bin) total from (select case when duration/60 < 5 then '[0-5>' when duration/60 < 10 then '[5-10>' when duration/60 < 15 then '[10-15>' else '15 or more' end as bin from sessions) s right join ( select '[0-5>' bin union select '[5-10>' bin union select '[10-15>' bin union select '15 or more' bin ) b using(bin) group by b.bin
select b.bin, ifnull(total,0) total from (select case when duration/60 >= 0 and duration/60 < 5 then '[0-5>' when duration/60 >= 5 and duration/60 < 10 then '[5-10>' when duration/60 >= 10 and duration/60 < 15 then '[10-15>' else '15 or more' end bin, count(distinct session_id) total from Sessions group by bin) a right join ( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin) b on a.bin = b.bin
select bins.bin as BIN, coalesce(total, 0) as TOTAL from( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) as bins LEFT JOIN (SELECT bin, COUNT(bin) as total FROM ( SELECT CASE WHEN duration<300 THEN "[0-5>" WHEN duration>=300 and duration<600 THEN "[5-10>" WHEN duration>=600 and duration<900 THEN "[10-15>" WHEN duration>=900 THEN "15 or more" END AS bin FROM Sessions ) as A GROUP BY bin) as trans ON bins.bin = trans.bin
select bins.bin as bin, coalesce(total, 0) as total from( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) as bins LEFT JOIN (SELECT bin, COUNT(bin) as total FROM ( SELECT CASE WHEN duration<300 THEN "[0-5>" WHEN duration>=300 and duration<600 THEN "[5-10>" WHEN duration>=600 and duration<900 THEN "[10-15>" WHEN duration>=900 THEN "15 or more" END AS bin FROM Sessions ) as A GROUP BY bin) as trans ON bins.bin = trans.bin
select bins.bin as bin, coalesce(total, 0) as total from( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) as bins LEFT JOIN (SELECT bin, COUNT(bin) as total FROM ( SELECT CASE WHEN duration<5*60 THEN "[0-5>" WHEN duration>=5*60 and duration<10*60 THEN "[5-10>" WHEN duration>=10*60 and duration<15*60 THEN "[10-15>" WHEN duration>=15*60 THEN "15 or more" END AS bin FROM Sessions ) as A GROUP BY bin) as trans ON bins.bin = trans.bin
select t2.bin, count(t1.bin) as total from (select case when duration/60 between 0 and 5 then '[0-5>' when duration/60 between 5 and 10 then '[5-10>' when duration/60 between 10 and 15 then '[10-15>' else '15 or more' end as bin from Sessions) t1 right join (select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin ) t2 on t1.bin = t2.bin group by t2.bin
select tab2.bin, ifnull(count(tab1.session_id),0)as total from (select session_id, duration, case when duration<300 then '[0-5>' when duration<600 and duration >=300 then '[5-10>' when duration<900 and duration >=600 then '[10-15>' else '15 or more' end as bin from Sessions) as tab1 right join (SELECT '[0-5>' AS bin UNION ALL SELECT '[5-10>' AS bin UNION ALL SELECT '[10-15>' AS bin UNION ALL SELECT '15 or more' AS bin) as tab2 on tab2.bin=tab1.bin group by 1
select temp.bin, count(x.session_id) as total from (select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin) as temp left join (select session_id, duration, case when duration/60 < 5 then '[0-5>' when (5 <= duration/60 and duration/60 < 10) then '[5-10>' when (10 <= duration/60 and duration/60 < 15) then '[10-15>' else '15 or more' end as bin from sessions) as x on temp.bin = x.bin group by temp.bin
select x.bin, ifnull(y.total,0) as total from(select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin) x left join (select bin, ifnull(count(distinct session_id),0) as total from(select session_id, case when duration/60 >= 0 and duration/60 < 5 then '[0-5>' when duration/60 >= 5 and duration/60 < 10 then '[5-10>' when duration/60 >= 10 and duration/60 < 15 then '[10-15>' when duration/60 >= 15 then '15 or more' end as bin from Sessions)x group by 1) y on x.bin = y.bin
select x.bins as bin, coalesce(sum(total), 0) as total from (select "[0-5>" as bins union all select "[5-10>" as bins union all select "[10-15>" as bins union all select "15 or more" as bins) x left join (select bins, count(*) as total from (select case when duration < 300 then "[0-5>" when duration < 600 then "[5-10>" when duration < 900 then "[10-15>" when duration >= 900 then "15 or more" else 0 end as bins from sessions) y group by 1) z on x.bins = z.bins group by 1
with CTE as ( select session_id, round(duration/60,2) as minutes from Sessions) (select '[0-5>' as BIN, sum(case when minutes >=0 and minutes<5 then 1 else 0 end) as TOTAL from CTE) UNION (select '[5-10>' as BIN, sum(case when minutes >= 5 and minutes<10 then 1 else 0 end) as TOTAL from CTE) UNION (select '[10-15>' as BIN, sum(case when minutes >=10 and minutes <15 then 1 else 0 end) as TOTAL from CTE) UNION (select '15 or more' as BIN, sum(case when minutes >=15 then 1 else 0 end) as TOTAL from CTE)
with CTE1 as ( select session_id, CASE WHEN duration/60>= 0 and duration/60<5 then '[0-5>' WHEN duration/60>= 5 and duration/60<10 then '[5-10>' WHEN duration/60>=10 and duration/60<15 then '[10-15>' else '15 or more' end as bin from Sessions), CTE2 as ( select '[0-5>' as Bin Union All select '[5-10>' as Bin Union All select '[10-15>' as Bin Union All select '15 or more' as Bin ) Select B.bin as BIN, Coalesce(count(session_id),0) as Total from CTE1 A Right Join CTE2 B on A.Bin=B.bin group by B.Bin
with b as(select '[0-5>' as bin union select'[5-10>' as bin union select'[10-15>'as bin union select'15 or more'as bin) select b.bin, count(session_id) total from (select session_id,(case when duration/60<5 then '[0-5>' when duration/60>=5 and duration/60<10 then '[5-10>' when duration/60>=10 and duration/60<15 then '[10-15>' when duration/60>=15 then '15 or more' end) bin from Sessions) s right join b using(bin) group by b.bin
with binned_sessions as ( select *, case when duration < 300 then '[0-5>' when duration < 600 then '[5-10>' when duration < 900 then '[10-15>' else '15 or more' end as bin from Sessions ), all_bins as ( select * from ( select '[0-5>' as bin union all select '[5-10>' union all select '[10-15>' union all select '15 or more' ) as a ), bin_counts as ( select bin, count(*) as total from binned_sessions group by bin ) select a.bin, coalesce(b.total, 0) as total from all_bins as a left join bin_counts as b on a.bin = b.bin
with bins as ( SELECT '[0-5>' AS bin UNION ALL Select '[5-10>' AS bin UNION ALL Select '[10-15>' AS bin UNION ALL Select '15 or more' AS bin ), grouped as ( Select bin,count(session_id) as total from( Select session_id, case when (duration/60) <5 then "[0-5>" when (duration/60)<10 then "[5-10>" when (duration/60)<15 then "[10-15>" when (duration/60)>=15 then "15 or more" end as bin from Sessions) t group by bin ) Select bins.bin as BIN,IFNULL(grouped.total,0) as TOTAL from bins left join grouped on bins.bin=grouped.bin
with bins as( select '[0-5>' as bin, 0 as min,5 as max,1 as od union all select '15 or more' as bin, 15 as min,null as max,4 as od union all select '[5-10>' as bin, 5 as min,10 as max,2 as od union all select '[10-15>' as bin, 10 as min,15 as max,3 as od ) select bin as BIN,count(session_id) as TOTAL from bins b left join sessions s on s.duration/60.0 >= b.min and ( b.max is null or s.duration/60.0 < b.max ) group by 1 order by od
with cte as ( SELECT '[0-5>' as bin union all SELECT '[5-10>' union all SELECT '[10-15>' union all SELECT '15 or more' ) select cte.bin, IFNULL(a.total,0) as total FROM(select (case when duration < 300 then '[0-5>' when duration >=300 and duration < 600 then '[5-10>' when duration >=600 and duration < 900 then '[10-15>' else '15 or more' end) BIN, count(session_id) as TOTAL from Sessions group by 1) a right join cte using (bin)
with cte as ( select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin) select a.bin, ifnull(total,0) as total from cte as a left join ( select case when duration/60 < 5 then '[0-5>' when duration/60 < 10 then '[5-10>' when duration/60 < 15 then '[10-15>' else '15 or more' end as bin, count(distinct session_id) as total from sessions group by 1 ) as b on a.bin = b.bin group by 1
with cte as ( select session_id , case when duration>=0*60 and duration<5*60 then '[0-5>' when duration>=5*60 and duration<10*60 then '[5-10>' when duration>=10*60 and duration<15*60 then '[10-15>' when duration>=15*60 then '15 or more' end as bin from Sessions), cte2 as ( select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin ) select c2.bin , coalesce(count(c.session_id),0) as total from cte2 c2 left join cte c on c2.bin=c.bin group by 1
with cte as ( select session_id, case when duration between 0 and 5*60 then "[0-5>" when duration between 5*60+1 and 10*60 then "[5-10>" when duration between 601 and 15* 60 then "[10-15>" else "15 or more" end as bin from Sessions) , bins as ( select "[0-5>" as bin union select "[5-10>" as bin union select "[10-15>" as bin union select "15 or more" as bin ) , summary as ( select bin, count( session_id) as total from cte group by 1) select b. bin as BIN, ifnull(total,0) as TOTAL from bins b left join summary s on b.bin = s.bin
with cte as (select session_id, ( case when (duration/60) <5 then '[0-5>' when (duration/60) <10 then '[5-10>' when (duration/60) <15 then '[10-15>' when (duration/60) >=15 then '15 or more' end ) as bin from Sessions), cte2 as( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ) select cte2.bin, count(session_id) as total from cte2 LEFT JOIN cte using(bin) group by 1
with cte as( select '[0-5>' as bin, 0 as min_duration, 5*60 as max_duration union all select '[5-10>' as bin, 5*60 as min_duration, 10*60 as max_duration union all select '[10-15>' as bin, 10*60 as min_duration, 15*60 as max_duration union all select '15 or more' as bin, 15*60 as min_duration, 2147483647 as max_duration ) select cte.bin, count(session_id) as total from Sessions right join cte on Sessions.duration >= min_duration and Sessions.duration < max_duration group by cte.bin
with cte1 as ( select session_id, case when duration/60 < 5 then '[0-5>' when duration/60 <10 then '[5-10>' when duration/60 <15 then '[10-15>' else '15 or more' end as bin from sessions), cte2 as( select '[0-5>' as bin union select '[5-10>' union select '[10-15>' union select '15 or more') select cte2.bin, ifnull (count(cte1.session_id),0) as total from cte2 left join cte1 on cte2.bin = cte1.bin group by 1
with cte1 as (select '[0-5>' as Bin Union All select '[5-10>' as Bin Union All select '[10-15>' as Bin Union All select '15 or more' as Bin), cte2 as (select session_id, case when duration/60>=0 and duration/60 <5 then '[0-5>' WHEN duration/60>= 5 and duration/60<10 then '[5-10>' WHEN duration/60>=10 and duration/60<15 then '[10-15>' else '15 or more' end as bin from Sessions) select distinct A.bin, ifnull(count(session_id),0) as "total" from cte1 A left join cte2 B on A.Bin=B.bin group by A.bin
with cte1 as (select '[0-5>' as Bin Union select '[5-10>' as Bin Union All select '[10-15>' as Bin Union All select '15 or more' as Bin), cte2 as (select session_id, case when duration/60>=0 and duration/60 <5 then '[0-5>' WHEN duration/60>= 5 and duration/60<10 then '[5-10>' WHEN duration/60>=10 and duration/60<15 then '[10-15>' else '15 or more' end as bin from Sessions) select distinct A.bin, ifnull(count(session_id),0) as "total" from cte1 A left join cte2 B on A.Bin=B.bin group by A.bin
with cte1 as( select session_id, case when duration < 300 then '[0-5>' when duration >=300 and duration < 600 then '[5-10>' when duration >= 600 and duration < 900 then '[10-15>' when duration >= 900 then '15 or more' end as bin from sessions group by session_id ) ,cte2 as(select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin) select cte2.bin as bin, ifnull(count(cte1.session_id),0) as total from cte2 left join cte1 on cte2.bin = cte1.bin group by cte2.bin
with cte_bins as ( select "[0-5>" as bin union all select "[5-10>" as bin union all select "[10-15>" as bin union all select "15 or more" as bin ), cte_join_agg as ( select b.bin, count(session_id) as total from cte_bins as b left join Sessions as s on b.bin = ( case when duration/60 >= 0 and duration/60 < 5 then "[0-5>" when duration/60 >= 5 and duration/60 < 10 then "[5-10>" when duration/60 >= 10 and duration/60 < 15 then "[10-15>" else "15 or more" end ) group by 1 ) select * from cte_join_agg
with cte_bins as ( select '[0-5>' as bin union select '[5-10>' union select '[10-15>' union select '15 or more'), cte_join as (select session_id, case when duration between 0 and 300 then '[0-5>' when duration between 300 and 600 then '[5-10>' when duration between 600 and 900 then '[10-15>' when duration between 600 and 900 then '[10-15>' when duration > 900 then '15 or more' else 0 end as bin from sessions) select cb.bin, coalesce(count(session_id),0) as total from cte_bins cb left join cte_join cj on cb.bin = cj.bin group by cb.bin
with ind as (select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin), base as (select bin, count(distinct session_id) as total from (select session_id, case when duration>=0 and duration <5*60 then '[0-5>' when duration<10*60 then '[5-10>' when duration<15*60 then '[10-15>' else '15 or more' end as bin from sessions) a group by 1) select i.bin, ifnull(b.total,0) as total from ind i left join base b on i.bin = b.bin
with sesstable as( select "[0-5>" as bin union select "[5-10>" as bin union select "[10-15>" as bin union select "15 or more" as bin ) select s.bin,count(d.session_id) as total from sesstable as s left join ( select session_id, case when duration/60<5 then "[0-5>" when duration/60<10 then "[5-10>" when duration/60<15 then "[10-15>" else "15 or more" end as binname from sessions )d on s.bin=d.binname group by s.bin
with t as ( select "[0-5>" as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin) select t.*, coalesce(k.TOTAL,0) as TOTAL from t left join ( select case when (duration/60) <5 then '[0-5>' when (duration/60 >=5 and duration/60<10) then '[5-10>' when (duration/60 >=10 and duration/60<15) then '[10-15>' when (duration/60 >=15) then '15 or more' end as BIN, coalesce (count(session_id),0) as TOTAL from Sessions group by bin) k on t.bin=k.bin
with t as (select '[0-5>' as bin union all select '[5-10>' union all select '[10-15>' union all select '15 or more') select t.bin, count(s.session_id) as total from (select session_id, case when duration/60<5 and duration/60>=0 then '[0-5>' when duration/60<10 and duration/60>=5 then '[5-10>' when duration/60<15 and duration/60>=10 then '[10-15>' else '15 or more' end as 'bin' from Sessions) s right join t on s.bin=t.bin group by 1
with t as (select *, case when (duration)>= 0 and (duration) < 300 then '[0-5>' when (duration) >= 300 and (duration) < 600 then '[5-10>' when (duration)>= 600 and (duration)<= 900 then '[10-15>' else '15 or more' end as bin from sessions), t2 as (select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin ) select t2.bin, coalesce(z.cnt,0) as total from t2 left join (select t.bin, count(t.session_id) as cnt from t group by t.bin) z on t2.bin= z.bin
with temp as ( select (case when duration < 300 then '[0-5>' when duration between 0 and 599 then '[5-10>' when duration between 0 and 899 then '[10-15>' else '15 or more' end) bin, count(*) as total from sessions group by 1), temp2 as ( select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin) select t2.bin, ifnull(t.total,0) as total from temp2 t2 left join temp t on t2.bin=t.bin
with temp1 as ( select *, case when duration/60<5 then "[0-5>" when duration/60<10 then "[5-10>" when duration/60<15 then "[10-15>" else "15 or more" end as bin from sessions ), temp2 as ( select "[0-5>" as bin union select "[5-10>" as bin union select "[10-15>" as bin union select "15 or more" as bin ) select bin, ifnull(count(session_id),0) as total from temp2 left join temp1 using (bin) group by temp2.bin
with tmp as (select '[0-5>' as bin union select '[5-10>' as bin union select '[10-15>' as bin union select '15 or more' as bin) select a.bin, ifnull(total,0) as total from tmp a left join ( select case when duration/60>=0 and duration/60<5 then '[0-5>' when duration/60>=5 and duration/60<10 then '[5-10>' when duration/60>=10 and duration/60<15 then '[10-15>' when duration/60>=15 then '15 or more' end as bin, count(session_id) as total from sessions group by 1) b on a.bin=b.bin
with tmp as (select (case when duration < 300 then '[0-5>' when duration < 600 then '[5-10>' when duration < 900 then '[10-15>' else '15 or more' end) as bin from sessions), tmp1 as (select bin, count(*) as total from tmp group by bin), tmp2 as ((select '[0-5>' as bin) union (select '[5-10>' as bin) union (select '[10-15>' as bin) union (select '15 or more' as bin)) select a.bin, ifnull(total, 0) as total from tmp2 a left join tmp1 b on a.bin = b.bin
with tmp as (select session_id, case when duration between 0 and 299 then "[0-5>" when duration between 300 and 599 then "[5-10>" when duration between 600 and 899 then "[10-15>" else "15 or more" end bin from sessions ), tmp1 as (select "[0-5>" as bin union select "[5-10>" as bin union select "[10-15>" as bin union select "15 or more" as bin ) select tmp1.bin BIN, coalesce(count(session_id),0) TOTAL from tmp right join tmp1 on tmp.bin = tmp1.bin group by tmp1.bin
