SELECT A.user id, COUNT(A.friend) num FROM (SELECT requester_id user, accepter_id AS friend FROM request_accepted UNION ALL SELECT accepter_id user, requester_id AS friend FROM request_accepted ) A GROUP BY A.user ORDER BY num DESC LIMIT 1
SELECT Sub.id, SUM(Sub.num) as num FROM ( SELECT requester_id AS id, COUNT(requester_id) AS num FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS id, COUNT(accepter_id) AS num FROM request_accepted GROUP BY accepter_id ) Sub GROUP BY Sub.id ORDER BY num DESC LIMIT 1
SELECT a.id,a.num FROM (SELECT col AS id, count(col) AS num, rank() over (ORDER BY count(col) desc)r FROM (SELECT requester_id AS col FROM request_accepted UNION ALL SELECT accepter_id AS col FROM request_accepted)x GROUP BY col)a WHERE a.r=1
SELECT a.ids as id, sum(a.number) as num FROM ( SELECT requester_id AS ids , count(1) as number FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS ids , count(1) as number FROM request_accepted GROUP BY accepter_id ) a GROUP BY ids ORDER BY sum(number) DESC Limit 1
SELECT a.requester_id AS id, (a.accecpted + CASE WHEN b.requested IS NULL THEN 0 ELSE b.requested END) as num FROM (SELECT requester_id, count(distinct accepter_id) as accecpted FROM request_accepted GROUP BY requester_id) a LEFT JOIN (SELECT accepter_id, count(distinct requester_id) as requested FROM request_accepted GROUP BY accepter_id) b ON a.requester_id = b.accepter_id ORDER BY num desc limit 1
SELECT a.requester_id AS id, COUNT(*) AS num FROM( (SELECT t1.requester_id, t1.accepter_id FROM request_accepted t1) UNION ALL (SELECT t2.accepter_id, t2.requester_id FROM request_accepted t2)) a GROUP BY a.requester_id ORDER BY num DESC LIMIT 1
SELECT a.requester_id id, (SELECT COUNT(1) FROM request_accepted b WHERE b.requester_id = a.requester_id or b.accepter_id = a.requester_id) num FROM request_accepted a ORDER BY num DESC LIMIT 1
SELECT c.id, COUNT(c.id) AS num FROM (SELECT a.requester_id as id FROM request_accepted a UNION ALL SELECT b.accepter_id as id FROM request_accepted b ) c GROUP BY id ORDER BY COUNT(c.id) DESC LIMIT 1
SELECT friend_counts.id, SUM(friend_counts.num) AS num FROM ( SELECT requester_id AS id, COUNT(*) AS num FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS id, COUNT(*) AS num FROM request_accepted GROUP BY accepter_id ) AS friend_counts GROUP BY friend_counts.id ORDER BY num DESC LIMIT 1
SELECT id , COUNT(DISTINCT id2) AS num FROM ( SELECT requester_id AS id, accepter_id AS id2 from request_accepted UNION SELECT accepter_id AS id, requester_id AS id2 from request_accepted ) A GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, COUNT(*) AS num FROM ( SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id as id from request_accepted ) AS friends GROUP BY 1 ORDER BY 2 DESC LIMIT 1
SELECT id, COUNT(*) As num FROM ( SELECT requester_id As id FROM request_accepted UNION ALL SELECT accepter_id As id FROM request_accepted ) As t GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, COUNT(*) num FROM( SELECT requester_id id FROM request_accepted UNION ALL SELECT accepter_id id FROM request_accepted ) t GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, COUNT(DISTINCT id2) AS num FROM ( SELECT requester_id AS id, accepter_id AS id2 FROM request_accepted UNION SELECT accepter_id AS id, requester_id AS id2 FROM request_accepted ) t GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, COUNT(id) AS num FROM ( SELECT accepter_id AS id FROM request_accepted UNION ALL SELECT requester_id AS id FROM request_accepted ) AS temp1 GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, COUNT(id) as num FROM ( select requester_id as id, accepter_id as id2 from request_accepted union all select accepter_id as id, requester_id as id2 from request_accepted) tmp GROUP BY 1 ORDER BY 2 DESC LIMIT 1
SELECT id, COUNT(id) num FROM ( SELECT requester_id as id FROM request_accepted UNION ALL SELECT accepter_id as id FROM request_accepted ) t GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, SUM(cnt) AS num FROM (SELECT requester_id AS id, COUNT(*) AS cnt FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS id, COUNT(*) AS cbt FROM request_accepted GROUP BY accepter_id) AS A GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, SUM(counts) AS num FROM ( SELECT requester_id AS id, COUNT(DISTINCT accepter_id) as counts FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS id, COUNT(DISTINCT requester_id) as counts FROM request_accepted GROUP BY accepter_id ) AS T GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, SUM(num) AS num FROM ( SELECT requester_id AS id, COUNT(*) AS num FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS id, COUNT(*) AS num FROM request_accepted GROUP BY accepter_id ) AS combined_acceps GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, count(*) AS num FROM (SELECT a.requester_id AS id FROM request_accepted a UNION ALL SELECT b.accepter_id AS id FROM request_accepted b) table1 GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, count(1) as num from ( SELECT requester_id as id from request_accepted UNION ALL SELECT accepter_id as id from request_accepted ) temp group by id ORDER BY 2 desc LIMIT 1
SELECT id, count(distinct friend_id) AS num FROM( SELECT requester_id AS id, accepter_id AS friend_id FROM request_accepted UNION SELECT accepter_id AS id, requester_id AS friend_id FROM request_accepted) t GROUP BY 1 ORDER BY 2 desc LIMIT 1
SELECT id, count(friend_id) as num FROM ( SELECT requester_id as id, accepter_id as friend_id from request_accepted UNION ALL SELECT accepter_id as id, requester_id as friend_id from request_accepted) f GROUP BY id ORDER BY num desc limit 1
SELECT id, count(id) as num FROM ( SELECT requester_id id FROM ( SELECT distinct requester_id, accepter_id FROM request_accepted) a UNION ALL SELECT accepter_id id FROM ( SELECT distinct requester_id, accepter_id FROM request_accepted) a )b GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id, cts as num from ( select id, count(*) as cts FROM ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) a group by id ) b order by cts desc limit 1
SELECT id, num from ( SELECT id, COUNT(id) as num, rank() over (order by COUNT(id) desc) as ranking FROM ( SELECT requester_id as id FROM request_accepted UNION ALL SELECT accepter_id as id FROM request_accepted ) asd GROUP BY id ) asdf where ranking = 1
SELECT id, sum(Friends) AS num FROM (SELECT Requester_id AS id, COUNT(*) AS Friends FROM request_accepted GROUP BY Requester_id UNION ALL SELECT Accepter_id AS id, COUNT(*) AS Friends FROM request_accepted GROUP BY Accepter_id) A GROUP BY id ORDER BY sum(friends) DESC LIMIT 1
SELECT id,COUNT(ID) AS num FROM (SELECT requester_id AS ID FROM request_accepted UNION ALL SELECT accepter_id AS ID FROM request_accepted) T GROUP BY ID ORDER BY 2 DESC LIMIT 1
SELECT id,count(*) as num FROM ( SELECT requester_id as id FROM request_accepted UNION ALL SELECT accepter_id as id FROM request_accepted ) a GROUP BY 1 ORDER BY 2 DESC LIMIT 1
SELECT id,count(fid) as num FROM ( SELECT requester_id as id,accepter_id as fid FROM request_accepted UNION SELECT accepter_id as id,requester_id as fid FROM request_accepted ) fl GROUP BY id ORDER BY num DESC LIMIT 1
SELECT id1 id, COUNT(id2) num FROM ( SELECT requester_id AS id1, accepter_id AS id2 FROM request_accepted UNION SELECT accepter_id AS id1, requester_id AS id2 FROM request_accepted ) tmp GROUP BY id1 ORDER BY COUNT(id2) DESC LIMIT 1
SELECT p_id AS id, SUM(p_count) AS num FROM (SELECT requester_id AS p_id, COUNT(accepter_id) AS p_count FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS p_id, COUNT(requester_id) AS p_count FROM request_accepted GROUP BY accepter_id) AS friends GROUP BY p_id ORDER BY num DESC LIMIT 1
SELECT person as id, COUNT(*) AS num FROM ( (SELECT requester_id AS person FROM request_accepted) UNION ALL (SELECT accepter_id AS person FROM request_accepted) ) AS Z GROUP BY person ORDER BY num DESC LIMIT 1
SELECT requester_id AS id, COUNT(DISTINCT(accepter_id)) AS num FROM ( SELECT requester_id, accepter_id FROM request_accepted UNION SELECT accepter_id as requester_id, requester_id AS accepter_id FROM request_accepted ) AS all_friends GROUP BY requester_id ORDER BY num DESC LIMIT 1
SELECT requester_id as id, COUNT(*) as num FROM( SELECT requester_id ,accepter_id FROM request_accepted UNION ALL SELECT accepter_id AS requester_id , requester_id AS accepter_id FROM request_accepted) A GROUP BY 1 ORDER BY num DESC LIMIT 1
SELECT requester_id as id, count(requester_id) as num from (SELECT requester_id, accepter_id, accept_date FROM request_accepted UNION SELECT accepter_id as requester_id, requester_id as accepter_id, accept_date FROM request_accepted) d group by id order by num DESC LIMIT 1
SELECT t.id, COUNT(*) num FROM (SELECT requester_id id FROM request_accepted UNION ALL SELECT accepter_id id FROM request_accepted) t GROUP BY t.id ORDER BY num DESC LIMIT 1
SELECT t1.id, SUM(t1.acc) num FROM ( SELECT requester_id id, COUNT(DISTINCT accepter_id) acc FROM request_accepted GROUP BY 1 UNION ALL SELECT accepter_id id, COUNT(DISTINCT requester_id) acc FROM request_accepted GROUP BY 1)T1 GROUP BY 1 ORDER BY num DESC LIMIT 1
SELECT t2.id, t2.num FROM( SELECT t.id, COUNT(t.id) AS num , DENSE_RANK() OVER(ORDER BY COUNT(t.id)) AS 'rank' FROM (SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id AS id FROM request_accepted) t GROUP BY 1 ORDER BY 3 DESC) t2 LIMIT 1
SELECT temp2.user_id AS id, number_of_friends AS num FROM( SELECT temp.user_id AS user_id, COUNT(*) AS number_of_friends FROM( SELECT requester_id AS user_id FROM request_accepted UNION ALL SELECT accepter_id AS user_id FROM request_accepted )temp GROUP BY 1 )temp2 ORDER BY 2 DESC LIMIT 1
SELECT temp3.id AS id, temp3.num AS num FROM( SELECT id, num, RANK() OVER(ORDER BY num DESC) AS rank_number FROM( SELECT temp.user_id AS id, COUNT(*) AS num FROM( SELECT requester_id AS user_id FROM request_accepted UNION ALL SELECT accepter_id AS user_id FROM request_accepted )temp GROUP BY 1 )temp2 )temp3 WHERE temp3.rank_number = 1
SELECT x.a as id, count(x.b) as num FROM ( SELECT requester_id as a, accepter_id as b FROM request_accepted UNION SELECT accepter_id as a, requester_id as b FROM request_accepted ) x GROUP BY x.a ORDER BY num DESC LIMIT 1
Select id,SUM(num1) AS num from (Select requester_id as id,count(requester_id) as num1 from request_accepted AS A group by requester_id UNION ALL Select accepter_id as id,count(accepter_id) as num1 from request_accepted as B group by accepter_id) AS X group by id ORDER BY num DESC LIMIT 1
WITH CTE AS ( SELECT requester_id as id , COUNT(requester_id) AS count_friend FROM request_accepted GROUP BY 1 UNION ALL SELECT accepter_id as id, COUNT(accepter_id) AS count_friend FROM request_accepted GROUP BY 1 ) SELECT id, SUM(count_friend) as num FROM CTE GROUP BY 1 ORDER BY 2 DESC LIMIT 1
WITH CTE AS (select requester_id, accepter_id from request_accepted UNION ALL select accepter_id, requester_id from request_accepted) select requester_id as id , COUNT(requester_id) as num from CTE group by requester_id order by num DESC LIMIT 1
WITH Combo AS ( SELECT requester_id AS id, COUNT(requester_id) AS num FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS id, COUNT(accepter_id) AS num FROM request_accepted GROUP BY accepter_id ) SELECT id, SUM(num) AS num FROM Combo GROUP BY id ORDER BY SUM(num) DESC LIMIT 1
WITH FRIEND AS( SELECT ACCEPTER_ID AS ID FROM REQUEST_ACCEPTED UNION ALL SELECT REQUESTER_ID AS ID FROM REQUEST_ACCEPTED ), N AS( SELECT ID, COUNT(*) AS NUM FROM FRIEND GROUP BY ID ) SELECT ID, NUM FROM N WHERE NUM = ( SELECT MAX(NUM) FROM N )
WITH Friends AS ( SELECT requester_id AS Id, COUNT(accept_date) AS n FROM request_accepted GROUP BY requester_id UNION ALL SELECT accepter_id AS Id, COUNT(accept_date) AS n FROM request_accepted GROUP BY accepter_id ) SELECT id, SUM(n) AS num FROM Friends GROUP BY Id ORDER BY SUM(n) DESC LIMIT 1
WITH S0 AS (SELECT accepter_id AS person_id, COUNT(requester_id) AS friend_count FROM request_accepted GROUP BY accepter_id), S1 AS (SELECT requester_id AS person_id, COUNT(accepter_id) AS friend_count FROM request_accepted GROUP BY requester_id), S2 AS (SELECT DISTINCT(requester_id) AS person_id FROM request_accepted UNION SELECT DISTINCT(accepter_id) AS person_id FROM request_accepted), S3 AS (SELECT S2.person_id, IFNULL(S0.friend_count,0) + IFNULL(S1.friend_count,0) AS friend_count FROM S2 LEFT JOIN S1 ON S2.person_id = S1.person_id LEFT JOIN S0 ON S2.person_id = S0.person_id) SELECT person_id AS `id`, friend_count AS num FROM S3 WHERE friend_count = (SELECT MAX(friend_count) FROM S3)
WITH TABLE1 AS ( SELECT requester_id, accepter_id FROM request_accepted UNION ALL SELECT accepter_id, requester_id FROM request_accepted ) SELECT requester_id AS id, COUNT(accepter_Id) AS num FROM TABLE1 GROUP BY requester_id ORDER BY COUNT(accepter_Id) desc LIMIT 1
WITH counted AS( SELECT id1 id, COUNT(id2) num FROM( SELECT requester_id AS id1, accepter_id AS id2 FROM request_accepted UNION SELECT accepter_id AS id2, requester_id AS id2 FROM request_accepted ) AS tmp GROUP BY 1 ) SELECT id, num FROM counted WHERE num = (SELECT MAX(num) FROM counted)
WITH cte as ( SELECT r1.requester_id, COUNT(DISTINCT r1.accepter_id) + COUNT(DISTINCT r2.requester_id) as friends_num FROM request_accepted r1 LEFT JOIN request_accepted r2 ON r1.requester_id = r2.accepter_id GROUP BY r1.requester_id) SELECT requester_id as id, friends_num as num FROM cte WHERE friends_num IN (SELECT MAX(friends_num) FROM cte)
WITH cte as( SELECT requester_id as id1, accepter_id as id2 FROM request_accepted UNION SELECT accepter_id as id1, requester_id as id2 FROM request_accepted ) SELECT id1 as id, COUNT(DISTINCT id2) as num FROM cte GROUP BY id1 ORDER BY num DESC LIMIT 1
WITH cte_req AS ( SELECT requester_id id FROM request_accepted UNION ALL SELECT accepter_id id FROM request_accepted ) SELECT id, ct num FROM (SELECT id, count(*) ct FROM cte_req GROUP BY id) a ORDER BY ct DESC LIMIT 1
WITH friends AS ( SELECT accepter_id as id, COUNT(*) as cnt FROM request_accepted GROUP BY id UNION ALL SELECT requester_id as id, COUNT(*) as cnt FROM request_accepted GROUP BY id ) SELECT id, SUM(CNT) as num FROM friends GROUP BY id ORDER BY num DESC LIMIT 1
WITH friends AS ( SELECT requester_id AS id, accepter_id AS friend_id FROM request_accepted UNION SELECT accepter_id AS id, requester_id AS friend_id FROM request_accepted ) SELECT f.id, COUNT(friend_id) AS num FROM friends f GROUP BY f.id ORDER BY Count(friend_id) DESC LIMIT 1
WITH friendtable AS( SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id AS id FROM request_accepted ), friendcount AS( SELECT id, COUNT(id) as num FROM friendtable GROUP BY id ) SELECT id, num FROM( SELECT id, num, DENSE_RANK()OVER(ORDER BY num DESC )AS numrank FROM friendcount )myt WHERE numrank=1
WITH id AS ( SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id AS id FROM request_accepted ) SELECT id, COUNT(*) AS num FROM id GROUP BY 1 ORDER BY 2 DESC LIMIT 1
WITH requested_sent as( SELECT requester_id, COUNT(*) as num_requests FROM request_accepted GROUP BY 1 ), accepted as ( SELECT accepter_id, COUNT(*) as num_accepted FROM request_accepted GROUP BY 1 ), full_id_lst as ( SELECT DISTINCT requester_id as id from request_accepted UNION SELECT DISTINCT accepter_id from request_accepted ) SELECT a.id, MAX(IFNULL(b.num_requests,0) + IFNULL(c.num_accepted,0)) as num FROM full_id_lst a LEFT JOIN requested_sent b ON a.id = b.requester_id LEFT JOIN accepted c ON a.id = c.accepter_id GROUP BY 1 ORDER BY 2 DESC LIMIT 1
WITH sub AS ((SELECT requester_id AS id FROM request_accepted) UNION ALL (SELECT accepter_id AS id FROM request_accepted)), max_friend AS (SELECT MAX(count_of_id) FROM (SELECT COUNT(id) as count_of_id FROM sub GROUP BY id) sub1) SELECT id, COUNT(id) AS num FROM sub GROUP BY id HAVING num = (SELECT * FROM max_friend)
WITH t AS ( SELECT requester_id AS id, accepter_id AS b FROM request_accepted UNION ALL SELECT accepter_id AS id, requester_id AS b FROM request_accepted ) SELECT id, COUNT(*) AS num FROM t GROUP BY 1 ORDER BY num DESC LIMIT 1
WITH t AS (SELECT accepter_id AS id, COUNT(requester_id) AS cnt FROM request_accepted GROUP BY accepter_id UNION ALL SELECT requester_id AS id, COUNT(accepter_id) AS cnt FROM request_accepted GROUP BY requester_id) SELECT id, SUM(cnt) AS num FROM t GROUP BY id ORDER BY num DESC LIMIT 1
WITH t AS (SELECT requester_id id1, accepter_id id2 FROM request_accepted UNION ALL SELECT accepter_id id1, requester_id id2 FROM request_accepted) SELECT id1 id, COUNT(id1) num FROM t GROUP BY 1 ORDER BY 2 DESC LIMIT 1
WITH t1 AS ( SELECT id, COUNT(id) as num FROM (SELECT requester_id as id FROM request_accepted UNION ALL SELECT accepter_id as id FROM request_accepted) a GROUP BY id), t2 AS ( SELECT id, num, DENSE_RANK() OVER (ORDER BY num DESC) rank_num FROM t1) SELECT id, num FROM t2 WHERE rank_num = 1
WITH t1 AS ( SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id AS id FROM request_accepted ), t2 AS ( SELECT id, COUNT(*) AS num FROM t1 GROUP BY id ) SELECT id, num FROM (SELECT *, RANK() OVER(ORDER BY num DESC) AS rnk FROM t2) t3 WHERE rnk = 1
WITH table1 AS( SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id AS id FROM request_accepted ), table2 AS( SELECT id, COUNT(id) AS num FROM table1 GROUP BY id ) SELECT id, num FROM table2 WHERE num = (SELECT MAX(num) FROM table2)
WITH tcte AS ( SELECT requester_id AS id FROM request_accepted UNION ALL SELECT accepter_id AS id FROM request_accepted ) SELECT id, COUNT(*) as num FROM tcte GROUP BY id ORDER BY num DESC LIMIT 1
WITH temp AS ( SELECT requester_id, accepter_id FROM request_accepted UNION ALL SELECT accepter_id AS requester_id, requester_id AS accepter_id FROM request_accepted ), temp2 AS ( SELECT requester_id AS id, COUNT(accepter_id) AS num FROM temp GROUP BY requester_id ) SELECT * FROM temp2 ORDER BY num DESC LIMIT 1
WITH temp as ( SELECT a.request as id, COUNT(DISTINCT a.accept) AS "num" FROM ( (SELECT requester_id as "request", accepter_id AS "accept" FROM request_accepted) UNION (SELECT accepter_id as "request", requester_id AS "accept" FROM request_accepted) ) as a GROUP BY a.request ) SELECT id, num from temp where num = (SELECT MAX(num) FROM temp)
WITH user_friend AS (SELECT requester_id as user_id, accepter_id as friend_id FROM request_accepted UNION ALL SELECT accepter_id as user_id, requester_id as friend_id FROM request_accepted) SELECT user_id as id,COUNT(friend_id) as num FROM user_friend GROUP BY user_id ORDER BY 2 DESC LIMIT 1
With CTE1 AS ( Select requester_id AS id, count(accept_date) AS R_Num from request_accepted Group by id ), CTE2 AS ( Select accepter_id AS id, count(accept_date) AS A_Num from request_accepted Group by id ) Select CTE1.id As id, coalesce(R_Num,0)+coalesce(A_Num,0) AS num From CTE1 LEFT JOIN CTE2 ON CTE1.id = CTE2.id UNION select CTE1.id, R_Num+A_Num AS num From CTE1 RIGHT JOIN CTE2 ON CTE1.id = CTE2.id Order BY 2 Desc Limit 1
select A.id, count(*) as num from (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) A group by A.id order by count(*) DESC limit 1
select ID, Count(*) as num from( select Requester_id as ID from request_accepted union all select Accepter_id as ID from request_accepted ) a group by 1 order by num desc limit 1
select T.id,sum(T.cnt) as 'num' from( (select r1.requester_id as id, count(r1.accepter_id) as cnt from request_accepted r1 group by r1.requester_id) union all (select r2.accepter_id as id, count(r2.requester_id) as cnt from request_accepted r2 group by r2.accepter_id) )as T group by T.id order by sum(T.cnt) desc limit 1
select a as id , count(distinct b) as num from (select requester_id as a, accepter_id as b from request_accepted ra union select accepter_id as a, requester_id as b from request_accepted ra) ab group by id order by num desc limit 1
select a as id, count(b) as num from( select requester_id as a, accepter_id as b from request_accepted union select accepter_id as a, requester_id as b from request_accepted) as temp group by a order by num desc limit 1
select a.firstt as id, count(a.secondd) as num from ( select requester_id as firstt, accepter_id as secondd from request_accepted union all select accepter_id as firstt, requester_id as secondd from request_accepted) a group by a.firstt order by num desc limit 1
select a.requester_id as id, count(distinct a.accepter_id)+coalesce(b.c2,0) as num from request_accepted as a left join (select accepter_id, count(distinct requester_id) as c2 from request_accepted group by accepter_id) as b on a.requester_id=b.accepter_id group by a.requester_id order by count(distinct a.accepter_id)+coalesce(b.c2,0) desc limit 1
select b.user_id as id,b.req as num from ( select a.user_id, count(*) as req from ( select requester_id as user_id from request_accepted union all select accepter_id from request_Accepted )a group by a.user_id )b order by b.req desc limit 1
select c.id, count(*) num from ( select a.requester_id as id from request_accepted a union all select b.accepter_id as id from request_accepted b ) c group by c.id order by count(*) desc limit 1
select d.requester_id as id, sum(1) as num from ( select requester_id as requester_id, accepter_id as accepter_id from request_accepted union select accepter_id as requester_id , requester_id as accepter_id from request_accepted) as d group by 1 order by 2 desc limit 1
select f1 as id, count(f2) as num from( select requester_id as f1, accepter_id as f2 from request_accepted union select accepter_id as f1,requester_id as f2 from request_accepted ) f group by f1 order by count(f2) desc limit 1
select id , count(*) as num from (select requester_id as id from request_accepted union all select accepter_id from request_accepted) as tbl group by id order by num desc limit 1
select id , sum(cnt) as num FROM ( select requester_id as id , count(0) as cnt FROM request_accepted group by requester_id UNION ALL select accepter_id as id , count(0) as cnt FROM request_accepted group by accepter_id )t GROUP BY id ORDER BY sum(cnt) DESC LIMIT 1
select id, count(*) as num from ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) as tb group by id order by num desc limit 1 offset 0
select id, count(*) as num from ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) asd group by id order by count(*) desc limit 1
select id, count(*) as num from ((select requester_id as id from request_accepted) union all (select accepter_id as id from request_accepted)) temp group by id order by num desc limit 1
select id, count(*) as num from (select accepter_id as id from request_accepted union all select requester_id as id from request_accepted) results group by id order by num desc limit 1
select id, count(*) as num from (select requester_id as id from request_accepted ra1 union all select accepter_id as id from request_accepted ra2) x group by 1 order by count(*) desc limit 1
select id, count(*) as num from (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) x group by 1 order by num desc limit 1
select id, count(*) as num from (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted)cte group by 1 order by 2 desc limit 1
select id, count(*) as num from (select requester_id as id from request_accepted union all select accepter_id from request_accepted) t group by id order by num desc limit 1
select id, count(*) as num from (select requester_id as id, accepter_id as id2 from request_accepted union select accepter_id as id, requester_id as id2 from request_accepted) as a group by 1 order by 2 desc limit 1
select id, count(*) num from ( (select requester_id id from request_accepted) union all (select accepter_id id from request_accepted) ) tb group by id order by num desc limit 1
select id, count(1) as num from (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) t group by id order by num desc limit 1
select id, count(1) num from (select requester_id id from request_accepted union all select accepter_id id from request_accepted) temp group by 1 order by 2 desc limit 1
select id, count(Id) Num from (select requester_id as id from request_accepted UNION ALL select accepter_id as id from request_accepted) res group by id order by Num desc limit 1
select id, count(distinct friend_id) as num from ( select requester_id as id, accepter_id as friend_id from request_accepted union all select accepter_id as id, requester_id as friend_id from request_accepted ) a group by id order by 2 desc limit 1
select id, count(friend) as num from ( select distinct requester_id as id, accepter_id as friend from request_accepted union select distinct accepter_id as id, requester_id as friend from request_accepted ) a group by id order by count(friend) desc limit 1
select id, count(friend) as num from ( select requester_id as id, accepter_id as friend from request_accepted union all select accepter_id as id, requester_id as friend from request_accepted ) a group by id order by count(friend) desc limit 1
select id, count(friend) as num from ( select requester_id as id, accepter_id as friend from request_accepted union select accepter_id as id, requester_id as friend from request_accepted ) a group by id order by count(friend) desc limit 1
select id, count(friend_id) as num from ( select requester_id as id, accepter_id as friend_id from request_accepted union select accepter_id as id, requester_id as friend_id from request_accepted ) a group by id order by 2 desc limit 1
select id, count(friendcount) as num from ( select requester_id as id, accepter_id as friendcount from request_accepted union select accepter_id as id , requester_id as friendcount from request_accepted ) a group by id order by 2 desc limit 1
select id, count(id) as num from (select accepter_id as id from request_accepted union all select requester_id as id from request_accepted ) a group by 1 order by 2 desc limit 1
select id, count(id) as num from (select accepter_id as id from request_accepted union all select requester_id as id from request_accepted) a group by 1 order by 2 desc limit 1
select id, count(id) as num from (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) a group by id order by num DESC limit 1
select id, count(id) num from( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted)a group by id order by num desc limit 1
select id, num FROM( SELECT PERSON_ID id, COUNT(PERSON_ID) num FROM ( SELECT requester_id AS PERSON_ID FROM request_accepted UNION ALL SELECT accepter_id AS PERSON_ID FROM request_accepted ) A GROUP BY PERSON_ID ORDER BY PERSON_ID )B order by num desc limit 1
select id, num from ( select id, count(*) as num from ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) as Table1 group by id ) as Table2 order by num desc limit 1
select id, num from ( select id, count(*) as num from ( select requester_id as id from request_accepted union all select accepter_id from request_accepted ) t0 group by id ) t1 order by num desc limit 1
select id, num from ( select id, count(*) as num, rank() over (order by count(id) desc) as rk from ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) x group by id ) x where rk = 1
select id, num from ( select id, sum(num) as num, rank() over (order by sum(num) desc) as rnk from ( select requester_id as id, 1 as ind, count(accepter_id) as num from request_accepted group by 1 union select accepter_id as id, 0 as ind, count(requester_id) as num from request_accepted group by 1 ) TBL group by 1 ) TBL2 where rnk = 1
select id, num from (select friend as id, count(*) as num from (select requester_id as friend from request_accepted union all select accepter_id as friend from request_accepted) t group by friend) g order by num desc limit 1
select id, num from (select id, sum(num) as num , rank() over (order by sum(num) desc) as rk from (select accepter_id as id, count(requester_id) as num from request_accepted group by accepter_id union all select requester_id as id, count(accepter_id) as num from request_accepted group by requester_id) a group by id) b where rk =1
select id, sum(c) as num from( select requester_id as id, count(requester_id) as c from request_accepted group by requester_id union all select accepter_id as id, count(accepter_id)as c from request_accepted group by accepter_id) a group by id order by num desc limit 1
select id, sum(cnt) as num from ( select requester_id as id, count(distinct accepter_id) as cnt from request_accepted group by 1 union all select accepter_id as id, count(distinct requester_id) as cnt from request_accepted group by 1 )a group by 1 order by 2 desc limit 1
select id, sum(cnt) num from (select accepter_id id, count(*) cnt from request_accepted group by accepter_id union all select requester_id id, count(*) cnt from request_accepted group by requester_id) t group by id order by sum(cnt) desc limit 1
select id, sum(count_num) as num from (select requester_id as id, count(accepter_id) as count_num from request_accepted group by requester_id union all select accepter_id as id, count(requester_id) as count_num from request_accepted group by accepter_id) as t1 group by id order by num desc limit 1
select id, sum(ct) num from ( select requester_id id,count(requester_id) as ct from request_accepted group by requester_id union all select accepter_id id,count(accepter_id ) as ct from request_accepted group by accepter_id ) as t group by id order by num desc limit 1
select id, sum(friend_count) as num from ( select requester_id as id , count(accepter_id) as friend_count from request_accepted group by requester_id union all select accepter_id as id , count(requester_id) as friend_count from request_accepted group by accepter_id )tmp group by id order by sum(friend_count) desc limit 1
select id, sum(friends) as num from ( select accepter_id as id, count(accept_date) as friends from request_accepted group by 1 union all select requester_id as id, count(*) as friends from request_accepted group by 1 ) a group by id order by num desc limit 1
select id, sum(num) as num from ( select a.requester_id as id , count(a.accepter_id) as num from request_accepted a group by a.requester_id union all select b.accepter_id as id , count(b.requester_id) as num from request_accepted b group by b.accepter_id) a group by id order by num desc limit 1
select id, sum(num) as num from (select requester_id as id, count(*) as num from request_accepted group by requester_id UNION ALL select accepter_id as id, count(*) as num from request_accepted group by accepter_id ) as t1 group by id order by num desc limit 1
select id, sum(num) as num from (select requester_id as id, count(accepter_id) as num from request_accepted group by requester_id union all select accepter_id as id, count(requester_id) as num from request_accepted group by accepter_id) cte group by id order by num desc limit 1
select id, sum(num) num from ( select requester_id as id, count(accepter_id) as num from request_accepted group by requester_id union all select accepter_id, count(requester_id) as num from request_accepted group by accepter_id ) tmp group by tmp.id order by num desc limit 1
select id, sum(num) num from (select requester_id id, count(requester_id) num from request_accepted group by requester_id union all select accepter_id id, count(accepter_id ) num from request_accepted group by accepter_id ) a group by id order by sum(num) desc limit 1
select id, sum(num_friends) as num from( (select requester_id as id, count(*) as num_friends from request_accepted group by 1) UNION ALL (select accepter_id as id, count(*) as num_friends from request_accepted group by 1) ) as union_table group by 1 order by num desc limit 1
select id, sum(number) as num from ( (select requester_id as id,count(*) as number from request_accepted group by requester_id) union all (select accepter_id as id,count(*) as number from request_accepted group by accepter_id) ) a group by id order by sum(number) desc limit 1
select id,count(*) as num from ( (select accepter_id as id from request_accepted) union all (select requester_id as id from request_accepted) ) t1 group by 1 order by 2 desc limit 1
select id,sum(c) as num from ( (select accepter_id as id, count(*) c from request_accepted group by accepter_id order by 2 desc) union all (select requester_id as id,count(*) c from request_accepted group by 1 order by 2 desc) ) t1 group by 1 order by 2 desc limit 1
select id,sum(counter) as num from (select requester_id as id,count(*) as counter from request_accepted group by 1 union all select accepter_id as id,count(*) as counter from request_accepted group by 1) as a group by 1 order by 2 desc limit 1
select id,sum(counter) as num from (select requester_id as id,count(distinct accepter_id) as counter from request_accepted group by 1 union all select accepter_id as id,count(distinct requester_id) as counter from request_accepted group by 1) as a group by 1 order by 2 desc limit 1
select id,sum(num) as num from ( select requester_id as id, count(*) as num from request_accepted group by requester_id union all select accepter_id as id, count(*) as num from request_accepted group by accepter_id ) as temp group by id order by num desc limit 1
select id,total_accepts as num from ( select id , total_accepts ,rank() over (order by total_accepts desc) as num from ( select id , sum(cnt) as total_accepts from ( select accepter_id as id, count(*) as cnt from request_accepted group by accepter_id union all select requester_id as id , count(*) as cnt from request_accepted group by requester_id ) a group by id ) b ) c where num = 1
select id1 as id, count(*) as num from (select requester_id as id1, accepter_id as id2 from request_accepted union select accepter_id as id1, requester_id as id2 from request_accepted) as tmp group by id1 order by num desc limit 1
select id1 as id, count(id2) as num from (select requester_id as id1, accepter_id as id2 from request_accepted union select accepter_id as id1, requester_id as id2 from request_accepted) t group by id1 order by num desc limit 1
select id1 as id, count(id2) as num from (select requester_id as id1, accepter_id as id2 from request_accepted union select accepter_id as id1, requester_id as id2 from request_accepted) tmp group by id1 order by num desc limit 1
select ids as id, cnt as num from ( select ids, count(*) as cnt from ( select requester_id as ids from request_accepted union all select accepter_id from request_accepted ) as tbl1 group by ids ) as tbl2 order by cnt desc limit 1
select ids as id, cnt as num from (select ids, count(*) as cnt from (select requester_id as ids from request_accepted union all select accepter_id from request_accepted) as tbl1 group by ids) as tbl2 order by cnt desc limit 1
select ids as id, count(*) as 'num' from( select requester_id as 'ids' from request_accepted union all select accepter_id as'ids' from request_accepted ) temp group by 1 order by 2 desc limit 1
select ids as id, count(ids) as num from (select requester_id as ids from request_accepted union all select accepter_id from request_accepted) as temp1 group by ids order by num desc limit 1
select ids as id,count(*) as num from( select requester_id as ids from request_accepted union all select accepter_id from request_accepted) as u group by ids order by count(*) desc limit 1
select new_col as id, count(*) as num from ( select requester_id as new_col from request_accepted union all select accepter_id as new_col from request_accepted ) as A group by 1 order by num desc limit 1
select new_col as id, count(new_col) as num from (select requester_id as new_col from request_accepted union all select accepter_id as new_col from request_accepted)x group by new_col order by count(new_col) desc limit 1
select p as id, count(*) as num from (select requester_id as p, accepter_id from request_accepted UNION select accepter_id as p, requester_id from request_accepted) t group by p order by num DESC limit 1
select requester_id as id, count(*) as num from (select requester_id from request_accepted union all select accepter_id from request_accepted) b group by id order by num desc limit 1
select requester_id as id, count(accepter_id) as num from( select * from request_accepted union select accepter_id as requester_id, requester_id as accepter_id, accept_date from request_accepted) t group by 1 order by 2 desc limit 1
select requester_id as id, count(distinct accepter_id) as num from ( select requester_id, accepter_id from request_accepted union all select accepter_id, requester_id from request_accepted ) as t group by requester_id order by count(distinct accepter_id) desc limit 1
select requester_id as id, count(distinct accepter_id) as num from ( select requester_id, accepter_id from request_accepted union select accepter_id, requester_id from request_accepted ) f group by requester_id order by num desc limit 1
select requester_id as id, count(requester_id) as num from (select requester_id from request_accepted union all select accepter_id from request_accepted) a group by requester_id order by num desc limit 1
select requester_id as id, num from ( select requester_id, count(*) as num from ( select requester_id,accepter_id from request_accepted union all select accepter_id as requester_id,requester_id as accepter_id from request_accepted)a group by requester_id order by num desc limit 1)b
select requester_id id, sum(cnt) num from ( select requester_id, count(1) cnt from request_accepted group by 1 union all select accepter_id, count(1) cnt from request_accepted group by 1 )a group by 1 order by 2 desc limit 1
select sub.id, sum(sub.num) as num from ( select requester_id as id, count(requester_id ) as num from request_accepted group by requester_id UNION ALL select accepter_id as id, count(requester_id ) as num from request_accepted group by accepter_id ) sub group by sub.id order by num desc limit 1
select t.friends as id, num from (select temp.friends, count(*) as num from (select requester_id as friends from request_accepted a union all select accepter_id as friends from request_accepted b ) temp group by friends ) as t order by num desc limit 1
select t.id, sum(t.num) as num from ( (select requester_id as id, count(1) as num from request_accepted group by requester_id) union all (select accepter_id as id, count(1) as num from request_accepted group by accepter_id)) as t group by t.id order by num desc limit 1
select t3.id as id, count(t3.id) as num from ( select requester_id as id from request_accepted UNION ALL select accepter_id as id from request_accepted ) as t3 GROUP BY 1 ORDER BY 2 DESC LIMIT 1
select t3.id as id, count(t3.id) as num from ( select requester_id as id from request_accepted UNION ALL select accepter_id as id from request_accepted ) as t3 GROUP BY 1 ORDER BY num DESC LIMIT 1
select t3.id as id, count(t3.id) as num from ( select requester_id as id from request_accepted UNION ALL select accepter_id as id from request_accepted ) as t3 GROUP BY t3.id ORDER BY num DESC LIMIT 1
select t3.id as id, count(t3.id) as num from ( select t1.requester_id as id from request_accepted as t1 UNION ALL select t2.accepter_id as id from request_accepted as t2 ) as t3 GROUP BY t3.id ORDER BY num DESC LIMIT 1
select t3.id as id, count(t3.id) as num from ( select t1.requester_id as id, t1.accepter_id as friend_id from request_accepted as t1 UNION ALL select t2.accepter_id as id, t2.requester_id as friend_id from request_accepted as t2 ) as t3 GROUP BY t3.id ORDER BY num DESC LIMIT 1
select temp.id, count(*) as num from (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) temp group by 1 order by num desc limit 1
select tmp.id, sum(tmp.cnt) num from(select requester_id id, count(requester_id) cnt from request_accepted group by requester_id union all select accepter_id id, count(accepter_id) cnt from request_accepted group by accepter_id) as tmp group by id order by sum(tmp.cnt) desc limit 1
select u1 as id, count(distinct u2) as num from ((select requester_id as u1, accepter_id as u2 from request_accepted) union all (select accepter_id as u1, requester_id as u2 from request_accepted) ) t group by 1 order by num desc limit 1
select user_id as id, count(*) as num from (select requester_id as user_id from request_accepted UNION ALL select accepter_id as user_id from request_accepted) t group by user_id order by num desc limit 1
select x.requester_id as id,count(*) as num from (Select requester_id from request_accepted union all select accepter_id from request_accepted) as x group by 1 order by count(*) desc limit 1
with Cnt as ( select id, count(id) as num from ( select requester_id as id, accepter_id as id2 from request_accepted union all select accepter_id as id, requester_id as id2 from request_accepted ) x group by id ) select * from cnt where num = (select max(num) from cnt)
with Cnt as ( select id, count(id) as num from ( select requester_id as id, accepter_id as id2 from request_accepted union select accepter_id as id, requester_id as id2 from request_accepted ) x group by id ) select * from cnt where num = (select max(num) from cnt)
with a as ( select requester_id from request_accepted union all select accepter_id from request_accepted) select requester_id as id, count(requester_id) as num from a group by 1 order by 2 desc limit 1
with a as( select requester_id as id, count(accepter_id) as num from request_accepted group by requester_id union all select accepter_id as id, count(requester_id) as num from request_accepted group by accepter_id ) select id, sum(num) as num from a group by 1 order by 2 desc limit 1
with a as( select requester_id id ,accepter_id friend_id from request_accepted union all select accepter_id,requester_id from request_accepted) select id, count(distinct friend_id) as num from a group by id order by count(distinct friend_id) desc limit 1
with all_nodes as (select requester_id as id from request_accepted union all select accepter_id from request_accepted) select id, count(*) num from all_nodes group by id order by count(*) desc limit 1
with all_user as( select accepter_id userid from request_accepted union all select requester_id userid from request_accepted) select userid as id, count(userid) num from all_user group by 1 order by 2 desc limit 1
with base as ( select requester_id as id, accept_date as date1 from request_accepted union all select accepter_id as id, accept_date as date1 from request_accepted ), base1 as (select id, count(*) as cnt from base group by 1) select id, cnt as num from base1 where cnt in (select max(cnt) from base1)
with c as (SELECT * from request_accepted union select accepter_id, requester_id, accept_date from request_accepted) select requester_id as id, count(*) as num from c group by requester_id order by num desc limit 1
with count_requesters as ( select requester_id as id, count(*) as count from request_accepted group by requester_id ), count_accepters as ( select accepter_id as id, count(*) as count from request_accepted group by accepter_id ), final as ( select id, count from count_requesters cr union all select id, count from count_accepters ) select id, sum(count) num from final group by id order by num desc limit 1
with cte as ( Select id, total, dense_rank() over (order by total desc ) rnk from ( Select requester_id as id, sum(total) total from ( Select requester_id, count(accepter_id) total from request_accepted group by requester_id union all Select accepter_id as requester_id, count(requester_id) total from request_accepted group by accepter_id ) temp group by requester_id ) t ) Select id , total as num from cte where rnk = 1
with cte as ( select id, sum(num) as num from( select requester_id as id, count(*) as num from request_accepted group by requester_id union all select accepter_id as id, count(*) as num from request_accepted group by accepter_id) t group by id) select id, num from cte order by num desc limit 1
with cte as ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) select id, cnt as num from (select id, count(*) as cnt from cte group by id order by cnt desc limit 1) a
with cte as ( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) select id,count(id) as num from cte group by id order by 2 desc limit 1
with cte as ( select requester_id as id, count(*) as num from request_accepted group by requester_id union all select accepter_id as id, count(*) as num from request_accepted group by accepter_id ) select id, sum(num) as num from cte group by id order by num desc limit 1
with cte as ( select requester_id as id, count(requester_id ) as num from request_accepted group by requester_id union all select accepter_id as id, count(accepter_id ) as num from request_accepted group by accepter_id ) select id, sum(num) as num from cte group by id order by num desc limit 1
with cte as ( select requester_id as id,count(*) as num from request_accepted group by requester_id ), demo as ( select accepter_id as id,count(*) as num from request_accepted group by accepter_id ), sub as ( select id,num from cte union all select id,num from demo ) select id,sum(num) as num from sub group by id order by num desc limit 1
with cte as ( select requester_id as id,count(accepter_id) as num from request_accepted group by requester_id union all select accepter_id as id,count(requester_id) as num from request_accepted group by accepter_id ) select id,sum(num) as num from cte group by id order by num desc limit 1
with cte as (select count(*) as c, requester_id as id from request_accepted as r group by 2) , cte1 as (select count(*) as c , accepter_id as id from request_accepted as r group by 2), cte2 as (select * from cte union all select * from cte1), cte3 as ( select sum(c) as c , id from cte2 group by id) select id , c as num from cte3 where c = (select max(c) from cte3 )
with cte as (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted ) , cte1 as ( select id , count(id) as num , rank() over ( order by count(id) DESC) as rnk from cte group by 1) select id , num from cte1 where rnk = 1
with cte as (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) select id, count(id)as num from cte group by id order by num desc limit 1
with cte as( select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) select id as id, count(id) as num from cte c group by id order by num desc limit 1
with cte as( select requester_id as id, accepter_id as f_id from request_accepted union all select accepter_id as id, requester_id as f_id from request_accepted ) select id as id, cnt as num from ( select id, count(*) as cnt from cte group by 1 ) tmp order by cnt desc limit 1
with cte as( select requester_id as id, accepter_id as friend from request_accepted union all select accepter_id as id, requester_id as friend from request_accepted ) select id, count(friend) as num from cte group by 1 order by 2 desc limit 1
with cte as( select requester_id, row_number() over(partition by requester_id) as r1 from request_accepted ) , cte2 as( select accepter_id, row_number() over(partition by accepter_id) as r1 from request_accepted ), cte3 as( select requester_id as rq, count(r1) as r1 from cte group by cte.requester_id union all select accepter_id as rq, count(r1) as r1 from cte2 group by cte2.accepter_id) select rq as id, sum(r1) as num from cte3 group by rq order by 2 desc limit 1
with cte as((select requester_id id from request_accepted) union all (select accepter_id id from request_accepted ) ) select distinct id id, count(*) num from cte group by id order by num desc limit 1
with ctedistinctra AS( select distinct requester_id, accepter_id from request_accepted ), cteunion AS ( select requester_id as id from ctedistinctra UNION ALL select accepter_id as id from ctedistinctra ) select id, count(id) as num from cteunion group by id order by count(id) desc limit 1
with f as ( select requester_id u1, accepter_id u2 from request_accepted union select accepter_id u1, requester_id u2 from request_accepted ) select u1 id, count(u2) num from f group by u1 order by num desc limit 1
with fdata as (select requester_id as id from request_accepted union all select accepter_id as id from request_accepted) select id, count(id) as num from fdata group by id order by num desc limit 1
with m1 as (Select r.accepter_id as person, count(r.accepter_id) as counter from request_accepted r group by accepter_id), m2 as (Select r.requester_id as person, count(r.requester_id) as counter from request_accepted r group by requester_id), m3 as (select person, counter from m1 union all select person, counter from m2) select person as id, sum(counter) as num from m3 group by person order by num DESC Limit 1
with request as ( select requester_id, count(requester_id) as rnum from request_accepted group by requester_id), accept as( select accepter_id, count(accepter_id) as anum from request_accepted group by accepter_id), sums as ( select requester_id, ifnull(rnum,0) as rnum, ifnull(anum,0) as anum from request as r left join accept as a on r.requester_id = a.accepter_id union select accepter_id as requester_id, ifnull(rnum,0) as rnum, ifnull(anum,0) as anum from request as r right join accept as a on r.requester_id = a.accepter_id) select requester_id as id, (rnum + anum) as num from sums order by num desc limit 1
with requests as(select accepter_id,count(requester_id) as requesters from request_accepted group by accepter_id), requested as (select requester_id,count(accepter_id) as requested from request_accepted group by requester_id), final_table as(select a.requester_id as id,(ifnull(requesters,0)+requested) as num from requested a left join requests b on b.accepter_id=a.requester_id) select * from final_table where num in (select max(num) from final_table)
with sub as ( select requester_id as id, accepter_id as num from request_accepted union all select accepter_id as id , requester_id as num from request_accepted) select id , num from ( select id , count(num) as num, rank() over ( order by count(num) desc ) as ranknum from sub group by id ) a where ranknum = 1
with t as ( select requester_id id from request_accepted union all select accepter_id id from request_accepted ) select id, count(*) num from t group by id order by num desc limit 1
with t as(SELECT requester_id id FROM request_accepted UNION ALL SELECT accepter_id id FROM request_accepted) select id, count(*) num from t group by id order by num desc limit 1
with t0 as ( select requester_id as id from request_accepted union all select accepter_id from request_accepted ) select id, count(*) as num from t0 group by id order by num desc limit 1
with t1 as ( Select requester_id as id from request_accepted union all Select accepter_id as id from request_accepted ) Select id,count(id) as num from t1 group by id order by num desc limit 1
with t1 as ( select requester_id as id, count(1) as friend_num from request_accepted group by requester_id union all select accepter_id as id, count(1) as friend_num from request_accepted group by accepter_id) select id, sum(friend_num) as num from t1 group by id order by num desc limit 1
with t1 as ( select requester_id, count(*) as sent from request_accepted group by requester_id ), t2 as ( select accepter_id, count(*) as received from request_accepted group by accepter_id ), t3 as ( select * from t1 UNION ALL select * from t2 ) select requester_id as id, sum(sent) as num from t3 group by requester_id order by num desc limit 1
with t1 as( select requester_id as user1, accepter_id as user2 from request_accepted union select accepter_id as user1, requester_id as id from request_accepted) select user1 id, count(user2) as num from t1 group by 1 order by count(user2) desc limit 1
with tem as( select requester_id as id, count(distinct accepter_id) as cnt_a from request_accepted group by requester_id ), tem2 as ( select accepter_id as id, count(distinct requester_id) as cnt_b from request_accepted group by accepter_id ) select a.id, coalesce (a.cnt_a, 0) + coalesce (b.cnt_b,0) as num from tem a left join tem2 b on a.id = b.id group by id order by num desc limit 1
with temp as ( select requester_id as id1, accepter_id as id2 from request_accepted union select accepter_id as id1, requester_id as id2 from request_accepted ) select id1 as id, count(*) as num from temp group by id order by num desc limit 1
with temp as ( select requester_id as id1, accepter_id as id2 from request_accepted union select accepter_id as id1, requester_id as id2 from request_accepted) select id1 as id, count(*) as num from temp group by id order by num desc limit 1
with temp as ((select requester_id as id, count(*) as frd from request_accepted group by requester_id) union all (select accepter_id as id, count(*) as frd from request_accepted group by accepter_id)) select id, sum(frd) as num from temp group by id order by num desc limit 1
with temp as (select requester_id as user1, accepter_id as user2 from request_accepted union all select accepter_id as usder1, requester_id as user2 from request_accepted) select user1 as id, count(user2) as num from temp group by user1 order by count(user2) desc limit 1
with tmp as ( select requester_id as users from request_accepted union all select accepter_id as users from request_accepted ), tmp2 as ( select users as id , count(*) as num from tmp group by 1 ), tmp3 as ( select id, num, dense_rank() over (order by num desc ) as rnk from tmp2 ) select id, num from tmp3 where rnk = 1
with valid_accepts as ( select requester_id, accepter_id from request_accepted where accepter_id is not Null ), valid_request as ( select requester_id, accepter_id from request_accepted where request_id is not Null ) select id, count(*) as num from( select accepter_id as id from valid_accepts where requester_id is not Null union all select requester_id as id from request_accepted where accepter_id is not Null) as a group by 1 order by num desc limit 1
with x as ( select requester_id as id , count(distinct accepter_id) as num from request_accepted group by 1 union all select accepter_id as id , count(distinct requester_id) as num from request_accepted group by 1 ) select id , sum(num) as num from x group by 1 order by 2 desc limit 1
