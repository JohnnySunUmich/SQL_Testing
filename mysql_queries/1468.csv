SELECT A.company_id, A.employee_id, A.employee_name, ROUND(A.SALARY - (A.SALARY * CASE WHEN B.MAX_SALARY > 10000 THEN 0.49 WHEN B.MAX_SALARY > 1000 THEN 0.24 ELSE 0 END),0) AS SALARY FROM SALARIES AS A JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) AS B ON A.COMPANY_ID=B.COMPANY_ID
SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) ELSE ROUND(0.51*SALARY) END AS SALARY FROM SALARIES
SELECT S.company_id, S.employee_id, S.employee_name, ROUND((S.salary*(1-T.rate)),0) 'salary' FROM Salaries S LEFT JOIN ( SELECT company_id, (CASE WHEN max(salary) < 1000 THEN 0 WHEN max(salary) >= 1000 AND max(salary) <= 10000 THEN 0.24 ELSE 0.49 END) 'rate' FROM Salaries GROUP BY 1 ) T ON S.company_id = T.company_id
SELECT S.company_id, S.employee_id, S.employee_name, ROUND(S.salary*(1-tax_percent),0) AS salary FROM Salaries S JOIN (SELECT company_id, (CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary)>10000 THEN 0.49 ELSE 0.24 END) AS tax_percent FROM Salaries GROUP BY company_id) T ON S.company_id=T.company_id
SELECT S.company_id, employee_id, employee_name, CASE WHEN max_salary < 1000 THEN salary WHEN max_salary > 10000 THEN ROUND(salary*(1-0.49)) ELSE ROUND(salary*(1-0.24)) END AS salary FROM Salaries S LEFT JOIN ( SELECT company_id , MAX(salary) AS max_salary FROM Salaries GROUP BY company_id ) as T ON S.company_id = T.company_id
SELECT S.company_id, employee_id, employee_name, ROUND(S.salary*after_tax) AS salary FROM Salaries AS S JOIN(SELECT company_id, CASE WHEN max_s < 1000 THEN 1 WHEN max_s BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS after_tax FROM (SELECT company_id, MAX(salary) AS max_s FROM Salaries GROUP BY company_id) AS T ) AS TS ON S.company_id = TS.company_id
SELECT S1.company_id, S1.employee_id, S1.employee_name, CASE WHEN S2.max_salary < 1000 THEN ROUND(S1.salary) WHEN S2.max_salary > 10000 THEN ROUND(S1.salary * 0.51) ELSE ROUND(S1.salary * 0.76) END AS 'salary' FROM Salaries S1 LEFT JOIN (SELECT company_id, max(salary) as 'max_salary' FROM Salaries GROUP BY company_id) S2 ON S1.company_id = S2.company_id
SELECT S2.company_id, S2.employee_id, S2.employee_name, ROUND((CASE WHEN S1.ms < 1000 THEN S2.salary WHEN S1.ms >= 1000 AND S1.ms <= 10000 THEN S2.salary * (1 - 0.24) WHEN S1.ms > 10000 THEN S2.salary * (1 - 0.49) END), 0) AS salary FROM (SELECT company_id, MAX(salary) as ms FROM Salaries GROUP BY company_id) AS S1 INNER JOIN Salaries S2 USING(company_id)
SELECT Salaries.company_id, Salaries.employee_id, Salaries.employee_name, ROUND((1 - tax_rate) * salary) AS salary FROM Salaries INNER JOIN ( SELECT company_id, ( CASE WHEN MAX(salary) < 1000 THEN .0 WHEN MAX(salary) >= 1000 AND MAX(salary) <= 10000 THEN .24 ELSE .49 END ) AS tax_rate FROM Salaries GROUP BY company_id ) AS Tax ON Salaries.company_id = Tax.company_id
SELECT Salaries.company_id, employee_id, employee_name, ROUND((CASE WHEN max_salary<1000 THEN salary WHEN max_salary>10000 THEN salary*(1-0.49) ELSE salary*(1-0.24) END)) AS salary FROM Salaries JOIN (SELECT company_id, MAX(Salary) AS max_salary FROM Salaries GROUP BY company_id) AS subquery ON Salaries.company_id=subquery.company_id
SELECT Salaries.company_id, employee_id, employee_name, ROUND(salary * effective_salary_rate, 0) AS salary FROM Salaries LEFT JOIN ( SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 1.0 WHEN MAX(salary) < 10000 THEN 0.76 ELSE 0.51 END AS effective_salary_rate FROM Salaries GROUP BY company_id) salary_rates ON Salaries.company_id = salary_rates.company_id
SELECT Salaries.company_id, employee_id, employee_name, ROUND(salary*(1-tax_rate)) as salary FROM Salaries JOIN (SELECT company_id, IF(MAX(salary)<1000, 0, IF(MAX(salary)>10000,0.49,0.24)) as tax_rate FROM Salaries GROUP BY company_id ) taxes USING(company_id)
SELECT Salaries.company_id, employee_id, employee_name, round(tax_rate*Salaries.salary,0) as salary FROM Salaries JOIN (SELECT company_id, (CASE WHEN max(salary)<1000 THEN 1 WHEN max(salary)>=1000 and max(salary)<10000 THEN 0.76 ELSE 0.51 END) as tax_rate FROM Salaries GROUP BY company_id) as temp ON Salaries.company_id = temp.company_id
SELECT a.company_id, a.employee_id, a.employee_name, CASE WHEN b.maxSal >= 1000 AND b.maxSal <= 10000 THEN ROUND(a.salary - a.salary*0.24) WHEN b.maxSal > 10000 THEN ROUND(a.salary - a.salary*0.49) ELSE ROUND(a.salary) END salary FROM Salaries a INNER JOIN ( SELECT company_id, MAX(salary) maxSal FROM Salaries GROUP BY company_id ) b ON a.company_id = b.company_id
SELECT a.company_id, employee_id, employee_name, ( CASE WHEN maxsalary<1000 then salary WHEN maxsalary>=1000 and maxsalary<=10000 then round((salary - 0.24*salary),0) else round((salary - 0.49*salary),0) end ) as Salary FROM Salaries a left join (Select company_id, max(salary) as maxsalary from Salaries group by company_id) b on a.company_id = b.company_id
SELECT a.company_id, employee_id, employee_name, CASE WHEN a.highest < 1000 THEN ROUND(s.salary) WHEN a.highest between 1000 AND 10000 THEN ROUND(s.salary-(24/100)*s.salary) WHEN a.highest > 10000 THEN ROUND(s.salary- (49/100)*s.salary) END AS salary FROM Salaries s JOIN (SELECT company_id, Max(salary) as highest FROM Salaries GROUP BY company_id) a ON s.company_id=a.company_id
SELECT a.company_id, employee_id, employee_name, CASE WHEN max_salary < 1000 THEN a.salary WHEN max_salary >= 1000 AND max_salary <= 10000 THEN ROUND(a.salary * (1-0.24), 0) WHEN max_salary > 10000 THEN ROUND(a.salary * (1-0.49), 0) END AS salary FROM Salaries a LEFT JOIN (SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id) b ON a.company_id = b.company_id
SELECT company_id, employee_id, employee_name ,ROUND(CASE WHEN MAX(salary) over(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) over(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary-(salary*.24) ELSE salary-(salary*.49) END,0) salary FROM salaries
SELECT company_id, employee_id, employee_name, (CASE WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN ROUND(salary*(1-(24/100))) WHEN MAX(salary) OVER(PARTITION BY company_id) > 10000 THEN ROUND(salary*(1-(49/100))) END) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, (CASE WHEN MAX(salary) OVER(PARTITION BY company_id) > 10000 THEN ROUND(salary * 0.51) WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN ROUND(salary * 0.76) END) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER (PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER (PARTITION BY company_id) > 10000 THEN ROUND(salary*(1-.49),0) ELSE ROUND(salary*(1-.24),0) END AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER (PARTITION BY company_id) <1000 THEN salary WHEN MAX(salary) OVER (PARTITION BY company_id) <=10000 AND MAX(salary) OVER (PARTITION BY company_id) >=1000 THEN ROUND(salary * (1-0.24),0) WHEN MAX(salary) OVER (PARTITION BY company_id) >10000 THEN ROUND(salary * (1-0.49),0) END AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) > 10000 THEN ROUND((1-0.49)*salary,0) ELSE ROUND((1-0.24)*salary,0) END AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN ROUND(salary - (0.24*salary),0) ELSE ROUND(salary - (0.49*salary),0) END AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER(PARTITION BY company_id)> 10000 THEN ROUND(0.51*salary) WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary ELSE ROUND(0.76*salary) END AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER(partition by company_id) < 1000 THEN salary WHEN MAX(salary) OVER(partition by company_id) > 10000 THEN ROUND(0.51*salary,0) ELSE ROUND(0.76*salary,0) END AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, CASE WHEN max_salary < 1000 THEN salary WHEN max_salary > 10000 THEN ROUND(salary*(1-0.49)) ELSE ROUND(salary*(1-0.24)) END AS salary FROM (SELECT s.*, MAX(salary) OVER(PARTITION BY company_id) AS max_salary FROM Salaries s) sub
SELECT company_id, employee_id, employee_name, CASE WHEN maxsalary>10000 THEN round((salary/100) * 51,0) WHEN maxsalary BETWEEN 1000 AND 100000 THEN round((salary/100) * 76,0) WHEN maxsalary < 1000 THEN salary END as salary FROM (SELECT company_id, employee_id, employee_name, salary, MAX(SALARY) OVER ( partition by company_id) as maxsalary FROM Salaries GROUP BY company_id,employee_id) as m
SELECT company_id, employee_id, employee_name, ROUND( (CASE WHEN max_salary < 1000 THEN 1 WHEN max_salary<=10000 THEN 0.76 ELSE 0.51 END)*salary, 0) AS salary FROM ( SELECT company_id, employee_id, employee_name,salary, MAX(salary) OVER(PARTITION BY company_id) AS max_salary FROM salaries )t
SELECT company_id, employee_id, employee_name, ROUND((CASE WHEN MAX(salary) OVER (PARTITION BY company_id)>10000 THEN 0.51*salary WHEN MAX(salary) OVER (PARTITION BY company_id)>=1000 THEN 0.76*salary ELSE salary END),0) salary FROM Salaries
SELECT company_id, employee_id, employee_name, ROUND((CASE WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary*(1-0.24) WHEN MAX(salary) OVER(PARTITION BY company_id) > 10000 THEN salary*(1-0.49) END),0) salary FROM Salaries
SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN MAX(salary) OVER (PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER (PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN (1-0.24)*salary ELSE (1-0.49)*salary END,0) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN MAX(salary) OVER (PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER (PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary * (1 - 0.24) ELSE salary * (1- 0.49) END) AS salary FROM salaries
SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary-(salary*0.24) ELSE salary - (salary*0.49) END,0) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN MAX(salary) OVER(PARTITION BY company_id) <1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary*(1-0.24) ELSE salary*(1-0.49) END,0) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN MAX(salary) OVER(PARTITION BY company_id)<1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary-salary*(24/100) ELSE salary-salary*(49/100) END,0) AS salary FROM Salaries ORDER BY employee_id
SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN ma < 1000 THEN salary WHEN ma > 10000 THEN salary*(1-.49) ELSE salary*(1-.24) END, 0) AS salary FROM (SELECT *, MAX(salary) OVER (PARTITION BY company_id) AS ma FROM salaries) s
SELECT company_id, employee_id, employee_name, ROUND(salary * ratio, 0) AS salary FROM (SELECT *, CASE WHEN max_salary < 1000 THEN 1 WHEN max_salary > 10000 THEN 0.51 ELSE 0.76 END AS ratio FROM Salaries AS s JOIN (SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id) AS sub USING(company_id)) AS sub2
SELECT company_id, employee_id, employee_name, ROUND(salary*( CASE WHEN MAX(salary) OVER(PARTITION BY company_id)<1000 THEN 100 WHEN MAX(salary) OVER(PARTITION BY company_id)<10000 THEN 76 ELSE 51 END )/100) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, ROUND(salary*(1 - (CASE WHEN MAX_Salary > 10000 THEN 0.49 WHEN MAX_Salary < 1000 THEN 0 ELSE 0.24 END))) AS salary FROM ( SELECT company_id, employee_id, employee_name, salary, MAX(salary) OVER (PARTITION BY company_id) AS MAX_Salary FROM Salaries ) s
SELECT company_id, employee_id, employee_name, ROUND(salary*(1-tax_rate)) AS salary FROM ( SELECT company_id, employee_id, employee_name, salary, MAX(salary) OVER (PARTITION BY company_id) company_max, CASE WHEN MAX(salary) OVER (PARTITION BY company_id) < 1000 THEN 0 WHEN MAX(salary) OVER (PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS tax_rate FROM Salaries ) t
SELECT company_id, employee_id, employee_name, ROUND(salary*(CASE WHEN MAX(salary) OVER(PARTITION BY company_id) > 10000 THEN 0.51 WHEN MAX(salary) OVER(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN 1 END),0) AS salary FROM Salaries
SELECT company_id, employee_id, employee_name, case when max(salary) over (partition by company_id)< 1000 THEN round(salary,0) when max(salary) over (partition by company_id) between 1000 and 10000 then round(salary * .76,0) when max(salary) over (partition by company_id) > 10000 then round(salary * .51,0) else NULL end as salary FROM Salaries
SELECT company_id, employee_id, employee_name, case when max_company_salary <1000 then salary when max_company_salary between 1000 and 10000 then round(salary*0.76,0) when max_company_salary >10000 then round(salary*0.51,0) end as salary from ( SELECT company_id, employee_id, employee_name, salary, max(salary) over(partition by company_id order by company_id) as max_company_salary FROM Salaries ) a
SELECT company_id, employee_id, employee_name, round(salary - (salary * tax_rate),0) as salary FROM ( SELECT *, case when max_salary < 1000 then 0 when max_salary > 1000 and max_salary <= 10000 then 0.24 else 0.49 end as tax_rate FROM ( SELECT company_id, employee_id, employee_name, salary, max(salary) over(partition by company_id) as max_salary FROM Salaries ) a )b
SELECT company_id, employee_id,employee_name, ROUND(CASE WHEN MAX(salary) over(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) over(PARTITION BY company_id) BETWEEN 1000 AND 10000 THEN salary-(salary*.24) ElSE salary-(salary*0.49) END,0) salary FROM salaries
SELECT company_id,employee_id, employee_name,(CASE WHEN Max_Salary<1000 THEN salary WHEN Max_Salary>=1000 AND Max_Salary<=10000 THEN ROUND(salary*(1-0.24),0) ELSE ROUND(salary*(1-0.49),0) END) AS salary FROM (SELECT *, MAX(salary) OVER(PARTITION BY company_id) AS Max_Salary FROM Salaries) a
SELECT s.company_id , s.employee_id , employee_name , round(salary * t.taxes) as salary FROM Salaries s JOIN ( select company_id , case when max(salary) < 1000 then 1 when max(salary) <= 10000 then 0.76 else 0.51 end as taxes FROM Salaries GROUP BY company_id) t on t.company_id = s.company_id
SELECT s.company_id AS company_id, s.employee_id AS employee_id, s.employee_name AS employee_name, CASE WHEN s.max_salary < 1000 THEN s.salary WHEN 1000 <= s.max_salary AND s.max_salary <= 10000 THEN ROUND(s.salary * 0.76,0) WHEN s.max_salary > 10000 THEN ROUND(s.salary * 0.51,0) END AS salary FROM ( SELECT s1.company_id, s1.employee_id, s1.employee_name, s1.salary, s2.max_salary FROM Salaries s1 JOIN ( SELECT company_id, MAX(Salary) AS max_salary FROM Salaries GROUP BY company_id ) AS s2 ON s1.company_id = s2.company_id ) AS s
SELECT s.company_id, employee_id, employee_name, CASE WHEN MAX(salary) OVER(PARTITION BY company_id) < 1000 THEN salary WHEN MAX(salary) OVER(PARTITION BY company_id) >= 1000 AND MAX(salary) OVER(PARTITION BY company_id) <= 10000 THEN ROUND(salary - (salary * .24)) WHEN MAX(salary) OVER(PARTITION BY company_id) > 10000 THEN ROUND(salary - (salary *.49)) END AS salary FROM Salaries s
SELECT s.company_id, employee_id, employee_name, ROUND(CASE WHEN max_salary < 1000 THEN salary WHEN max_salary BETWEEN 1000 AND 10000 THEN salary * (1 - 0.24) WHEN max_salary > 10000 THEN salary * (1 - 0.49) END) AS salary FROM (SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id) a JOIN Salaries s ON a.company_id = s.company_id
SELECT s.company_id, s.employee_id, s.employee_name, ROUND((s.salary * (CASE WHEN t.max_salary < 1000 THEN 1 WHEN t.max_salary >= 1000 AND t.max_salary <= 10000 THEN 0.76 ELSE 0.51 END)), 0) AS salary FROM Salaries s JOIN ( SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id ) t ON s.company_id = t.company_id
SELECT s.company_id, s.employee_id, s.employee_name, ROUND(CASE WHEN max <1000 THEN salary WHEN max between 1000 and 10000 THEN 0.76*salary ELSE 0.51*salary END,0) salary FROM Salaries s JOIN ( SELECT company_id,MAX(salary) max FROM Salaries GROUP BY company_id ) t ON s.company_id = t.company_id
SELECT s.company_id, s.employee_id, s.employee_name, ROUND(CASE WHEN max <1000 THEN salary WHEN max>=1000 AND max<=10000 THEN 0.76*salary ELSE 0.51*salary END,0) salary FROM Salaries s JOIN ( SELECT company_id,MAX(salary) max FROM Salaries GROUP BY company_id ) t ON s.company_id = t.company_id
SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary * (1 - sub.tax_rate), 0) AS salary FROM Salaries s INNER JOIN (SELECT company_id, MAX(salary) AS max_salary, CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS tax_rate FROM Salaries GROUP BY company_id) sub ON s.company_id = sub.company_id
SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary*t.tax, 0) AS salary FROM Salaries s JOIN ( SELECT company_id, ( CASE WHEN MAX(salary) < 1000 THEN 1 WHEN MAX(salary) <= 10000 THEN 0.76 ELSE 0.51 END ) AS tax FROM Salaries GROUP BY company_id ) t ON s.company_id = t.company_id
SELECT s1.company_id, employee_id, employee_name, ROUND(salary*(1-tax_percent),0) AS salary FROM Salaries s1 JOIN (SELECT company_id, (CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary)>10000 THEN 0.49 ELSE 0.24 END) AS tax_percent FROM Salaries GROUP BY company_id) t1 ON s1.company_id=t1.company_id
SELECT s1.company_id, s1.employee_id, s1.employee_name, ROUND(s1.salary * CASE WHEN s2.max_salary < 1000 THEN 1 WHEN s2.max_salary >= 1000 AND s2.max_salary <= 10000 THEN 0.76 ELSE 0.51 END,0) as salary FROM Salaries s1 LEFT JOIN ( SELECT company_id, MAX(salary) as max_salary FROM Salaries GROUP BY 1) s2 ON s1.company_id = s2.company_id
Select S.company_id, S.employee_id, S.employee_name, Round(S.salary *(1-T.tax_rate),0) as salary From Salaries as S Left Join (Select company_id, employee_id, Case when Max(salary)<1000 then 0 when Max(salary)>=10000 then 0.49 Else 0.24 End as tax_rate From Salaries Group by company_id) as T ON S.company_id = T.company_id
Select Salaries.company_id, employee_id, employee_name, ROUND(salary*(1- tax_rate)) As salary From Salaries JOIN (Select company_id, IF(MAX(salary) < 1000, 0, IF(MAX(salary) > 10000, .49, .24)) As tax_rate From Salaries Group By company_id) taxes ON Salaries.company_id=taxes.company_id
Select a.company_id as company_id, a.employee_id as employee_id, a.employee_name as employee_name, Round((Case when max(b.salary) >= 10000 Then a.salary*0.51 when max(b.salary) >= 1000 Then a.salary*0.76 Else a.salary End),0) as salary From Salaries a, Salaries b Where a.company_id = b.company_id And a.salary <= b.salary Group by a.company_id, a.employee_id, a.employee_name
Select company_id, employee_id, employee_name, (Case When max(salary) over (partition by company_id) < 1000 Then salary When max(salary) over (partition by company_id) Between 1000 and 10000 Then Round(salary*0.76,0) When max(salary) over (partition by company_id) > 10000 Then Round(salary*(1-0.49),0) END) salary From Salaries
Select company_id, employee_id, employee_name, case when Max(salary) over (partition by company_id) < 1000 then salary when Max(salary) over (partition by company_id) > 10000 then Round((1-0.49) * salary, 0) else Round((1-0.24) * salary, 0) end as Salary From Salaries
Select company_id, employee_id, employee_name, round(case when max(salary) over (partition by company_id) < 1000 then salary*1 when max(salary) over (partition by company_id) between 1000 and 10000 then salary*0.76 when max(salary) over (partition by company_id) > 10000 then salary*0.51 end, 0) as salary from salaries
Select distinct company_id,employee_id,employee_name, CASE WHEN MAX(Salary) OVER (PARTITION BY company_id) <1000 then Salary WHEN MAX(Salary) OVER (PARTITION BY company_id) > 10000 THEN ROUND((salary - salary*.49),0) Else ROUND((salary - salary*.24),0) END as salary FROM Salaries order by 1
Select s.company_id,employee_id, employee_name, round(salary*(1-tax_Rate),0) as salary from salaries s left join (select company_id, case when max(salary) <1000 then 0.00 when max(salary) >=1000 and max(salary) <=10000 then 0.24 else 0.49 end as 'tax_Rate' from Salaries group by company_id) x on s.company_id = x.company_id
WITH CALC as ( select company_id , CASE WHEN max(salary) < 1000 THEN 0 WHEN max(salary) > 999 and max(salary) < 10001 THEN 24 WHEN max(salary) > 10000 THEN 49 END as tax_bracket from Salaries group by company_id ) select a.company_id , a.employee_id , a.employee_name , round((a.salary -((a.salary * b.tax_bracket)/100 )),0) as salary from Salaries A inner join CALC b on a.company_id = b.company_id
WITH CTE AS ( SELECT company_id, CASE WHEN max_sal < 1000 THEN 0 WHEN max_sal >= 1000 AND max_sal <= 10000 THEN 24 ELSE 49 END AS tax_rate FROM ( SELECT company_id, MAX(salary) as max_sal FROM Salaries GROUP BY company_id ) xx ) SELECT s.company_id, employee_id, employee_name, ROUND(salary - salary * tax_rate / 100, 0) AS salary FROM Salaries s LEFT JOIN CTE c ON c.company_id = s.company_id
WITH CTE AS ( SELECT company_id, MAX(salary) as max_sal FROM Salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND(CASE WHEN max_sal < 1000 THEN salary WHEN max_sal >= 1000 AND max_sal <= 10000 THEN salary - salary * 0.24 ELSE salary - salary * 0.49 END) AS salary FROM Salaries s LEFT JOIN CTE c ON c.company_id = s.company_id
WITH CTE AS (SELECT company_id, (CASE WHEN MAX(salary) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) > 10000 THEN 0.49 END) tax FROM Salaries GROUP BY company_id) SELECT S1.company_id, S1.employee_id, S1.employee_name, ROUND(salary*(1-tax),0) salary FROM Salaries S1 LEFT JOIN CTE ON S1.company_id = CTE.company_id
WITH CTE AS(SELECT company_id, employee_id, employee_name, salary, MAX(salary) as MS FROM Salaries GROUP BY company_id) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(CASE WHEN MS < 1000 THEN s.salary WHEN MS BETWEEN 1000 AND 10000 THEN s.salary * (1-0.24) WHEN MS > 10000 THEN s.salary * (1-0.49) END) AS salary FROM Salaries s JOIN cte ON s.company_id = CTE.company_id
WITH CTE1 AS ( SELECT company_id, employee_id, employee_name, salary, MAX(salary) OVER (PARTITION BY company_id) AS max_s FROM Salaries) SELECT company_id, employee_id, employee_name, ROUND((CASE WHEN max_s<1000 THEN 1 WHEN max_s>=1000 AND max_s<=10000 THEN 1-0.24 else 1-0.49 END)*salary, 0) AS salary FROM CTE1
WITH CTE1 AS (SELECT company_id, employee_id, employee_name, MAX(salary) as max_salary FROM salaries GROUP BY company_id) SELECT a.company_id, a.employee_id, a.employee_name, CASE WHEN b.max_salary>10000 THEN ROUND(salary - salary*49/100,0) WHEN b.max_salary>=1000 THEN ROUND(salary - salary*24/100,0) ELSE salary END as salary FROM salaries a LEFT JOIN CTE1 b ON a.company_id=b.company_id
WITH CompanyMaxSalaries AS ( SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id ), CompanyTax AS ( SELECT company_id, (CASE WHEN max_salary > 10000 THEN 0.49 WHEN max_salary > 1000 THEN 0.24 ELSE 0 END) AS tax_percent FROM CompanyMaxSalaries ), EmployeePaycheckAfterTax AS ( SELECT S.company_id, S.employee_id, S.employee_name, ROUND(S.salary * (1-C.tax_percent),0) AS salary FROM Salaries S INNER JOIN CompanyTax C ON S.company_id = C.company_id ) SELECT * FROM EmployeePaycheckAfterTax
WITH MAX_SAL AS( Select company_id, max(salary) AS sal FROM Salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND((CASE WHEN m.sal < 1000 THEN s.salary WHEN m.sal BETWEEN 1000 AND 10000 THEN (0.76)*s.salary ELSE (0.51)*s.salary END),0) AS salary FROM Salaries s JOIN MAX_SAL m ON s.company_id = m.company_id GROUP BY s.company_id, s.employee_id
WITH Max_salaries AS ( SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND(CASE WHEN max_salary < 1000 THEN salary WHEN max_salary > 10000 THEN 0.51*salary ELSE 0.76*salary END) AS salary FROM Salaries AS s JOIN Max_salaries AS m ON s.company_id = m.company_id
WITH Max_salaries AS ( SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND(CASE WHEN max_salary < 1000 THEN salary WHEN max_salary > 10000 THEN salary*0.51 ELSE salary*0.76 END) AS salary FROM Salaries AS s JOIN Max_salaries AS m ON s.company_id = m.company_id
WITH T1 AS (SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END tax_rate FROM salaries GROUP BY 1) SELECT company_id, employee_id, employee_name, ROUND(salary*(1-tax_rate)) salary FROM salaries JOIN T1 USING(company_id)
WITH T1 AS( SELECT *,MAX(salary) OVER (PARTITION BY company_id) AS highest_salary FROM Salaries) SELECT company_id,employee_id,employee_name, ROUND(salary*tax_rate,0) AS salary FROM ( SELECT *, CASE WHEN highest_salary < 1000 THEN 1 WHEN highest_salary >=1000 AND highest_salary < 10000 THEN 0.76 WHEN highest_salary >=10000 THEN 0.51 END AS tax_rate FROM T1) AS sub
WITH TaxRate AS (SELECT company_id ,CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) < 10000 THEN 0.24 ELSE 0.49 END AS Rate FROM Salaries GROUP BY company_id) SELECT S.company_id ,S.employee_id ,S.employee_name ,ROUND(S.salary * (1-TR.Rate)) AS salary FROM Salaries S INNER JOIN TaxRate TR ON TR.company_id = S.company_id
WITH TaxRates AS ( SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 0.0 WHEN MAX(salary) <= 10000 THEN 0.24 ELSE 0.49 END AS tax_rate FROM Salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND(salary * (1 - tax_rate)) AS 'salary' FROM Salaries AS s LEFT JOIN TaxRates AS t ON s.company_id = t.company_id
WITH c AS (SELECT company_id,CASE WHEN MAX(salary)<1000 THEN 1 WHEN MAX(salary) BETWEEN 1000 AND 10000 THEN 1-0.24 ELSE 1-0.49 END AS mul FROM Salaries GROUP BY company_id) SELECT s.company_id,s.employee_id,s.employee_name, ROUND(salary*mul,0) AS salary FROM Salaries s LEFT JOIN c USING (company_id)
WITH company as ( SELECT *, max(salary) as cmax_salary FROM Salaries GROUP BY company_id ), bracket as ( SELECT *, case WHEN cmax_salary < 1000 THEN 0 WHEN cmax_salary <= 10000 THEN .24 ELSE .49 END as tax_bracket FROM company ) SELECT s.company_id, s.employee_id, s.employee_name, round(s.salary - tax_bracket * s.salary, 0) as salary FROM Salaries s LEFT JOIN bracket b on s.company_id = b.company_id
WITH company as( SELECT company_id, CASE WHEN max(salary)<1000 THEN 0 WHEN max(salary)>=1000 AND max(salary)<=10000 THEN 0.24 WHEN max(salary)>10000 THEN 0.49 END as tax FROM Salaries GROUP BY company_id) SELECT Salaries.company_id,Salaries.employee_id,Salaries.employee_name, round(Salaries.salary*(1-company.tax),0) as salary FROM Salaries LEFT JOIN company ON Salaries.company_id = company.company_id
WITH cte AS ( SELECT company_id, MAX(salary) AS top_salary FROM Salaries GROUP BY 1 ) SELECT s.company_id, employee_id, employee_name, CASE WHEN top_salary < 1000 THEN salary WHEN top_salary >= 1000 AND top_salary <= 10000 THEN ROUND(salary - (salary * .24)) WHEN top_salary > 10000 THEN ROUND(salary - (salary *.49)) END AS salary FROM Salaries s LEFT JOIN cte USING (company_id)
WITH cte AS (SELECT * FROM salaries a JOIN (SELECT company_id, max(salary) AS com_sal FROM salaries group by company_id) a USING (company_id)) SELECT company_id, employee_id,employee_name, CASE WHEN com_sal < 1000 then salary WHEN com_sal BETWEEN 1000 AND 10000 THEN round(salary*(1-0.24),0) ELSE round(salary*(1-0.49),0) END AS salary FROM cte
WITH cte AS (SELECT company_id, CASE WHEN max_salary < 1000 THEN 0 WHEN max_salary >= 1000 AND max_salary <= 10000 THEN 0.24 WHEN max_salary > 10000 THEN 0.49 ELSE NULL END AS tax_rate FROM (SELECT DISTINCT company_id, MAX(salary) OVER(partition by company_id order by salary desc) AS max_salary FROM Salaries ) x ) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary - ( s.salary * tax_rate ),0) AS salary FROM Salaries s LEFT JOIN cte c ON c.company_id = s.company_id
WITH cte AS (SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id) SELECT S.company_id, S.employee_id, S.employee_name, (ROUND(CASE WHEN cte.max_salary < 1000 THEN S.salary WHEN cte.max_salary <= 10000 THEN S.salary * 0.76 ELSE S.salary * 0.51 END, 0)) AS salary FROM Salaries AS S JOIN cte ON S.company_id = cte.company_id
WITH cte AS( SELECT company_id, employee_id, employee_name, salary, MAX(salary)OVER(PARTITION BY company_id) AS maxs FROM salaries ) SELECT company_id, employee_id, employee_name, ROUND(salary*(1-rate)) AS salary FROM( SELECT company_id, employee_id, employee_name, salary, CASE WHEN maxs < 1000 THEN 0 WHEN maxs > 10000 THEN 0.49 ELSE 0.24 END AS rate FROM cte)a
WITH cte as( Select company_id, employee_id, employee_name, salary, max(salary) OVER (PARTITION by company_id) as 'max_salary_company' from Salaries ) Select company_id, employee_id, employee_name, CASE WHEN max_salary_company <1000 THEN ROUND(salary,0) WHEN max_salary_company>=1000 and max_salary_company<10000 THEN ROUND(salary * (0.76),0) WHEN max_salary_company>=10000 THEN ROUND(salary * (.51),0) ELSE salary END as 'salary' from cte
WITH cte1 as (SELECT company_id, employee_id, employee_name, salary, MAX(salary) OVER (PARTITION BY company_id) as max_emp_comp FROM Salaries) SELECT company_id, employee_id, employee_name, ROUND(CASE WHEN max_emp_comp < 1000 THEN salary WHEN max_emp_comp BETWEEN 1000 AND 10000 THEN salary - 0.24*(salary) WHEN max_emp_comp > 10000 THEN salary - 0.49*salary END, 0) as salary FROM cte1
WITH main AS ( SELECT *, MAX(salary) OVER(PARTITION BY company_id) AS max_salary FROM Salaries ) SELECT company_id, employee_id, employee_name, ROUND((CASE WHEN max_salary < 1000 THEN salary WHEN max_salary > 10000 THEN 0.51*salary ELSE 0.76*salary END),0) AS salary FROM main
WITH max_sal AS ( SELECT company_id, MAX(salary) max_salary FROM Salaries GROUP BY company_id), tax_rate AS ( SELECT company_id, CASE WHEN max_salary > 10000 THEN 0.49 WHEN max_salary BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS tax_rate FROM max_sal ) SELECT s.company_id, s.employee_id, s.employee_name, ROUND((s.salary - (s.salary * tax_rate.tax_rate)), 0) AS salary FROM Salaries s JOIN tax_rate ON s.company_id = tax_rate.company_id
WITH max_salaries AS (SELECT company_id, employee_id, employee_name, salary, MAX(salary) OVER(PARTITION BY company_id) AS max_salary FROM Salaries) SELECT company_id, employee_id, employee_name, CASE WHEN max_salary < 1000 THEN ROUND(salary * (1 -0), 0) WHEN max_salary BETWEEN 1000 AND 10000 THEN ROUND(salary * (1-0.24), 0) ELSE ROUND(salary * (1 - 0.49), 0) END AS salary FROM max_salaries
WITH max_salary_calc as ( SELECT company_id, MAX(salary) max_salary FROM Salaries GROUP BY company_id ) SELECT S.company_id, S.employee_id, S.employee_name, CASE WHEN M.max_salary<1000 THEN salary WHEN M.max_salary>=1000 AND M.max_salary<=10000 THEN ROUND((salary-((salary*24)/100)),0) ELSE ROUND((salary-((salary*49)/100)),0) END salary FROM Salaries S INNER JOIN max_salary_calc M ON S.company_id=M.company_id
WITH maxes AS ( SELECT company_id, MAX(salary) as max_salary FROM salaries GROUP BY company_id) SELECT salaries.company_id, employee_id, employee_name, CASE WHEN max_salary > 10000 THEN CAST(salary - (salary * .49) as UNSIGNED) WHEN max_salary >= 1000 AND max_salary <= 10000 THEN CAST(salary - (salary * .24) as UNSIGNED) ELSE salary END as salary FROM salaries INNER JOIN maxes ON salaries.company_id = maxes.company_id
WITH maxtab as ( SELECT company_id, max(salary) max_sal FROM Salaries GROUP BY company_id ) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(CASE WHEN max_sal < 1000 THEN Salary WHEN max_sal BETWEEN 1000 and 10000 THEN 0.76 * Salary ELSE 0.51 * Salary END,0) salary FROM maxtab m JOIN Salaries s ON m.company_id = s.company_id
WITH salary_cte AS ( SELECT company_id, employee_id, employee_name, MAX(salary) OVER( PARTITION BY company_id ORDER BY salary DESC) AS max_salary FROM Salaries ) SELECT DISTINCT * FROM ( SELECT s.company_id, s.employee_id, s.employee_name, (CASE WHEN a.max_salary < 1000 THEN s.salary WHEN a.max_salary BETWEEN 1000 AND 10000 THEN ROUND((s.salary - (s.salary * 0.24)), 0) WHEN a.max_salary > 10000 THEN ROUND((s.salary - (s.salary * 0.49)), 0) END) AS salary FROM Salaries s INNER JOIN salary_cte a ON s.company_id = a.company_id ) sub
WITH salary_cte AS ( SELECT company_id, employee_id, employee_name, MAX(salary) OVER( PARTITION BY company_id ORDER BY salary DESC) AS max_salary FROM Salaries ) SELECT DISTINCT * FROM ( SELECT s.company_id, s.employee_id, s.employee_name, (CASE WHEN a.max_salary < 1000 THEN s.salary WHEN a.max_salary BETWEEN 1000 AND 10000 THEN ROUND((s.salary - (s.salary * 0.24)), 0) WHEN a.max_salary > 10000 THEN ROUND((s.salary - (s.salary * 0.49)), 0) END) AS salary FROM Salaries s JOIN salary_cte a ON s.company_id = a.company_id ) sub
WITH sub AS ( SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY company_id ) SELECT Salaries.company_id, Salaries.employee_id, Salaries.employee_name, (CASE WHEN sub.max_salary < 1000 THEN ROUND(Salaries.salary) WHEN sub.max_salary BETWEEN 1000 AND 10000 THEN ROUND(Salaries.salary - Salaries.salary*0.24) ELSE ROUND(Salaries.salary - Salaries.salary*0.49) END) AS salary FROM Salaries JOIN sub ON Salaries.company_id = sub.company_id
WITH t AS (SELECT company_id, (CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) > 10000 THEN 0.49 ELSE 0.24 END) AS tax FROM Salaries GROUP BY company_id) SELECT s.company_id, s.employee_id, s.employee_name, ROUND((s.salary - s.salary*t.tax), 0) AS salary FROM Salaries s LEFT JOIN t ON s.company_id = t.company_id
WITH t AS (SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) > 10000 THEN 0.49 ELSE 0.24 END AS tax_rate FROM Salaries GROUP BY company_id) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary - (s.salary * t.tax_rate), 0) AS salary FROM Salaries s JOIN t ON s.company_id = t.company_id
WITH t AS (SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 0 WHEN MAX(salary) > 10000 THEN 0.49 ELSE 0.24 END AS tax_rate FROM Salaries GROUP BY company_id) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary - s.salary * t.tax_rate, 0) AS salary FROM Salaries s JOIN t ON s.company_id = t.company_id
WITH t AS( SELECT company_id, CASE WHEN MAX(salary) <1000 THEN 0 WHEN MAX(salary) >10000 THEN 0.49 ELSE 0.24 END AS trate FROM Salaries GROUP BY 1) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary - s.salary*t.trate,0) AS salary FROM t JOIN Salaries s ON t.company_id = s.company_id
WITH tab AS ( SELECT company_id, MAX(salary) AS max_salary FROM salaries GROUP BY 1) SELECT s.company_id, s.employee_id, s.employee_name, CASE WHEN t.max_salary < 1000 THEN ROUND(s.salary, 0) WHEN t.max_salary >=1000 AND t.max_salary <=10000 THEN ROUND(s.salary * (1-0.24),0) ELSE ROUND(s.salary * (1-0.49), 0) END AS salary FROM salaries AS s JOIN tab AS t ON t.company_id = s.company_id
WITH table1 AS ( SELECT *, MAX(salary) OVER (PARTITION BY company_id) AS max_salary FROM Salaries ) SELECT company_id, employee_id, employee_name, CASE WHEN max_salary <1000 THEN salary WHEN max_salary BETWEEN 1000 AND 10000 THEN ROUND(salary *(1-0.24),0) WHEN max_salary >10000 then ROUND(salary*(1-0.49),0) END AS salary FROM table1
WITH tax AS ( SELECT company_id, (CASE WHEN MAX(salary)<1000 THEN 0 WHEN MAX(salary)>=1000 AND MAX(salary)<=10000 THEN 0.24 ELSE 0.49 END) AS tax_rate FROM Salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND(s.salary*(1-t.tax_rate)) AS salary FROM Salaries s LEFT JOIN tax t ON s.company_id=t.company_id
WITH tax AS( SELECT company_id, (CASE WHEN MAX(salary) < 1000 THEN 1 WHEN MAX(salary) BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(salary) > 10000 THEN 0.51 END ) AS tax_factor FROM Salaries GROUP BY 1 ) SELECT s.company_id, employee_id, employee_name, ROUND((tax_factor * salary), 0) AS salary FROM Salaries s LEFT JOIN tax t ON s.company_id = t.company_id
WITH tax_multiplier AS ( SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 1.0 WHEN MAX(salary) <= 10000 THEN 0.76 ELSE 0.51 END AS mult FROM Salaries GROUP BY company_id ) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary * t.mult) AS salary FROM Salaries s JOIN tax_multiplier t ON s.company_id = t.company_id
WITH tax_r as ( select company_id, case when max(salary) < 1000 then 0 when ((max(salary) > 1000) and (max(salary) < 10000)) then 0.24 else 0.49 end as tax_rate from Salaries group by company_id ) select S.company_id, S.employee_id, S.employee_name, round(S.salary - (S.salary * tr.tax_rate)) as salary from salaries S left join tax_r tr on S.company_id = tr.company_id
WITH tax_rate AS ( SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 1 WHEN MAX(salary) <= 10000 THEN 0.76 ELSE 0.51 END AS rate FROM salaries GROUP BY company_id ) SELECT salaries.company_id, employee_id, employee_name, ROUND(salary * rate) AS salary FROM salaries JOIN tax_rate USING(company_id)
WITH tax_rate_per_company AS( SELECT temp.company_id AS company_id, CASE WHEN temp.max_salary >= 1000 AND temp.max_salary <= 10000 THEN 24 WHEN temp.max_salary > 10000 THEN 49 ELSE 0 END AS tax_rate FROM( SELECT company_id, MAX(salary) AS max_salary FROM Salaries GROUP BY 1 )temp ) SELECT temp.company_id AS company_id, temp.employee_id AS employee_id, temp.employee_name AS employee_name, ROUND(temp.salary * (100 - temp.tax_rate) / 100) AS salary FROM( SELECT s.company_id AS company_id, s.employee_id AS employee_id, s.employee_name AS employee_name, s.salary AS salary, t.tax_rate AS tax_rate FROM Salaries s JOIN tax_rate_per_company t ON s.company_id = t.company_id )temp
WITH tax_rates AS ( SELECT company_id, CASE WHEN MAX(salary) < 1000 THEN 0.0 WHEN MAX(salary) < 10000 THEN 0.24 ELSE 0.49 END AS tax_rate FROM salaries GROUP BY 1 ) SELECT s.company_id, employee_id, employee_name, ROUND(salary * (1-tax_rate)) AS salary FROM salaries s LEFT JOIN tax_rates t ON s.company_id = t.company_id
WITH temp AS ( SELECT company_id, CASE WHEN MAX(Salary) < 1000 THEN 1 WHEN MAX(Salary) BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS rate FROM Salaries GROUP BY company_id ) SELECT s.company_id, s.employee_id, s.employee_name, ROUND(s.salary * t.rate, 0) AS salary FROM Salaries s JOIN temp t ON s.company_id = t.company_id
WITH tmp AS ( SELECT company_id, employee_id, employee_name, salary, MAX(salary) OVER(PARTITION BY company_id) AS max_sal FROM Salaries ) SELECT company_id, employee_id, employee_name, CASE WHEN max_sal < 1000 THEN ROUND(salary) WHEN max_sal BETWEEN 1000 AND 10000 THEN ROUND(salary * (1-0.24)) ELSE ROUND(salary * (1-0.49)) END AS salary FROM tmp
With CTE As ( Select company_id, Case When Max(Salary) < 1000 Then 0 When Max(Salary) between 1000 and 10000 Then 0.24 When Max(Salary) > 10000 Then 0.49 End as Tax_Rate from Salaries group by company_id) Select a.company_id, a.employee_id, a.employee_name, Round(a.salary - (b.Tax_Rate*a.salary),0) as salary from salaries a join CTE b on a.company_id = b.company_id
With CTE as (select company_id, (case when max(salary) > 10000 then 0.49 when max(salary) < 1000 then 0 when 1000 < max(salary) and max(salary)<10000 then 0.24 else null end ) as tax from Salaries group by company_id) select s1.company_id, s1.employee_id, s1.employee_name, round(s1.salary*(1-tax), 0)as salary from Salaries s1 join CTE on s1.company_id = CTE.company_id order by company_id asc, employee_id asc
With a2 as (SELECT company_id,MAX(salary) as a FROM Salaries GROUP BY company_id) SELECT s.company_id , employee_id , employee_name, CASE WHEN a< 1000 then salary WHEN a between 1000 and 10000 then round(0.76*salary,0) ELSE round(0.51*salary,0) END AS salary FROM salaries s JOIN a2 ON a2.company_id=s.company_id
With cte as (select company_id, case when max(salary) < 1000 then 0 when max(salary) between 1000 and 10000 then 24 else 49 end as tax_perc from Salaries group by company_id) select s.company_id, employee_id, employee_name, ROUND((s.salary - (c.tax_perc/100)*(s.salary)),0) as salary from Salaries s inner join cte c on s.company_id = c.company_id
select A.company_id, B.employee_id, B.employee_name, case when A.max_salary<1000 then round(B.salary) when A.max_salary>=1000 and A.max_salary<=10000 then round(B.salary-B.salary*0.24) else round(B.salary - B.salary*0.49) end as salary from (select company_id, max(salary) as max_salary from Salaries group by company_id) A inner join Salaries B on A.company_id = B.company_id
select B.company_id,employee_id, employee_name, round(salary- (salary*(tax/100))) as salary from ( select company_id, case when max_sal <1000 then 0 when max_sal>=1000 and 10000>=max_sal then 24 else 49 end as tax from ( select company_id, max(salary) as max_sal from salaries group by company_id) A ) B join Salaries S on B.company_id=S.company_id
select S.company_id, S.employee_id,S.employee_name, Case when max(S.salary) over(partition by S.company_id)< 1000 then S.salary when max(S.salary) over(partition by S.company_id) between 1000 and 10000 then round(S.salary- 0.24*S.salary) when max(S.salary) over(partition by S.company_id) >10000 then round(S.salary- 0.49*S.salary) end as salary from salaries S
select S1.company_id, S1.employee_id, S1.employee_name, round((S1.salary - S1.salary * rate),0) as 'salary' from Salaries S1 join (select company_id, case when max(salary) < 1000 then 0 when max(salary) <= 10000 and max(salary) >= 1000 then 0.24 else 0.49 end as 'rate' from Salaries group by company_id) S2 on S1.company_id = S2.company_id order by 1, 2
select Salaries.company_id, Salaries.employee_id, Salaries.employee_name, round(case when salary_max<1000 then Salaries.salary when salary_max>=1000 and salary_max<=10000 then Salaries.salary * 0.76 else Salaries.salary * 0.51 end, 0) as salary from Salaries inner join ( select company_id, max(salary) as salary_max from Salaries group by company_id) as t on Salaries.company_id = t.company_id
select Salaries.company_id, employee_id, employee_name, round(case when max_salary between 1000 and 10000 then salary*0.76 when max_salary > 1000 then salary*0.51 else salary end,0) as salary from Salaries join (select company_id, max(salary) as max_salary from Salaries group by company_id) tmp on Salaries.company_id = tmp.company_id
select Salaries.company_id, employee_id, employee_name, round(salary * (1-tax_rate)) as salary from Salaries join (select company_id, if(max(salary) < 1000, 0, if(max(salary) >10000, 0.49, 0.24)) as tax_rate from Salaries group by company_id) taxes on Salaries.company_id = taxes.company_id
select a.company_id, a.employee_id, a.employee_name , round(case when maxsalary >10000 then salary*0.51 when maxsalary >= 1000 and maxsalary<=10000 then salary*0.76 else salary end, 0) as salary from Salaries a join ( select company_id, max(salary) as maxsalary from Salaries group by company_id ) b on a.company_id = b.company_id
select a.company_id, a.employee_id, a.employee_name , round(case when maxsalary >10000 then salary*0.51 when maxsalary >= 1000 and maxsalary<=10000 then salary*0.76 else salary end, 0) as salary from Salaries a join ( select company_id, max(salary) as maxsalary from Salaries group by company_id ) b using (company_id)
select a.company_id, a.employee_id, a.employee_name, case when a.max_sal<1000 then a.salary when a.max_sal>=1000 and a.max_sal<10000 then round(a.salary-salary*24/100) else round(a.salary-salary*49/100) end as salary from (select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_sal from salaries)a
select a.company_id, a.employee_id, a.employee_name, round( (case when a.maxx < 1000 then a.salary when a.maxx <= 10000 and a.maxx >= 1000 then a.salary - a.salary * (24/100) else a.salary - a.salary * (49/100) end) ,0) as salary from (select company_id, employee_id, employee_name, salary, max(salary) over(partition by company_id )as maxx from Salaries) a
select a.company_id, a.employee_id, a.employee_name, round((a.salary) - (a.salary*b.tax_bracket)/100) as salary from salaries a inner join (select company_id, max(salary), case when max(salary) < 1000 then 0 when max(salary) > 10000 then 49 else 24 end as tax_bracket from salaries group by company_id) b on a.company_id = b.company_id
select a.company_id, a.employee_id, a.employee_name, round((case when x.max_salary between 1000 and 10000 then salary*0.76 when x.max_salary > 10000 then salary*0.51 else a.salary end)) as salary from salaries as a join (select company_id, max(salary) as max_salary from salaries group by company_id) as x on a.company_id=x.company_id
select a.company_id, a.employee_id, a.employee_name, round(case when b.salary < 1000 then a.salary when b.salary <= 10000 then a.salary*0.76 else a.salary*0.51 end, 0) as salary from salaries a inner join (select company_id, max(salary) salary from salaries group by 1) b on a.company_id = b.company_id
select a.company_id, a.employee_id, a.employee_name, round(case when x.max_sal between 1000 and 10000 then 0.76*a.salary when x.max_sal > 10000 then 0.51*a.salary else a.salary end) as salary from salaries as a join (select company_id, max(salary) as max_sal from salaries group by company_id) as x on a.company_id=x.company_id
select a.company_id, a.employee_id, a.employee_name, round(case when x.max_sal between 1000 and 10000 then a.salary*0.76 when x.max_sal > 10000 then 0.51*a.salary else a.salary end) as salary from salaries as a join (select company_id, max(salary) as max_sal from salaries group by company_id) as x using(company_id)
select a.company_id, a.employee_id, a.employee_name, round(case when x.max_sal between 1000 and 10000 then a.salary*0.76 when x.max_sal > 10000 then a.salary*0.51 else a.salary end) as salary from salaries as a join (select company_id, max(salary) as max_sal from salaries group by company_id) as x on a.company_id=x.company_id
select a.company_id, a.employee_id, a.employee_name, round(case when x.max_sal between 1000 and 10000 then a.salary*0.76 when x.max_sal > 10000 then a.salary*0.51 else a.salary end) as salary from salaries as a join (select company_id, max(salary) as max_sal from salaries group by company_id) as x using(company_id)
select a.company_id, a.employee_id, a.employee_name, round(case when x.max_sal between 1000 and 10000 then salary*0.76 when x.max_sal > 10000 then salary*0.51 else salary end) as salary from salaries as a join (select company_id, max(salary) as max_sal from salaries group by company_id) as x on a.company_id=x.company_id
select a.company_id, employee_id, employee_name, IF(max_salary > 10000, ROUND(salary * 0.51), IF(max_salary > 1000, ROUND(salary * 0.76), salary)) as salary from Salaries as a join (select company_id, max(salary) as max_salary from Salaries group by company_id) as b on a.company_id = b.company_id
select a.company_id, employee_id, employee_name, round(a.salary * (1 - b.tax_rate), 0) as salary from salaries a join (select company_id, case when max(salary) < 1000 then 0 when max(salary) >= 1000 and max(salary) <= 10000 then 0.24 when max(salary) > 10000 then 0.49 end as tax_rate from salaries group by company_id) b on a.company_id = b.company_id
select a.company_id, employee_id, employee_name, round(case when num < 1000 then salary when num >= 1000 and num <= 10000 then salary * (1-0.24) when num > 10000 then salary * (1-0.49) end,0) as salary from salaries a join (select company_id, max(salary) as num from salaries group by company_id) b on a.company_id = b.company_id
select a.company_id,a.employee_id, a.employee_name, case when b.sl < 1000 then salary when b.sl between 1000 and 10000 then round(0.76*salary) when b.sl > 10000 then round(0.51*salary) end as salary from salaries as a left join (select company_id, max(salary) as sl from salaries group by company_id) as b on a.company_id=b.company_id
select a.company_id,a.employee_id,a.employee_name, round((case when a.max<1000 then a.salary when a.max between 1000 and 10000 then 0.76*a.salary when a.max>10000 then 0.51*a.salary end ),0) as salary from (select s.company_id,s.employee_id,s.employee_name,s.salary, max(s.salary) over(partition by s.company_id ) as max from Salaries as s)a
select a.company_id,a.employee_id,a.employee_name,round(salary-salary*rating/100,0) as 'salary' from (select company_id, employee_id , employee_name, salary, case when max(salary) over(partition by company_id)>10000 then 49 when max(salary) over(partition by company_id)>=1000 and max(salary) over(partition by company_id)<=10000 then 24 else 0 end as 'rating' from Salaries )a
select c.company_id, c.employee_id, c.employee_name, case when max_salary < 1000 then c.salary when max_salary <10001 then round(c.salary*0.76,0) else round(c.salary*0.51,0) end as salary from (select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_salary from salaries) c
select company_id , employee_id , employee_name, case when MAX(salary) OVER(PARTITION BY company_id)<1000 then round(salary) when MAX(salary) OVER(PARTITION BY company_id)between 1000 and 10000 then round(salary-salary*0.24) when MAX(salary) OVER(PARTITION BY company_id) > 10000 then round(salary-salary*0.49) end as salary from Salaries
select company_id ,employee_id,employee_name, case when max_sal<1000 then salary when max_sal between 1000 and 10000 then round(0.76*salary) else round(0.51*salary) end as salary from (select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_sal from Salaries) as s
select company_id, employee_id, employee_name, ( case when max(salary) over(partition by company_id) < 1000 then salary when max(salary) over(partition by company_id) between 1000 and 10000 then round(salary*.76) when max(salary) over(partition by company_id) > 10000 then round(salary*.51) end ) as salary from Salaries
select company_id, employee_id, employee_name, (case when max(salary) over (partition by company_id) < 1000 then salary when max(salary) over (partition by company_id) <= 10000 then round(salary - salary * 0.24,0) else round(salary - salary * 0.49,0) end) as salary from salaries
select company_id, employee_id, employee_name, (case when max(salary) over (partition by company_id) < 1000 then salary when max(salary) over (partition by company_id) between 1000 and 10000 then round(salary - salary * 0.24,0) else round(salary - salary * 0.49,0) end) as salary from salaries
select company_id, employee_id, employee_name, (case when max(salary) over (partition by company_id) <1000 then round(salary,0) when max(salary) over (partition by company_id) >=1000 and max(salary) over (partition by company_id)<=10000 then round((1-24/100)*salary,0) else round(((1-49/100)*salary),0) end) as salary from Salaries
select company_id, employee_id, employee_name, (case when max(salary) over(partition by company_id) < 1000 THEN salary when max(salary) over(partition by company_id) between 1000 and 10000 THEN ROUND(salary*(1-24/100)) when max(salary) over(partition by company_id) > 10000 THEN ROUND(salary*(1-(49/100))) end) as salary from Salaries
select company_id, employee_id, employee_name, (case when max(salary) over(partition by company_id) < 1000 then salary when max(salary) over(partition by company_id) > 10000 then round(salary - 0.49*salary,0) else round(salary - 0.24*salary,0) end) as salary from Salaries
select company_id, employee_id, employee_name, (case when max(salary) over(partition by company_id) < 1000 then salary when max(salary) over(partition by company_id) > 10000 then round(salary*(1-0.49),0) else round(salary*(1-0.24),0) end) as salary from salaries
select company_id, employee_id, employee_name, (case when max_salary < 1000 then round(salary) when max_salary between 1000 and 10000 then round(salary*(1-0.24)) else round(salary*(1-0.49)) end) as salary from (select *, max(salary) over (partition by company_id) as max_salary from Salaries) t
select company_id, employee_id, employee_name, (case when mxsa < 1000 then round(salary,0) when mxsa >= 1000 and mxsa <= 10000 then round((salary * 76)/100,0) when mxsa > 10000 then round((salary * 51)/100,0) end ) as salary from ( select *, max(salary) over(partition by company_id) as mxsa from salaries ) dudu
select company_id, employee_id, employee_name, ROUND(CASE WHEN max_salary < 1000 THEN salary WHEN max_salary >= 1000 and max_salary <= 10000 THEN salary *0.76 WHEN max_salary > 10000 THEN salary * 0.51 END) as salary from( select *, MAX(salary) OVER(partition by company_id) as max_salary from Salaries) t
select company_id, employee_id, employee_name, case when max(salary) over (partition by company_id) < 1000 then 1*salary when 10000< max(salary) over (partition by company_id) then round(0.51*salary,0) else round(0.76*salary,0) end as salary from salaries
select company_id, employee_id, employee_name, case when max(salary) over (partition by company_id) < 1000 then round(salary,0) when max(salary) over (partition by company_id) BETWEEN 1000 AND 10000 then round((salary-salary*0.24),0) else round((salary-salary*0.49),0) end as salary from salaries
select company_id, employee_id, employee_name, case when max(salary) over (partition by company_id) < 1000 then salary when max(salary) over (partition by company_id) between 1000 and 10000 then round(salary*0.76,0) when max(salary) over (partition by company_id) > 10000 then round(salary*0.51,0) end as salary from salaries
select company_id, employee_id, employee_name, case when max(salary) over (partition by company_id) <1000 then salary when max(salary) over (partition by company_id) between 1000 and 10000 then round(salary* (1-0.24),0) else round(salary*(1-0.49),0) end as salary from Salaries
select company_id, employee_id, employee_name, case when max(salary) over (partition by company_id) <1000 then salary when max(salary) over (partition by company_id)>=1000 and max(salary) over (partition by company_id)<=10000 then round(salary* (1-0.24),0) else round(salary*(1-0.49),0) end as salary from Salaries
select company_id, employee_id, employee_name, case when max(salary) over (partition by company_id) <1000 then salary when max(salary) over (partition by company_id)>=1000 and max(salary) over (partition by company_id)<=10000 then round(salary* (1-0.24),0) else round(salary*(1-0.49),0) end as salary from Salaries group by 1,2,3
select company_id, employee_id, employee_name, case when max(salary) over(partition by company_id) < 1000 then salary when max(salary) over(partition by company_id) <= 10000 then round(salary * (1 - 0.24), 0) else round(salary * (1 - 0.49), 0) end as salary from salaries
select company_id, employee_id, employee_name, case when max(salary) over(partition by company_id) > 10000 then round((.51*salary),0) when max(salary) over(partition by company_id) > 1000 then round((.76*salary),0) else round(salary,0) end as salary from salaries
select company_id, employee_id, employee_name, case when max(salary) over(partition by company_id)<1000 then salary when max(salary) over(partition by company_id) between 1000 and 10000 then round(salary*0.76,0) else round(salary*0.51,0) end salary from salaries
select company_id, employee_id, employee_name, case when max_salary < 1000 then salary when max_salary >=1000 and max_salary <=10000 then round(salary-salary*0.24,0) when max_salary > 10000 then round(salary-0.49*salary,0) end as salary from (select company_id, employee_id, employee_name,salary, max(salary) over(partition by company_id) as max_salary from Salaries) tbl
select company_id, employee_id, employee_name, case when max_salary < 1000 then salary when max_salary between 1000 and 10000 then round((1-0.24) * salary) when max_salary > 10000 then round((1-0.49) * salary) else null end as salary from( select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_salary from Salaries) as TMP
select company_id, employee_id, employee_name, case when max_salary < 1000 then salary when max_salary between 1000 and 10000 then round(salary*(1-0.24),0) when max_salary > 10000 then round(salary*(1-0.49),0) end as salary from ( select *, max(salary) over(partition by company_id) as max_salary from Salaries ) s
select company_id, employee_id, employee_name, case when max_salary <1000 then salary when max_salary >=1000 and max_salary <=10000 then round(salary * (1-0.24)) else round(salary*(1-0.49)) end as salary from ( select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_salary from Salaries) TBL
select company_id, employee_id, employee_name, case when max_salary <1000 then salary when max_salary between 1000 and 10000 then round(salary*0.76,0) when max_salary >10000 then round(salary*0.51,0) end as salary from (select * , max(salary)over(partition by company_id) as max_salary from salaries) a
select company_id, employee_id, employee_name, case when s1.maxSalary<1000 then round(s1.salary) when s1.maxSalary between 1000 and 10000 then round(s1.salary-0.24*s1.salary) when s1.maxSalary>10000 then round(s1.salary-0.49*s1.salary) end as salary from (select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as maxSalary from salaries) as s1
select company_id, employee_id, employee_name, round( case when max(salary) over (partition by company_id) >= 10000 then salary * 0.51 when max(salary) over (partition by company_id) >= 1000 then salary * 0.76 else salary end , 0) as salary from Salaries
select company_id, employee_id, employee_name, round(( case when tax < 1000 then salary when tax > 10000 then .51 * salary else .76 * salary end )) as salary from ( select *, max(salary) over(partition by company_id) as tax from Salaries ) as tmp
select company_id, employee_id, employee_name, round((case when maxi<1000 then salary when maxi between 1000 and 10000 then salary*0.76 when maxi>10000 then salary*0.51 end),0) 'salary' from (select s.*, b.maxi from salaries s join (select company_id, max(salary) 'maxi' from salaries group by company_id) b on s.company_id=b.company_id) c group by company_id, employee_id, employee_name
select company_id, employee_id, employee_name, round(case when max(salary) over (partition by company_id)<1000 then salary when max(salary) over (partition by company_id)>10000 then salary*(1-0.49) else salary*(1-0.24) end,0) salary FROM salaries
select company_id, employee_id, employee_name, round(case when max(salary) over(partition by company_id) > 10000 then salary-.49*salary when max(salary) over(partition by company_id) between 1000 and 10000 then salary-.24*salary when max(salary) over(partition by company_id) <1000 then salary end,0) as salary from Salaries group by 1,2,3
select company_id, employee_id, employee_name, round(case when max_salary < 1000 then salary when max_salary <10000 then salary *0.76 else salary*0.51 end) as salary from (select *, max(salary) over (partition by company_id) as max_salary from Salaries ) s
select company_id, employee_id, employee_name, round(case when max_salary < 1000 then salary when max_salary between 1000 and 10000 then salary*(1-0.24) when max_salary > 10000 then salary*(0.51) end) as salary from (select *, max(salary) over (partition by company_id) as max_salary from Salaries)t
select company_id, employee_id, employee_name, round(case when maxsalary < 1000 then salary when maxsalary between 1000 and 10000 then salary*.76 when maxsalary > 10000 then salary*.51 end, 0) as salary from (select company_id, employee_id, employee_name, salary, max(salary) over(partition by company_id) as maxsalary from Salaries) t1
select company_id, employee_id,employee_name, round(salary * (1-tax_rate), 0 ) as salary from salaries as t1 join (select company_id, case when max(salary) <1000 then 0 when max(salary) > 10000 then 0.49 else 0.24 end as tax_rate from salaries group by company_id) as t2 using (company_id)
select company_id,employee_id, employee_name, case when max(salary)over(partition by company_id) < 1000 then salary when max(salary)over(partition by company_id) > 10000 then round(salary - (salary*0.49)) else round(salary - (salary*0.24)) end as salary from Salaries
select company_id,employee_id,employee_name, case when m<1000 then salary when m between 1000 and 10000 then round(salary-(salary*0.24),0) when m>10000 then round(salary-(salary*0.49),0) end as Salary from (select *,max(salary) over(partition by company_id) as m from Salaries) as t1
select company_id,employee_id,employee_name,round(case when max(salary) over(partition by company_id) <1000 then (salary) when max(salary) over(partition by company_id)>= 1000 and max(salary) over(partition by company_id)<=10000 then salary-((salary*24)/100) when max(salary) over(partition by company_id) > 10000 then salary-((salary*49)/100) end,0) as salary from salaries group by 1,2
select company_id,employee_id,employee_name,round(salary - salary*tax_rate,0) as salary from ( select *, case when max(salary) over(partition by company_id)<1000 then 0 when max(salary) over(partition by company_id) between 1000 and 10000 then 0.24 else 0.49 end as tax_rate from salaries ) a
select e.company_id, e.employee_id, e.employee_name, round(e.salary - c.tax_rate * e.salary) as salary from Salaries e join ( select company_id, case when max(salary) < 1000 then 0 when max(salary) >= 1000 and max(salary) <= 10000 then 0.24 when max(salary) > 10000 then 0.49 else 0 end as tax_rate from Salaries group by 1 ) c using(company_id)
select s.company_id , s.employee_id , s.employee_name , round(case when m_sal < 1000 then s.salary when m_sal between 1000 and 10000 then s.salary - ((24 / 100) * s.salary ) when m_sal >= 10000 then s.salary - ((49 / 100) * s.salary ) end) salary from Salaries s inner join (select company_id, max(salary) as m_sal from Salaries group by company_id) a on a.company_id= s.company_id
select s.company_id , s.employee_id , s.employee_name , round(s.salary*t1.net_tax,0) as salary from Salaries s inner join (select company_id, case when max(salary) < 1000 then 1 when max(salary) >=1000 and max(salary) <=10000 then 0.76 when max(salary) > 10000 then 0.51 end as net_tax from Salaries group by 1) t1 on s.company_id=t1.company_id
select s.company_id as company_id , employee_id, employee_name, round(salary*rate) as salary from salaries s join (select company_id, case when max(salary) < 1000 then 1 when max(salary) > 10000 then 1-0.49 else 1-0.24 end as rate from salaries group by 1) a on s.company_id = a.company_id
select s.company_id, employee_id, employee_name, round(case when max_salary < 1000 then salary when max_salary >= 1000 and max_salary <= 10000 then salary * (1-0.24) when max_salary > 10000 then salary * (1-0.49) else null end) as salary from Salaries s left join ( select company_id, max(salary) as max_salary from Salaries group by 1 ) t on (s.company_id = t.company_id)
select s.company_id, employee_id, employee_name, round(case when maxs <1000 then salary when maxs >= 1000 and maxs <= 10000 then salary *(1-0.24) else salary * (1-0.49) end) as salary from salaries s join (select company_id, max(salary) as maxs from salaries group by 1) b on s.company_id = b.company_id
select s.company_id, employee_id, employee_name, round(case when tax_level = 'I' then salary when tax_level = 'II' then salary - 0.24 * (salary) else salary -(salary) * 0.49 end,0) as salary from salaries s join ( select company_id, case when max(salary) < 1000 then 'I' when max(salary) <= 10000 then 'II' else 'III' end tax_level from salaries group by company_id ) c on s.company_id = c.company_id
select s.company_id, employee_id, employee_name, round(salary * (1 - tax_rate)) as salary from salaries s join ( select company_id, CASE WHEN max(salary) < 1000 THEN 0 WHEN max(salary) between 1000 and 10000 THEN 0.24 ELSE 0.49 END AS tax_rate from salaries group by 1 ) c on c.company_id = s.company_id
select s.company_id, employee_id, employee_name, round(salary * (1 - tax_rate)) as salary from salaries s join ( select company_id, case when max(salary) < 1000 then 0 when max(salary) between 1000 and 10000 then 0.24 else 0.49 end as tax_rate from salaries group by 1 ) c on c.company_id = s.company_id
select s.company_id, employee_id, employee_name, round(salary - salary * (case when max between 1000 AND 10000 then 0.24 when max > 10000 then 0.49 else 0 end)) as salary from salaries s left join (select company_id, max(salary) as max from salaries group by company_id) as max on s.company_id = max.company_id
select s.company_id, employee_id, employee_name, round(salary*(1-tax_rate)) as salary from Salaries s left join (select company_id, case when max(salary)>10000 then 0.49 when max(salary) between 1000 and 10000 then 0.24 else 0 end as tax_rate from Salaries group by company_id) t on s.company_id=t.company_id
select s.company_id, s.employee_id, s.employee_name, case when max_salary < 1000 then salary when max_salary > 10000 then round(salary*(1-0.49),0) else round(salary*(1-0.24),0) end as salary from Salaries s left join (select company_id, max(salary) as max_salary from Salaries group by 1) t on s.company_id = t.company_id
select s.company_id, s.employee_id, s.employee_name, case when t.msalary<1000 then s.salary when t.msalary >= 1000 and t.msalary <= 10000 then round(s.salary *(1-.24),0) when t.msalary > 10000 then round(s.salary *(1-.49),0) end as salary from salaries as s left join (select company_id, max(salary) as msalary from salaries group by company_id) as t on s.company_id = t.company_id
select s.company_id, s.employee_id, s.employee_name, round( case when x.max_sal between 1000 and 10000 then salary * 0.76 when x.max_sal > 10000 then salary * 0.51 else salary end, 0) as salary from salaries s inner join (select company_id, max(salary) max_sal from salaries group by company_id) x on s.company_id = x.company_id
select s.company_id, s.employee_id, s.employee_name, round( case when x.max_sal between 1000 and 10000 then salary * 0.76 when x.max_sal > 10000 then salary * 0.51 else salary end, 0) as salary from salaries s left join (select company_id, max(salary) max_sal from salaries group by company_id) x on s.company_id = x.company_id
select s.company_id, s.employee_id, s.employee_name, round(case when msal<1000 then salary when msal between 1000 and 10001 then salary*(1-0.24) when msal>10000 then salary*(1-0.49) end,0) as salary from salaries s join (select company_id, max(salary) as msal from salaries group by company_id) a on s.company_id = a.company_id
select s.company_id, s.employee_id, s.employee_name, round(case when t.msalary < 1000 then s.salary when t.msalary >= 1000 and t.msalary <= 10000 then s.salary*0.76 else s.salary*0.51 end, 0) as salary from Salaries s, ( select company_id, max(salary) msalary from Salaries group by company_id ) t where s.company_id = t.company_id
select s.company_id, s.employee_id, s.employee_name, round(s.salary * (1-tmp.tax_rt),0) as salary from salaries s join ( select company_id, case when max(salary) < 1000 then 0 when max(salary) >=1000 and max(salary) <= 10000 then 0.24 else 0.49 end as tax_rt from salaries group by company_id ) tmp on s.company_id = tmp.company_id
select s.company_id, s.employee_id, s.employee_name, round(s.salary*(1-t.tax_rate), 0) salary from salaries s join (select company_id, case when max(salary) < 1000 then 0 when max(salary) <= 10000 then 0.24 else 0.49 end tax_rate from salaries group by company_id) t using(company_id)
select s.company_id, s.employee_id, s.employee_name, round(s.salary*(1-temp.tax_rate),0) as salary from salaries s left join (select distinct company_id, max(salary), case when max(salary)<1000 then 0 when max(Salary)>=1000 and max(salary)<10000 then 0.24 else 0.49 end as tax_rate from salaries group by company_id) as temp on temp.company_id = s.company_id
select s.company_id, s.employee_id, s.employee_name, round(s.salary-s.salary* ( case when mx<1000 then 0 when mx>1000 and mx<10000 then 0.24 when mx>10000 then 0.49 end) ,0) as salary from Salaries s left join (select company_id, max(salary) as mx from Salaries group by 1)t on s.company_id=t.company_id
select s.company_id, s.employee_id,s.employee_name, round( s.salary-s.salary* (case when mx<1000 then 0 when mx>1000 and mx<10000 then 0.24 when mx>10000 then 0.49 end) ,0) as salary from Salaries s left join (select company_id, max(salary) as mx from Salaries group by 1)t on s.company_id=t.company_id
select s.company_id,employee_id,employee_name, round(s.salary*(1-factor),0) as salary from Salaries s inner join (select company_id, (case when max(salary) <1000 then 0 when max(salary) >10000 then 0.49 else 0.24 end) as factor from Salaries group by company_id) as temp on s.company_id=temp.company_id
select s.company_id,employee_id,employee_name,round(salary*multiply,0) as salary from Salaries s join (select company_id, (case when m<1000 then 1 when m between 1000 and 10000 then 0.76 else 0.51 end) as multiply from (select company_id,max(salary) as m from Salaries group by company_id) a) b on b.company_id=s.company_id
select s.company_id,s.employee_id,s.employee_name, case when max(salary) over (partition by company_id) <1000 then round(salary,0) when max(salary) over (partition by company_id) between 1000 and 10000 then round(salary-salary*0.24,0) else round(salary-salary*0.49,0) end as salary from salaries s
select s.company_id,s.employee_id,s.employee_name, case when t.max_salary < 1000 then round(salary,0) when t.max_salary>=1000 and t.max_salary<=10000 then round(salary-salary*0.24,0) when t.max_salary> 10000 then round(salary-salary*0.49,0) end as salary from salaries s left join (select company_id,max(salary) as max_salary from salaries group by company_id) as t on s.company_id = t.company_id
select s.company_id,s.employee_id,s.employee_name, cast(s.salary-(case when cm.comp_max <1000 then 0 when cm.comp_max <=10000 and cm.comp_max>=1000 then 0.24 else 0.49 end)*s.salary as SIGNED) as salary from Salaries s left join (select company_id, max(salary) comp_max from Salaries group by company_id) as cm on s.company_id=cm.company_id
select s1.company_id ,s1.employee_id ,s1.employee_name ,case when max(salary) over(partition by company_id) < 1000 then s1.salary when max(salary) over(partition by company_id) BETWEEN 1000 and 10000 then round(s1.salary*(1-0.24),0) when max(salary) over(partition by company_id) > 10000 then round(s1.salary*(1-0.49),0) end as salary from Salaries s1
select s1.company_id, employee_id, employee_name, cast(case when max_salary > 10000 then salary*(1-0.49) when max_salary >= 1000 and max_salary <= 10000 then salary*(1-0.24) else salary end as unsigned) as salary from Salaries s1 inner join (select company_id, max(salary) as max_salary from Salaries group by 1) ms on ms.company_id = s1.company_id
select s1.company_id, s1.employee_id, s1.employee_name, Case when tab.maxSalary < 1000 then round(s1.salary) when tab.maxSalary >= 1000 and tab.maxSalary < 10000 then round(0.76*s1.salary) else round(0.51*s1.salary) end salary from Salaries s1 inner join (select company_id, max(salary) maxSalary from salaries group by company_id) tab on tab.company_id = s1.company_id
select s1.company_id, s1.employee_id, s1.employee_name, round(case when s2.max_salary < 1000 then salary when s2.max_salary between 1000 and 10000 then salary * 0.76 else salary * 0.51 end,0) as salary from salaries s1 left join (select company_id, max(salary) as max_salary from salaries group by 1) s2 on s1.company_id = s2.company_id
select s1.company_id, s1.employee_id, s1.employee_name, round(s1.salary*(1-s2.tax_rate),0) as salary from salaries s1 left join ( select company_id, case when max(salary) <1000 then 0 when max(salary) between 1000 and 10000 then .24 when max(salary) > 10000 then 0.49 end as tax_rate from salaries group by company_id) s2 on s1.company_id=s2.company_id
select salaries.company_id ,salaries.employee_id ,salaries.employee_name ,round(case when maxsalaries.max_salary < 1000 then salary when maxsalaries.max_salary between 1000 and 10000 then salary*(1-0.24) else salary*(1-0.49) end,0) salary from Salaries salaries join( select company_id ,max(salary) max_salary from Salaries group by company_id )maxsalaries on salaries.company_id = maxsalaries.company_id
select salaries.company_id, employee_id, employee_name, round(salary * (1-tax_rate)) as salary from Salaries join (select company_id, IF(max(salary) < 1000, 0, if(max(salary) > 10000, 0.49, 0.24)) as tax_rate from salaries group by company_id) taxes on salaries.company_id = taxes.company_id
select salaries.company_id,employee_id,employee_name, case when maxsal<1000 then round(salary) when maxsal>=1000 and maxsal<=10000 then round(salary-(salary*0.24)) else round(salary-salary*.49) end as salary from salaries join (select company_id,max(salary) as maxsal from salaries group by company_id ) X on X.company_id = salaries.company_id
select salaries.company_id,salaries.employee_id, salaries.employee_name,round(salary * (1-tax_rate),0) as salary from salaries left join ( select company_id, CASE WHEN max(salary) < 1000 THEN 0 WHEN max(salary) between 1000 and 10000 THEN 0.24 ELSE 0.49 END AS tax_rate from salaries group by 1) tax on tax.company_id =salaries.company_id
select t1.company_id,t1.employee_id,t1.employee_name, case when t1.maximum between 1000 and 10000 then round(0.76*t1.salary) when t1.maximum>10000 then round(0.51*t1.salary) else t1.salary end as salary from (select *,max(salary) over(partition by company_id) as maximum from salaries)t1
select x.company_id, x.employee_id, x.employee_name, case when max_salary < 1000 then salary when max_salary between 1000 and 10000 then round((1-0.24)*salary) else round((1-0.49)*salary) end as salary from Salaries x join ( select company_id, max(salary) as max_salary from Salaries group by 1) y on x.company_id = y.company_id
with CTE As ( Select company_id as ci,Max(salary) as sal FROM Salaries GROUP BY company_id) Select company_id,employee_id,employee_name, (case when c.sal<1000 Then salary when c.sal>=1000 and c.sal<=10000 Then Round((salary-(salary*0.24)),0) Else round((salary-(salary*0.49)),0) End) as salary FROM Salaries s JOIN CTE c ON s.company_id=c.ci
with CTE1 As ( Select company_id, max(salary) as max_salary from Salaries group by company_id ) Select s.company_id, s.employee_id, s.employee_name, CASE WHEN c.max_salary < 1000 THEN s.salary WHEN c.max_salary > 10000 THEN round(s.salary * 0.51,0) ELSE round(s.salary * 0.76,0) END as salary from Salaries s inner join CTE1 c on s.company_id = c.company_id
with NS as ( select company_id, case when max(salary)<1000 then 1 when max(salary)>10000 then 0.51 else 0.76 end as net_rate from Salaries group by company_id ) select S.company_id, S.employee_id, S.employee_name, round(S.salary*NS.net_rate,0) as salary from Salaries as S left join NS on S.company_id=NS.company_id
with a as ( select company_id, max(salary) as maxs from salaries group by company_id ) select s.company_id,s.employee_id,s.employee_name, case when maxs < 1000 then round(s.salary,0) when 1000<=maxs and maxs<=10000 then round(s.salary*0.76,0) when maxs > 10000 then round(s.salary*0.51,0) end as salary from salaries s, a where s.company_id = a.company_id
with a as (select *, case when max(salary) over ( partition by company_id) <1000 then round(salary,0) when max(salary) over ( partition by company_id) >=1000 and max(salary) over ( partition by company_id) <=10000 then round((salary - salary * 0.24),0) when max(salary) over ( partition by company_id) >10000 then round((salary - salary* 0.49),0) end as salary1 from Salaries) select company_id, employee_id, employee_name, salary1 as salary from a
with base as ( select company_id, employee_id, employee_name, salary, case when max_sal < 1000 then 0 when max_sal between 1000 and 10000 then 0.24 else 0.49 end tax from( select *, max(salary) over(partition by company_id) as max_sal from salaries ) sub ) select company_id, employee_id, employee_name, round(salary*(1-tax)) as salary from base
with base as ( select company_id, employee_id, employee_name, salary, max(salary) over(partition by company_id) as max_salary from Salaries ) select company_id, employee_id, employee_name, round(case when max_salary <1000 then salary when max_salary >10000 then salary*(1-0.49) else salary*(1-0.24) end,0) as salary from base
with comp_tax_rate as ( SELECT company_id, case when max(salary) < 1000 then 0.0 when max(salary)>=1000 and max(salary) <= 10000 then 0.24 when max(salary) > 10000 then 0.49 else null end as "tax_percnt" from salaries group by company_id ) select s.company_id, employee_id, employee_name, round(salary*(1-ctr.tax_percnt)) "salary" from Salaries s inner join comp_tax_rate ctr on ctr.company_id = s.company_id
with company_max_salary as ( select company_id, max(salary) as salary_max from Salaries group by company_id ), company_tax as ( select company_id, case when salary_max<1000 then 0 when (salary_max>=1000)and(salary_max<=10000) then 0.24 when salary_max>10000 then 0.49 end as salary_tax from company_max_salary ) select S.company_id, S.employee_id,S.employee_name, round(S.salary * (1-C.salary_tax) ,0)as salary from Salaries S inner join company_tax C on S.company_id=C.company_id
with ct_tax as (select case when max(salary) < 1000 then 0 when max(salary)<10000 then 24 else 49 end as tax_rate, company_id from Salaries group by company_id) select s.company_id, s.employee_id, s.employee_name, round((s.salary- (s.salary*c.tax_rate/100))) as salary from Salaries s, ct_tax c where s.company_id = c.company_id
with cte as ( SELECT company_id, MAX(salary) as max_salary FROM salaries GROUP BY company_id ) SELECT s.company_id, employee_id, employee_name, ROUND((CASE WHEN max_salary BETWEEN 1000 AND 10000 THEN salary*0.76 WHEN max_salary > 10000 THEN salary*0.51 ELSE salary END), 0) as salary FROM salaries s JOIN cte ON cte.company_id = s.company_id
with cte as ( Select company_id, max(salary) over (partition by company_id) as max_salary, employee_id from Salaries ), c2 as ( Select company_id, max_salary, employee_id, case when max_salary<1000 then 1 when max_salary between 1000 and 10000 then 1-0.24 else 1-0.49 end as rate from cte ) select s.company_id, s.employee_id, s.employee_name, ROUND(s.salary*c.rate,0) as salary from Salaries s join c2 c on s.company_id = c.company_id and s.employee_id = c.employee_id
with cte as ( select *, max(salary) over (partition by company_id order by salary desc) maxs from salaries ) select company_id, employee_id, employee_name, round((case when maxs <1000 then salary when (maxs >= 1000 and maxs <= 10000) then (salary -(salary *0.24)) when (maxs > 10000) then (salary-(0.49*salary)) end ),0) as salary from cte
with cte as ( select *, max(salary) over(partition by company_id) as mxsalary from salaries order by company_id ) select company_id, employee_id, employee_name, round(case when mxsalary < 1000 then salary when mxsalary < 10000 then .76*salary else .51*salary end) as salary from cte
with cte as ( select *,max(salary) over (partition by company_id) as max_salary from salaries group by company_id, employee_id ) select company_id, employee_id, employee_name, case when max_salary < 1000 then round(salary-salary*0,0) when max_salary >= 1000 and max_salary <= 10000 then round(salary -salary *0.24,0) when max_salary >= 10000 then round(salary - salary*0.49,0) end as salary from cte
with cte as ( select company_id, case when max(salary) < 1000 then 0.00 when max(salary) between 1000 and 10000 then 0.24 else 0.49 end as tax_rate from Salaries group by company_id) select s.company_id,s.employee_id,s.employee_name,round(salary*(1-tax_rate))as salary from Salaries s left join cte on s.company_id = cte.company_id
with cte as ( select company_id, case when max(salary) > 10000 then 0.49 when max(salary) between 1000 and 10000 then 0.24 else 0 end as tax_rates from Salaries group by company_id ) select s.company_id,s.employee_id,s.employee_name,round((s.salary - s.salary * c.tax_rates),0) as salary from Salaries s left join cte c on s.company_id = c.company_id
with cte as ( select company_id, employee_id , employee_name , salary, max(salary) over (partition by company_id) as max_salary from Salaries ) select company_id,employee_id ,employee_name , case when max_salary<1000 then round((salary),0) when max_salary between 1000 and 10000 then round((salary -salary*0.24 ),0) when max_salary>10000 then round((salary -salary*0.49),0) end as salary from cte
with cte as ( select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_sal from Salaries ) select company_id, employee_id, employee_name, cast(case when max_sal < 1000 then salary when max_sal between 1000 and 10000 then salary - (0.24*salary) when max_sal >10000 then salary - (0.49*salary) end as decimal) as salary from cte
with cte as ( select company_id, max(salary) as comp_sal from Salaries group by company_id ), cte2 as ( select s.company_id , employee_id , employee_name , salary, cte.comp_sal from Salaries s join cte on cte.company_id = s.company_id ) select company_id , employee_id , employee_name, case when comp_sal < 1000 then salary when comp_sal between 1000 and 10000 then round(salary - salary*(24/100)) when comp_sal > 10000 then round(salary - salary*(49/100)) end as salary from cte2
with cte as ( select company_id, max(salary) as max_salary from Salaries group by 1 ) select a.company_id, a.employee_id, a.employee_name, case when b.max_salary <1000 then round(salary,0) when b.max_salary>=1000 AND b.max_salary<=10000 then round(salary-(0.24*salary),0) when b.max_salary>10000 then round(salary-(0.49*salary),0) END as Salary from Salaries a left join cte b on a.company_id = b.company_id
with cte as ( select company_id, max(salary) as max_salary from salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, case when c.max_salary <1000 then s.salary when c.max_salary>=100 and c.max_salary<=10000 then round(s.salary-(0.24*s.salary),0) when c.max_salary>10000 then round(s.salary-(0.49*s.salary),0) end as salary from salaries s left join cte c on c.company_id=s.company_id
with cte as ( select company_id, max(salary) as sal from salaries group by 1) select company_id, employee_id, employee_name, case when sal < 1000 then salary when sal between 1000 and 10000 then round(salary *.76 , 0) else round(salary * .51 ) end as salary from salaries left join cte c using(company_id)
with cte as ( select company_id,max(salary) as max_salary from salaries group by company_id ), demo as ( select s.company_id,s.employee_id,s.employee_name,s.salary,cte.max_salary, case when max_salary<1000 then salary when max_salary>=1000 and max_salary<=10000 then salary-(0.24)*salary else salary-(0.49)*salary end as new_salary from salaries as s join cte on s.company_id=cte.company_id ) select company_id,employee_id,employee_name,round(new_salary,0) as salary from demo
with cte as (select company_id, (case when max(salary) < 1000 then 0 when max(salary) >= 1000 and max(salary) <= 10000 then 0.24 when max(salary) > 10000 then 0.49 end) as tax_percent from Salaries group by company_id) select company_id, employee_id, employee_name, round(salary * (1 - tax_percent)) as salary from Salaries join cte using(company_id)
with cte as (select company_id, case when max(salary) < 1000 then 0 when max(salary) > 10000 then 0.49 else 0.24 end as tax from salaries group by company_id) select company_id, employee_id, employee_name, round(salary*(1-tax)) as salary from salaries join cte using(company_id)
with cte as (select company_id, case when max(salary) > 10000 then 0.49 when max(salary) < 1000 then 0 when 1000 <= max(salary) <= 10000 then 0.24 end as rate from salaries group by company_id) select c.company_id, employee_id, employee_name, round(salary *(1-rate),0) as salary from cte c join salaries s on c.company_id = s.company_id
with cte as (select company_id, case when max(salary) >= 10000 then 0.49 when max(salary) between 1000 and 10000 then 0.24 else 0 end as tax_rate from Salaries group by company_id) select a.company_id, employee_id, employee_name, round(salary*(1-tax_rate)) as salary from Salaries a inner join cte b on a.company_id = b.company_id
with cte as (select company_id, case when max(salary)>10000 then 0.49 when max(salary)>1000 then 0.24 else 0 end as tax from salaries group by 1) select company_id, employee_id, employee_name , round(salary*(1-tax),0) as salary from salaries s inner join cte c using(company_id)
with cte as (select company_id, case when max(salary)>10000 then 0.49 when max(salary)>1000 then 0.24 else 0 end as tax from salaries group by 1) select company_id, employee_id, employee_name , round(salary*(1-tax),0) as salary from salaries s left join cte c using(company_id)
with cte as (select company_id, employee_id, employee_name, max(salary) over (partition by company_id) as max_salary, salary from salaries), cte1 as ( select company_id, employee_id, employee_name, salary, case when max_salary < 1000 then 0 when max_salary > 10000 then 0.49 else 0.24 end as tax_rate from cte ) select company_id, employee_id, employee_name, round(salary * (1-tax_rate)) as salary from cte1
with cte as (select company_id, max(salary) as max_sal from salaries group by company_id) select s.company_id, s.employee_id, s.employee_name, case when max_sal<1000 then round(s.salary, 0) when max_sal>=1000 and max_sal<=10000 then round(s.salary*0.76, 0) when max_sal>10000 then round(s.salary*0.51, 0) end as salary from salaries as s join cte on cte.company_id = s.company_id
with cte as (select company_id, max(salary) as maximum from salaries group by company_id) select company_id, employee_id, employee_name, salary from salaries where company_id in (select company_id from cte where maximum <1000) union select company_id, employee_id, employee_name, round(salary*0.76,0) from salaries where company_id in (select company_id from cte where maximum >= 1000 and maximum <=10000) union select company_id, employee_id, employee_name, round(salary*0.51,0) from salaries where company_id in (select company_id from cte where maximum >=10000)
with cte as (select company_id, max(salary) as num from salaries group by company_id) select a.company_id, employee_id, employee_name, round(case when num < 1000 then salary when num > 1000 and num < 10000 then salary * (1-0.24) when num > 10000 then salary * (1-0.49) end,0) as salary from salaries a join cte b on a.company_id = b.company_id
with cte as (select company_id,max(salary) MS from Salaries group by company_id), cte2 as (select * , (case when MS <1000 then 0 when MS>=1000 and MS<=10000 then 0.24 else 0.49 end) tax from cte), cte3 as (select * from Salaries left join cte2 using(company_id)) select company_id,employee_id,employee_name, round(salary*(1-tax),0) as salary from cte3
with cte as (select salaries.company_id,employee_id,employee_name,salary, max_salary from salaries join (Select company_id, max(salary) as max_salary from salaries group by company_id) as b on salaries.company_id=b.company_id) select company_id, employee_id, employee_name, round((case when max_salary<1000 then salary when max_salary between 1000 and 10000 then salary*0.76 when max_salary >10000 then salary*0.51 end),0) as salary from cte
with cte as( select *, dense_rank() over(partition by company_id order by salary desc) as rnk from Salaries), top_salary as( select * from cte where rnk = 1), tax as( select distinct company_id, case when salary < 1000 then 0 when salary between 1000 and 10000 then 0.24 else 0.49 end as tax_rate from top_salary ) select s.company_id, employee_id, employee_name, round(salary*(1-tax_rate),0) as salary from Salaries s left join tax t on s.company_id = t.company_id
with cte as( select company_id, (case when max(salary) < 1000 then 0.00 when max(salary) > 1000 and max(salary) < 10000 then 0.24 when max(salary) > 10000 then 0.49 end) as tax from salaries group by 1 ) select s.company_id, s.employee_id, s.employee_name, round(s.salary * (1 - cte.tax)) as salary from salaries s join cte on s.company_id = cte.company_id
with cte as( select company_id, case when max_salary < 1000 then 0 when max_salary >=1000 and max_salary <=10000 then 24 else 49 END as tax from (select company_id, max(salary) as max_salary from salaries group by 1) s1 ) select s.company_id, employee_id, employee_name, round(salary*(1-tax/100),0) as salary from salaries s join cte c on s.company_id = c.company_id
with cte as( select company_id, max(salary) as max_salary from salaries group by company_id) SELECT s.company_id, s.employee_id, s.employee_name, case when max_salary < 1000 then round(s.salary, 0) when max_salary>=1000 and max_salary<=10000 then round(s.salary*(1-0.24),0) when max_salary > 10000 then round(s.salary*(1-0.49),0) end as salary from salaries s join cte on cte.company_id = s.company_id
with cte as( select company_id, max(salary) as ms from Salaries group by company_id) select s.company_id, s.employee_id, s.employee_name, case when ms<1000 then round(salary,0) when 1000 <= ms and ms <= 10000 then round((0.76*salary),0) when ms>10000 then round((0.51*salary),0) end as salary from cte a inner join Salaries s on a.company_id=s.company_id
with cte as( select company_id, max(salary) as ms from salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, case when ms<1000 then round(s.salary,0) when ms>=1000 and ms<=10000 then round(s.salary*0.76,0) when ms>10000 then round(s.salary*0.51,0) end as salary from salaries s join cte on cte.company_id = s.company_id
with cte as( select company_id,max(salary) as mx from salaries group by company_id) select a.company_id,employee_id,employee_name, case when mx <1000 then 1*salary when mx<=10000 and mx>=1000 then round(0.76*salary,0) when mx>10000 then round(0.51*salary,0) end as salary from salaries a left join cte on a.company_id=cte.company_id
with cte as(select company_id,max(salary) as sal from salaries group by company_id) select s.company_id,employee_id,employee_name, round(case when cte.sal>10000 then salary-(0.49*salary) when cte.sal<1000 then salary else salary-(0.24*salary) end,0) as salary from salaries s join cte on cte.company_id=s.company_id
with cte1 as (select company_id, max(salary) as max_salary from Salaries group by company_id), cte2 as (select company_id, case when max_salary<1000 then 1 when max_salary between 1000 and 10000 then 0.76 when max_salary>10000 then 0.51 end as tax_rate from cte1) select a.company_id, a.employee_id, a.employee_name, round(a.salary*b.tax_rate,0) as salary from Salaries a left join cte2 b on a.company_id=b.company_id
with cte1 as (select company_id,max(salary)as salary from salaries group by company_id) select s.company_id,s.employee_id,s.employee_name, case when cte1.salary<1000 then round(s.salary*1,0) when cte1.salary>=1000 and cte1.salary<=10000 then round(s.salary*0.76,0) when cte1.salary>10000 then round(s.salary*0.51) end as salary from salaries s join cte1 on cte1.company_id=s.company_id
with cte_companysalary as ( select company_id, case when max(salary) < 1000 then 0 when max(salary) between 1000 and 10000 then 0.24 when max(salary)>10000 then 0.49 end as tax_rate from salaries group by company_id ) select s.company_id,s.employee_id,s.employee_name,round((s.salary - (c.tax_rate*s.salary)),0) as salary from salaries s join cte_companysalary c on c.company_id = s.company_id
with cte_max_salary as ( select *, max(salary) over (partition by company_id) as max_salary from Salaries ), cte_post_tax as ( select company_id, employee_id, employee_name, round( salary * (1 - ( case when max_salary < 1000 then 0.00 when max_salary between 1000 and 10000 then 0.24 else 0.49 end ) ), 0 ) as salary from cte_max_salary ) select * from cte_post_tax
with final1 as ( with final as ( with cte as ( Select * , max(salary) over (partition by company_id) as 'max_of_company' from Salaries ) Select * , case when max_of_company < 1000 then 0 when max_of_company >= 1000 and max_of_company <= 10000 then 24 when max_of_company > 10000 then 49 end as 'tax_percent' from cte ) Select company_id,employee_id,employee_name,round((salary - (tax_percent/100)*salary),2) as 'amount' from final order by company_id ) Select company_id,employee_id,employee_name, case when right(amount,2) >= 50 then ceil(amount) when right(amount,2) < 50 then floor(amount) end as 'salary' from final1
with high as( select company_id, max(salary) as highest from salaries group by company_id) select s.company_id, employee_id, employee_name, round(case when highest < 1000 then (salary-salary*0) when highest >= 1000 and highest <= 10000 then (salary - salary*0.24) when highest > 10000 then (salary-salary*0.49) else null end,0) as salary from high as h join salaries as s on h.company_id = s.company_id group by 1,2
with m_sal as (select *,max(salary) over(partition by company_id) as max_sal from salaries) select company_id,employee_id,employee_name, case when max_sal < 1000 then salary when max_sal between 1000 and 10000 then round(salary-(salary*(24/100))) else round(salary-(salary*(49/100))) end as salary from m_sal
with ma as(select s.company_id, s.employee_id, s.employee_name, s.salary, max(s.salary) over(partition by s.company_id) as m1 from Salaries s) select m.company_id, m.employee_id, m.employee_name, case when m.m1<1000 then round(m.salary-(0.00*m.salary)) when m.m1>=1000 and m.m1<=10000 then round(m.salary-(0.24*m.salary)) when m.m1>=10000 then round(m.salary-(0.49*m.salary)) end as salary from ma m
with max_sal as( select company_id, max(salary) as mx from salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, round(case when m.mx<1000 then s.salary when m.mx>=1000 and m.mx<=10000 then s.salary-s.salary*0.24 when m.mx>10000 then s.salary-s.salary*0.49 end,0) as salary from salaries s left join max_sal m on s.company_id=m.company_id
with max_salaries as ( select company_id, max(salary) as max_salary from salaries group by 1 ), tax_brackets as ( select company_id as cid, case when max_salary < 1000 then 1 when max_salary < 10000 then 0.76 else 0.51 end as tax_bracket from max_salaries ) select company_id, employee_id, employee_name, round(salary * tb.tax_bracket,0) as salary from salaries s join tax_brackets tb on s.company_id = tb.cid
with max_salaries as ( select company_id, max(salary) as max_salary from salaries group by company_id) select s.company_id, s.employee_id, s.employee_name, round(case when ms.max_salary < 1000 then s.salary when ms.max_salary > 10000 then s.salary * 0.51 else s.salary * 0.76 end) as salary from salaries s left join max_salaries ms on s.company_id = ms.company_id
with max_salaries as (select company_id, max(salary) as max_salary from salaries group by company_id) select c.company_id, c.employee_id, c.employee_name, round((case when ms.max_salary < 1000 then 1 when ms.max_salary < 10000 then 0.76 else 0.51 end) * c.salary) as salary from salaries c inner join max_salaries ms using(company_id)
with max_salary as (select company_id, case when max_salary < 1000 then 1 when max_salary >= 1000 and max_salary <= 10000 then 0.76 else 0.51 end as tax_rate from (select company_id, max(salary) as max_salary from Salaries group by 1)A ) select A.company_id, A.employee_id, A.employee_name, round(A.salary * B.tax_rate) as salary from Salaries A inner join max_salary B on A.company_id = B.company_id
with max_salary as (select company_id, max(salary) as max_sal from Salaries group by company_id) select s.company_id, employee_id, employee_name, round(case when max_sal < 1000 then salary when max_sal BETWEEN 1000 and 10000 then salary - ((salary * 24) / 100) when max_sal > 10000 then salary - ((salary*49)/100) end,0) as salary from Salaries s join max_salary m on s.company_id = m.company_id
with maxsal (company_id , msalary) as ( select company_id, max(salary) from salaries group by company_id ) select company_id,employee_id,employee_name, case when msalary>1000 and msalary<10000 then round((salary*76)/100) when msalary>10000 then round((salary*51)/100) else salary end as salary from (select salaries.company_id,salaries.employee_id,salaries.employee_name, salaries.salary,maxsal.msalary from salaries,maxsal where maxsal.company_id=salaries.company_id)t
with mx as( select distinct company_id, max(salary) as mx from salaries group by company_id), tax as( select company_id, (case when mx < 1000 then 1 when mx >= 1000 and mx<= 10000 then 0.76 when mx >10000 then 0.51 end )as tax from mx ) select s.company_id, employee_id, employee_name, round(tax * s.salary,0) as salary from salaries s join tax t on s.company_Id = t.company_Id
with sal_max as (select company_id, max(salary) as max_sal from salaries group by company_id) select a.company_id,a.employee_id,a.employee_name,round(case when max_sal < 1000 then salary when max_sal >= 1000 and max_sal <= 10000 then (salary - salary*0.24) else (salary - salary*0.49) end,0) as salary from salaries a inner join sal_max b on a.company_id = b.company_id group by a.company_id,a.employee_id,a.employee_name
with src as ( select *, max(salary) over (partition by company_id) as max_salary from Salaries ) select company_id ,employee_id ,employee_name , case when max_salary < 1000 then salary when max_salary >=1000 and max_salary <= 10000 then round(salary-salary*0.24,0) when max_salary > 10000 then round(salary-salary *0.49,0) end as salary from src order by company_id
with subtable as (select company_id, employee_id, employee_name, salary, max(salary) over(partition by company_id) as max_salary from salaries), subtable2 as (select company_id, employee_id, employee_name, salary, case when max_salary > 10000 then 0.49 when max_salary >= 1000 then 0.24 else 0 end as tax_rate from subtable) select company_id, employee_id, employee_name, round(salary * (1 - tax_rate),0) as salary from subtable2
with t as ( select company_id, (case when max(salary) >10000 then 0.49 when max(salary) <= 10000 and max(salary)>= 1000 then 0.24 when max(salary) <1000 then 0 end) as tax from salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, round(s.salary - s.salary * t.tax, 0) as salary from salaries s left join t on s.company_id = t.company_id
with t as ( select company_id, case when max(salary) < 1000 then 0 when max(salary) <= 10000 and max(salary)>=1000 then 0.24 else 0.49 end as tax from Salaries group by company_id) select company_id, employee_id, employee_name, round(salary-salary*tax, 0) as salary from t join salaries using(company_id)
with t as (select *,max(salary)over(partition by company_id) as maxs from Salaries) select company_id, employee_id, employee_name, round(case when maxs<1000 then salary when maxs>=1000 and maxs<=10000 then salary*(1-0.24) else salary*(1-0.49) end,0) as salary from t
with t as (select case when max( salary) < 1000 then 0 when max( salary) < 10000 then 0.24 else 0.49 end as rate, company_id from salaries group by company_id) select s.company_id, employee_id, employee_name, round(salary*(1-rate), 0) as salary from Salaries s join t on s.company_id = t.company_id
with t as (select company_id, max(salary) as max_salary, case when max(salary) <1000 then 1 when max(salary)>=1000 and max(salary) <=10000 then 0.76 else 0.51 end as tax_rate from Salaries group by company_id) select a.company_id as company_id, a.employee_id as employee_id, a.employee_name employee_name, floor(round(a.salary*t.tax_rate,0)) as salary from Salaries a left join t on a.company_id = t.company_id
with t as( select company_id,case when max(salary) <1000 then 0 when max(salary) between 1000 and 10000 then 0.24 else 0.49 end tax from salaries group by 1) select s.company_id,s.employee_id,s.employee_name,round(s.salary*(1-tax),0) as salary from salaries s left join t on t.company_id=s.company_id
with t as(select company_id, employee_id , employee_name , salary , max(salary) over (partition by company_id) as max_salary from salaries), new_t as (select company_id, employee_id , employee_name , salary, ( case when max_salary<1000 then 0 when max_salary >= 1000 and max_salary <= 10000 then 0.24 when max_salary > 10000 then 0.49 end) as tax_percent from t) select company_id, employee_id , employee_name , round(salary*(1-tax_percent),0) as salary from new_t
with t1 as ( select *, MAX(salary) over (partition by company_id) as max_salary from Salaries ) select company_id, employee_id, employee_name, round(case when max_salary < 1000 then salary when max_salary between 1000 and 10000 then (0.76*salary) else (0.51*salary) end) as salary from t1
with t1 as ( select s1.*, s2.max_salary from salaries s1 join ( select company_id, max(salary) as max_salary from salaries group by company_id ) s2 on s1.company_id = s2.company_id ) select company_id, employee_id, employee_name, case when max_salary < 1000 then round(salary,0) when max_salary between 1000 and 10000 then round(salary*0.76,0) when max_salary > 10000 then round(salary * 0.51,0) end as salary from t1
with t1 as (select company_id, max(salary) as max_s from salaries group by 1), t2 as (select company_id, case when max_s < 1000 then 1 when max_s <= 10000 then 0.76 else 0.51 end as tax from t1) select a.company_id, employee_id, employee_name, round(a.salary*tax) as 'salary' from salaries a join t2 on a.company_id = t2.company_id
with t1 as (select company_id,max(salary) as max_comp from salaries group by company_id) select s.company_id, s.employee_id,s.employee_name, round(case when t1.max_comp <1000 then s.salary when (t1.max_comp >=1000 and t1.max_comp<=10000) then s.salary-0.24*s.salary when t1.max_comp>10000 then s.salary-0.49*s.salary end,0) as `salary` from salaries s join t1 on s.company_id=t1.company_id
with t1 as( select company_id, case when max(salary) < 1000 then 0 when max(salary) >= 1000 and max(salary) <= 10000 then 0.24 else 0.49 end as rate from Salaries group by company_id ) select t2.company_id, t2.employee_id, t2.employee_name, round(t2.salary-t1.rate*t2.salary,0) as salary from Salaries t2 left join t1 on t2.company_id = t1.company_id
with tax as ( select company_id, case when max(salary) over(partition by company_id ) < 1000 then 0 when max(salary) over(partition by company_id ) between 1000 and 10000 then 0.24 else 0.49 end as tax_rate from Salaries ) select distinct s.company_id, employee_id, employee_name, round((1-tax_rate) * salary, 0) as salary from Salaries s left join tax t on s.company_id = t.company_id
with tax as ( select company_id,max(salary) max_salary from Salaries group by 1 ) , tax1 as (select company_id, case when max_salary<1000 then 0 when max_salary<=10000 then 0.24 else 0.49 end as tax_rate from tax ) select s.company_id, employee_id,employee_name,round(salary*(1-tax_rate)) salary from Salaries s join tax1 t on s.company_id=t.company_id
with tax as (select company_id, case when max_salary <=1000 then 0 when max_salary <=10000 then 0.24 else 0.49 end as tax_rate from (select company_id, max(salary) as max_salary from Salaries group by company_id)as temp) select Salaries.company_id,Salaries.employee_id,Salaries.employee_name,ROUND(salary*(1-tax_rate),0) as salary from Salaries left join tax on Salaries.company_id = tax.company_id
with tax as( select distinct company_id, case when max(salary) < 1000 then 0 when max(salary) between 1000 and 10000 then 0.24 else 0.49 end as tax from Salaries group by company_id ) select a.company_id, a.employee_id, a.employee_name, round(a.salary * (1-b.tax)) as salary from Salaries as a join tax as b on a.company_id=b.company_id
with tax_data as ( select company_id, case when max(salary)<1000 then 0 when max(salary) between 1000 and 10000 then 0.24 when max(salary)>10000 then 0.49 end as tax_rate from salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, round(s.salary*(1-t.tax_rate), 0) as salary from salaries s join tax_data t using(company_id)
with tax_multiplier as (select company_id, case when max(salary)<1000 then 1 when max(salary) <= 10000 then 0.76 else 0.51 end as mult from Salaries group by company_id) select a.company_id, a.employee_id, a.employee_name, round(a.salary*t.mult) as salary from Salaries a join tax_multiplier t on a.company_id = t.company_id
with tax_rate_by_salary as ( select *, case when salary < 1000 then 0.0 when salary <= 10000 then 0.24 else 0.49 end as tax_rate from salaries s ) , tax_by_company as ( select company_id, max(tax_rate) as tax from tax_rate_by_salary t group by 1 ) select s.company_id, s.employee_id, s.employee_name, round(s.salary*(1-t.tax),0) as salary from salaries s left join tax_by_company t on t.company_id = s.company_id
with taxtable as( select company_id, case when max(salary)<1000 then 0 when max(salary)<=10000 then 0.24 else 0.49 end as taxrate from salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, round( s.salary*(1-t.taxrate), 0) as salary from salaries as s join taxtable as t using (company_id)
with temp as ( select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as company_highest from Salaries ) select company_id, employee_id, employee_name, case when company_highest < 1000 then salary when company_highest between 1000 and 10000 then round(salary*0.76) when company_highest > 10000 then round(salary*0.51) end as salary from temp
with temp as ( select company_id, max(salary) as max_salary from Salaries group by company_id ) select s.company_id, s.employee_id, s.employee_name, round((case when temp.max_salary < 1000 then s.salary when temp.max_salary between 1000 and 10000 then s.salary * (1-0.24) when temp.max_salary > 10000 then s.salary* (1-0.49) end), 0) as salary from Salaries as s left join temp on s.company_id = temp.company_id
with temp as ( select max(salary) as max_salary ,company_id from Salaries group by company_id ) select sal.company_id ,sal.employee_id ,sal.employee_name ,(CASE WHEN t.max_salary < 1000 THEN sal.salary WHEN t.max_salary BETWEEN 1000 AND 10000 THEN ROUND((sal.salary - (sal.salary * 0.24)), 0) WHEN t.max_salary > 10000 THEN ROUND((sal.salary - (sal.salary * 0.49)), 0) END) AS salary from Salaries sal join temp t on sal.company_id = t.company_id
with temp as (select *, case when max(salary)over(partition by company_id)<1000 then 0 when max(salary)over(partition by company_id)<=10000 then 0.24 else 0.49 end as tax from salaries) select company_id, employee_id, employee_name, round(salary*(1-tax),0) as salary from temp
with temp as (select company_id, employee_id, employee_name, salary, max(salary) over (partition by company_id) as max_salary from Salaries) select company_id, employee_id, employee_name, case when max_salary < 1000 then round(salary,0) when max_salary > 10000 then round(salary * 0.51,0) else round(salary * 0.76,0) end as salary from temp
with temp as (select company_id, max(salary) as max from salaries group by company_id) select s.company_id, s.employee_id, s.employee_name, case when (t.max <1000) then round(s.salary,0) when (t.max >1000 and t.max <10000) then round((s.salary-(0.24)*s.salary),0) when (t.max >10000) then round((s.salary-(0.49)*s.salary),0) end as salary from salaries s left outer join temp t on t.company_id = s.company_id
with temp as( select company_id , max(salary) as max_sal , case when max(salary) < 1000 then 0 when max(salary) between 1000 and 10000 then 24 when max(salary) > 10000 then 49 end as tax from salaries group by company_id) select salaries.company_id , employee_id , employee_name , round((salary - ((salary*tax)/100))) as salary from salaries join temp on temp.company_id = salaries.company_id
with temp1 as ( SELECT company_id, max(salary) as max FROM Salaries GROUP BY company_id ), temp2 as( SELECT company_id, ( CASE WHEN max < 1000 THEN 0 WHEN max > 10000 THEN 0.49 ELSE 0.24 END ) as tax_rate FROM temp1 ) SELECT s.company_id, s.employee_id, s.employee_name, ROUND((s.salary * (1-t.tax_rate)),0) as salary FROM Salaries as s LEFT JOIN temp2 as t ON s.company_id = t.company_id
with temp1 as ( select company_id, case when max_salary<1000 then 0.0 when max_salary between 1000 and 10000 then 0.24 when max_salary>10000 then 0.49 end as tax from ( select company_id, max(salary) as max_salary from Salaries group by 1 )t ) select Salaries.company_id as company_id,employee_id,employee_name, round(salary-salary*tax) as salary from Salaries inner join temp1 on Salaries.company_id=temp1.company_id
with tmp as ( select *,max(salary) over (partition by company_id) as max_salary from salaries ) select company_id,employee_id,employee_name, round(CASE WHEN max_salary<1000 THEN salary WHEN max_salary>10000 THEN salary*(0.51) ELSE salary*(0.76) END,0) AS salary from tmp
with tmp as ( select *,max(salary) over (partition by company_id) as max_salary from salaries ) select company_id,employee_id,employee_name, round(CASE WHEN max_salary<1000 THEN salary WHEN max_salary>10000 THEN salary*(1-0.49) ELSE salary*(1-0.24) END,0) AS salary from tmp
with tmp as ( select *,max(salary) over (partition by company_id) as max_salary from salaries ) select company_id,employee_id,employee_name, round(CASE WHEN max_salary<1000 THEN salary WHEN max_salary>10000 THEN salary-salary*(0.49) ELSE salary-salary*(0.24) END,0) AS salary from tmp
with tmp as ( select company_id, case when max(salary) < 1000 then 0 when max(salary) <= 10000 then 0.24 else 0.49 end as tax from salaries group by company_id ) select company_id, employee_id, employee_name, round(salary * (1-tax)) as salary from salaries natural join tmp
with tmp as ( select company_id, max(salary) as max_salary from Salaries group by company_id ) , tmp2 as ( select company_id, case when max_salary < 1000 then 0 when 1000 <= max_salary and max_salary <= 10000 then 0.24 else 0.49 end as tax_rate from tmp ) select s.company_id, employee_id, employee_name, round(salary * (1 - tax_rate)) as salary from Salaries s join tmp2 t on s.company_id = t.company_id
with x as ( select company_id,employee_id,employee_name,salary, max(salary) over (partition by company_id) as maxi from salaries ), y as ( select *, case when maxi < 1000 then 0 when maxi > 1000 and maxi < 10000 then 24 when maxi > 10000 then 49 end as tax from x ) select company_id, employee_id, employee_name,round(salary-(salary*tax/100),0) as salary from y
