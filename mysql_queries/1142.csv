SELECT ( CASE WHEN Count(DISTINCT user_id) = 0 THEN 0 ELSE Round(Cast(Count(DISTINCT session_id) AS FLOAT) / Count(DISTINCT user_id), 2) END ) average_sessions_per_user FROM activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'
SELECT COALESCE(ROUND(AVG(cnt), 2), 0.00) AS average_sessions_per_user FROM ( SELECT COUNT(DISTINCT session_id) AS cnt FROM ( SELECT user_id, session_id FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id, session_id ) t GROUP BY user_id ) t
SELECT COALESCE(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date > date_sub('2019-07-27', interval 30 DAY)
SELECT COALESCE(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date between '2019-06-28' and '2019-07-27'
SELECT IFNULL( (SELECT round(((COUNT(DISTINCT session_id))/(COUNT( DISTINCT user_id))),2) from activity WHERE activity_date BETWEEN "2019-06-28" and "2019-07-27") ,0) AS average_sessions_per_user
SELECT IFNULL( ROUND( (COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id)) , 2) , 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'
SELECT IFNULL( ROUND(COUNT(DISTINCT session_id) /COUNT(DISTINCT user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'
SELECT IFNULL(ROUND( COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2) , 0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27', activity_date)<=29
SELECT IFNULL(ROUND( COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2) ,0) as average_sessions_per_user FROM Activity WHERE activity_date BETWEEN date_sub('2019-07-27', interval 29 day) and '2019-07-27' and user_id in ( SELECT distinct user_id FROM Activity WHERE activity_date BETWEEN date_sub('2019-07-27', interval 29 day) and '2019-07-27' GROUP BY user_id HAVING COUNT(activity_type)>=1 )
SELECT IFNULL(ROUND((COUNT(DISTINCT CONCAT(user_id,session_id ))/COUNT(DISTINCT user_id)),2),0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30
SELECT IFNULL(ROUND((COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id)),2),0) AS average_sessions_per_user FROM Activity WHERE activity_date > DATE_SUB('2019-07-27', INTERVAL 30 DAY) AND activity_date <= '2019-07-27'
SELECT IFNULL(ROUND((COUNT(distinct session_id) / count(distinct user_id)), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'
SELECT IFNULL(ROUND(AVG((SESSIONS)),2),0) average_sessions_per_user FROM (SELECT COUNT(DISTINCT SESSION_ID) SESSIONS FROM ACTIVITY WHERE ACTIVITY_DATE > DATE_SUB('2019-07-27', INTERVAL 30 DAY) GROUP BY USER_ID )X
SELECT IFNULL(ROUND(AVG(a.num), 2),0) as average_sessions_per_user FROM ( SELECT COUNT(DISTINCT session_id) as num FROM Activity WHERE DATEDIFF("2019-07-27", activity_date) < 30 AND DATEDIFF("2019-07-27", activity_date) > 0 GROUP BY user_id ) as a
SELECT IFNULL(ROUND(AVG(a.session_count),2),0) AS average_sessions_per_user FROM ( SELECT COUNT(DISTINCT session_id) AS session_count FROM activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id) a
SELECT IFNULL(ROUND(AVG(num),2),0) average_sessions_per_user FROM (SELECT user_id, COUNT(DISTINCT session_id) num FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY 1)T1
SELECT IFNULL(ROUND(AVG(num_sessions),2),0) as average_sessions_per_user FROM ( SELECT user_id, COUNT(distinct session_id) as num_sessions FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-28', INTERVAL 30 DAY) AND DATE('2019-07-27') GROUP BY user_id) as ctv
SELECT IFNULL(ROUND(AVG(sessions), 2), 0.00) AS average_sessions_per_user FROM (SELECT user_id, COUNT(DISTINCT(session_id)) AS sessions FROM activity WHERE (activity_date <= CAST('2019-07-27' AS DATE)) AND (activity_date > DATE_SUB("2019-07-27", INTERVAL 30 DAY)) GROUP BY user_id) AS activity_filtered
SELECT IFNULL(ROUND(COUNT(DISTINCT SESSION_ID)/COUNT(DISTINCT USER_ID), 2), 0.00) AS average_sessions_per_user FROM ACTIVITY WHERE ACTIVITY_DATE >= '2019-06-28' AND ACTIVITY_DATE <= '2019-07-27'
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE activity_date <= '2019-07-27' AND activity_date >= '2019-06-28'
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE activity_date >= "2019-06-28" AND activity_date <= "2019-07-27"
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2),0) as average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date)<30
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2), 0) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27'
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date)<30
SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN DATE_SUB("2019-07-27",INTERVAL 29 DAY) AND "2019-07-27"
SELECT IFNULL(ROUND(COUNT(DISTINCT user_id, session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30
SELECT IFNULL(ROUND(COUNT(DISTINCT user_id,session_id)/COUNT(DISTINCT user_id),2),0) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'
SELECT IFNULL(ROUND(SUM(A.USER_SESSION)/COUNT(*),2),0) AS average_sessions_per_user FROM ( SELECT USER_ID, COUNT(DISTINCT SESSION_ID) AS USER_SESSION FROM ACTIVITY WHERE activity_date > "2019-06-27" AND activity_date < "2019-07-28" GROUP BY USER_ID ) AS A
SELECT IFNULL(ROUND(SUM(session)/COUNT(*), 2), 0) AS "average_sessions_per_user" FROM (SELECT user_id, COUNT(DISTINCT(session_id)) AS session FROM Activity WHERE activity_date <= DATE("2019-07-27") AND activity_date > DATE("2019-06-27") GROUP BY user_id) A
SELECT IFNULL(ROUND(SUM(session)/COUNT(*), 2), 0) AS "average_sessions_per_user" FROM (SELECT user_id, COUNT(DISTINCT(session_id)) AS session FROM Activity WHERE activity_date <= DATE("2019-07-27") AND activity_date >= DATE("2019-06-28") GROUP BY user_id) A
SELECT IFNULL(ROUND(SUM(t.cnt) / COUNT(*), 2), 0.00) AS 'average_sessions_per_user' FROM (SELECT COUNT(DISTINCT session_id) AS 'cnt' FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY user_id) t
SELECT IFNULL(round(avg(n_session),2),0) as average_sessions_per_user FROM (SELECT user_id, count(distinct(session_id)) as n_session FROM Activity WHERE activity_date BETWEEN DATE('2019-07-27') - INTERVAL 29 DAY AND '2019-07-27' GROUP BY user_id) a
SELECT ROUND( IFNULL(AVG(a.count),0) ,2) AS "average_sessions_per_user" FROM ( SELECT user_id, COUNT(DISTINCT session_id) AS "count" FROM Activity WHERE activity_date > DATE_ADD("2019-07-27", INTERVAL -30 DAY) AND activity_date <= "2019-07-27" GROUP BY user_id HAVING COUNT(DISTINCT session_id) >= 1 ) AS a
SELECT ROUND((CASE WHEN COUNT(DISTINCT A1.user_id) = 0 THEN 0 ELSE SUM(A1.sessionCount)/ COUNT(DISTINCT A1.user_id) END), 2) AS average_sessions_per_user FROM (SELECT user_id, COUNT(DISTINCT (CASE WHEN activity_date BETWEEN "2019-06-28" AND "2019-07-27" THEN session_id END)) AS sessionCount FROM Activity GROUP BY user_id) AS A1 WHERE A1.sessionCount > 0
SELECT ROUND(COALESCE(AVG(ct),0),2) AS average_sessions_per_user FROM (SELECT user_id, COUNT(session_id) AS ct FROM (SELECT user_id, session_id FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id, session_id) sub GROUP BY user_id ) sub
SELECT ROUND(IFNULL((COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id)),0),2) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN DATE_ADD("2019-07-27", INTERVAL-29 day) AND "2019-07-27"
SELECT ROUND(IFNULL(AVG(cnt),0), 2) AS average_sessions_per_user FROM ( SELECT user_id, COUNT(DISTINCT session_id) AS cnt FROM Activity WHERE DATEDIFF("2019-07-27", activity_date) < 30 GROUP BY user_id ) t
SELECT ROUND(IFNULL(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 0), 2) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN "2019-06-28" AND "2019-07-27"
SELECT ROUND(IFNULL(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id) ,0),2) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date)<=29
SELECT ROUND(IFNULL(COUNT(DISTINCT(session_id)) / COUNT(DISTINCT(user_id)),0),2) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30
SELECT coalesce(round(avg(nb_sessions),2),0) as average_sessions_per_user FROM ( SELECT user_id , count(distinct(session_id)) as nb_sessions FROM Activity Where activity_date between date_add('2019-07-27', INTERVAL -29 DAY) and '2019-07-27' GROUP by user_id HAVING count(distinct(session_id)) > 0 )t
SELECT ifnull(ROUND(AVG(CNT), 2), 0.00) AS average_sessions_per_user FROM ( SELECT user_id, count(DISTINCT session_id) AS CNT FROM Activity WHERE activity_date >= "2019-06-28" AND activity_date <= "2019-07-27" GROUP BY user_id) AS A
SELECT ifnull(ROUND(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date > Subdate('2019-07-27',30) and activity_date <= '2019-07-27'
SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date > '2019-06-27' AND activity_date <= '2019-07-27'
SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'
SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) as average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'
SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(distinct user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE datediff('2019-07-27',activity_date)<30
SELECT ifnull(round(cOUNT(distinct user_id,session_id) /COUNT(distinct user_id),2),0.00) as Average_sessions_per_user FROM activity WHERE activity_date BETWEEN ('2019-07-27'-INTERVAL 29 DAY) AND '2019-07-27'
SELECT ifnull(round(count(DISTINCT session_id)/count(distinct user_id),2),0.00) as "average_sessions_per_user" FROM Activity WHERE activity_date BETWEEN "2019-06-28" AND "2019-07-27"
SELECT ifnull(round(count(distinct session_id) / count(distinct user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date <= '2019-07-27' AND activity_date >= '2019-06-28'
SELECT round(coalesce(avg(s_id),0),2) average_sessions_per_user FROM (SELECT user_id, count(DISTINCT session_id) s_id FROM activity WHERE 1=1 AND activity_date BETWEEN date_sub(cast('2019-07-27' as date),INTERVAL 29 DAY) AND cast('2019-07-27' as date) GROUP BY user_id) a
Select IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT(user_id)),2),0.00) as average_sessions_per_user FROM Activity where activity_date >= "2019-06-28" and activity_date <= "2019-07-27"
Select IFNULL(ROUND(COUNT(DISTINCT user_id,session_id)/COUNT(DISTINCT user_id),2),0) as average_sessions_per_user From Activity where activity_date between '2019-06-28' and '2019-07-27'
Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= '2019-06-28' Group By user_id) as Activity_
Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= Cast('2019-06-28' as Date) Group By user_id) as Activity_
Select IfNull (round(count(distinct session_id)/count(distinct User_id),2), 0.00) as average_sessions_per_user From Activity Where activity_date > date_sub('2019-07-27', interval 30 day)
Select ifnull((round(sum(cs)/count(user_id),2)),0.00) as average_sessions_per_user from ( Select user_id, count(distinct session_id)cs from Activity where activity_date between '2019-06-28' AND '2019-07-27' group by 1 having count(distinct session_id)>=1 )t
Select ifnull(round((count(Distinct(concat(user_id,'_',session_id))) / count(Distinct(user_id))),2),0) as average_sessions_per_user From Activity Where activity_date between '2019-06-28' and '2019-07-27'
Select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'
WITH CTE_1 AS( SELECT user_id , session_id , activity_type FROM Activity WHERE activity_date BETWEEN DATE_ADD("2019-07-27", INTERVAL -29 DAY) AND "2019-07-27" ) , CTE_2 AS ( SELECT user_id , COALESCE(COUNT(DISTINCT session_id), 0) AS num_sessions FROM CTE_1 GROUP BY user_id ) SELECT COALESCE(ROUND(SUM(num_sessions) / COUNT(*), 2), 0) AS average_sessions_per_user FROM CTE_2
WITH cte AS (SELECT user_id,COUNT(DISTINCT session_id )num_session FROM activity WHERE datediff('2019-07-27',activity_date) <=29 GROUP BY user_id ) SELECT COALESCE(ROUND(SUM(num_session)/count(DISTINCT user_id),2),0.00)average_sessions_per_user FROM cte
WITH cte_getActivity AS ( SELECT COUNT(DISTINCT session_id) AS count_session FROM Activity WHERE activity_date > date_sub('2019-07-27', interval 30 day) GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(count_session),2),0) AS average_sessions_per_user FROM cte_getActivity
WITH d AS (SELECT * FROM Activity a WHERE activity_date BETWEEN date_add('2019-07-27', interval -29 day) AND '2019-07-27') SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT USER_ID) , 2) , 0) AS average_sessions_per_user FROM d
WITH sessions AS ( SELECT user_id, COALESCE(COUNT(DISTINCT session_id), 0) total_sessions FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id ) SELECT ROUND(COALESCE((SUM(total_sessions)/COUNT(user_id)), 0), 2) average_sessions_per_user FROM sessions
WITH sessions as ( SELECT DISTINCT user_id as active_users, COUNT(DISTINCT session_id) as session_count FROM ACTIVITY WHERE activity_date > DATE_SUB("2019-07-27", INTERVAL 30 DAY) GROUP BY user_id ) SELECT IFNULL(ROUND(SUM(session_count)/ count(active_users),2),0) as average_sessions_per_user FROM sessions
WITH sessions_per_user AS (SELECT user_id, COUNT(DISTINCT session_id) AS cnt_session FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id) SELECT IFNULL(ROUND(SUM(cnt_session)/COUNT(user_id), 2), 0.00) AS average_sessions_per_user FROM sessions_per_user
WITH t1 AS ( SELECT user_id, COUNT(DISTINCT session_id) AS sess FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) <= 29 GROUP BY user_id ), t2 AS ( SELECT IFNULL(ROUND(AVG(sess), 2), 0) AS average_sessions_per_user FROM t1 ) SELECT * FROM t2
WITH temp AS ( SELECT COUNT( DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(sess), 2), 0) AS average_sessions_per_user FROM temp
WITH temp AS ( SELECT COUNT(DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(sess), 2), 0) AS average_sessions_per_user FROM temp
WITH user_session AS ( SELECT user_id, COUNT(DISTINCT(session_id)) AS num FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(num), 2),0) AS average_sessions_per_user FROM user_session
WITH user_sessions AS ( SELECT COUNT(DISTINCT session_id) AS sessions, user_id FROM Activity WHERE activity_date > '2019-6-27' AND activity_date < '2019-7-28' GROUP BY user_id ) SELECT CASE WHEN sessions IS NULL THEN 0 ELSE ROUND(AVG(sessions), 2) END AS average_sessions_per_user FROM user_sessions
WITH user_sessions AS ( SELECT user_id, COUNT(DISTINCT session_id) AS sessions FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 AND DATEDIFF('2019-07-27', activity_date) >= 0 GROUP BY user_id ) SELECT IFNULL(ROUND(SUM(sessions)/COUNT(user_id),2),0) AS average_sessions_per_user FROM user_sessions
With new_table as ( select count(distinct(session_id)) as sessions_per_user from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) select ifnull(round(avg(sessions_per_user),2),0) as average_sessions_per_user From new_table
With session_date as (Select user_id, count(distinct session_id) as count_session From Activity Where datediff("2019-07-27", activity_date)<=29 Group by user_id) Select round(ifnull(avg(count_session),0),2) as average_sessions_per_user From session_date
With t1 AS (SELECT COUNT(DISTINCT(session_id)) AS session_total FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND'2019-07-27' GROUP BY user_id) SELECT IFNULL(ROUND(AVG(session_total),2),0) AS average_sessions_per_user FROM t1
With t1 AS (SELECT COUNT(DISTINCT(session_id)) AS session_total FROM Activity WHERE activity_date<='2019-07-27' AND activity_date>'2019-06-27' GROUP BY user_id) SELECT IFNULL(ROUND(AVG(session_total),2),0) AS average_sessions_per_user FROM t1
With temp AS ( SELECT COUNT(DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id) SELECT IFNULL(ROUND(AVG(sess),2),0) AS average_sessions_per_user FROM temp
select (case when count(distinct user_id)=0 then 0 else round(cast(count(distinct session_id) as float)/count(distinct user_id),2) end) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select COALESCE(ROUND(avg(sessions),2),0) AS average_sessions_per_user FROM ( select user_id, (count(distinct(session_id))) as sessions FROM activity WHERE activity_date between '2019-06-28' and '2019-07-27' GROUP BY 1 ) AS X
select COALESCE(round(sum(x.b)/count(x.a),2),0.00) as average_sessions_per_user from (select user_id as a, count(distinct session_id) as b from Activity where activity_date between "2019-06-28" and "2019-07-27" group by user_id) as x
select IFNULL( (select round(count(distinct session_id)/count(distinct user_id),2) as average_sessions_per_user from Activity where activity_date>DATE_ADD('2019-07-27', INTERVAL -30 DAY) and activity_date<='2019-07-27'), 0) as average_sessions_per_user
select IFNULL(ROUND(avg(number_sessions),2),0) as average_sessions_per_user FROM ( select user_id, count(distinct session_id) as number_sessions FROM Activity where activity_date between date_sub('2019-07-27', interval (30-1) day) and '2019-07-27' group by 1 ) a
select IFNULL(round(avg(number_sessions), 2), 0) as average_sessions_per_user FROM (select user_id, count(distinct session_id) as number_sessions from Activity where activity_date between date_sub('2019-07-27', interval (29) day) and '2019-07-27' group by user_id) result
select IFNULL(round(count(distinct session_id) / count(distinct user_id), 2), 0) average_sessions_per_user from activity where datediff('2019-07-27', activity_date) < 30
select IFNULL(round(count(distinct session_id) / count(distinct user_id),2),0) as 'average_sessions_per_user' from Activity act where datediff('2019-07-27', activity_date) < 30
select ROUND(ifnull(count(distinct session_id)/count(distinct user_id), 0.00),2) AS average_sessions_per_user from activity where activity_date between "2019-06-28" and "2019-07-27" ORDER BY user_id
select case when count(distinct session_id) = 0 then 0.00 else round((count(distinct session_id)/ count(distinct user_id)),2) end as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) < 30 and datediff('2019-07-27', activity_date) >= 0
select case when count(distinct user_id) =0 then 0.00 else round(count(distinct session_id) / count(distinct user_id) , 2) END as average_sessions_per_user from Activity where activity_date between date '2019-06-28' and date '2019-07-27'
select case when round(avg(totalsession),2) is null then round(0, 2) else round(avg(totalsession),2) end average_sessions_per_user from ( select user_id, count(distinct session_id) totalsession from activity where activity_date <= '2019-07-27' and activity_date > date_add('2019-07-27', INTERVAL -30 day) group by user_id )a
select coalesce(cast(avg(sessionids) as decimal(5,2) ), 0.0000) as average_sessions_per_user from ( select user_id , count(distinct session_id) sessionids from activity a where activity_date between '2019-06-28' and '2019-07-27' group by 1 )a
select coalesce(round(avg(session_cnt),2),0) as average_sessions_per_user from (select user_id, count(distinct session_id) as session_cnt from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by 1 having count(1)>=1 ) sess
select coalesce(round(avg(session_count),2),0) average_sessions_per_user from ( select user_id, count(distinct(session_Id)) session_count from activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id ) as r
select coalesce(round(avg(session_number),2),0.00) as average_sessions_per_user from (select distinct user_id, count(distinct session_id) as session_number from Activity where datediff('2019-07-27',activity_date) < 30 group by user_id having session_number >= 1) c
select coalesce(round(count(distinct session_id) / count(distinct user_id), 2), 0) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select coalesce(round(count(distinct session_id)/count(distinct user_id),2), 0.00) as average_sessions_per_user from activity where timestampdiff(day, activity_date, '2019-07-28') <= 30
select coalesce(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where timestampdiff(day, activity_date, '2019-07-28') <=30
select coalesce(round(count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from Activity where activity_date between DATE_SUB(DATE("2019-07-27"), INTERVAL 29 DAY) AND DATE("2019-07-27")
select coalesce(round(count(t.session_id) / count(distinct user_id),2) ,0) as average_sessions_per_user from ( select user_id, session_id, count(session_id) as id_num from Activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27' group by session_id) t
select coalesce(round(sum(session_per_user_cnt)/user_cnt,2),0) as average_sessions_per_user from ( select count(distinct user_id) as user_cnt, count(distinct session_id) as session_per_user_cnt from activity where activity_date between '2019-06-28' and '2019-07-26' ) a
select coalesce(round(sum(sumc)/count(distinct user_id),2), 0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sumc from activity where datediff('2019-07-27', activity_date) < 30 group by user_id ) a
select ifnull ( (select round( ((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between "2019-06-28" and "2019-07-27") ,0) as average_sessions_per_user
select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between "2019-06-28" and "2019-07-27") ,0) as average_sessions_per_user
select ifnull (round( count(distinct session_id) * 1.0 / count(distinct user_id) , 2) , 0) as average_sessions_per_user from activity where datediff('2019-07-27', activity_date) < 30
select ifnull (round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) as temp
select ifnull( (select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between "2019-06-28" and "2019-07-27"),0) as average_sessions_per_user
select ifnull( round(count(distinct(session_id))/ count(distinct(user_id)),2), 0.00) as average_sessions_per_user from activity where datediff('2019-07-27', activity_date)<30
select ifnull(Round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from Activity where activity_date >= date_sub('2019-07-27',interval 29 day)
select ifnull(round ((count(distinct session_id)/ count(distinct user_id)),2),0) as average_sessions_per_user from activity where activity_date > date_sub('2019-07-27',interval 30 day)
select ifnull(round ((select sum(numerator.total_sessions) from ( select count(distinct session_id) as total_sessions from Activity where activity_date between DATE_SUB('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' group by user_id ) as numerator) / ( select count(distinct denominator.total_users) from ( select distinct user_id as total_users from Activity where activity_date between DATE_SUB('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' ) as denominator ),2),0) as average_sessions_per_user
select ifnull(round( count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from Activity where activity_date <= '2019-07-27' and activity_date >= date_add('2019-07-27', interval -29 day)
select ifnull(round( sum(N) / sum(D), 2), 0.00) average_sessions_per_user from ( select count(distinct session_id) N, 1 D from Activity where activity_date between "2019-06-28" and "2019-07-27" group by user_id ) t
select ifnull(round(((count(distinct session_id))/(count( distinct user_id))),2),0) as average_sessions_per_user from activity where activity_date between "2019-06-28" and "2019-07-27"
select ifnull(round((count(distinct session_id))/(count(distinct user_id)),2),0.00) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) < 30
select ifnull(round((count(distinct session_id)/count(distinct user_id)),2),0.00) as average_sessions_per_user from activity where activity_date >='2019-06-28' and activity_date <='2019-07-27'
select ifnull(round((select count(distinct session_id) from activity where datediff( '2019-07-27',activity_date)<=29)/ count(distinct user_id),2) ,0)as average_sessions_per_user from activity where datediff('2019-07-27',activity_date)<=29
select ifnull(round((sum(sessions)/count(user_id)) ,2) ,0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sessions from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id )as a
select ifnull(round(AVG(session),2),0.00) as average_sessions_per_user from (select user_id, count(distinct session_id) as session from Activity where activity_date between date_sub('2019-07-27',interval 29 day) and '2019-07-27' group by user_id)as T
select ifnull(round(avg(c),2),0.00) as average_sessions_per_user from( select count(distinct session_id) as c from Activity where activity_date between "2019-06-28" and "2019-07-27" group by user_id )t
select ifnull(round(avg(cnt), 2), 0) as average_sessions_per_user from (select user_id, count(distinct session_id) as cnt from activity a where activity_date between '2019-06-28' and '2019-07-27' group by user_id) tmp
select ifnull(round(avg(cnt),2),0) as average_sessions_per_user from (select user_id, count(distinct session_id) as cnt from Activity where datediff('2019-07-27',activity_date) < 30 group by user_id) t
select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select count(distinct session_id) cnt from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) t
select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select user_id, count(distinct session_id) cnt from Activity where activity_date > ('2019-07-27' - interval 30 day) group by user_id) temp
select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select user_id, count(distinct session_id) cnt from Activity where activity_date >= '2019-06-28' group by user_id) temp
select ifnull(round(avg(cnt),2),0.00) as average_sessions_per_user from ( select count(distinct session_id) as cnt from Activity where datediff("2019-07-27",activity_date)<30 group by user_id) as tb1
select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select *, count(distinct session_id)as count_session from Activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27'group by user_id ) cte where user_id in (select user_id from Activity group by user_id, activity_type having count(activity_type)>=1 )
select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id having count_session >0) f
select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f
select ifnull(round(avg(ct),2),0) average_sessions_per_user from ( select user_id, count(distinct session_id) ct from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id ) a
select ifnull(round(avg(ct),2),0.00)as average_sessions_per_user from ( select count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t
select ifnull(round(avg(n_sessions),2),0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as n_sessions from Activity where datediff('2019-07-27',activity_date) < 30 group by user_id) a
select ifnull(round(avg(new.a),2), 0) as average_sessions_per_user from ( select user_id, count(distinct session_id)/count(distinct user_id) as a from activity where activity_date between '2019-06-28' and '2019-07-27') new
select ifnull(round(avg(num),2),0.00000) as average_sessions_per_user from ( select count(distinct session_id) as num from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' and activity_type is not null group by user_id ) temp
select ifnull(round(avg(num_sess), 2), 0) average_sessions_per_user from ( select count(distinct session_id) num_sess from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id ) tmp
select ifnull(round(avg(number),2),0) as average_sessions_per_user From (Select user_id as id,count(distinct session_id) as number from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) as tb1
select ifnull(round(avg(number),2),0) as average_sessions_per_user from ( select distinct user_id, count(distinct session_id) as number from activity where activity_date <= '2019-07-27' and activity_date >= '2019-06-28' group by user_id )t
select ifnull(round(avg(sess),2),0) as average_sessions_per_user from ( select user_id,count(distinct session_id) as sess from Activity where activity_date between '2019-06-28' and '2019-07-27' group by 1)x
select ifnull(round(avg(sess_no),2),0) as average_sessions_per_user from (select count(distinct session_id) as sess_no from Activity where activity_date between "2019-06-28" and "2019-07-27" group by user_id ) tmp
select ifnull(round(avg(session),2),0) as average_sessions_per_user From ( Select user_id, count(distinct(session_id)) as session From Activity Where activity_date <= "2019-07-27" And activity_date >= "2019-06-28" Group by user_id ) as c
select ifnull(round(avg(session_count), 2),0) as average_sessions_per_user from (select user_id, count(distinct session_id) as session_count from Activity WHERE activity_date BETWEEN "2019-06-28" AND "2019-07-27" GROUP BY user_id) as t1
select ifnull(round(avg(sessions),2),0) average_sessions_per_user from( select distinct user_id , count(distinct session_id) sessions from activity where activity_date >= '2019-06-28' and activity_date <= '2019-07-27' group by user_id ) t
select ifnull(round(avg(t),2),0) as average_sessions_per_user from( select activity_date,count(distinct session_id) as t from Activity where activity_date>cast('2019-06-27'as date) and activity_date<cast('2019-07-27' as date) group by user_id ) as t
select ifnull(round(avg(table2.session_number),2),0) as average_sessions_per_user from( select table1.user_id,count(distinct(table1.session_id)) as session_number from( select * from Activity where activity_date > '2019-06-27' and activity_date <= '2019-07-27') AS table1 group by table1.user_id ) AS table2
select ifnull(round(avg(tem.a),2),0) as average_sessions_per_user from (select count(distinct(s.session_id)) as a from Activity s where s.activity_date between '2019-06-28' and '2019-07-27' group by user_id) tem
select ifnull(round(count(distinct session_id) / count(distinct user_id), 2), 0) as 'average_sessions_per_user' from (select * from Activity where datediff('2019-07-27', activity_date) < 30 ) as temp
select ifnull(round(count(distinct session_id) / count(distinct user_id), 2), 0.00) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select ifnull(round(count(distinct session_id)/ count(distinct user_id),2),0) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select ifnull(round(count(distinct session_id)/ count(distinct user_id),2),0) as average_sessions_per_user from Activity where datediff('2019-07-27',activity_date) <30
select ifnull(round(count(distinct session_id)/(count(distinct user_id)), 2), 0.00) as average_sessions_per_user from activity where activity_date >= '2019-06-28' and activity_date <= '2019-07-27'
select ifnull(round(count(distinct session_id)/count(distinct user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'
select ifnull(round(count(distinct session_id)/count(distinct user_id),2), 0) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27 '
select ifnull(round(count(distinct session_id)/count(distinct user_id),2), 0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'
select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date > '2019-07-27' - interval 1 month
select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'
select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between date_sub('2019-07-27',interval 29 day) and '2019-07-27'
select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from Activity where datediff('2019-07-27',activity_date) < 30
select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from activity where activity_date between '2019-6-28' and '2019-07-27'
select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0.00)as average_sessions_per_user from Activity where activity_date between '2019-06-28'and'2019-07-27'
select ifnull(round(count(distinct user_id ,session_id )/count(distinct user_id ),2),0.00) as average_sessions_per_user from Activity where activity_date BETWEEN '2019-06-28' AND '2019-07-27'
select ifnull(round(count(distinct(session_id))/count(distinct(user_id)),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'
select ifnull(round(count(session_id)/count(distinct user_id),2),0) as average_sessions_per_user from( select user_id, session_id from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by 1,2) z
select ifnull(round(sum(ct)/count(ct),2),0.00)as average_sessions_per_user from ( select count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t
select ifnull(round(sum(ct)/count(ct),2),0.00)as average_sessions_per_user from ( select user_id, count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t
select ifnull(round(sum(ct)/count(user_id), 2), 0) as average_sessions_per_user from (select user_id, count(distinct session_id) as ct from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) a
select ifnull(round(sum(ct)/count(user_id),2),0.00)as average_sessions_per_user from ( select user_id, count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t
select ifnull(round(sum(num)/count(distinct user_id),2), 0) as average_sessions_per_user from (select distinct user_id, count(distinct session_id) as num from Activity where activity_date between date_sub('2019-07-27', Interval 29 Day) and '2019-07-27' group by 1) as tempt
select ifnull(round(sum(sub.sess)/ count( distinct user_id),2),0) average_sessions_per_user from ( select user_id ,count(distinct session_id) sess from Activity where activity_date <= '2019-07-27' and activity_date >= '2019-06-28' group by user_id) sub
select ifnull(round(sum(total)/count(*),2),0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as total from Activity where activity_date <= '2019-07-27' and activity_date >= '2019-06-28' group by user_id) T
select round( ifnull( count(distinct session_id) / count(distinct user_id) ,0) ,2) as average_sessions_per_user from Activity where DATEDIFF("2019-07-27", activity_date) < 30
select round(coalesce(avg(session),0),2) as average_sessions_per_user from (SELECT DISTINCT user_id, COUNT(DISTINCT session_id) AS session FROM Activity WHERE activity_date > DATE_SUB("2019-07-27", INTERVAL 30 DAY) GROUP BY user_id HAVING session >= 1) as tb1
select round(coalesce(avg(sessions), 0), 2) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sessions from activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27' group by 1 ) f
select round(coalesce(avg(sessions),0), 2) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sessions from activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27' group by user_id ) f
select round(coalesce(count(distinct session_id)/count(distinct user_id), 0), 2) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) between 0 and 29
select round(coalesce(count(distinct session_id)/count(distinct user_id),0),2) as average_sessions_per_user from Activity where activity_date <= '2019-07-27' and activity_date >'2019-06-27'
select round(coalesce(sum(b.num_sessions)/count(b.user_id), 0), 2) as average_sessions_per_user from ( select a.user_id, count(*) as num_sessions from ( select user_id, session_id from Activity where activity_date between '2019-06-28' and '2019-07-27' and activity_type in ('open_session', 'end_session', 'scroll_down', 'send_message') group by 1,2 ) a group by a.user_id ) b
select round(coalesce(sum(ses_count)/count(distinct user_id),0),2) as average_sessions_per_user from (select user_id, count(distinct session_id) as ses_count from activity where activity_date <= '2019-07-27' and activity_date >'2019-06-27' group by user_id) as T
select round(ifnull(avg(_count),0),2) average_sessions_per_user from(select distinct user_id, count(distinct session_id) _count from Activity where activity_date <= '2019-07-27' and activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) a
select round(ifnull(avg(c),0),2) as average_sessions_per_user from ( select user_id, count(distinct session_id) as c from Activity where DATEDIFF('2019-07-27',activity_date) < 30 group by 1) k
select round(ifnull(avg(c.a),0),2) as average_sessions_per_user from (Select count(distinct session_id) as a from Activity where activity_date between SUBDATE('2019-07-27',interval 29 day) and '2019-07-27' group by user_id) c
select round(ifnull(avg(ifnull(n,0)),0),2) "average_sessions_per_user" from (select user_id, count(distinct session_id) n from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id) t
select round(ifnull(avg(n),0),2) "average_sessions_per_user" from (select user_id, count(distinct session_id) n from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id) t
select round(ifnull(avg(num),0),2) as 'average_sessions_per_user' from ( select user_id, count(distinct session_id) as 'num' from activity where datediff('2019-07-27',activity_date) < 30 group by user_id) as A
select round(ifnull(count(distinct session_id) *1.0/count(distinct user_id),0 ),2) as average_sessions_per_user from Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'
select round(ifnull(count(distinct session_id) / count(distinct user_id), 0), 2) as average_sessions_per_user from Activity where activity_date between DATE_sub('2019-07-27', INTERVAL 29 DAY) and '2019-07-27'
select round(ifnull(count(distinct session_id) / count(distinct user_id),0),2) as average_sessions_per_user from Activity where activity_date between date_add("2019-07-27", interval -29 day) and "2019-07-27"
select round(ifnull(count(distinct session_id) / count(distinct user_id),0.00),2) as average_sessions_per_user from Activity where activity_date between subdate('2019-07-27', 29) and '2019-07-27'
select round(ifnull(count(distinct session_id)/ count(distinct user_id),0), 2) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select round(ifnull(count(distinct session_id)/count(distinct user_id) ,0),2)average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select round(ifnull(count(distinct session_id)/count(distinct user_id), 0), 2) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'
select round(ifnull(count(distinct session_id)/count(distinct user_id), 0),2) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) <= 29
select round(ifnull(count(distinct session_id)/count(distinct user_id),0), 2) average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'
select round(ifnull(count(distinct user_id, session_id)/count(distinct user_id),0),2) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'
select round(ifnull(count(distinct user_id, session_id)/count(distinct user_id),0),2) as average_sessions_per_user from activity where activity_date <= "2019-07-27" and activity_date > date_sub("2019-07-27",interval 30 day)
select round(ifnull(count(distinct user_id,session_id)/count(distinct user_id),0),2) as average_sessions_per_user from activity where activity_date<='2019-07-27' and activity_date>date_sub('2019-07-27', INTERVAL 30 DAY)
select round(ifnull(sum(b.req)*1.0/count(b.user_id),0),2) as average_sessions_per_user from ( select a.user_id, ifnull(count(distinct a.session_id),0) as req from (select distinct * from Activity where datediff('2019-07-27',activity_Date) < 30)a group by a.user_id )b
select round(ifnull(sum(session_num) / count(session_num), 0.00), 2) as average_sessions_per_user from (select count(distinct session_id) as session_num from Activity where activity_date between Date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) as new_table
with T as( select user_id, count(distinct session_id) as num_session from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id ) select ifnull(round(sum(T.num_session) / count(T.user_id), 2), 0.00) as average_sessions_per_user from T
with a as ( select user_id, count(distinct session_id) sess_num from Activity where datediff('2019-07-27',activity_date) <=29 group by user_id ) select coalesce(round(sum(sess_num) /count(distinct user_id), 2), 0.00) average_sessions_per_user from a
with a as (select user_id, count(distinct session_id) as sc from activity where activity_date >= '2019-06-28' and activity_date < '2019-07-27' group by user_id) select coalesce(round(sum(sc)/count(distinct user_id),2),0.00000) as average_sessions_per_user from a
with ct as( select user_id, count(distinct session_id) as ag from Activity where datediff('2019-07-27',activity_date)<=29 group by 1 having count(distinct activity_type)>=1 ) select ifnull(round(sum(ag)/count(user_id),2),0) as average_sessions_per_user from ct
with cte as ( SELECT count(distinct session_id) as tot FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' Group BY user_id) select ifnull(Round(avg(tot),2),0) as average_sessions_per_user FROM cte
with cte as ( select count(distinct session_id) as cnt from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) select ifnull(round(avg(cnt),2),0) as average_sessions_per_user from cte
with cte as ( select count(distinct user_id) as eachuser, count(distinct session_id) as sessioncount from Activity where datediff('2019-07-27', activity_date) < 30 ) select ifnull( round( sessioncount /eachuser, 2 ) ,0 ) as average_sessions_per_user from cte
with cte as ( select user_id , count(distinct session_id) num_session from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) select round(coalesce(sum(num_session)/count(distinct user_id),0.00),2) as average_sessions_per_user from cte
with cte as ( select user_id, count(distinct session_id) as session_uniq_id, sum(case when activity_type is not null then 1 else 0 end) as activity_bool from Activity where activity_date >= "2019-06-28" and activity_date <= "2019-07-27" group by user_id ) select ifnull(round(sum(session_uniq_id) / count(distinct user_id), 2), 0) as average_sessions_per_user from cte where activity_bool != 0
with cte as (select count(distinct session_id) as totalSessions, count(distinct user_id) as totalUsers from Activity where activity_date between subDate("2019-07-27", interval 29 day) and "2019-07-27") select ifnull(round(totalSessions/totalUsers, 2), 0) as average_sessions_per_user from cte
with cte as (select distinct session_id, user_id from Activity where Activity.activity_date between "2019-06-28" and "2019-07-27") select round(coalesce((count(session_id)) / (count(distinct user_id)), 0), 2) as average_sessions_per_user from cte
with cte as (select user_id, count(distinct session_id) as count_session from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id ) select ifnull(round(sum(count_session) / count(distinct user_id), 2),0) as average_sessions_per_user from cte
with cte as (select user_id, count(distinct session_id) as num_sessions from activity where activity_date between date_add( '2019-07-27', interval -29 day) and '2019-07-27' group by 1) select round(ifnull(sum(num_sessions)/count(*),0) , 2) as average_sessions_per_user from cte
with cte as( select user_id, count(distinct session_id) as countofsessions from activity where activity_date < '2019-07-28' and activity_date > '2019-06-27' group by user_id) select (case when ROUND(sum(countofsessions) /count(user_id),2) is null then 0 else ROUND(sum(countofsessions) /count(user_id),2) end) as average_sessions_per_user from cte
with cte as( select user_id, count(distinct session_id) as numofsession from Activity where datediff(date("2019-07-27"), activity_date) <= 29 group by user_id ) select coalesce( round(sum(numofsession)/count(distinct user_id) ,2), 0.00) as average_sessions_per_user from cte
with cte1 as ( select user_id, count(distinct session_id) as session_num from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by 1), cte2 as ( select count(distinct user_id) as user_num from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27') select round(ifnull(sum(c1.session_num)/c2.user_num,0),2) as average_sessions_per_user from cte1 c1 cross join cte2 c2
with cte_cleaned as (select distinct * from Activity), agg as (select user_id, count(distinct session_id) as session_count from cte_cleaned where activity_date <= '2019-07-27' and activity_date > '2019-06-27' group by 1) select coalesce(round(avg(session_count), 2), 0) average_sessions_per_user from agg
with filtered as (select user_id, session_id from Activity where activity_date <= '2019-07-27' and activity_date > '2019-06-27' group by 1,2) select round(coalesce(avg(sessions),0),2) as average_sessions_per_user from (select user_id, count(session_id) as sessions from filtered group by 1) a
with new as( select user_id, count(distinct session_id) as cnt from activity where activity_date between subdate('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) select ifnull(round(avg(cnt),2),0) as average_sessions_per_user from new
with pre as (select user_id,count(distinct session_id )num_session from activity where datediff('2019-07-27',activity_date) <=29 group by user_id ) select coalesce(round(sum(num_session)/count(distinct user_id),2),0.00)average_sessions_per_user from pre
with t as ( select distinct user_id, count(distinct session_id) as num_sessions from Activity where activity_date <= date("2019-07-27") and activity_date >= date_add("2019-07-27", INTERVAL -29 DAY) group by user_id) select ifnull(round(sum(num_sessions)/count(user_id),2),0) as average_sessions_per_user from t
with t as ( select user_id,count(distinct session_id) as num_sess from activity where activity_date >= date_add('2019-07-27',interval -29 day) and activity_date <= '2019-07-27' group by 1 ) select coalesce(cast(avg(num_sess) as decimal(65,2)),0) as average_sessions_per_user from t
with t1 as (select user_id, count(distinct session_id) as total from activity where datediff('2019-07-27',activity_date) <=29 group by 1) select ifnull(round(sum(total)/count(distinct user_id),2),0) as average_sessions_per_user from t1
with t1 as (select user_id, count(distinct session_id) sd from activity where activity_date >= date_add("2019-07-28", INTERVAL -30 DAY) group by user_id having sd>0) select ifnull(round(avg(sd),2),0) average_sessions_per_user from t1
with t1 as (select user_id, count(distinct session_id) sd from activity where activity_date between date_sub('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' group by user_id having sd>0) select ifnull(round(avg(sd),2),0) average_sessions_per_user from t1
with temp (tot_sessions,user_id) as ( select count(distinct session_id) as tot_sessions, user_id from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id ) select case when round(sum(tot_sessions)/count(user_id),2) is NULL then 0 else round(sum(tot_sessions)/count(user_id),2) end as average_sessions_per_user from temp
with temp as ( select count(distinct session_id) as dissession ,user_id from Activity where activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' group by user_id ) select ifnull(round(sum(dissession) / count(user_id),2),0) as average_sessions_per_user from temp
with temp as ( select user_id, (count(distinct session_id)) as count1, count(distinct user_id) as counts from Activity where activity_date between '2019-06-28' AND '2019-07-27' group by user_id having count(activity_type) >=1) select COALESCE(ROUND(sum(temp.count1) / sum(counts),2),0) as average_sessions_per_user from temp
with temp as (SELECT COUNT(DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id) select ifnull(round(avg(sess),2),0) as average_sessions_per_user from temp
with temp as(select user_id,count(distinct session_id) as count from activity where datediff('2019-07-27',activity_date)<30 group by user_id) select ifnull(round(avg(count),2),0) as average_sessions_per_user from temp
with temp1 as ( select user_id, count(distinct session_id) cnt from activity where activity_date between ADDDATE('2019-07-27', -29) and '2019-07-27' group by user_id ) select ifnull(round(sum(cnt)/count(distinct user_id), 2), 0) average_sessions_per_user from temp1
with total as(select session_id from activity where activity_date between date_sub('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' group by session_id) select ifnull(round(count(total.session_id)/B.avgt,2),0.00) as average_sessions_per_user from total,(select count(distinct user_id) as avgt from activity where activity_date between date_sub('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' )B
with user_count as ( select user_id, count(distinct session_id) as session_count from activity where activity_date >= '2019-07-27' - interval 29 day and activity_date <= '2019-07-27' group by user_id ) select ifnull(round(avg(session_count),2),0) as average_sessions_per_user from user_count
with user_session_counts as ( SELECT user_id, COUNT(DISTINCT session_id) as sessions FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30 and DATEDIFF('2019-07-27',activity_date)>= 0 GROUP BY 1 ) SELECT ROUND(CASE WHEN AVG(sessions) IS NULL THEN 0 ELSE AVG(sessions) END,2) as average_sessions_per_user FROM user_session_counts
with user_session_counts as ( SELECT user_id, COUNT(DISTINCT session_id) as sessions FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27' GROUP BY 1 ) SELECT ROUND(CASE WHEN AVG(sessions) IS NULL THEN 0 ELSE AVG(sessions) END,2) as average_sessions_per_user FROM user_session_counts
with x as (select user_id as users, count(distinct session_id) as total from activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id) select coalesce (round (sum(total)/ count(distinct users),2),0) as average_sessions_per_user from x
