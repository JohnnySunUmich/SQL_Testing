SELECT A.buyer_id FROM Sales AS A INNER JOIN Product AS B ON A.product_id=B.product_id GROUP BY A.buyer_id HAVING SUM(CASE WHEN B.product_name="S8" THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN B.product_name="iPhone" THEN 1 ELSE 0 END)=0
SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = "S8") > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
SELECT DISTINCT A.buyer_id FROM (SELECT S.buyer_id, P.product_name FROM Sales S LEFT JOIN Product P ON S.product_id = P.product_id WHERE P.product_name = 'S8') A LEFT JOIN (SELECT S.buyer_id, P.product_name FROM Sales S LEFT JOIN Product P ON S.product_id = P.product_id WHERE P.product_name = 'iPhone') B ON A.buyer_id = B.buyer_id WHERE B.product_name IS NULL
SELECT DISTINCT BUYER_ID FROM Product P RIGHT JOIN Sales S ON P.product_id = S.product_id WHERE product_name = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM Product P RIGHT JOIN Sales S ON P.product_id = S.product_id WHERE product_name = 'iphone')
SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
SELECT DISTINCT BUYER_ID from sales s join product p on s.product_id=p.product_id where product_name='S8' and buyer_id not in (select distinct buyer_id from sales s join product p on s.product_id=p.product_id where product_name='iPhone' )
SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0
SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone')
SELECT DISTINCT S.buyer_id FROM Sales S INNER JOIN Product P ON S.product_id = P.product_id WHERE P.product_name = 'S8' AND S.buyer_id NOT IN ( SELECT DISTINCT S.buyer_id FROM Sales S INNER JOIN Product P ON S.product_id = P.product_id WHERE P.product_name = 'iPhone' )
SELECT DISTINCT S1.buyer_id FROM Sales S1, Product P WHERE S1.product_id = P.product_id AND P.product_name = 'S8' AND S1.buyer_id NOT IN ( SELECT S1.buyer_id AS iPhone FROM Sales S1, Product P WHERE S1.product_id = P.product_id AND P.product_name = 'iPhone')
SELECT DISTINCT Sales.buyer_id FROM Product, Sales WHERE Product.product_id = Sales.product_id AND Product.Product_name = 'S8' AND buyer_id not in (SELECT Sales.buyer_id FROM Product, Sales WHERE Product.product_id = Sales.product_id AND Product.Product_name = 'iPhone')
SELECT DISTINCT Sales.buyer_id FROM Sales LEFT JOIN Product ON Sales.product_id = Product.product_id WHERE Product.product_name = 'S8' AND Sales.buyer_id NOT IN ( SELECT DISTINCT Sales.buyer_id FROM Sales LEFT JOIN Product ON Sales.product_id = Product.product_id WHERE Product.product_name = 'iPhone' )
SELECT DISTINCT Sales.buyer_id FROM Sales left join Product on Sales.product_id = Product.product_id WHERE Product.product_name = 'S8' and Sales.buyer_id not IN (SELECT Sales.buyer_id FROM Sales left join Product on Sales.product_id = Product.product_id WHERE Product.product_name = 'iPhone')
SELECT DISTINCT Sales.buyer_id from Sales where Sales.buyer_id in (select b.buyer_id from Product a left join Sales b on a.product_id = b.product_id where a.Product_Name = "S8") and Sales.buyer_id not in ( select b.buyer_id from Product a left join Sales b on a.product_id = b.product_id where a.Product_Name = "iPhone")
SELECT DISTINCT a.buyer_id FROM (SELECT buyer_id FROM Sales WHERE product_id IN (SELECT product_id FROM Product WHERE product_name LIKE 'S8') ) a JOIN (SELECT buyer_id FROM Sales WHERE buyer_id NOT IN (SELECT buyer_id FROM Sales WHERE product_id IN (SELECT product_id FROM Product WHERE product_name LIKE 'iPhone') ) ) b ON a.buyer_id=b.buyer_id
SELECT DISTINCT buyer_id FROM ( SELECT buyer_id, CASE WHEN product_name = 'S8' THEN 1 ELSE 0 END AS S8, CASE WHEN product_name = 'iPhone' THEN 1 ELSE 0 END AS iPhone FROM Sales S INNER JOIN Product P ON S.product_id = P.product_id) AS sub GROUP BY buyer_id HAVING SUM(S8) >0 AND SUM(iPhone) = 0
SELECT DISTINCT buyer_id FROM Product AS t1 RIGHT JOIN Sales AS t2 ON t1.product_id = t2.product_id WHERE product_name = 'S8' AND buyer_id NOT IN ( SELECT DISTINCT buyer_id FROM Product AS t1 RIGHT JOIN Sales AS t2 ON t1.product_id = t2.product_id WHERE product_name = 'iPhone' )
SELECT DISTINCT buyer_id FROM Product JOIN Sales WHERE Product.product_id = Sales.product_id GROUP BY buyer_id HAVING SUM(Product.product_name='S8')>0 AND SUM(Product.product_name = 'iPhone') =0
SELECT DISTINCT buyer_id FROM Product LEFT JOIN Sales USING(product_id) WHERE product_name='S8' AND buyer_id NOT IN ( SELECT buyer_id FROM Sales LEFT JOIN Product USING(product_id) WHERE product_name='iPhone' )
SELECT DISTINCT buyer_id FROM Product NATURAL JOIN Sales WHERE buyer_id NOT IN ( SELECT buyer_id FROM Product NATURAL JOIN Sales WHERE product_name = 'iPhone' ) AND product_name = 'S8'
SELECT DISTINCT buyer_id FROM Product p JOIN Sales s ON p.product_id = s.product_id WHERE product_name = 'S8' AND buyer_id NOT IN ( SELECT DISTINCT buyer_id FROM Product p JOIN Sales s ON p.product_id = s.product_id WHERE product_name = 'iPhone' )
SELECT DISTINCT buyer_id FROM Product p RIGHT JOIN Sales s ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND buyer_id NOT IN (SELECT DISTINCT buyer_id FROM Product p RIGHT JOIN Sales s ON s.product_id = p.product_id WHERE p.product_name = 'IPhone')
SELECT DISTINCT buyer_id FROM Sales AS S INNER JOIN Product AS P ON S.product_id = P.product_id AND P.product_name = 'S8' AND S.buyer_id NOT IN( SELECT DISTINCT buyer_id FROM Sales INNER JOIN Product WHERE Sales.product_id = Product.product_id AND product_name = 'iPhone' )
SELECT DISTINCT buyer_id FROM Sales AS s JOIN Product AS p USING(product_id) GROUP BY buyer_id HAVING SUM(IF(product_name = "S8", 1, 0)) > 0 AND SUM(IF(product_name = "iPhone", 1, 0)) = 0
SELECT DISTINCT buyer_id FROM Sales INNER JOIN Product ON Product.product_id = Sales.product_id WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT Sales.buyer_id FROM Sales INNER JOIN Product ON Sales.product_id = Product.product_id WHERE product_name = 'iPhone')
SELECT DISTINCT buyer_id FROM Sales INNER JOIN Product ON Sales.product_id=Product.product_id WHERE product_name='S8' AND buyer_id NOT IN ( SELECT buyer_id FROM Sales INNER JOIN Product ON Sales.product_id=Product.product_id WHERE product_name='iPhone' )
SELECT DISTINCT buyer_id FROM Sales JOIN Product ON Product.product_id = Sales.product_id WHERE buyer_id NOT IN( SELECT buyer_id FROM Sales JOIN Product ON Product.product_id = Sales.product_id WHERE product_name = "iPhone") AND product_name = "S8"
SELECT DISTINCT buyer_id FROM Sales JOIN Product ON Sales.product_id = Product.product_id WHERE product_name = "S8" AND buyer_id NOT IN ( SELECT DISTINCT buyer_id FROM Sales JOIN Product ON Sales.product_id = Product.product_id WHERE product_name = "iPhone" )
SELECT DISTINCT buyer_id FROM Sales JOIN Product USING(product_id) WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM Sales JOIN Product USING(product_id) WHERE product_name = 'iPhone')
SELECT DISTINCT buyer_id FROM Sales JOIN product ON sales.product_id = product.product_id WHERE product.product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM Sales JOIN Product ON sales.product_id = product.product_id WHERE product.product_name = 'iPhone' )
SELECT DISTINCT buyer_id FROM Sales LEFT JOIN Product USING (product_id) WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT DISTINCT buyer_id FROM Sales LEFT JOIN Product USING (product_id) WHERE product_name = 'iPhone')
SELECT DISTINCT buyer_id FROM Sales LEFT JOIN Product USING(product_id) WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM Sales JOIN Product USING (product_id) WHERE product_name = 'iPhone' GROUP BY buyer_id)
SELECT DISTINCT buyer_id FROM Sales LEFT JOIN Product USING(product_id) WHERE product_name='S8' AND buyer_id NOT IN (SELECT buyer_id FROM Sales LEFT JOIN Product USING(product_id) WHERE product_name='iPhone')
SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN ( SELECT DISTINCT buyer_id FROM Sales INNER JOIN Product USING(product_id) WHERE product_name = "S8" ) AND buyer_id NOT IN ( SELECT DISTINCT buyer_id FROM Sales INNER JOIN Product USING(product_id) WHERE product_name = "Iphone" ) ORDER BY buyer_id
SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN ( SELECT s.buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8') AND buyer_id NOT IN ( SELECT s.buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN (SELECT buyer_id FROM Sales JOIN Product USING(product_id) WHERE product_name="S8") AND buyer_id NOT IN (SELECT buyer_id FROM Sales JOIN Product USING(product_id) WHERE product_name="iPhone")
SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id NOT IN (SELECT buyer_id FROM Sales LEFT JOIN Product USING(product_id) WHERE product_name = 'iPhone') AND buyer_id IN (SELECT buyer_id FROM Sales LEFT JOIN Product USING(product_id) WHERE product_name = 'S8')
SELECT DISTINCT buyer_id FROM Sales WHERE product_id = (SELECT product_id FROM Product WHERE product_name = 'S8') AND buyer_id NOT IN ( SELECT DISTINCT buyer_id FROM Sales WHERE product_id = (SELECT product_id FROM Product WHERE product_name = 'iPhone') )
SELECT DISTINCT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE buyer_id IN (SELECT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name='S8') AND buyer_id NOT IN (SELECT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name='iPhone')
SELECT DISTINCT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND buyer_id NOT IN ( SELECT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone' )
SELECT DISTINCT buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name IN ('S8', 'iPhone') GROUP BY buyer_id HAVING COUNT(DISTINCT product_name) = 1 AND MAX(product_name) = 'S8'
SELECT DISTINCT buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE product_name = 'iPhone')
SELECT DISTINCT buyer_id FROM sales INNER JOIN product ON sales.product_id = product.product_id WHERE product_name = 'S8' AND buyer_id NOT IN ( SELECT buyer_id FROM sales INNER JOIN product ON sales.product_id = product.product_id WHERE product_name = 'iphone' )
SELECT DISTINCT buyer_id FROM sales JOIN product ON sales.product_id = product.product_id AND product.product_name = 'S8' AND buyer_id NOT IN ( SELECT buyer_id FROM sales JOIN product ON sales.product_id = product.product_id AND product.product_name = 'iPhone')
SELECT DISTINCT buyer_id FROM sales JOIN product ON sales.product_id = product.product_id WHERE buyer_id NOT IN (SELECT DISTINCT buyer_id FROM sales JOIN product using(product_id) WHERE product.product_name = 'iPhone') AND product.product_name = 'S8'
SELECT DISTINCT buyer_id FROM sales JOIN product USING(product_id) WHERE product_name = 'S8' AND (buyer_id NOT IN ( SELECT buyer_id FROM sales JOIN product USING(product_id) WHERE product_name = 'iPhone' ))
SELECT DISTINCT buyer_id FROM sales WHERE buyer_id IN (SELECT buyer_id FROM sales s LEFT JOIN product p ON s.product_id = p.product_id WHERE product_name = 'S8') AND buyer_id NOT IN (SELECT buyer_id FROM sales s LEFT JOIN product p ON s.product_id = p.product_id WHERE product_name = 'iPhone')
SELECT DISTINCT s.buyer_id AS buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id AS buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id=p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM Product p JOIN Sales s USING (product_id) WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT buyer_id FROM Product JOIN Sales USING (product_id) WHERE product_name = 'iphone')
SELECT DISTINCT s.buyer_id FROM Sales AS s LEFT JOIN Product AS p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT s.buyer_id FROM Sales AS s LEFT JOIN Product AS p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id AND p.product_name = 'S8' WHERE s.buyer_id NOT IN ( SELECT buyer_id FROM sales s INNER JOIN Product p ON s.product_id = p.product_id AND p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(p.product_name = 'S8') > 0 AND SUM(p.product_name = 'iPhone') = 0
SELECT DISTINCT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id AND p.product_name = 'S8' WHERE s.buyer_id NOT IN ( SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id AND p.product_name = 'iPhone' )
SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN ( SELECT s2.buyer_id FROM Sales s2 JOIN Product p2 ON s2.product_id = p2.product_id WHERE p2.product_name = 'iPhone' )
SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name = "S8" OR product_name = "iPhone" GROUP BY s.buyer_id HAVING SUM(CASE WHEN product_name = "S8" THEN 1 ELSE 0 END) != 0 AND SUM(CASE WHEN product_name = "iPhone" THEN 1 ELSE 0 END) = 0
SELECT DISTINCT s.buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND buyer_id NOT IN (SELECT s.buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone' )
SELECT DISTINCT s.buyer_id FROM sales s INNER JOIN product p on p.product_id = s.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT buyer_id FROM sales sx INNER JOIN product px ON px.product_id = sx.product_id where product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN( SELECT s.buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone' )
SELECT DISTINCT s.buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE s.buyer_id NOT IN (SELECT s.buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone') AND p.product_name = 'S8'
SELECT DISTINCT s.buyer_id FROM sales s JOIN product p on s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN (SELECT s.buyer_id FROM sales s JOIN product p on s.product_id = p.product_id WHERE product_name = 'iPhone')
SELECT DISTINCT s.buyer_id FROM sales s LEFT JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id NOT IN ( SELECT DISTINCT s.buyer_id FROM sales s LEFT JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone' )
SELECT DISTINCT s2.buyer_id FROM sales s2 INNER JOIN product p2 ON s2.product_id = p2.product_id WHERE p2.product_name = 'S8' AND s2.buyer_id NOT IN ( SELECT DISTINCT sa.buyer_id FROM sales sa INNER JOIN product pa ON sa.product_id = pa.product_id WHERE pa.product_name = 'iPhone' )
SELECT DISTINCT(BUYER_ID) from sales s join product p on s.product_id =p.product_id where p.product_name = 'S8' AND s.buyer_id NOT in ( SELECT BUYER_ID FROM sales s join product p on s.product_id = p.product_id where p.product_name = 'Iphone' )
SELECT DISTINCT(buyer_id) FROM Sales AS S JOIN Product AS P ON S.product_id = P.product_id WHERE S.buyer_id IN (SELECT buyer_id FROM Sales AS S JOIN Product AS P ON S.product_id = P.product_id WHERE P.product_name = 'S8') AND S.buyer_id NOT IN (SELECT buyer_id FROM Sales AS S JOIN Product AS P ON S.product_id = P.product_id WHERE P.product_name = 'iPhone')
SELECT DISTINCT(buyer_id) FROM Sales WHERE buyer_id IN ( SELECT buyer_id FROM Sales AS S JOIN Product AS P ON S.product_id = P.product_id WHERE product_name = 'S8' ) AND buyer_id NOT IN ( SELECT buyer_id FROM Sales AS S JOIN Product AS P ON S.product_id = P.product_id WHERE product_name = 'iPhone' )
SELECT DISTINCT(buyer_id) FROM Sales WHERE buyer_id IN ( SELECT buyer_id FROM Sales AS S LEFT JOIN Product AS P ON S.product_id = P.product_id WHERE product_name = 'S8' ) AND buyer_id NOT IN ( SELECT buyer_id FROM Sales AS S LEFT JOIN Product AS P ON S.product_id = P.product_id WHERE product_name = 'iPhone' )
SELECT DISTINCT(buyer_id) FROM Sales WHERE buyer_id IN ( SELECT buyer_id FROM Sales AS S LEFT JOIN Product as P ON S.product_id = P.product_id WHERE P.product_name = 'S8' ) AND buyer_id NOT IN( SELECT buyer_id FROM Sales AS S LEFT JOIN Product as P ON S.product_id = P.product_id WHERE P.product_name = 'iPhone' )
SELECT DISTINCT(buyer_id) FROM Sales WHERE buyer_id IN (SELECT S.buyer_id FROM Product P JOIN Sales S ON P.product_id = S.product_id WHERE P.product_name = 'S8') AND buyer_id NOT IN (SELECT S.buyer_id FROM Product P JOIN Sales S ON P.product_id = S.product_id WHERE P.product_name = 'iPhone')
SELECT DISTINCT(buyer_id) FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone')
SELECT DISTINCT(buyer_id) FROM Sales ss JOIN product pp ON ss.product_id = pp.product_id WHERE product_name = "S8" AND buyer_id NOT IN( SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name = "iphone" )
SELECT DISTINCT(s.buyer_id) FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = "S8" AND s.buyer_id NOT IN (SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = "iPhone")
SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8')>0 AND SUM(P.PRODUCT_NAME ='iPHONE')=0
SELECT S.buyer_id FROM Sales AS S INNER JOIN Product AS P ON S.product_id = P.product_id GROUP BY S.buyer_id HAVING SUM(CASE WHEN P.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT S.buyer_id FROM Sales AS S JOIN Product AS P ON S.product_id = P.product_id GROUP BY S.buyer_id HAVING SUM(P.product_name = "S8") > 0 AND SUM(P.product_name = "iPhone") = 0
SELECT S.buyer_id FROM Sales AS S JOIN Product P USING(product_id) GROUP BY S.buyer_id HAVING SUM('S8' = P.product_name) > 0 AND SUM('iPhone' = P.product_name) = 0
SELECT S.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 and SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT a.buyer_id FROM sales a INNER JOIN product p on a.product_id = p.product_id WHERE 1=1 AND p.product_name = 'S8' AND a.buyer_id NOT IN ( SELECT buyer_id FROM sales s INNER JOIN product b on b.product_id = s.product_id WHERE b.product_name = 'iPhone' ) GROUP BY 1
SELECT b.buyer_id FROM Product AS a JOIN Sales AS b ON a.product_id = b.product_id GROUP BY b.buyer_id HAVING SUM(a.product_name = 'S8') > 0 and SUM(a.product_name = 'iPhone') = 0
SELECT b.buyer_id FROM Product AS a JOIN Sales AS b ON b.product_id = a.product_id GROUP BY b.buyer_id HAVING SUM(a.product_name = 'S8') > 0 and SUM(a.product_name = 'iPhone') = 0
SELECT buyer_id FROM ( SELECT buyer_id, CASE WHEN Product.product_name = 'S8' THEN 1 WHEN Product.product_name = 'iPhone' THEN -1 END AS coeff FROM Product JOIN Sales ON Product.product_id = Sales.product_id AND ( Product.product_name = 'S8' OR Product.product_name = 'iPhone' ) GROUP BY buyer_id, Product.product_name ) AS sales_info GROUP BY buyer_id HAVING SUM(coeff) = 1
SELECT buyer_id FROM ( SELECT buyer_id, GROUP_CONCAT(product_name) as product_names FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY buyer_id HAVING product_names LIKE '%S8%' AND product_names NOT LIKE '%iPhone%') a
SELECT buyer_id FROM Product as p JOIN Sales as s ON p.product_id = s.product_id GROUP BY buyer_id HAVING SUM(IF(product_name = 'S8', 1, 0)) > 0 AND SUM(IF(product_name = 'iPhone', 1, 0)) = 0
SELECT buyer_id FROM Sales JOIN Product ON Sales.product_id = Product.product_id WHERE Sales.product_id IN (SELECT product_id FROM Product WHERE product_name = "S8" OR product_name = "iPhone") GROUP BY buyer_id HAVING SUM(CASE WHEN product_name = "iPhone" THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM Sales JOIN Product USING (product_id) GROUP BY 1 HAVING SUM(CASE WHEN product_name='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name='iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM Sales JOIN Product USING(product_id) GROUP BY buyer_id HAVING SUM(CASE WHEN product_name='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name='iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM Sales JOIN Product USING(product_id) GROUP BY buyer_id HAVING SUM(CASE product_name WHEN "S8" THEN 1 ELSE 0 END)>0 AND SUM(CASE product_name WHEN "iPhone" THEN 1 ELSE 0 END)=0
SELECT buyer_id FROM Sales LEFT JOIN Product ON Sales.product_id = Product.product_id GROUP BY buyer_id HAVING SUM(CASE product_name WHEN 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE product_name WHEN 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM Sales LEFT JOIN Product USING (product_id) GROUP BY buyer_id HAVING SUM(CASE WHEN product_name='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN product_name='iphone' THEN 1 ELSE 0 END)=0
SELECT buyer_id FROM Sales S JOIN Product P ON S.product_id = P.product_id GROUP BY buyer_id HAVING SUM(product_name = 'S8') >0 AND SUM(product_name = 'iPhone') = 0
SELECT buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id GROUP BY buyer_id HAVING SUM(product_name = 'S8') > 0 AND SUM(product_name = 'iPhone') = 0
SELECT buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id GROUP BY buyer_id HAVING SUM(product_name = 'S8') AND SUM(product_name = 'iPhone') = 0
SELECT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY buyer_id HAVING SUM(CASE WHEN product_name = "S8" THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name = "iPhone" THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY buyer_id HAVING SUM(CASE WHEN product_name='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name='iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM Sales s LEFT JOIN Product p ON p.product_id = s.product_id GROUP BY buyer_id HAVING MAX(product_name = 'S8') AND MAX(product_name = 'iPhone') = 0
SELECT buyer_id FROM Sales s LEFT JOIN Product t USING(product_id) GROUP BY buyer_id HAVING SUM(CASE WHEN product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM product p join sales s ON p.product_id = s.product_id where product_name in ('S8','iPhone') group by buyer_id having count(distinct product_name) =1 and min(product_name) = 'S8'
SELECT buyer_id FROM sales AS t1 INNER JOIN product USING(product_id) GROUP BY buyer_id HAVING SUM(CASE WHEN product_name = 's8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM sales INNER JOIN product USING(product_id) GROUP BY buyer_id HAVING SUM(CASE WHEN product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM sales JOIN product USING(product_id) GROUP BY buyer_id HAVING SUM(CASE WHEN product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id FROM sales LEFT JOIN product ON sales.product_id = product.product_id GROUP BY 1 HAVING max(product_name = "S8") and max(product_name = "iPhone") = 0
SELECT buyer_id FROM(Sales JOIN Product ON Sales.product_id = Product.product_id) WHERE product_name IN ('S8','iPhone') GROUP BY buyer_id HAVING SUM(CASE product_name WHEN 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT buyer_id from Sales S LEFT JOIN Product P ON S.product_id = P.product_id where P.product_name = 'S8' AND S.buyer_id not in ( select buyer_id from Sales where product_id IN ( select product_id from Product where product_name = 'iPhone')) group by 1
SELECT distinct buyer_id FROM Sales S WHERE buyer_id IN (SELECT S.buyer_id FROM Sales S JOIN Product P ON S.product_id = P.product_id WHERE P.product_name ='S8') AND buyer_id NOT IN (SELECT S.buyer_id FROM Sales S JOIN Product P ON S.product_id = P.product_id WHERE P.product_name ='iPhone')
SELECT distinct buyer_id FROM Sales join Product using(product_id) WHERE product_name = "S8" and buyer_id not in(select buyer_id from Sales join Product using(product_id) where product_name ="iPhone")
SELECT distinct buyer_id FROM Sales s, Product p where s.product_id = p.product_id group by buyer_id having sum(product_name = "S8")>0 and sum(product_name = "iPhone")=0
SELECT distinct buyer_id FROM Sales where buyer_id in (select buyer_id from Sales s join Product p on s.product_id = p.product_id and p.product_name = 'S8') and buyer_id not in (select buyer_id from Sales s join Product p on s.product_id = p.product_id and p.product_name = 'iPhone')
SELECT distinct buyer_id FROM sales WHERE buyer_id IN ( SELECT buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE product_name = 'S8' ) AND buyer_id NOT IN ( SELECT buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE product_name = 'iPhone' )
SELECT distinct buyer_id FROM sales WHERE product_id IN ( SELECT product_id FROM product WHERE product_name = 'S8' ) AND buyer_id NOT IN ( SELECT buyer_id FROM sales WHERE product_id IN ( SELECT product_id FROM product WHERE product_name = 'iPhone' ) )
SELECT distinct buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' and buyer_id NOT IN( SELECT buyer_id FROM sales s JOIN product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone' )
SELECT distinct buyer_id FROM sales s JOIN product p USING (product_id) WHERE p.product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM sales s JOIN product p USING (product_id) WHERE p.product_name = 'iPhone' )
SELECT distinct buyer_id from Sales S left join Product P on P. product_id = S.product_id where product_name= 'S8' AND buyer_id not in (SELECT distinct buyer_id from Sales S left join Product P on P. product_id = S.product_id where product_name= 'iPhone')
SELECT distinct buyer_id from sales JOIN product on sales.product_id=product.product_id WHERE product_name='S8' AND buyer_id NOT IN ( SELECT distinct buyer_id from sales JOIN product on sales.product_id=product.product_id WHERE product_name='iphone')
SELECT distinct s.buyer_id FROM Sales AS s INNER JOIN Product AS p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT distinct s.buyer_id FROM Sales as s INNER JOIN Product as p ON s.product_id = p.product_id Where p.product_name = 'S8' Having buyer_id not in ( SELECT s.buyer_id FROM Sales as s INNER JOIN Product as p ON s.product_id = p.product_id Where p.product_name = 'iphone' )
SELECT distinct s.buyer_id from Sales s inner join Product p on s.product_id=p.product_id WHERE product_name='S8' and s.buyer_id not in (SELECT s.buyer_id from Sales s inner join Product p on s.product_id=p.product_id WHERE product_name='iPhone')
SELECT distinct(S.buyer_id) FROM Product P JOIN Sales S on P.product_id=S.product_id WHERE P.product_name = "S8" and S.buyer_id not in (SELECT S.buyer_id FROM Product P JOIN Sales S on P.product_id=S.product_id WHERE P.product_name = "iPhone")
SELECT distinct(S.buyer_id) FROM Sales s LEFT JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'S8' AND s.buyer_id not in (SELECT distinct(s.buyer_id) as iphonebuyer FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name = 'iPhone')
SELECT distinct(buyer_id) FROM Sales WHERE buyer_id in (SELECT s.buyer_id FROM sales s JOIN product p ON s.product_id=p.product_id WHERE p.product_name='S8' ) AND buyer_id not in (SELECT s.buyer_id FROM sales s JOIN product p ON s.product_id=p.product_id WHERE p.product_name='iphone' )
SELECT distinct(s.buyer_id) FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name = 'S8' AND s.buyer_id not in (SELECT distinct(s.buyer_id) as iphonebuyer FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE product_name = 'iPhone' )
SELECT s.buyer_id FROM Product p JOIN Sales s ON p.product_id = s.product_id GROUP BY s.buyer_id HAVING SUM(p.product_name = 'S8') > 0 AND SUM(p.product_name = 'iPhone') = 0
SELECT s.buyer_id FROM Sales AS s INNER JOIN Product AS p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END ) = 0
SELECT s.buyer_id FROM Sales AS s INNER JOIN Product AS p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT s.buyer_id FROM Sales AS s LEFT JOIN Product AS p ON s.product_id=p.product_id GROUP BY s.buyer_id HAVING group_concat(DISTINCT p.product_name) LIKE '%S8%' and group_concat(DISTINCT p.product_name) NOT LIKE '%iPhone%'
SELECT s.buyer_id FROM Sales s INNER JOIN Product p ON s.Product_id = p.Product_id GROUP BY buyer_id HAVING SUM(product_name = 'S8')>0 AND SUM(product_name = 'iPhone')=0
SELECT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id GROUP BY buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT s.buyer_id FROM Sales s JOIN Product p ON p.product_id = s.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN (p.product_name = 'iPhone') THEN 1 ELSE 0 END)=0 and SUM(CASE WHEN (p.product_name = 'S8') THEN 1 ELSE 0 END)>0
SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY 1 HAVING SUM(p.product_name = 'S8') > 0 AND SUM(p.product_name = 'iPhone') = 0
SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM( CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END ) = 0 AND SUM( CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END ) >= 1
SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id GROUP BY s.buyer_id HAVING SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id group by s.buyer_id having sum(p.product_name='S8')>=1 and sum(p.product_name='iPhone')=0
SELECT s.buyer_id FROM Sales s JOIN Product p ON s.product_id=p.product_id GROUP BY 1 HAVING SUM(CASE WHEN p.product_name LIKE 'S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN p.product_name LIKE 'iPhone' THEN 1 ELSE 0 END)=0
SELECT s.buyer_id FROM Sales s JOIN Product p USING(product_id) GROUP BY s.buyer_id HAVING SUM(p.product_name = 'S8') > 0 AND SUM(p.product_name = 'iPhone') = 0
SELECT t1.buyer_id FROM Sales AS t1 INNER JOIN Product AS t2 ON t1.product_id = t2.product_id GROUP BY t1.buyer_id HAVING SUM(CASE WHEN t2.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN t2.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
Select Buyer_id from (Select s.product_id, p.product_name, s.buyer_id from Product p Left Join sales s On p.product_id = s.product_id) AS T1 group by buyer_id having Sum(T1.product_name = 'S8') > 0 AND Sum(T1.product_name = 'iPhone') = 0
Select Distinct buyer_id From Sales Where product_id = (Select product_id From Product Where product_name = "S8") and buyer_id Not In (Select buyer_id From Sales Where product_id = (Select product_id From Product Where product_name = "iPhone"))
Select distinct a.buyer_id from Sales a join product b on a.product_id = b.product_id Where b.product_name = 'S8' and a.buyer_id not in (Select a.buyer_id from Sales a join product b on a.product_id = b.product_id Where b.product_name = 'iphone' )
Select distinct a.buyer_id from sales a join product b on a.product_id = b.product_id where a.buyer_id in (Select a.buyer_id from sales a join product b on a.product_id = b.product_id where b.product_name = 'S8') and a.buyer_id not in (Select a.buyer_id from sales a join product b on a.product_id = b.product_id where b.product_name = 'iPhone')
Select distinct buyer_id from Sales s join Product p on s.product_id=p.product_id group by buyer_id having sum(p.product_name = 'S8')>0 and sum(p.product_name ='iphone')=0
Select distinct buyer_id from Sales where buyer_id not in (Select buyer_id from Sales s left join Product p on s.product_id = p.product_id where p.product_name = 'iPhone') and buyer_id in (Select buyer_id from Sales s left join Product p on s.product_id = p.product_id where p.product_name = 'S8')
Select distinct buyer_id from sales where product_id = (Select product_id from product where product_name = "S8") and buyer_id not in( Select buyer_id from sales where product_id = (Select product_id from product where product_name = "iphone"))
Select distinct s.buyer_id from Product p join Sales s on s.product_id = p.product_id where p.product_name like 's8' and s.buyer_id not in ( Select buyer_id from Sales where product_id in ( Select product_id from Product where product_name like 'iPhone'))
Select distinct t3.buyer_id from Sales as t3 join Product as t4 on t3.product_id=t4.product_id where t4.product_name ='S8' and t3.buyer_id not in (select t1.buyer_id from Sales as t1 left join Product as t2 on t1.product_id=t2.product_id where t2.product_name ='iPhone')
Select distinct(s.buyer_id) from sales s join product p on p.product_id = s.product_id where p.product_name ='S8' and s.buyer_id not in (Select distinct(s.buyer_id) from sales s join product p on p.product_id = s.product_id where p.product_name = 'iPhone')
Select s.buyer_id From Sales as s Join Product as p on s.product_id = p.product_id Group by s.buyer_id Having sum(case when p.product_name = 'S8' Then 1 else 0 end) >= 1 and sum(case when p.product_name = 'iPhone' Then 1 else 0 end) = 0
WITH A AS ( SELECT DISTINCT buyer_id, product_name FROM Product AS P JOIN Sales AS S ON P.product_id = S.product_id), B AS ( SELECT buyer_id, SUM(CASE WHEN product_name = 'S8' THEN 1 ELSE 0 END) AS buy_s8, SUM(CASE WHEN product_name = 'iPhone' THEN 1 ELSE 0 END) AS buy_ip FROM A GROUP BY buyer_id) SELECT buyer_id FROM B WHERE buy_s8>0 AND buy_ip = 0
WITH A AS( SELECT Sales.buyer_id FROM Product LEFT JOIN Sales ON Product.product_id = Sales.product_id WHERE Product.product_name = 'S8' ), B AS( SELECT Sales.buyer_id FROM Product LEFT JOIN Sales ON Product.product_id = Sales.product_id WHERE Product.product_name = 'iPhone' ) SELECT DISTINCT A.buyer_id FROM A WHERE buyer_id NOT IN ( SELECT Sales.buyer_id FROM Product LEFT JOIN Sales ON Product.product_id = Sales.product_id WHERE Product.product_name = 'iPhone' )
WITH BUYER AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME IN ('IPHONE', 'S8') GROUP BY 1,2 ) SELECT DISTINCT T1.BUYER_ID FROM (SELECT BUYER_ID FROM BUYER WHERE PRODUCT_NAME = 'S8') T1 JOIN (SELECT BUYER_ID FROM BUYER GROUP BY 1 HAVING COUNT(*) = 1) T2 ON T1.BUYER_ID = T2.BUYER_ID
WITH BoughtS8 AS (SELECT buyer_id FROM Sales S INNER JOIN Product P ON S.product_id = P.product_id WHERE P.product_name = 'S8'), BoughtiPhone AS (SELECT buyer_id FROM Sales S INNER JOIN Product P ON S.product_id = P.product_id WHERE P.product_name = 'iPhone') SELECT DISTINCT buyer_id FROM BoughtS8 WHERE buyer_id NOT IN (SELECT buyer_id FROM BoughtiPhone)
WITH CTE AS ( SELECT a.buyer_id FROM sales a INNER JOIN product b ON a.product_id=b.product_id AND product_name='S8'), CTE1 AS( SELECT a.buyer_id FROM sales a INNER JOIN product b ON a.product_id=b.product_id AND product_name='iPhone') SELECT DISTINCT buyer_id FROM CTE a WHERE buyer_id NOT IN (SELECT buyer_id FROM CTE1)
WITH CTE AS ( SELECT buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = "iPhone" ) SELECT buyer_id FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id WHERE buyer_id NOT IN (SELECT * FROM CTE) AND p.product_name = 'S8' GROUP BY 1
WITH CTE AS ( SELECT distinct(buyer_id) FROM Sales s JOIN Product p ON s.product_id = p.product_id AND p.product_name = "iPhone"), TEMP AS ( SELECT distinct(buyer_id) FROM Sales s JOIN Product p ON s.product_id = p.product_id AND p.product_name = "S8") SELECT t.buyer_id FROM TEMP t LEFT JOIN CTE c ON t.buyer_id = c.buyer_id WHERE c.buyer_id IS NULL
WITH CTE AS( SELECT BUYER_ID,PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID ) SELECT distinct BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone')
WITH S8Buyers AS (SELECT DISTINCT buyer_id FROM Sales S INNER JOIN Product P ON P.product_id = S.product_id AND P.product_name = 'S8'), iPhoneBuyers AS (SELECT DISTINCT buyer_id FROM Sales S INNER JOIN Product P ON P.product_id = S.product_id AND P.product_name = 'iPhone') SELECT buyer_id FROM S8Buyers WHERE buyer_id NOT IN (SELECT buyer_id FROM iPhoneBuyers)
WITH S8_ID AS ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' ), I_ID AS( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone' ), S8_BUYER AS ( SELECT SALES.BUYER_ID FROM S8_ID, SALES WHERE SALES.PRODUCT_ID = S8_ID.PRODUCT_ID ), I_BUYER AS ( SELECT SALES.BUYER_ID FROM I_ID, SALES WHERE SALES.PRODUCT_ID = I_ID.PRODUCT_ID ) SELECT DISTINCT(S8_BUYER.BUYER_ID) FROM S8_BUYER WHERE S8_BUYER.BUYER_ID NOT IN ( SELECT BUYER_ID FROM I_BUYER)
WITH T1 AS ( SELECT * FROM sales JOIN product USING(product_id) WHERE product_name = 'S8'), T2 AS ( SELECT * FROM sales JOIN product USING(product_id) WHERE product_name = 'iPhone') SELECT DISTINCT T1.buyer_id FROM T1 LEFT JOIN T2 USING(buyer_id) WHERE T2.seller_id IS NULL
WITH TEMP AS ( SELECT a.*,b.product_name FROM Sales a LEFT JOIN Product b ON a.product_id = b.product_id) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN (SELECT buyer_id FROM TEMP WHERE product_name = 'S8') AND buyer_id NOT IN (SELECT buyer_id FROM TEMP WHERE product_name = 'iPhone')
WITH a AS ( SELECT a.buyer_id, MAX(CASE WHEN product_name = 'S8' THEN 1 ELSE 0 END) AS bought_s8, MAX(CASE WHEN product_name = 'Iphone' THEN 1 ELSE 0 END) AS bought_iphone FROM Sales a INNER JOIN Product b ON b.product_id = a.product_id GROUP BY 1 ) SELECT buyer_id FROM a WHERE bought_s8 = 1 AND bought_iphone = 0
WITH buyer_s8 AS (SELECT buyer_id FROM Sales JOIN Product ON Sales.product_id = Product.product_id WHERE Product.product_name = 'S8'), buyer_no_iphone AS (SELECT buyer_id FROM Sales JOIN Product ON Sales.product_id = Product.product_id WHERE Product.product_name = 'iPhone') SELECT DISTINCT buyer_id FROM buyer_s8 WHERE buyer_id NOT IN (SELECT buyer_id FROM buyer_no_iphone)
WITH buyertable AS( SELECT s.buyer_id, p.product_name FROM sales AS s LEFT JOIN Product AS p ON s.product_id=p.product_id ) SELECT DISTINCT buyer_id FROM buyertable WHERE product_name='S8' and buyer_id NOT IN( SELECT buyer_id FROM buyertable WHERE product_name='iPhone' )
WITH comb as (SELECT P.product_id as pid, P.product_name as name, S.buyer_id as bid FROM Sales S LEFT JOIN Product P ON S.product_id = P.product_id) SELECT distinct(bid) as buyer_id FROM comb WHERE bid IN (SELECT bid FROM comb WHERE name = 'S8') AND bid NOT IN (SELECT bid FROM comb WHERE name = 'iPhone')
WITH cte AS (SELECT * FROM Sales LEFT JOIN Product USING (product_id)) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN (SELECT buyer_id FROM cte WHERE product_name='S8') AND buyer_id NOT IN (SELECT buyer_id FROM cte WHERE product_name='iPhone')
WITH cte AS (SELECT a.product_id, b.product_name, a.buyer_id FROM Sales a LEFT JOIN Product b ON a.product_id = b.product_id) SELECT DISTINCT buyer_id FROM cte WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM cte WHERE product_name = 'iPhone')
WITH iphone AS ( SELECT DISTINCT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 'iPhone' ) SELECT DISTINCT buyer_id FROM Sales s JOIN Product p ON s.product_id = p.product_id WHERE p.product_name = 's8' AND buyer_id NOT IN (SELECT buyer_id FROM iphone)
WITH iphone_buyers AS ( SELECT DISTINCT buyer_id AS buyer_id FROM Product p JOIN Sales s ON p.product_id=s.product_id WHERE p.product_name="iPhone" ), s_buyers AS (SELECT DISTINCT buyer_id AS buyer_id FROM Product p JOIN Sales s ON p.product_id=s.product_id WHERE p.product_name="S8") SELECT buyer_id FROM s_buyers WHERE buyer_id NOT IN (select buyer_id FROM iphone_buyers)
WITH s8_buyers AS ( SELECT DISTINCT a.buyer_id AS 'buyer_id' FROM Sales a, Product b WHERE a.product_id=b.product_id AND b.product_name="S8" ), iphone_buyers AS ( SELECT DISTINCT a.buyer_id AS 'buyer_id' FROM Sales a, Product b WHERE a.product_id=b.product_id AND b.product_name="iPhone" ) SELECT buyer_id FROM s8_buyers WHERE buyer_id NOT IN (SELECT buyer_id FROM iphone_buyers)
WITH sold_products AS ( SELECT s.buyer_id, SUM(CASE WHEN p.product_name = 'S8' THEN 1 ELSE 0 END) s8, SUM(CASE WHEN p.product_name = 'iPhone' THEN 1 ELSE 0 END) iPhone FROM Sales s INNER JOIN Product p ON s.product_id = p.product_id GROUP BY s.buyer_id ) SELECT DISTINCT buyer_id FROM sold_products WHERE s8 > 0 AND iPhone = 0
WITH t AS ( SELECT p.product_name, s.buyer_id FROM Product p RIGHT JOIN Sales s ON p.product_id = s.product_id) SELECT buyer_id FROM (SELECT buyer_id, GROUP_CONCAT(product_name SEPARATOR ',') as pro FROM t GROUP BY 1) t1 WHERE pro LIKE '%S8%' AND pro not LIKE '%iPhone%'
WITH t(buyer_Id) AS ( SELECT buyer_id FROM Sales s INNER JOIN Product p ON s.Product_id=p.Product_id WHERE p.product_Name ='iPhone' ) SELECT DISTINCT s.buyer_id FROM Sales s INNER JOIN Product p ON s.product_id=p.product_id LEFT JOIN t ON t.buyer_id=s.buyer_id WHERE p.product_name='S8' AND t.buyer_id IS NULL
WITH t1 AS ( SELECT s.buyer_id, p.product_name FROM Sales s JOIN Product p ON s.product_id = p.product_id) SELECT DISTINCT buyer_id FROM t1 WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM t1 WHERE product_name = 'iPhone')
WITH t1 AS (SELECT buyer_id, product_name FROM Sales s JOIN Product p ON s.product_id = p.product_id), t2 AS (SELECT DISTINCT(buyer_id) as ib FROM t1 WHERE product_name = 'iPhone') SELECT DISTINCT(buyer_id) FROM t1 WHERE product_name = 'S8' AND buyer_id NOT IN (SELECT ib FROM t2)
WITH t1 AS (SELECT s.buyer_id FROM sales s JOIN product p ON p.product_id = s.product_id WHERE p.product_name = 'S8'), t2 AS (SELECT s.buyer_id FROM sales s JOIN product p ON p.product_id = s.product_id WHERE p.product_name = 'iPhone' ) SELECT DISTINCT buyer_id from t1 WHERE buyer_id NOT IN (SELECT * FROM t2) ORDER BY buyer_id
WITH temp AS ( SELECT * FROM Product AS p JOIN Sales AS s USING(product_id) ) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN (SELECT buyer_id FROM temp WHERE product_name='S8') AND buyer_id NOT IN (SELECT buyer_id FROM temp WHERE product_name='iPhone')
WITH temp AS ( SELECT * FROM Sales JOIN Product USING(product_id) ) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id in (SELECT buyer_id FROM temp WHERE product_name='S8') AND buyer_id NOT IN (SELECT buyer_id FROM temp WHERE product_name = 'iPhone')
WITH temp AS ( SELECT * FROM Sales LEFT JOIN Product USING (product_id) ) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN (SELECT buyer_id FROM temp WHERE product_name = 'S8') AND buyer_id NOT IN (SELECT buyer_id FROM temp WHERE product_name = 'iPhone')
WITH temp AS ( SELECT * FROM Sales LEFT JOIN Product USING (product_id) ) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id IN (SELECT buyer_id FROM temp WHERE product_name='S8') AND buyer_id NOT IN (SELECT buyer_id FROM temp WHERE product_name='iPhone')
WITH temp AS ( SELECT * FROM Sales LEFT JOIN Product USING (product_id) ) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id in (SELECT buyer_id FROM temp WHERE product_name='S8') and buyer_id not in (SELECT buyer_id FROM temp WHERE product_name='iPhone')
WITH temp AS ( SELECT buyer_id AS "buyer_id", product_name FROM Sales AS a JOIN (SELECT product_id, product_name from Product) AS b ON a.product_id = b.product_id GROUP BY buyer_id , product_name ) SELECT DISTINCT(buyer_id) FROM temp WHERE buyer_id IN (SELECT buyer_id FROM temp WHERE product_name='S8') AND buyer_id NOT IN (SELECT buyer_id FROM temp WHERE product_name='iPhone')
WITH temp AS (SELECT * FROM Sales LEFT JOIN Product USING (product_id)) SELECT DISTINCT buyer_id FROM Sales WHERE buyer_id NOT IN (SELECT temp.buyer_id FROM temp WHERE product_name='iPhone' ) AND buyer_id IN (SELECT temp.buyer_id FROM temp WHERE product_name='S8')
With cte as ( Select s.product_id, p.product_name, s.buyer_id From sales s join product p on s.product_id = p.product_id Where p.product_name in ('S8', 'iPhone') ) select distinct buyer_id from cte where product_name = 'S8' and buyer_id not in (select buyer_id from cte where product_name = 'iPhone')
With iphone_buyers as ( Select distinct s.buyer_id from Sales s inner join Product p on s.product_id = p.product_id where product_name = "iPhone" ) , S8_buyers as ( Select distinct s.buyer_id from Sales s inner join Product p on s.product_id = p.product_id where product_name = "S8" ) Select * from S8_buyers where buyer_id not in (Select buyer_id from iphone_buyers)
With temp as( select* From sales Left Join product using(product_id)) Select distinct buyer_id From sales Where buyer_id IN (select buyer_id from temp where product_name = "S8") And buyer_id not in (select buyer_id from temp where product_name = "iphone")
With temp as( select* From sales Left Join product using(product_id)) Select distinct buyer_id From sales Where buyer_id IN (select buyer_id from temp where product_name = 'S8') And buyer_id not in (select buyer_id from temp where product_name = 'iPhone')
select A.buyer_id from Sales A left join Product B using(product_id) group by A.buyer_id having sum(case when B.product_name = 'S8' then 1 else 0 end) > 0 and sum(case when B.product_name = 'iPhone' then 1 else 0 end) = 0
select DISTINCT buyer_id from sales where (buyer_id) in (select buyer_id from product right join sales using(product_id) where product_name='S8') and (buyer_id) not in (select buyer_id from product right join sales using(product_id) where product_name='iPhone')
select DISTINCT(sales.buyer_id) from sales inner join product on sales.product_id = product.product_id where product.product_name = 'S8' and sales.buyer_id not in (select DISTINCT(sales.buyer_id) from sales inner join product on sales.product_id = product.product_id where product.product_name = 'iPhone')
select S.buyer_id from Product as P, Sales as S where P.product_id = S.product_id group by S.buyer_id having sum(P.product_name = 'iPhone') = 0 and sum(P.product_name = 'S8') > 0
select S.buyer_id from Sales S LEFT JOIN Product P ON S.product_id = P.product_id where P.product_name = 'S8' AND S.buyer_id not in (select buyer_id from Sales where product_id in ( select product_id from Product where product_name = 'iPhone')) group by 1
select S.buyer_id from Sales S LEFT JOIN Product P ON S.product_id= P.product_id where P.product_name = 'S8' and S.buyer_id not in (select buyer_id from Sales where product_id = (select product_id from Product where product_name = 'iPhone')) group by 1
select S.buyer_id from Sales S inner join Product P on S.product_id=P.product_id where P.product_name = 'S8' and S.buyer_id not in (select S.buyer_id from Sales S inner join Product P on S.product_id=P.product_id where P.product_name = 'iPhone' group by buyer_id) group by buyer_id
select Sales.buyer_id from Sales left join Product on Sales.product_id = Product.product_id group by Sales.buyer_id having sum(product_name='S8') >0 and sum(product_name='iPhone')=0
select a.buyer_id from Sales a left join Product b on a.product_id = b.product_id group by a.buyer_id having sum(b.product_name = 'S8') > 0 and sum(b.product_name = 'iPhone') = 0
select a.buyer_id from sales a left join Product b on a.product_id=b.product_id group by a.buyer_id having group_concat(distinct product_name) like'%S8%' and group_concat(distinct product_name) not like '%iphone%'
select b.buyer_id from product a right join sales b on a.product_id = b.product_id group by b.buyer_id having sum(case when a.product_name = 'S8' then 1 else 0 end) >=1 and sum(case when a.product_name = 'iPhone' then 1 else 0 end) = 0
select buyer_id from ( select buyer_id, max(case when product_name = 'iPhone' then 1 else 0 end) as bought_iphone, max(case when product_name = 'S8' then 1 else 0 end) as bought_S8 from Sales join Product on Sales.product_id = Product.product_id group by buyer_id ) a where bought_iphone = 0 and bought_S8 = 1
select buyer_id from ( select buyer_id, sum(case when product_name = 'S8' then 1 else 0 end) as s8, sum(case when product_name = 'iPhone' then 1 else 0 end) as iphone from Product p join Sales s on p.product_id = s.product_id group by buyer_id ) x where s8 > 0 and iPhone = 0
select buyer_id from ( select buyer_id, sum(case when product_name = 'S8' then 1 else 0 end) as s8_flag, sum(case when product_name = 'iPhone' then 1 else 0 end) as iphone_flag from sales s join product p on s.product_id=p.product_id group by buyer_id ) a where s8_flag>=1 and iphone_flag=0
select buyer_id from ( select s.buyer_id, max(if(p.product_name='S8', 1, 0)) as b_s8, max(if(p.product_name='iPhone', 1, 0)) as b_ip from product p right join sales s using (product_id) group by s.buyer_id) as temp where b_s8=1 and b_ip=0
select buyer_id from ( select s.buyer_id, sum(case when p.product_name = 'S8' then 1 else 0 end) as s8_flag, sum(case when p.product_name = 'iPhone' then 1 else 0 end) as iphone_flag from sales s join product p on s.product_id = p.product_id group by 1 ) a where s8_flag > 0 and iphone_flag = 0
select buyer_id from (sales s inner join product p on p.product_id=s.product_id) group by buyer_id having sum(case when p.product_name='S8' then 1 else 0 end)>0 and sum(case when p.product_name= 'iPhone' then 1 else 0 end)=0
select buyer_id from (select a.buyer_id, sum(case when b.product_name = 'iPhone' then 1 else 0 end) as iphone_sales, sum(case when b.product_name = 'S8' then 1 else 0 end) as S8_sales from sales a left join product b on a.product_id = b.product_id group by a.buyer_id) c where iphone_sales = 0 and S8_sales >= 1
select buyer_id from (select buyer_id, group_concat(distinct product_name) as products from sales s inner join product p on s.product_id = p.product_id group by buyer_id) as t where products like '%S8%' and products not like '%iPhone%'
select buyer_id from (select buyer_id, product_name from sales s left join product p on s.product_id=p.product_id where product_name in ("iphone","S8") group by buyer_id having count(distinct product_name)=1 and product_name="S8")tmp
select buyer_id from (select distinct s.buyer_id as buyer_id from sales s join product p on s.product_id = p.product_id where p.product_name = "S8") s1 where buyer_id not in (select distinct s.buyer_id as buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name = "iPhone")
select buyer_id from (select distinct(buyer_id) from Sales) s where exists (select * from (select distinct(buyer_id) from Sales join Product using (product_id) where product_name = 'S8') s1 where s1.buyer_id = s.buyer_id) and not exists (select * from (select distinct(buyer_id) from Sales join Product using (product_id) where product_name = 'iPhone') s2 where s2.buyer_id = s.buyer_id)
select buyer_id from Product as p join Sales as s on p.product_id = s.product_id group by buyer_id having count(if(p.product_name='S8',1,null)) > 0 and count(if(p.product_name='iPhone',1,null)) = 0
select buyer_id from Product join Sales on Product. product_id = Sales. product_id group by buyer_id having sum(product_name = 's8') > 0 and sum(product_name = 'iphone') =0
select buyer_id from Product join Sales using (product_id) group by buyer_id having sum(product_name='S8')>0 and sum(product_name='iPhone')=0
select buyer_id from Product join Sales using(product_id) GROUP BY buyer_id HAVING SUM(product_name = 'S8') > 0 and SUM(product_name = 'iPhone') = 0
select buyer_id from Product p JOIN Sales s ON p.product_id = s.product_id group by buyer_id having sum(product_name = 'S8') > 0 and sum(product_name = 'iPhone') = 0
select buyer_id from Sales Join Product using(product_id) Group by buyer_id HAVING sum(case WHEN product_name='S8' then 1 else 0 END)>0 AND sum(case when product_name='iphone' then 1 else 0 END)=0
select buyer_id from Sales a join Product b using (product_id) group by buyer_id having sum(case when b.product_name = 'S8' then 1 else 0 end) >0 AND sum(case when b.product_name = 'iPhone' then 1 else 0 end) = 0
select buyer_id from Sales a left join Product b on a.product_id = b.product_id group by 1 having sum(case when b.product_name='S8' then 1 else 0 end) > 0 and sum(case when b.product_name='iPhone' then 1 else 0 end) = 0
select buyer_id from Sales as s join Product as p on s.product_id = p.product_id group by buyer_id having sum(case when product_name = 'S8' then 1 else 0 end) > 0 and sum(case when product_name = 'iPhone' then 1 else 0 end) = 0
select buyer_id from Sales inner join Product on Sales.product_id = Product.product_id group by buyer_id having sum(case when product_name = "S8" then 1 else 0 end) > 0 and sum(case when product_name = "iPhone" then 1 else 0 end) = 0
select buyer_id from Sales inner join Product on Sales.product_id = Product.product_id where Sales.product_id IN (select product_id from Product where product_name = "S8" OR product_name = "iPhone") group by buyer_id HAVING SUM(CASE WHEN product_name = "iPhone" THEN 1 ELSE 0 END) = 0
select buyer_id from Sales join Product on Sales.product_id = Product.product_id group by buyer_id having sum(If(product_name = 'S8',1,0)) >=1 and sum(If(product_name = 'iPhone',1,0)) = 0
select buyer_id from Sales join Product using (product_id) group by buyer_id having group_concat(product_name) like "%S8%" and group_concat(product_name) not like "%iPhone%"
select buyer_id from Sales join Product using(product_id) group by buyer_id HAVING SUM(CASE WHEN Product.product_name = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN Product.product_name = 'iPhone' THEN 1 ELSE 0 END) = 0
select buyer_id from Sales join Product using(product_id) group by buyer_id having sum(Product.product_name = 'S8') > 0 and sum(Product.product_name = 'iPhone') = 0
select buyer_id from Sales join Product using(product_id) group by buyer_id having sum(case when product_name = 'S8' then 1 else 0 end) > 0 and sum(case when product_name = 'iPhone' then 1 else 0 end) =0
select buyer_id from Sales join product using(product_id) group by buyer_id having sum(product_name='S8')>0 and sum(product_name='iphone')=0
select buyer_id from Sales left join Product on Sales.product_id = Product.product_id group by buyer_id having (sum(product_name = 'S8') > 0) and (sum(product_name = 'iPhone') = 0)
select buyer_id from Sales s join Product p on s.product_id = p.product_id group by buyer_id having sum(product_name = 'S8') > 0 and sum(product_name = 'iPhone') = 0
select buyer_id from Sales s join Product p using(product_id) group by buyer_id having sum(p.product_name='S8')>=1 and sum(p.product_name='iPhone')=0
select buyer_id from Sales s join Product p where s.product_id = p.product_id group by buyer_id having sum(product_name = "S8") > 0 and sum(product_name = "iPhone") = 0
select buyer_id from Sales s join Product p where s.product_id=p.product_id group by buyer_id having sum(product_name='S8')>0 and sum(product_name='iPhone')=0
select buyer_id from Sales s join product p on s.product_id = p.product_id where s.product_id in ( select product_id from Product where product_name in ('S8','iPhone') ) group by buyer_id having sum(case when product_name = 'iPhone' then 1 else 0 end) = 0
select buyer_id from Sales s left join Product p on s.product_id = p.product_id group by buyer_id having sum(IF(product_name='S8',1,0))>=1 and sum(IF(product_name='iPhone',1,0))=0
select buyer_id from product join sales on product.product_id = sales.product_id group by buyer_id having sum(product_name = 'S8') > 0 and sum(product_name = 'iPhone') = 0
select buyer_id from product join sales using (product_id) where product_name='iPhone' or product_name='S8' group by buyer_id having sum(if(product_name='iPhone', 1, 0)) = 0
select buyer_id from product p join sales s using (product_id) group by buyer_id having sum(case when p.product_name='S8' then 1 else 0 end)>0 and sum(case when p.product_name='iPhone' then 1 else 0 end)=0
select buyer_id from sales a, product b where a.product_id=b.product_id group by buyer_id having max(product_name='S8') and max(product_name='iPhone')=0
select buyer_id from sales a,product b where a.product_id=b.product_id group by buyer_id having sum(case when product_name='S8' then 1 else 0 end) >0 and sum(case when product_name='iPhone' then 1 else 0 end) =0
select buyer_id from sales inner join product using(product_id) group by buyer_id having sum(case when product_name='S8' then 1 else 0 end)>0 and sum(case when product_name='iPhone' then 1 else 0 end)=0
select buyer_id from sales join Product using(product_id) where product_name='S8' and buyer_id not in ( select buyer_id from sales join Product using(product_id) where product_name='iPhone' ) group by buyer_id
select buyer_id from sales join product using (product_id) group by buyer_id having ( sum(case when product_name ='S8' then 1 else 0 end)>0 and sum(case when product_name ='iphone' then 1 else 0 end)=0)
select buyer_id from sales join product using(product_id) where product_name = 'S8' and buyer_id not in (select buyer_id from sales join product using(product_id) where product_name = 'iPhone') group by buyer_id
select buyer_id from sales s join product p on p.product_id=s.product_id group by buyer_id having sum(if(p.product_name='S8', 1, 0))>0 and sum(if(p.product_name='iPhone', 1, 0))=0
select buyer_id from sales s join product p on s.product_id = p.product_id group by 1 having max(product_name = 'S8') and max(product_name = 'iPhone') = 0
select buyer_id from sales s join product p on s.product_id = p.product_id group by 1 having max(product_name = 'S8')>0 and max(product_name = 'iPhone') = 0
select buyer_id from sales s join product p on s.product_id = p.product_id group by s.buyer_id having max(product_name = 'S8')=1 and max(product_name = 'iPhone') = 0
select buyer_id from sales s join product p on s.product_id=p.product_id group by buyer_id having sum(case when p.product_name='s8' then 1 else 0 end)>0 and sum(case when p.product_name='iphone' then 1 else 0 end)=0
select buyer_id from( select buyer_id, (case when product_name = 'S8' then 1 else 0 end) s8, (case when product_name = 'iPhone' then 1 else 0 end) iPhone from Sales s left join Product p on s.product_id = p.product_id) z group by 1 having sum(s8)>0 and sum(iPhone)=0
select distinct Sales.buyer_id from Sales inner join Product on Product.product_id = Sales.product_id where buyer_id in ( select distinct Sales.buyer_id from Sales left join ( select Sales.buyer_id from Sales inner join Product on Product.product_id = Sales.product_id where Product.product_name='iPhone') iPhoneUsers on Sales.buyer_id = iPhoneUsers.buyer_id where iPhoneUsers.buyer_id is null ) and product_name='S8'
select distinct a.buyer_id from Sales a inner join Product b on a.product_id = b.product_id where a.buyer_id in (select c.buyer_id from Sales c inner join Product d on c.product_id = d.product_id where d.product_name = 'S8') and a.buyer_id not in (select c.buyer_id from Sales c inner join Product d on c.product_id = d.product_id where d.product_name = 'iPhone' )
select distinct a.buyer_id from Sales a left join Product b on a.product_id=b.product_id where b. product_name = 'S8' and buyer_id not in (select a.buyer_id from Sales a left join Product b on a.product_id=b.product_id where b. product_name = 'iPhone')
select distinct b.buyer_id from Sales b left join product a on a.product_id=b.product_id where a.product_name="S8" and buyer_id not in (select distinct b.buyer_id from Sales b left join product a on a.product_id=b.product_id where a.product_name="iPhone") group by 1
select distinct buyer_id from ( select buyer_id from Sales where product_id in ( select product_id from Product where product_name = 'S8' ) ) as t where t.buyer_id not in ( select buyer_id from Sales where product_id = (select product_id from Product where product_name = 'iPhone' ) )
select distinct buyer_id from (select buyer_id from sales s, product p where s.product_id = p.product_id and p.product_name = 'S8') s1 where buyer_id not in ( select buyer_id from sales s, product p where s.product_id = p.product_id and p.product_name = 'iPhone')
select distinct buyer_id from (select s.buyer_id, case when p.product_name = 'S8' then 1 else 0 end as s8, case when p.product_name = 'iPhone' then 1 else 0 end as iphone from Sales s join Product p on s.product_id = p.product_id) temp1 group by buyer_id having sum(s8) > 0 and sum(iphone) = 0
select distinct buyer_id from Product P inner join Sales S on P.product_id=S.product_id where P.product_name='S8' and S.buyer_id not in (select buyer_id from Product P inner join Sales S on P.product_id=S.product_id where P.product_name='iPhone' )
select distinct buyer_id from Product P join Sales S on P.product_id = S.product_id where product_name ='S8' and buyer_id not in (select buyer_id from Product P join Sales S on P.product_id = S.product_id where product_name ='iPhone' )
select distinct buyer_id from Product inner join Sales on Product.product_id = Sales.product_id where product_name = 'S8' and buyer_id not in ( select distinct buyer_id from Product inner join Sales on Product.product_id = Sales.product_id where product_name = 'iPhone' )
select distinct buyer_id from Product p join Sales s on p.product_id = s.product_id where product_name ='S8' AND buyer_id not in (select buyer_id from Product p join Sales s on p.product_id = s.product_id where product_name ='iPhone')
select distinct buyer_id from Product p join Sales s on s.product_id=p.product_id where product_name = 'S8' and buyer_id not in ( select distinct buyer_id from Product p join Sales s on s.product_id=p.product_id where product_name = 'iPhone' )
select distinct buyer_id from SALES where buyer_id IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID =(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = "S8")) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID =(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = "IPHONE"))
select distinct buyer_id from Sales S join Product P on S.product_id = P.product_id where product_name = 's8' and buyer_id not in ( select buyer_id from Sales S join Product P on S.product_id = P.product_id where product_name = 'iPhone')
select distinct buyer_id from Sales a join Product p using(product_id) where p.product_name = 'S8' and a.buyer_id NOT IN (select distinct buyer_id from Sales join Product using(product_id) where product_name='iphone')
select distinct buyer_id from Sales a left join Product b on a.product_id = b.product_id where b.product_name = 'S8' and buyer_id not in (select distinct buyer_id from Sales a left join Product b on a.product_id = b.product_id where b.product_name ='iPhone')
select distinct buyer_id from Sales as a left join Product as b on a.product_id =b.product_id where (product_name ='S8' and buyer_id not in (select buyer_id from Sales as a left join Product as b on a.product_id =b.product_id where product_name ='iPhone' ))
select distinct buyer_id from Sales as s inner join Product as p on s.product_id = p.product_id where p.product_name ='S8' and buyer_id not in (select s.buyer_id from Product as p inner join Sales as s on p.product_id = s.product_id where p.product_name = 'iPhone ')
select distinct buyer_id from Sales inner join Product ON Sales.product_id = Product.product_id and product_name = 'S8' and buyer_id not in (select buyer_id from Sales inner join Product ON Sales.product_id = Product.product_id and product_name = 'iPhone')
select distinct buyer_id from Sales inner join Product using (product_id) where product_name = 'S8' and buyer_id not in (select distinct buyer_id from Sales inner join Product using (product_id) where product_name = 'Iphone')
select distinct buyer_id from Sales join Product on Sales.product_id = Product.product_id where Product.product_name ='S8' and buyer_id not in (select buyer_id from Sales join Product on Sales.product_id = Product.product_id where product_name = 'iPhone')
select distinct buyer_id from Sales join Product using (product_id) where product_name = 'S8' and buyer_id not in (select buyer_id from Sales join Product using(product_id) where product_name = 'iPhone')
select distinct buyer_id from Sales join Product using(product_id) where product_name = 'S8' and buyer_id not in (select distinct buyer_id from sales join product using(product_id) where product_name = 'iPhone')
select distinct buyer_id from Sales left join Product on Sales.product_id=Product.product_id group by buyer_id having sum(if(product_name='S8',1,0))>0 and sum(if(product_name='iphone',1,0))=0
select distinct buyer_id from Sales left join Product using(product_id) where product_name = 'S8' and buyer_id not in ( select buyer_id from Sales left join Product using(product_id) where product_name = 'iPhone' )
select distinct buyer_id from Sales left join product using(product_id) where product_name = "S8" and buyer_id not in (select buyer_id from sales left join product using(product_id) where product_name = 'iphone')
select distinct buyer_id from Sales s inner join Product p on (s.product_id = p.product_id) where product_name = 'S8' and buyer_id not in (select buyer_id from Sales s inner join Product p on s.product_id = p.product_id and product_name = 'iPhone')
select distinct buyer_id from Sales s inner join Product p on p.product_id=s.product_id where product_name="S8" and buyer_id not in (select buyer_id from Sales s inner join Product p on p.product_id=s.product_id where product_name="iPhone")
select distinct buyer_id from Sales s inner join Product p on s.product_id = p.product_id where p.product_name = 'S8' and buyer_id not in ( select distinct buyer_id from Sales s1 inner join Product p1 on s1.product_id =p1.product_id where p1.product_name = 'iPhone' )
select distinct buyer_id from Sales s inner join Product p on s.product_id=p.product_id where p.product_name="S8" and buyer_id not in (select buyer_id from Sales s inner join Product p on s.product_id=p.product_id where p.product_name="iPhone")
select distinct buyer_id from Sales s inner join Product p on s.product_id=p.product_id where p.product_name="S8" and buyer_id not in (select distinct buyer_id from Sales s inner join Product p on s.product_id=p.product_id where p.product_name="iPhone")
select distinct buyer_id from Sales s join Product p on p.product_id=s.product_id where p.product_name='S8' and buyer_id not in ( select buyer_id from Sales s join Product p on p.product_id=s.product_id where product_name = 'iPhone')
select distinct buyer_id from Sales s join Product p on s.product_id = p.product_id group by buyer_id having sum(p.product_name='S8') > 0 and sum(p.product_name = 'iPhone') = 0
select distinct buyer_id from Sales s join Product p using (product_id) where p.product_name = 'S8' and buyer_id not in (select buyer_id from Sales s join Product p using (product_id) where p.product_name = 'iPhone')
select distinct buyer_id from Sales s join product p using(product_id) where buyer_id not in (select buyer_id from sales ss join product pp using(product_id) where product_name ='iphone') and product_name ='s8'
select distinct buyer_id from Sales s left join product p on p.product_id = s.product_id where product_name = "S8" and buyer_id not in (select distinct buyer_id from Sales s left join product p on p.product_id = s.product_id where product_name = "iPhone")
select distinct buyer_id from Sales where (buyer_id in (select distinct buyer_id from Sales s join Product p on s.product_id = p.product_id where p.product_name = "S8")) and (buyer_id not in (select distinct buyer_id from Sales s2 join Product p2 on s2.product_id = p2.product_id where p2.product_name = "iPhone"))
select distinct buyer_id from Sales where buyer_id in ( select a.buyer_id from Sales as a inner join Product as b on a.product_id=b.product_id where b.product_name = "S8") and buyer_id not in (select a.buyer_id from Sales as a inner join Product as b on a.product_id=b.product_id where b.product_name = "iPhone")
select distinct buyer_id from Sales where buyer_id in ( select buyer_id from Sales left join Product on Sales.product_id=Product.product_id where product_name = "S8") and buyer_id not in (select buyer_id from Sales left join Product on Sales.product_id=Product.product_id where product_name = "iPhone")
select distinct buyer_id from Sales where buyer_id in ( select buyer_id from Sales where product_id = ( select product_id from Product where product_name = 'S8')) and buyer_id not in ( select buyer_id from Sales where product_id = ( select product_id from Product where product_name = 'iphone'))
select distinct buyer_id from Sales where buyer_id in (select distinct buyer_id from Sales s inner join Product p on s.product_id = p.product_id where p.product_name ='S8' ) and buyer_id not in (select distinct buyer_id from Sales s inner join Product p on s.product_id = p.product_id where p.product_name ='iPhone')
select distinct buyer_id from Sales where buyer_id in (select s.buyer_id from Sales s join Product p using (product_id) where p.product_name = 'S8') and buyer_id not in (select s.buyer_id from Sales s join Product p using (product_id) where p.product_name = 'iPhone')
select distinct buyer_id from Sales where buyer_id not in (select buyer_id from Sales s join Product p on s.product_id= p.product_id where p.product_name = 'iPhone') and buyer_id in (select buyer_id from Sales s join Product p on s.product_id= p.product_id where p.product_name = 'S8')
select distinct buyer_id from Sales where product_id in (select product_id from Product where product_name = 'S8') and buyer_id not in ( select distinct buyer_id from Sales where product_id in (select product_id from Product where product_name = 'iPhone') )
select distinct buyer_id from Sales where product_id in (select product_id from Product where product_name = 'S8') and buyer_id not in (select buyer_id from Sales where product_id in (select product_id from Product where product_name = 'Iphone')) order by 1
select distinct buyer_id from Sales where product_id in (select product_id from Product where product_name = 'S8') and buyer_id not in (select buyer_id from Sales where product_id in (select product_id from Product where product_name = 'iPhone'))
select distinct buyer_id from Sales where product_id in (select product_id from Product where product_name = 'S8') and buyer_id not in (select buyer_id from sales s join product p on s.product_id = p.product_id and p.product_name = 'iPhone' )
select distinct buyer_id from product a join sales b on a.product_id = b.product_id where product_name = 'S8' and buyer_id not in (select distinct buyer_id from product a join sales b on a.product_id = b.product_id where product_name = 'iphone')
select distinct buyer_id from product join sales using (product_id) where product_name ='S8' and buyer_id not in ( select buyer_id from product join sales using (product_id) where product_name ='iphone')
select distinct buyer_id from product p join Sales s on p.product_id = s.product_id where product_name = 'S8' and buyer_id not in (select buyer_id from sales s join product p on s.product_id = p.product_id where product_name = 'iPhone')
select distinct buyer_id from product p join sales s on p.product_id = s.product_id where product_name = 'S8' and buyer_id not in (select buyer_id from product p join sales s on p.product_id = s.product_id where product_name = 'iPhone')
select distinct buyer_id from product p join sales s on s.product_id=p.product_id group by 1 having sum(product_name='S8') > 0 and sum(product_name='iPhone') = 0
select distinct buyer_id from product p join sales s using (product_id) where product_name = 'S8' and buyer_id not in (select distinct buyer_id from product p join sales s using (product_id) where product_name = 'iPhone')
select distinct buyer_id from sales as s inner join product as p on s.product_id = p.product_id where p.product_name= 'S8' and buyer_id not in (select s.buyer_id from sales as s inner join product as p on s.product_id = p.product_id where p.product_name = 'iPhone ')
select distinct buyer_id from sales join product on sales.product_id = product.product_id where product_name = 'S8' and buyer_id not in (select buyer_id from sales join product on sales.product_id = product.product_id where product_name = 'iPhone' )
select distinct buyer_id from sales join product on sales.product_id = product.product_id where product_name = 'S8' and buyer_id not in (select buyer_id from sales join product using(product_id) where product_name = 'iPhone' )
select distinct buyer_id from sales join product using (product_id) where buyer_id not in (select distinct buyer_id from sales a join product b on a.product_id = b.product_id where b.product_name = 'iPhone') and product_name = 'S8'
select distinct buyer_id from sales join product using(product_id) where product_name = "S8" and buyer_id not in (select distinct buyer_id from sales join product using(product_id) where product_name = "iPhone" )
select distinct buyer_id from sales join product using(product_id) where product_name = 'S8' and buyer_id not in (select buyer_id from sales join product using(product_id) where product_name = 'iPhone' )
select distinct buyer_id from sales join product using(product_id) where product_name = 'S8' and buyer_id not in (select distinct buyer_id from sales join product using(product_id) where product_name = 'iPhone' )
select distinct buyer_id from sales join product using(product_id) where product_name="S8" and buyer_id not in (select buyer_id from sales join product using(product_id) where product_name="iPhone")
select distinct buyer_id from sales left join product on sales.product_id= product.product_id where product.product_name ='S8' and buyer_id not in (select buyer_id from sales left join product on sales.product_id=product.product_id where product.product_name = 'iphone')
select distinct buyer_id from sales left join product on sales.product_id=product.product_id where product_name ='S8' and buyer_id not in (select buyer_id from sales left join product on sales.product_id=product.product_id where product_name ='iPhone')
select distinct buyer_id from sales s inner join product p on s.product_id = p.product_id where s.buyer_id not in (select buyer_id from sales s inner join product p on s.product_id = p.product_id where p.product_name = 'iPhone') and p.product_name = 'S8'
select distinct buyer_id from sales s join product p on s.product_id = p.product_id group by buyer_id having sum(case when p.product_name = 'S8' then 1 else 0 end) >= 1 and sum(case when p.product_name = 'iPhone' then 1 else 0 end) = 0
select distinct buyer_id from sales s join product p on s.product_id = p.product_id where (buyer_id) not in( select distinct buyer_id from sales s join product p on s.product_id = p.product_id where p.product_name = 'iPhone') and p.product_name = 'S8'
select distinct buyer_id from sales s join product p on s.product_id = p.product_id where product_name = 'S8' AND buyer_id NOT IN (select distinct buyer_id from sales s join product p on s.product_id = p.product_id where product_name = 'iPhone')
select distinct buyer_id from sales s join product p on s.product_id=p.product_id where p.product_name='S8' and buyer_id not in ( select distinct buyer_id from sales s join product p on s.product_id=p.product_id where p.product_name='iPhone')
select distinct buyer_id from sales s join product p on s.product_id=p.product_id where product_name="S8" and buyer_id not in(select buyer_id from sales s join product p on s.product_id=p.product_id where product_name="iPhone")
select distinct buyer_id from sales s join product p using(product_id) where product_name="s8" and buyer_id not in ( select buyer_id from sales s join product p using (product_id) where product_name="iPhone" )
select distinct buyer_id from sales s left join product p on p.product_id = s.product_id where p.product_name = 'S8' and buyer_id not in (select buyer_id from sales s left join product p on p.product_id = s.product_id where p.product_name = 'iPhone')
select distinct buyer_id from sales s left join product p on p.product_id = s.product_id where product_name = 'S8' and buyer_id not in ( select buyer_id from sales s left join product p on p.product_id = s.product_id where product_name = 'iPhone')
select distinct buyer_id from sales s left join product p on s.product_id = p.product_id where product_name = 'S8' AND buyer_id not in (select buyer_id from sales s left join product p on s.product_id = p.product_id where product_name = 'iPhone')
select distinct buyer_id from sales s left join product p on s.product_id = p.product_id where product_name = 'S8' and buyer_id not in (select buyer_id from sales s left join product p on s.product_id = p.product_id where product_name = 'iphone')
select distinct buyer_id from sales s, product p where s.product_id=p.product_id and product_name='S8' and buyer_id not in ( select buyer_id from sales s, product p where s.product_id=p.product_id and product_name='iPhone' )
select distinct buyer_id from sales where buyer_id in (select buyer_id from sales join product on sales.product_id = product.product_id where product_name = "S8") and buyer_id not in (select buyer_id from sales join product on sales.product_id = product.product_id where product_name = "iPhone")
select distinct buyer_id from sales where buyer_id in (select buyer_id from sales s join product p using(product_id) where product_name='S8') and buyer_id not in (select buyer_id from sales s join product p using(product_id) where product_name='iphone')
select distinct buyer_id from sales where buyer_id in (select buyer_id from sales where product_id = (select product_id from product where product_name = 'S8')) and buyer_id not in (select buyer_id from sales where product_id = (select product_id from product where product_name = 'iPhone'))
select distinct buyer_id from sales where buyer_id in (select s.buyer_id from sales s join product p on s.product_id = p.product_ID where p.product_name = 'S8') and buyer_id not in (select s.buyer_id from sales s join product p on s.product_id = p.product_ID where p.product_name = 'iphone')
select distinct buyer_id from sales where buyer_id not in (select buyer_id from sales s left join product p on s.product_id=p.product_id where product_name="iphone") and buyer_id in (select buyer_id from sales s left join product p on s.product_id=p.product_id where product_name="S8")
select distinct buyer_id from sales where buyer_id not in(select s.buyer_id from sales s left join product p on s.product_id = p.product_id where p.product_name = 'iPhone') and buyer_id in(select s.buyer_id from sales s left join product p on s.product_id = p.product_id where p.product_name = 'S8')
select distinct buyer_id from sales where product_id = (select product_id from product where product_name = 'S8') and buyer_id not in (select buyer_id from sales where product_id in (select product_id from product where product_name = 'iPhone'))
select distinct buyer_id from sales where product_id in ( select product_id from product where product_name='S8' ) and buyer_id not in ( select buyer_id from sales s join product p on s.product_id = p.product_id and p.product_name = 'iPhone' )
select distinct buyer_id from sales where product_id in (select product_id from Product where product_name = 'S8') and buyer_id not in (select buyer_id from Sales where product_id in (select product_id from Product where product_name = 'iPhone'))
select distinct buyer_id from sales where product_id in (select product_id from product where product_name = 'S8') and buyer_id not in (select buyer_id from sales where product_id in (Select product_Id from product where product_name = 'iphone'))
select distinct buyer_id from sales where product_id in (select product_id from product where product_name = 'S8') and buyer_id not in (select buyer_id from sales where product_id in (select product_id from product where product_name = 'iPhone'))
select distinct buyer_id from sales where product_id in (select product_id from product where product_name in ('S8')) and buyer_id not in (select buyer_id from sales where product_id in (select product_id from product where product_name in ('iPhone', 'G4')))
select distinct c.buyer_id from Sales c left join Product g on c.product_id = g.product_id left join (select buyer_id from Sales a left join Product b on a.product_id = b.product_id where product_name = 'iPhone')d on c.buyer_id = d.buyer_id where d.buyer_id is null and g.product_name = 'S8'
select distinct c.buyer_id from Sales c left join Product g on c.product_id = g.product_id left join (select buyer_id, product_name from Sales a left join Product b on a.product_id = b.product_id where product_name = 'iPhone')d on c.buyer_id = d.buyer_id where d.product_name is null and g.product_name = 'S8'
select distinct s.buyer_id from (select s.product_id,product_name,buyer_id from Sales s join Product p using(product_id) where product_name = 'S8') s left join (select s.product_id,product_name,buyer_id from Sales s join Product p using(product_id) where product_name = 'iPhone') i using(buyer_id) where i.buyer_id is null
select distinct s.buyer_id from Product p inner join Sales s on p.product_id = s.product_id where p.product_name = 'S8' and s.buyer_id not in ( select s.buyer_id from Product p inner join Sales s on p.product_id = s.product_id where p.product_name = 'iPhone' )
select distinct s.buyer_id from Product p join Sales s on p.product_id = s.product_id where product_name = 'S8' and s.buyer_id not in ( select distinct s.buyer_id from Product p join Sales s on p.product_id = s.product_id where product_name = 'iPhone' )
select distinct s.buyer_id from Product p left join Sales s on p.product_id = s.product_id where product_name = 'S8' and s.buyer_id not in (select distinct s.buyer_id from Product p left join Sales s on p.product_id = s.product_id where product_name = 'iPhone')
select distinct s.buyer_id from Product p, Sales s where p.product_name = 'S8' and p.product_id = s.product_id and s.buyer_id not in (select distinct s1.buyer_id from Product p1, Sales s1 where p1.product_id = s1.product_id and p1.product_name = 'iPhone')
select distinct s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id where (p.product_name = "S8") and ( s.buyer_id not in ( select s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id where p.product_name = "iPhone" ) )
select distinct s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id where p.product_name = "S8" and s.buyer_id not in (select s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id where p.product_name = "iPhone")
select distinct s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id where p.product_name = 'S8' and s.buyer_id not in ( select s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id where p.product_name = "iphone")
select distinct s.buyer_id from Sales s join Product p on s.product_id = p.product_id group by s.buyer_id having sum(case when p.product_name = 'S8' then 1 else 0 end) > 0 and sum(case when p.product_name = 'iPhone' then 1 else 0 end) = 0
select distinct s.buyer_id from Sales s join Product p on s.product_id = p.product_id group by s.buyer_id having sum(product_name='S8')>0 and sum(product_name='iPhone') = 0
select distinct s.buyer_id from Sales s join Product p on s.product_id = p.product_id where p.product_name = "S8" and s.buyer_id not in (select distinct s.buyer_id from Sales s join Product p on s.product_id = p.product_id where p.product_name = "iPhone")
select distinct s.buyer_id from Sales s join Product p on s.product_id = p.product_id where product_name in ('S8') and s.buyer_id not in (select distinct s.buyer_id from Sales s join Product p on s.product_id = p.product_id where product_name in ('iPhone'))
select distinct s.buyer_id from Sales s join Product p using (product_id) where p.product_name = 'S8' and s.buyer_id not in ( select distinct s.buyer_id from Sales s join Product p using (product_id) where p.product_name = 'iPhone')
select distinct s.buyer_id from Sales s left join Product p on s.product_id = p.product_id where p.product_name = 'S8' and buyer_id not in (select s.buyer_id from Sales s left join Product p on s.product_id = p.product_id where p.product_name = 'iPhone' )
select distinct s.buyer_id from Sales s left join Product p on s.product_id = p.product_id where p.product_name = 'S8' and s.buyer_id not in (select s1.buyer_id from Sales s1 join Product p1 on p1.product_id = s1.product_id and p1.product_name = 'iPhone')
select distinct s.buyer_id from product p left join sales s on p.product_id = s.product_id where p.product_name = 'S8' and s.buyer_id not in (select s.buyer_id from product p left join sales s on p.product_id = s.product_id where p.product_name = 'iPhone')
select distinct s.buyer_id from sales as s , product as p where s.product_id = p.product_id AND p.product_name = 'S8' and s.buyer_id not in ( select s.buyer_id from sales as s , product as p where s.product_id = p.product_id AND p.product_name = 'iPhone' )
select distinct s.buyer_id from sales s inner join product p on s.product_id = p.product_id where p.product_name = "S8" and s.buyer_id not in (select buyer_id from sales s inner join product p on s.product_id = p.product_id where p.product_name = "iPhone")
select distinct s.buyer_id from sales s inner join product p on s.product_id = p.product_id where p.product_name = 'S8' and buyer_id not in ( select distinct s.buyer_id from sales s inner join product p on s.product_id = p.product_id where p.product_name = 'iPhone' group by s.buyer_id )
select distinct s.buyer_id from sales s join product p on p.product_id = s.product_id where buyer_id in (select s.buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name ='S8' ) and buyer_id not in (select s.buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name ='iPhone' )
select distinct s.buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name = 'S8' and s.buyer_id not in (select distinct s.buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name = 'iPhone') order by s.buyer_id
select distinct s.buyer_id from sales s join product p on s.Product_id =p.product_id where p.product_name='S8' and s.buyer_id not in (select distinct buyer_id from sales s join product p on s.Product_id =p.product_id where p.product_name='iphone')
select distinct s.buyer_id from sales s join product p on s.product_id = p.product_id where buyer_id in ( select s.buyer_id from sales s, product p where p.product_id = s.product_id and product_name = 'S8') and buyer_id not in ( select s.buyer_id from sales s, product p where p.product_id = s.product_id and product_name = 'iPhone')
select distinct s.buyer_id from sales s join product p on s.product_id = p.product_id where p.product_name = 'S8' and s.buyer_id not in ( select s.buyer_id from sales s join product p on s.product_id = p.product_id where p.product_name = 'iPhone' )
select distinct s.buyer_id from sales s join product p on s.product_id=p.product_id where s.buyer_id not in (select s.buyer_id buyer_id from sales s join product p on s.product_id=p.product_id where p.product_name='iPhone') and p.product_name='S8'
select distinct s.buyer_id from sales s join product p using(product_id) group by 1 having sum(case when p.product_name = 'S8' then 1 else 0 end) >=1 and sum(case when p.product_name = 'iPhone' then 1 else 0 end) = 0
select distinct s.buyer_id from sales s join product p using(product_id) where p.product_name = 'S8' and s.buyer_id not in (select s.buyer_id from sales s join product p using(product_id) where p.product_name = 'iphone')
select distinct s.buyer_id from sales s left join product p on s.product_id = p.product_id group by s.buyer_id having sum(case when p.product_name ='S8' then 1 else 0 end)>=1 and sum(case when p.product_name= 'iPhone' then 1 else 0 end)=0
select distinct s.buyer_id from sales s where s.product_id = (select product_id from product where product_name = 'S8') and s.buyer_id not in (select distinct buyer_id from sales where product_id = ((select product_id from product where product_name = 'iPhone')))
select distinct s.buyer_id from sales s where s.product_id = (select product_id from product where product_name = 'S8') and s.buyer_id not in (select distinct ss.buyer_id from sales ss, product p where p.product_name = 'iPhone' and p.product_id = ss.product_id )
select distinct s.buyer_id from sales s, product p where s.product_id=p.product_id and p.product_name='S8' and s.buyer_id not in (select buyer_id from sales s, product p where s.product_id=p.product_id and p.product_name='iPhone')
select distinct s1.buyer_id from product p1 left join sales s1 on p1.product_id = s1.product_id where p1.product_name = 'S8' and s1.buyer_id not in ( select distinct s1.buyer_id from product p1 left join sales s1 on p1.product_id = s1.product_id where p1.product_name = 'iPhone' )
select distinct s2.buyer_id from sales s2 join (select buyer_id from sales s join product p on s.product_id = p.product_id where p.product_name = 'S8') x on x.buyer_id = s2.buyer_id where x.buyer_id not in (select a.buyer_id from sales a join product b on a.product_id = b.product_id where b.product_name = 'iPhone')
select distinct t1.buyer_id from (select x.buyer_id from Sales as x where x.buyer_id not in (select s.buyer_id from Sales as s where s.product_id in (select product_id from Product where product_name = 'iPhone'))) as t1 where t1.buyer_id in (select y.buyer_id from Sales as y where y.product_id in (select product_id from Product where product_name = 'S8'))
select distinct(b.buyer_id) from sales b where b.buyer_id in( select b.buyer_id from sales b left join product a on a.product_id=b.product_id where a.product_name='S8') and b.buyer_id not in( select b.buyer_id from sales b left join product a on a.product_id=b.product_id where a.product_name='iPhone')
select distinct(buyer_id) from Sales left join product on sales.product_id = Product.product_id where buyer_id not in ( select buyer_id from Sales left join product on sales.product_id = Product.product_id where product_name ='IPhone') and product_name = 'S8'
select distinct(buyer_id) from Sales s where exists (select * from (select distinct(buyer_id) from Sales join Product using (product_id) where product_name = 'S8') s1 where s1.buyer_id = s.buyer_id) and not exists (select * from (select distinct(buyer_id) from Sales join Product using (product_id) where product_name = 'iPhone') s2 where s2.buyer_id = s.buyer_id)
select distinct(buyer_id) from Sales where buyer_id in (select buyer_id from Sales left join product on sales.product_id = Product.product_id where product_name = 'S8') and buyer_id not in ( select buyer_id from Sales left join product on sales.product_id = Product.product_id where product_name ='IPhone')
select distinct(buyer_id) from Sales where product_id in (select product_id from Product where product_name="S8") and buyer_id not in ( select buyer_id from sales s join product p on s.product_id = p.product_id and p.product_name = 'iPhone' )
select distinct(buyer_id) from Sales where product_id in (select product_id from Product where product_name='S8') and buyer_id not in (select distinct(buyer_id) from Sales where product_id in (select product_id from Product where product_name='iPhone'))
select distinct(buyer_id) from sales join product using (product_id) where product_name ='S8' AND buyer_id not IN ( select buyer_id from sales join product using (product_id) where product_name = 'iPhone')
select distinct(buyer_id) from sales s join product p on s.product_id = p.product_id where p.product_name = "S8" and buyer_id not in (select buyer_id from sales s join product p on s.product_id = p.product_id where p.product_name = "iPhone")
select distinct(buyer_id) from sales where buyer_id in (select s.buyer_id from sales as s join product as p on s.product_id=p.product_id where p.product_name = 'S8') and buyer_id not in (select s.buyer_id from sales as s join product as p on s.product_id=p.product_id where p.product_name = 'iPhone')
select distinct(buyer_id) from sales where product_id in ( select product_id from product where product_name='S8' ) and buyer_id not in ( select buyer_id from sales s join product p on s.product_id = p.product_id and p.product_name = 'iPhone' )
select distinct(buyer_id) from sales where product_id in ( select product_id from product where product_name='S8') and buyer_id not in ( select buyer_id from sales s join product p on s.product_id = p.product_id and p.product_name = 'iPhone' )
select distinct(buyer_id) from sales where product_id in (select product_id from product where product_name ='S8') and buyer_id not in( select buyer_id from sales s join product p on s.product_id = p.product_id where product_name = 'iPhone')
select distinct(s.buyer_id) from sales as s join product as p on s.product_id = p.product_id where p.product_name = 'S8' and s.buyer_id not in (select s.buyer_id from sales as s join product as p on s.product_id = p.product_id where p.product_name = 'iPhone')
select distinct(s.buyer_id) from sales s left join product p on s.product_id = p.product_id where p.product_name = 'S8' and buyer_id not in ( select s.buyer_id from sales s left join product p on s.product_id = p.product_id where p.product_name = 'iPhone' )
select final.buyer_id from (select bothh.buyer_id "buyer_id", bothh.product_name "product_name" from (select S.product_id, P.product_name "product_name", S.buyer_id "buyer_id" from Sales S, Product P where S.product_id = P.product_id and (P.product_name = 'S8' or P.product_name = 'iPhone')) bothh group by bothh.buyer_id having count(distinct bothh.product_name) = 1) final where final.product_name = 'S8'
select s.buyer_id as buyer_id from Sales s left join Product p on s.product_id = p.product_id group by s.buyer_id having sum(p.product_name = 'S8') >0 and sum(p.product_name = 'iPhone') = 0
select s.buyer_id from ( SELECT distinct buyer_id FROM Sales WHERE product_id IN (SELECT product_id from product where product_name = 'S8') ) s left outer join ( SELECT distinct buyer_id FROM Sales WHERE product_id IN (SELECT product_id from product where product_name = 'iPhone') ) i on s.buyer_id = i.buyer_id where i.buyer_id is null
select s.buyer_id from Product as p left join Sales as s using(product_id) group by 1 having sum(case when product_name = "S8" then 1 else 0 end) > 0 and sum(case when product_name = "iphone" then 1 else 0 end) = 0
select s.buyer_id from Product p inner join Sales s on p.product_id = s.product_id group by s.buyer_id having sum(p.product_name = 'S8') > 0 and sum(p.product_name = 'iPhone') = 0
select s.buyer_id from Product p join Sales s on p.product_id=s.product_id group by buyer_id having sum(p.product_name='S8') > 0 and sum(p.product_name = 'iPhone') = 0
select s.buyer_id from Sales as s join Product as p on s.product_id = p.product_id group by s.buyer_id having sum(if(p.product_name='S8',1,0))>0 and sum(if(p.product_name='iPhone',1,0))=0
select s.buyer_id from Sales s JOIN Product p ON s.product_id = p.product_id group by s.buyer_id Having SUM(CASE WHEN p.product_name= 'S8' THEN 1 ELSE 0 END) >= 1 and SUM(p.product_name = 'iPhone') = 0
select s.buyer_id from Sales s JOIN Product p ON s.product_id = p.product_id group by s.buyer_id Having SUM(p.product_name= 'S8') >= 1 and SUM(p.product_name = 'iPhone') = 0
select s.buyer_id from Sales s inner join Product p on s.product_id = p.product_id group by buyer_id having sum(product_name = 'iphone') = 0 and sum(product_name = 'S8') > 0
select s.buyer_id from Sales s join Product p on s.product_id = p.product_id group by s.buyer_id having sum(p.product_name = 'S8') > 0 and sum(p.product_name = 'iPhone') = 0
select s.buyer_id from Sales s join Product p using(product_id) group by buyer_id having sum(case when p.product_name = 'iPhone' then 1 else 0 end) = 0 and sum(case when p.product_name = 'S8' then 1 else 0 end) > 0
select s.buyer_id from Sales s left join Product p on s.product_id = p.product_id group by s.buyer_id having (max(case when p.product_name = 'S8' then 1 else 0 end) + min(case when p.product_name = 'iPhone' then -1 else 0 end)) = 1
select s.buyer_id from Sales s left join Product p on s.product_id=p.product_id group by buyer_id having count(case product_name when 'S8' then 1 else null end)>=1 and count(case product_name when 'iPhone' then 1 else null end) =0
select s.buyer_id from product p join sales s on p.product_id = s.product_id group by s.buyer_id having sum(case when p.product_name = 'S8' then 1 else 0 end) > 0 and sum(case when p.product_name = 'iPhone' then 1 else 0 end) = 0
select s.buyer_id from sales as s join product as p on s.product_id=p.product_id group by buyer_id having sum(p.product_name="S8")>0 and sum(p.product_name="iPhone")=0
select s.buyer_id from sales s join product p on p.product_id = s.product_id group by s.buyer_id having sum(case when p.product_name="S8" then 1 else 0 end) > 0 and sum(case when p.product_name="iPhone" then 1 else 0 end) = 0
select s.buyer_id from sales s join product p on p.product_id=s.product_id group by s.buyer_id having sum(p.product_name = 'S8') > 0 and sum(p.product_name = 'iPhone') = 0
select s.buyer_id from sales s join product p on s.product_id=p.product_id group by 1 having sum(case when p.product_name = 'S8' then 1 else 0 end)>0 and sum(case when p.product_name = 'iPhone' then 1 else 0 end)=0
select s.buyer_id from sales s join product p on s.product_id=p.product_id group by s.buyer_id having sum(p.product_name='S8')>0 and sum(p.product_name='iPhone')=0
select s.buyer_id from sales s join product p on s.product_id=p.product_id where p.product_name='S8' and s.buyer_id not in (select s.buyer_id from sales s join product p on s.product_id=p.product_id where p.product_name='iphone') group by s.buyer_id
select t.buyer_id from( select buyer_id,case when product_name = 'S8' then 1 else 0 end as S8_label, case when product_name ='iPhone' then 1 else 0 end as iPhone_label from sales a left join product b on a.product_id = b.product_id group by buyer_id having sum(S8_label) > 0 and sum(iPhone_label)=0) t
select t1.buyer_id from Sales t1 inner join Product t2 on t1.product_id = t2.product_id group by t1.buyer_id having( sum(case when t2.product_name = 'S8' then 1 else 0 end )>0 and sum(case when t2.product_name = 'iPhone' then 1 else 0 end )=0 )
with A as (select distinct buyer_id from Sales s left join product p on p.product_id = s.product_id where product_name = "iPhone") select distinct buyer_id from Sales s left join product p on p.product_id = s.product_id where product_name = "S8" and buyer_id not in (select * from A)
with CTE1 as (select buyer_id from sales where product_id = (select product_id from product where product_name = 's8')), CTE2 as (select buyer_id from sales where product_id = (select product_id from product where product_name = 'iPhone')) select distinct buyer_id from CTE1 where buyer_id not in (select buyer_id from CTE2)
with S as ( select buyer_id from Sales where product_id in (select product_id from Product where product_name='S8') ), I as ( select buyer_id from Sales where product_id in (select product_id from Product where product_name='iPhone') ) select distinct buyer_id from Sales where buyer_id in (select buyer_id from S) and buyer_id not in (select buyer_id from I)
with S8 AS (SELECT DISTINCT buyer_id FROM Sales S JOIN Product P ON S.product_id=P.product_id WHERE product_name='S8') SELECT DISTINCT buyer_id FROM Sales S JOIN Product P ON S.product_id=P.product_id WHERE product_name='S8' AND buyer_id NOT in (SELECT DISTINCT buyer_id FROM Sales S JOIN Product P ON S.product_id=P.product_id WHERE product_name='iphone')
with S8Buyers as ( select distinct buyer_id from Product p JOIN Sales s ON p.product_id = s.product_id where p.product_name = 'S8' ), iPhoneBuyers as ( select distinct buyer_id from Product p JOIN Sales s ON p.product_id = s.product_id where p.product_name = 'iPhone' ) select * from S8Buyers where buyer_id NOT IN (select buyer_id from iPhoneBuyers)
with S8_buyers as ( select buyer_id from Sales where product_id = (select product_id from Product p where product_name = 'S8') ), iPhone_buyers as ( select buyer_id from Sales where product_id = (select product_id from Product p where product_name='iPhone') ) select distinct s.buyer_id from Sales s where s.buyer_id IN (select A.buyer_id from S8_buyers A) and s.buyer_id NOT IN (select B.buyer_id from iPhone_buyers B)
with a as (select * from Sales left join Product using(product_id)) select distinct buyer_id from a where product_name="S8" and buyer_id not in (select buyer_id from a where product_name="iPhone")
with base as ( select s.buyer_id , case when product_name ='S8' then 1 else 0 end as S8, case when product_name ='iPhone' then 1 else 0 end as iPhone from Sales s inner join Product p on p.product_id = s.product_id ) select buyer_id from base group by buyer_id having sum(S8) >0 and sum(iPhone)=0
with bought_s8 as (select distinct buyer_id, product_id from sales where product_id in (select product_id from product where product_name = 'S8')) select buyer_id from bought_s8 where buyer_id not in (select buyer_id from Sales where product_id in (select product_id from product where product_name='iPhone'))
with buyers as ( select s.*, p.product_name from Sales s join Product p on s.product_id = p.product_id where p.product_name in ('s8','iPhone') ) select distinct buyer_id from buyers where product_name = 's8' group by buyer_id having buyer_id not in (select buyer_id from buyers group by buyer_id having count(distinct product_name) = 2)
with c as( select a.buyer_id,product_name from Sales a left join Product b on a.product_id=b.product_id ) select distinct buyer_id from c where product_name = 'S8' and buyer_id not in (select buyer_id from c where product_name ='iPhone')
with c1 as ( select distinct buyer_id from sales where product_id=(select product_id from product where product_name ='S8') ), c2 as ( select distinct buyer_id from sales where product_id=(select product_id from product where product_name ='iPhone') ) select buyer_id from c1 where buyer_id not in (select buyer_id from c2)
with comProSal as (Select buyer_id, s.product_id, p.product_name From Sales s Left join Product p On s.product_id = p.product_id) Select distinct buyer_id From comProSal Where product_name="S8" and buyer_id not in (Select buyer_id From comProSal Where product_name="iPhone") Order by buyer_id
with cte as ( select * from Sales where buyer_id not in ( select buyer_id from Sales join product on sales.product_id = product.product_id where product_name = 'iPhone' ) ) select distinct buyer_id from cte join product on cte.product_id = product.product_id where product_name = 'S8'
with cte as ( select a.seller_id, a.product_id, b.product_name, b.unit_price, a.buyer_id, a.sale_date, a.quantity, a.price from sales a join product b on a.product_id = b.product_id ) select distinct buyer_id from cte where buyer_id in (select buyer_id from cte where product_name = 'S8') and buyer_id not in (select buyer_id from cte where product_name = 'iPhone')
with cte as ( select buyer_id, product_name from Product p join Sales s using(product_id) where product_name ='S8' or product_name='iPhone' ) select distinct buyer_id from cte where buyer_id not in(select buyer_id from cte where product_name='iPhone') and product_name='S8'
with cte as ( select buyer_id, product_name from sales s left join product p on s.product_id = p.product_id) select distinct buyer_id from cte where product_name = 'S8' and buyer_id not in (select buyer_id from cte where product_name = 'iPhone')
with cte as ( select distinct buyer_id from sales where product_id=( select product_id from product where product_name='S8' ) ), demo as ( select distinct buyer_id from sales where product_id=( select product_id from product where product_name='iPhone' ) ) select cte.buyer_id from cte left join demo on cte.buyer_id=demo.buyer_id where demo.buyer_id is null
with cte as ( select distinct(buyer_id) from sales s left join product p on s.product_id = p.product_id where p.product_name = 'iPhone' ) select distinct(buyer_id) as buyer_id from sales s left join product p on s.product_id = p.product_id where p.product_name = 'S8' and buyer_id not in (select buyer_id from cte)
with cte as ( select distinct(buyer_id), product_name from Sales s join Product p on s.product_id = p.product_id ) select buyer_id from cte where product_name = 'S8' and buyer_id not in (select buyer_id from cte where product_name = 'IPhone')
with cte as ( select s.buyer_id, product_name from Sales s join product p on s.product_id=p.product_id ) select distinct buyer_id from cte where product_name ='S8' and buyer_id not in (select buyer_id from cte where product_name='iPhone')
with cte as ( select s.seller_id, s.buyer_id, p.product_name, p.product_id from sales s inner join product p on s.product_id = p.product_id where p.product_name in ('S8','iPhone') ) select distinct buyer_id from cte where product_name = 'S8' and buyer_id not in (select buyer_id from cte where product_name = 'iPhone ')
with cte as (Select distinct buyer_id from sales s join product p on s.product_id = p.product_id where product_name = 'iPhone') Select distinct buyer_id from sales s join product p on s.product_id = p.product_id where product_name = 'S8' and buyer_id not in (Select buyer_id from cte)
with cte as (Select s.*, p.product_name From Sales as s Join Product as p on s.product_id = p.product_id) Select distinct buyer_id from cte where product_name = 'S8' and buyer_id not in (Select buyer_id From cte where product_name = 'iPhone')
with cte as( select buyer_id, product_name from Sales s JOIN Product p USING(product_id) ), cte2 as( select buyer_id, sum(case when product_name = 'S8' then 1 else 0 end) as 'S8_flag', sum(case when product_name = 'iPhone' then 1 else 0 end) as 'ip_flag' from cte group by buyer_id having S8_flag>= 1 and ip_flag = 0) select buyer_id from cte2
with cte as( select buyer_id, sum(case when product_name = 'S8' then 1 else 0 end) as 'S8', sum(case when product_name = 'iPhone' then 1 else 0 end) as 'iPhone' from Product inner join sales on sales.product_id = product.product_id group by buyer_id ) select buyer_id from cte where S8 > 0 and iPhone = 0
with cte as( select s.*, case when p.product_name='s8' then 0 when p.product_name='iphone' then 1 else null end as n_id from Sales as s join Product as p on s.product_id=p.product_id) select distinct buyer_id from cte where n_id is not null group by buyer_id having sum(n_id)=0
with cte as( select s.buyer_id, s.product_id, p.product_name from Sales s left join Product p on s.product_id = p.product_id ) select distinct buyer_id from cte where product_name = 'S8' and buyer_id not in (select buyer_id from cte where product_name = 'iPhone')
with cte1 as ( Select s.buyer_id,p.product_name from Sales s inner join Product p on s.product_id = p.product_id where product_name = 'S8' ), cte2 as ( Select s.buyer_id as 'other',p.product_name from Sales s inner join Product p on s.product_id = p.product_id where product_name = 'Iphone' ) Select buyer_id from cte1 c1 left join cte2 c2 on c1.buyer_id = c2.other where other is null group by buyer_id
with cte1 as ( select buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name = 'S8'), cte2 as ( select buyer_id from sales s join product p on p.product_id = s.product_id where p.product_name = 'iPhone' ) select distinct buyer_id from cte1 where buyer_id NOT IN (select buyer_id from cte2) order by buyer_id
with cte1 as ( select distinct s.buyer_id from sales s left join Product p on p.product_id = s.product_id where p.product_name = "s8" ) , cte2 as ( Select distinct s1.buyer_id from sales s1 left join Product p on p.product_id = s1.product_id where p.product_name = "iphone" ) select distinct c1.buyer_id from cte1 c1 where c1.buyer_id not in (select c2.* from cte2 c2)
with cte1 as ( select s.buyer_id as boughts8 from Sales s where s.product_id = (select p.product_id from Product p where p.product_name = 'S8') ), cte2 as ( select s.buyer_id as boughtiphone from Sales s where s.product_id = (select p.product_id from Product p where p.product_name = 'iPhone') ) select distinct s.buyer_id from Sales s where s.buyer_id in (select boughts8 from cte1) and s.buyer_id not in (select boughtiphone from cte2)
with draft as ( select s.buyer_id, s.product_id, p.product_name from Sales as s inner join Product as p on s.product_id = p.product_id) select distinct buyer_id from draft where product_name = 'S8' and buyer_id not in (select buyer_id from draft where product_name = 'iPhone')
with iPhone_buyer as ( select distinct A.buyer_id from Sales as A left join Product as B on A.product_id=B.product_id where product_name = 'iPhone' ), s8_buyer as ( select distinct A.buyer_id from Sales as A left join Product as B on A.product_id=B.product_id where product_name = 'S8') select buyer_id from s8_buyer where buyer_id not in (select * from iPhone_buyer)
with iphonebuyer as (select distinct buyer_id from Sales where product_id in (select product_id from product where product_name = 'iPhone') ) select distinct buyer_id from Sales where product_id in (select product_id from product where product_name = 'S8') and buyer_id not in (select buyer_id from iphonebuyer) order by 1
with iphonebuyers as ( select buyer_id from sales a, product b where a.product_id = b.product_id and b.product_name = 'iPhone' ), s8buyers as ( select buyer_id from sales a, product b where a.product_id = b.product_id and b.product_name = 'S8' ) select distinct a.buyer_id from sales a,s8buyers i where a.buyer_id = i.buyer_id and a.buyer_id not in (select buyer_id from iphonebuyers)
with k as( select buyer_id, product_name from sales left join product on sales.product_id=product.product_id), a as( select distinct buyer_id from k where product_name='iPhone'), b as( select distinct buyer_id from k where product_name='S8') select * from b where buyer_id not in (select * from a)
with prod_sale (buyer_id,product_name ) as ( select buyer_id,product_name from Sales a left join Product b on a.product_id=b.product_id ) select buyer_id from prod_sale group by buyer_id having sum(product_name='S8')>0 and sum(product_name='iPhone')=0
with prodsales as( select prod.product_id ,prod.product_name ,buyer_id from Product prod join Sales sales on prod.product_id = sales.product_id ) select distinct buyer_id from prodsales where product_name = 'S8' and buyer_id not in ( select buyer_id from prodsales where product_name = 'iPhone' )
with refined_product as ( Select product_id, product_name, case when product_name = 'S8' then 1 else 0 end s8_sale, case when product_name ='iPhone' then 1 else 0 end iphone_sale from Product where product_name in ('S8', 'iPhone') ) select buyer_id from sales join refined_product using (product_id) group by 1 having sum(iphone_sale)=0 and sum(s8_sale)>0
with s as ( select buyer_id, sum(case when product_name = 'S8' then 1 else 0 end) as s8_cnt, sum(case when product_name = 'iPhone' then 1 else 0 end) as iphone_cnt from Sales inner join Product on Sales.product_id = Product.product_id group by 1 ) select buyer_id from s where s8_cnt > 0 and iphone_cnt = 0
with s8 as ( select buyer_id from Sales inner join Product on Sales.product_id = Product.product_id where product_name = 'S8' ), iphone as ( select buyer_id from Sales inner join Product on Sales.product_id = Product.product_id where product_name = 'iPhone' ) select distinct s8.buyer_id from s8 left join iphone on s8.buyer_id = iphone.buyer_id where iphone.buyer_id is null
with s8 as ( select buyer_id from sales s left join product p on s.product_id = p.product_id where product_name = 'S8'), iphone as ( select buyer_id from sales s left join product p on s.product_id = p.product_id where product_name = 'iPhone') select distinct buyer_id from s8 where buyer_id not in (select * from iphone)
with s8 as ( select distinct(sales.buyer_id) buyer from sales join product on sales.product_id = product.product_id where product_name = 'S8' ), iphone as( select distinct(sales.buyer_id) buyer from sales join product on sales.product_id = product.product_id where product_name = 'iPhone' ) select distinct(buyer_id) from sales where buyer_id in (select * from s8) and buyer_id not in (select * from iphone)
with s8_id as (select product_id from product where product_name = 's8'), iphone_id as (select product_id from product where product_name = 'iphone') select buyer_id from sales as s, s8_id as s8, iphone_id as ip group by buyer_id having sum(if(s.product_id = s8.product_id, 1, 0)) > 0 and sum(if(s.product_id = ip.product_id, 1, 0)) = 0
with sa as (select distinct s.buyer_id, p.product_name from Sales s join Product p on s.product_id = p.product_id where p.product_name in ('S8', 'iPhone')) select buyer_id from sa where buyer_id not in (select distinct buyer_id from sa where product_name = 'iPhone')
with sales_list as ( select s.product_id,s.buyer_id,p.product_name from Sales s left join Product p on s.product_id=p.product_id) select distinct buyer_id from sales_list where buyer_id in (select buyer_id from sales_list where product_name='S8' ) and buyer_id not in (select buyer_id from sales_list where product_name='iPhone')
with sales_with_product as (select a.buyer_id, a.product_id, b.product_name from Sales a join Product b on a.product_id = b.product_id) select buyer_id from Sales where buyer_id in (select buyer_id from sales_with_product where product_name = 'S8') and buyer_id not in (select buyer_id from sales_with_product where product_name = 'iPhone') group by buyer_id
with sales_with_product_name as( select s.buyer_id,s.product_id,p.product_name from sales s join product p on s.product_id=p.product_id) select distinct(buyer_id) from sales_with_product_name where buyer_id not in (select buyer_id from sales_with_product_name where product_name='iPhone') and buyer_id in (select buyer_id from sales_with_product_name where product_name='S8')
with t as ( select buyer_id, case when product_name = 'S8' then 1 else 0 end as s8_flag, case when product_name = 'iPhone' then 1 else 0 end as iphone_flag from sales s join product p on s.product_id = p.product_id ) select buyer_id from t group by buyer_id having sum(s8_flag) > 0 and sum(iphone_flag) =0
with t as ( select s.buyer_id,p.product_name from sales s left join product p on s.product_id = p.product_id ) select buyer_id from t group by buyer_id having buyer_id in (select buyer_id from t where product_name = "S8") and buyer_id not in (select buyer_id from t where product_name = "iPhone")
with t as (select s.*, p.product_name from sales s join product p on s.product_id = p.product_id) select distinct buyer_id from t where product_name ='S8' and buyer_id not in (select buyer_id from t where product_name='Iphone')
with t1 as ( select buyer_id from Sales as s left join Product as p using(product_id) where product_name = 'S8' ), t2 as ( select buyer_id from Sales as s left join Product as p using(product_id) where product_name = 'iPhone' ) select distinct buyer_id from t1 where buyer_id not in (select buyer_id from t2)
with tb as ( select S.*, P.product_name from Sales S left join Product P on S.product_id = P.product_id) Select distinct buyer_id from tb where tb.product_name = "S8" AND buyer_id not in ( Select buyer_id from tb where tb.product_name = 'iPhone' )
with tcte as ( select p.product_name, s.buyer_id from Sales s join Product p on p.product_id = s.product_id where p.product_name in ('S8','iPhone') ) select distinct buyer_id from tcte where product_name = 'S8' and buyer_id not in (select buyer_id from tcte where product_name = 'iPhone')
with temp as ( select * from Product natural join Sales) select distinct buyer_id from temp where product_name='S8' and buyer_id not in( select distinct buyer_id from temp where product_name='iPhone')
with temp as ( select * from Sales left join product USING (product_id) ) select distinct buyer_id from Sales where buyer_id in (select buyer_id from temp where product_name='S8') AND buyer_id not in (select buyer_id from temp where product_name='iPhone')
with temp as ( select * from product join sales using (product_id) ) select distinct buyer_id from sales where buyer_id in (select buyer_id from temp where product_name='S8') and buyer_id not in (select buyer_id from temp where product_name='iPhone')
with temp as ( select distinct S.buyer_id, S.product_id, P.product_name from Sales S inner join Product P on S.product_id = P.product_id) select distinct buyer_id from Sales where buyer_id in (select distinct buyer_id from temp where product_name = 'S8') and buyer_id not in (select distinct buyer_id from temp where product_name = 'iPhone' )
with temp as ( select s.product_id, s.buyer_id, p.product_name from Sales s, Product p where s.product_id = p.product_id ) select distinct buyer_id from temp where product_name = 'S8' and buyer_id not in (select buyer_id from temp where product_name = 'iPhone') order by buyer_id
with temp as (select * from Sales left join Product using (product_id)) select distinct buyer_id from Sales where buyer_id not in (select buyer_id from temp where product_name='iPhone') and buyer_id in (select buyer_id from temp where product_name='S8')
with temp as (select * from Sales left join Product using (product_id)) select distinct buyer_id from temp where buyer_id not in (select a.buyer_id from temp as a join temp as b on a.buyer_id=b.buyer_id where a.product_name='S8' and b.product_name='iPhone') and product_name='S8'
with temp as (select S.*, product_name from Product P join Sales S on P.product_id = S.product_id) select distinct buyer_id from temp where buyer_id in (select buyer_id from temp where product_name = 'S8') and buyer_id not in (select buyer_id from temp where product_name = 'iPhone')
with temp as (select distinct buyer_id, product_name from sales s join product p on s.product_id = p.product_id) select buyer_id from temp where product_name like 'S8' AND buyer_id NOT IN (SELECT buyer_id FROM temp where product_name like 'iPhone' )
with temp as( select p.product_id, p.product_name,s.buyer_id from Product p join Sales s on p.product_id = s.product_id) select distinct buyer_id from Sales where buyer_id in(select buyer_id from temp where product_name = 'S8') and buyer_id not in (select buyer_id from temp where product_name = 'iPhone')
with xtable as (select buyer_id, sales.product_id, product_name from sales left join product on sales.product_id = product.product_id), ytable as (select distinct buyer_id , product_name from xtable) select distinct buyer_id from xtable where product_name ='S8' and buyer_id not in (select buyer_id from ytable where product_name in ('iphone'))
