SELECT ROUND (AVG(timestampdiff(day,customer_pref_delivery_date, order_date)=0)*100,2) AS immediate_percentage FROM Delivery WHERE (customer_id,order_date ) in (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY 1 )
SELECT ROUND( AVG(order_date=customer_pref_delivery_date)*100, 2) AS immediate_percentage FROM delivery WHERE (customer_id, order_date) IN ( SELECT customer_id, MIN(order_date) FROM delivery GROUP BY customer_id )
SELECT ROUND(((SELECT COUNT(*) FROM(SELECT customer_id, MIN(order_date) first_order_date FROM Delivery GROUP BY customer_id) a LEFT JOIN Delivery d ON a.customer_id=d.customer_id WHERE delivery_id=delivery_id AND a.first_order_date=d.customer_pref_delivery_date) /(SELECT COUNT(DISTINCT customer_id ) FROM Delivery)*100 ),2) immediate_percentage
SELECT ROUND(((SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(order_date)) * 100), 2) as immediate_percentage FROM (SELECT *, (RANK() OVER(PARTITION BY customer_id ORDER BY order_date)) as rankk FROM Delivery) t WHERE rankk = 1
SELECT ROUND((SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(delivery_id)) * 100, 2) AS immediate_percentage FROM (SELECT *, ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY order_date) AS ranking FROM Delivery) a WHERE ranking = 1
SELECT ROUND((SUM(CASE WHEN t1.order_preference="immediate" THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS immediate_percentage FROM (SELECT delivery_id,customer_id,order_date,customer_pref_delivery_date, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) as rank_order, CASE WHEN order_date=customer_pref_delivery_date THEN "immediate" ELSE "scheduled" END AS order_preference FROM Delivery ORDER BY customer_id) t1 WHERE t1.rank_order=1
SELECT ROUND((SUM(pref = first_order)/ count(1))*100,2) as immediate_percentage from (SELECT customer_id, min(customer_pref_delivery_date) AS pref, min(order_date) as first_order FROM Delivery GROUP BY 1 )f
SELECT ROUND(100 * AVG(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END), 2) AS 'immediate_percentage' FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(100 * AVG(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END), 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(100 * AVG(a.order_date = a.customer_pref_delivery_date), 2) AS immediate_percentage FROM (SELECT customer_id, order_date, customer_pref_delivery_date, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS date_rank FROM Delivery) a WHERE a.date_rank = 1
SELECT ROUND(100 * AVG(order_date = customer_pref_delivery_date), 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) AS first_date FROM Delivery GROUP BY customer_id)
SELECT ROUND(100 * SUM( CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END ) / COUNT(distinct customer_id) , 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, min(order_date) as min_date FROM Delivery GROUP BY customer_id )
SELECT ROUND(100 * SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(customer_id), 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) AS order_date FROM Delivery GROUP BY customer_id)
SELECT ROUND(100 * SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/ COUNT(distinct customer_id), 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, min(order_date) as min_date FROM Delivery GROUP BY customer_id)
SELECT ROUND(100 * SUM(a.order_date = a.customer_pref_delivery_date) / COUNT(*), 2) AS immediate_percentage FROM (SELECT customer_id, order_date, customer_pref_delivery_date, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS date_rank FROM Delivery) a WHERE a.date_rank = 1
SELECT ROUND(100*AVG(order_date = customer_pref_delivery_date), 2) AS immediate_percentage FROM Delivery JOIN (SELECT customer_id, MIN(order_date) AS order_date FROM Delivery GROUP BY customer_id) a USING (customer_id, order_date)
SELECT ROUND(100*IFNULL(SUM(order_date = customer_pref_delivery_date )/ COUNT(customer_id),0),2) AS immediate_percentage FROM Delivery d2 WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery d1 GROUP BY customer_id)
SELECT ROUND(100*SUM(CASE WHEN customer_pref_delivery_date = order_date THEN 1 ELSE 0 END)/COUNT(*),2) as immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN ( SELECT customer_id, min(order_date) as firstOrder FROM Delivery GROUP BY customer_id)
SELECT ROUND(100*SUM(CASE WHEN order_Date=customer_pref_delivery_Date THEN 1 ELSE 0 END)/COUNT(delivery_id),2) as immediate_percentage FROM Delivery WHERE (customer_id, order_Date) IN (SELECT customer_id, min(order_Date) from delivery GROUP BY customer_id)
SELECT ROUND(100*SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(DISTINCT customer_id),2) AS immediate_percentage FROM Delivery WHERE (customer_id,order_date) in (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(100*SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/ COUNT(distinct customer_id) ,2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, min(order_date) as min_date FROM Delivery GROUP BY customer_id )
SELECT ROUND(100*SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(*),2) AS immediate_percentage FROM (SELECT customer_id, MIN(order_date) order_date, MIN(customer_pref_delivery_date) customer_pref_delivery_date FROM Delivery GROUP BY customer_id) t
SELECT ROUND(100*SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(DISTINCT Customer_id),2) immediate_percentage FROM Delivery WHERE (customer_id, order_date) in (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(100*SUM(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(*),2) AS immediate_percentage FROM ( SELECT customer_id, order_date, customer_pref_delivery_date, RANK() OVER(PARTITION BY customer_id ORDER BY order_date) as rnk FROM Delivery GROUP BY 1,2) ST WHERE rnk=1
SELECT ROUND(100*SUM(CASE WHEN order_date=customer_pref_delivery_date THEN 1 END)/ COUNT(distinct customer_id) ,2) AS immediate_percentage FROM ( SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) as rk FROM Delivery )temp WHERE rk = 1
SELECT ROUND(100*SUM(IF(order_date = customer_pref_delivery_date, 1, 0))/COUNT(order_date),2) as immediate_percentage FROM Delivery WHERE (delivery_id, customer_id) IN (select delivery_id, customer_id from (SELECT rank() over (partition by customer_id order by order_date asc) as date_rank, delivery_id, customer_id from Delivery) as d where date_rank = 1)
SELECT ROUND(100*SUM(order_date = customer_pref_delivery_date )/ COUNT(distinct customer_id) ,2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, min(order_date) as min_date FROM Delivery GROUP BY customer_id )
SELECT ROUND(100*avg(immediate),2) AS immediate_percentage FROM ( SELECT delivery_id, customer_id, order_date, if(customer_pref_delivery_date = order_date,1,0) as immediate, rank() over(partition by customer_id order by order_date) as rnk from delivery)t WHERE rnk = 1
SELECT ROUND(100*avg(order_date = customer_pref_delivery_date) ,2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, min(order_date) as min_date FROM Delivery GROUP BY customer_id )
SELECT ROUND(100*sum(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/count(*), 2) as immediate_percentage FROM (SELECT customer_id, order_date, customer_pref_delivery_date, RANK() OVER(PARTITION BY customer_id ORDER BY order_date ) as rnk FROM Delivery d) tmp where rnk =1
SELECT ROUND(100*sum(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/count(*), 2) as immediate_percentage FROM Delivery d where (customer_id, order_date) in (SELECT customer_id, min(order_date) FROM Delivery d GROUP BY customer_id)
SELECT ROUND(100*sum(order_date = customer_pref_delivery_date)/count(*), 2) as immediate_percentage FROM (SELECT customer_id, order_date, customer_pref_delivery_date, RANK() OVER(PARTITION BY customer_id ORDER BY order_date ) as rnk FROM Delivery d) tmp where rnk =1
SELECT ROUND(AVG(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) * 100, 2) AS immediate_percentage FROM Delivery d JOIN (SELECT customer_id, MIN(order_date) AS first_date FROM Delivery GROUP BY 1)t ON d.customer_id = t.customer_id AND d.order_date = t.first_date
SELECT ROUND(AVG(TIMESTAMPDIFF (day,customer_pref_delivery_date, order_date) =0)*100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY 1)
SELECT ROUND(AVG(TIMESTAMPDIFF (day,customer_pref_delivery_date, order_date) =0)*100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(AVG(TIMESTAMPDIFF (day,order_date,customer_pref_delivery_date) =0)*100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(AVG(a.NUM)*100,2) immediate_percentage FROM (SELECT (MIN(order_date)=MIN(customer_pref_delivery_date)) NUM FROM Delivery GROUP BY customer_id)a
SELECT ROUND(AVG(order_date = customer_pref_delivery_date ) * 100, 2) AS 'immediate_percentage' FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(AVG(order_date = customer_pref_delivery_date)*100, 2) AS immediate_percentage FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date) AS rk FROM Delivery) temp WHERE temp.rk = 1
SELECT ROUND(AVG(order_date=customer_pref_delivery_date)*100,2) AS immediate_percentage FROM ( SELECT * FROM ( SELECT customer_id,order_date,customer_pref_delivery_date, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rnk FROM Delivery )t1 WHERE rnk = 1 )t2
SELECT ROUND(AVG(pref)*100,2) AS immediate_percentage FROM (SELECT customer_id , CASE WHEN order_date = customer_pref_delivery_date THEN '1' ELSE '0' END AS pref , RANK() OVER (Partition BY customer_id ORDER BY order_date) AS R FROM Delivery ) AS temp WHERE R = 1
SELECT ROUND(COUNT(CASE WHEN order_date = customer_pref_delivery_date THEN customer_id END)/COUNT(DISTINCT customer_id)*100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(IFNULL(100*COUNT(DISTINCT CASE WHEN order_date = customer_pref_delivery_date THEN delivery_id ELSE NULL END) / COUNT(DISTINCT delivery_id),0),2) AS immediate_percentage FROM Delivery WHERE (customer_id,order_date) IN (SELECT customer_id, MIN(order_date) AS order_date FROM Delivery GROUP BY 1)
SELECT ROUND(IFNULL(100*SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(*),0),2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT DISTINCT customer_id, MIN(order_date) AS first_date FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN Delivery.order_date = Delivery.customer_pref_delivery_date THEN '1' ELSE 0 END)/COUNT(Delivery.customer_id) * 100, 2) AS immediate_percentage FROM Delivery LEFT JOIN Delivery AS Ref ON Ref.customer_id = Delivery.customer_id AND Ref.order_date < Delivery.order_date WHERE Ref.customer_id IS NULL
SELECT ROUND(SUM(CASE WHEN customer_pref_delivery_date = order_date THEN 1 ELSE 0 END)/COUNT(DISTINCT customer_id)*100,2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) in (SELECT customer_id, MIN(order_date) AS first_order FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN first_order = customer_pref_delivery_date THEN 1 ELSE 0 END) *100/ COUNT(*),2) AS immediate_percentage FROM (SELECT customer_id, MIN(order_date) AS first_order FROM Delivery GROUP BY customer_id) tmp JOIN Delivery d ON tmp.customer_id = d.customer_id WHERE first_order = order_date
SELECT ROUND(SUM(CASE WHEN first_order = customer_pref_delivery_date THEN 1 ELSE 0 END)*100/COUNT(DISTINCT customer_id), 2) AS immediate_percentage FROM ( SELECT *, MIN(order_date) OVER (PARTITION BY customer_id) AS first_order FROM delivery ) a
SELECT ROUND(SUM(CASE WHEN flag = 'immediate' THEN 1 ELSE 0 END)*100/COUNT(*),2) AS immediate_percentage FROM ( SELECT *, ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY order_date) AS R, CASE WHEN order_date = customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END AS flag FROM delivery ) AS T1 WHERE t1.R = 1
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN '1' ELSE 0 END)/COUNT(customer_id) * 100, 2) AS immediate_percentage FROM ( SELECT customer_id, order_date, customer_pref_delivery_date, ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY order_date) AS order_rank FROM Delivery ) AS RankedOrders WHERE order_rank = 1
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN '1' ELSE 0 END)/COUNT(customer_id) * 100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN ( SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id )
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(1) * 100, 2) AS 'immediate_percentage' FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(DISTINCT customer_id) * 100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN ( SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id )
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(DISTINCT customer_id)*100,2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(customer_id) * 100, 2) AS immediate_percentage FROM (SELECT *, DENSE_RANK() OVER (PARTITION BY customer_id ORDER BY order_date ASC) AS rn FROM Delivery) t WHERE rn = 1
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(customer_id) * 100, 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) AS order_date FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / COUNT(delivery_id) * 100, 2) AS immediate_percentage FROM (SELECT *, DENSE_RANK() OVER (PARTITION BY customer_id ORDER BY order_date ASC) AS rn FROM Delivery) t WHERE rn = 1
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)*100/COUNT(*),2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN ( SELECT customer_id, MIN(order_date) As firstOrder FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(*)*100, 2) AS immediate_percentage FROM (SELECT RANK() OVER(PARTITION BY customer_id ORDER BY order_date) AS rnk, delivery_id, customer_id, order_date, customer_pref_delivery_date FROM Delivery) tmp WHERE rnk = 1
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(customer_id)*100,2) AS immediate_percentage FROM delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 END)/COUNT(delivery_id) *100,2) immediate_percentage FROM ( SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) rnk FROM delivery)T1 WHERE rnk = 1
SELECT ROUND(SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 END)/COUNT(delivery_id)*100, 2) immediate_percentage FROM ( SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) rnk FROM delivery)T1 WHERE rnk = 1
SELECT ROUND(SUM(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)*100/COUNT(*),2) as immediate_percentage FROM Delivery WHERE (customer_id,order_date) IN (SELECT customer_id,MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(SUM(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(delivery_id) * 100, 2) AS immediate_percentage FROM (SELECT *, DENSE_RANK() OVER(PARTITION BY customer_id ORDER BY order_date ASC) AS rn FROM Delivery) AS t WHERE rn = 1
SELECT ROUND(SUM(CASE WHEN rk = 1 THEN i_s ELSE 0 END)*100.0/COUNT(DISTINCT customer_id),2) AS immediate_percentage FROM (SELECT *, (CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) AS i_s, RANK()OVER(PARTITION BY customer_id ORDER BY order_date) AS rk FROM Delivery) temp
SELECT ROUND(SUM(IF(order_date=customer_pref_delivery_date,1,0))/COUNT(*)*100,2) immediate_percentage FROM( SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date ASC) rnk FROM Delivery ) t WHERE rnk = 1
SELECT ROUND(SUM(TYPE ='immediate')/COUNT(*) *100,2) AS immediate_percentage FROM (SELECT TEMP.customer_id,TEMP.delivery_id,(CASE WHEN TEMP.order_date = TEMP.customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END)AS TYPE FROM ( SELECT *, RANK()OVER(PARTITION BY customer_id ORDER BY order_date )AS RNK FROM Delivery ) TEMP WHERE RNK = 1) TEMP2
SELECT ROUND(SUM(order_date = customer_pref_delivery_date)/COUNT(customer_id) * 100,2) immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT ROUND(count(distinct d1.customer_id)/count(distinct d2.customer_id) *100,2) AS immediate_percentage FROM Delivery d1, Delivery d2 WHERE (d1.customer_id,d1.order_date) IN (SELECT customer_id, MIN(order_date) AS first_date FROM Delivery GROUP BY customer_id) AND d1.order_date = d1.customer_pref_delivery_date
SELECT round(100*(SUM(if(order_date=customer_pref_delivery_date,1,0))/COUNT(delivery_id)),2) as immediate_percentage FROM Delivery WHERE (customer_id,order_date) IN (SELECT customer_id,MIN(order_date) FROM Delivery GROUP BY customer_id)
SELECT round(ifnull(sum(order_date= customer_pref_delivery_date)/count(*)*100,0), 2) AS immediate_percentage FROM (SELECT *, Rank() over(partition by customer_id order by order_date asc) AS rnk FROM Delivery) d WHERE rnk=1
SELECT round(sum(case when order_type = 'immediate' then 1 else 0 end)*100/count(0),2) as immediate_percentage FROM( SELECT customer_id , order_date , case when order_date = customer_pref_delivery_date then 'immediate' else 'schedule' end as order_type , rank() over (partition by customer_id order by order_date) as rk FROM Delivery) t WHERE rk = 1
SELECT round(sum(order_date= customer_pref_delivery_date)/count(*)*100,2) AS immediate_percentage FROM (SELECT *, rank() over(partition by customer_id order by order_date) AS rnk FROM Delivery) t WHERE rnk=1
SELECT round(sum(order_date=customer_pref_delivery_date)/count(customer_id)*100, 2) AS immediate_percentage FROM (SELECT *, rank() over(partition by customer_id order by order_date asc) AS rnk FROM Delivery) t WHERE t.rnk=1
Select ROUND(AVG(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)*100,2) AS immediate_percentage From delivery WHERE (customer_id,order_date) IN (Select customer_id,MIN(order_date) as order_date FROM delivery GROUP BY customer_id)
Select Round(Sum(order_date = customer_pref_delivery_date)/count(*)*100,2) as immediate_percentage From (Select *, DENSE_RANK() OVER (partition by customer_id order by order_date ASC) as rn From Delivery) t Where rn = 1
Select round((sum(order_status)/count(customer_id))*100,2) as immediate_percentage from ( select customer_id , row_number()over(partition by customer_id order by order_date)rn , Case when order_date=customer_pref_delivery_date then 1 else 0 end as order_status from Delivery )t where rn=1
Select round((sum(same_day_count)/count(*)) * 100,2) as immediate_percentage from ( Select d.customer_id, d.order_date, d.customer_pref_delivery_date, (case when d.order_date = d.customer_pref_delivery_date then 1 else 0 end) as same_day_count from Delivery d inner join (Select customer_id, min(order_date) as first_order_date from Delivery group by customer_id) first_order on d.customer_id = first_order.customer_id and d.order_date = first_order.first_order_date ) temp
Select round(100 * sum( IF (C.customer_pref_delivery_date = C.order_date, 1,0) ) / count(*), 2 ) immediate_percentage from (Select A.order_date, A.customer_pref_delivery_date from Delivery A join (Select customer_id, min(order_date) as dat from Delivery group by customer_id) B on A.order_date = B.dat and A.customer_id = B.customer_id) C
Select round(100*sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(customer_id),2) as immediate_percentage from Delivery where (order_date, customer_id) in ( Select min(order_date),customer_id from Delivery group by customer_id)
Select round(sum(case when first_order_date = customer_pref_delivery_date then 1 else 0 end) * 100 / count(first_order_date),2) as immediate_percentage from Delivery d Right Join ( Select customer_id, min(order_date) as first_order_date from Delivery group by customer_id )c on d.customer_id = c.customer_id and d.order_date = c.first_order_date
Select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)* 100.0/ count(customer_id),2) AS immediate_percentage from ( select *, dense_rank() over (partition by customer_id order by order_date) as order_rk from Delivery ) x where order_rk = 1
Select round(sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage from (Select *,rank()over(partition by customer_id order by order_date) as r from Delivery) a where a.r=1
Select round(z.counter/z.base*100,2) as immediate_percentage from (Select sum(case when y.order_Date=y.customer_pref_Delivery_date THEN 1 else 0 END) as counter, count(distinct y.delivery_id) as base from (Select x.delivery_id,x.order_date,x.customer_pref_delivery_date from (Select customer_id,delivery_id,order_date,customer_pref_delivery_date, dense_rank()over(partition by customer_id order by order_date ) as ranker from delivery) as x where x.ranker=1) as y) as z
WITH CNT AS( SELECT customer_id, MIN(order_date) as order_date FROM Delivery GROUP BY customer_id ) SELECT round(SUM(case when D.order_date = D.customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage FROM Delivery D, CNT C WHERE D.customer_id = C.customer_id AND D.order_date = C.order_date
WITH CTE AS (SELECT delivery_id, RANK() OVER(PARTITION BY customer_id ORDER BY order_date) AS RNK FROM Delivery) SELECT ROUND(100*SUM(IF(order_date=customer_pref_delivery_date AND RNK = 1,1,0))/COUNT(DISTINCT customer_id),2) AS immediate_percentage FROM Delivery JOIN CTE USING(delivery_id)
WITH CTE as (Select* FROM (Select*, rank() over(partition by customer_id order by order_date ) as rnk FROM Delivery)t WHERE rnk=1) SELECT ROUND((SUM(CASE WHEN order_date=customer_pref_delivery_date Then 1 ELSE 0 END)/count(*))*100,2) as immediate_percentage FROM CTE
WITH CTE_1 AS ( SELECT CUSTOMER_ID, MIN(ORDER_DATE) EARLIEST_DATE FROM DELIVERY GROUP BY CUSTOMER_ID ) ,CTE_2 AS ( SELECT D.CUSTOMER_ID, COUNT(*) IMM_COUNT FROM DELIVERY D, CTE_1 C WHERE D.CUSTOMER_ID = C.CUSTOMER_ID AND D.CUSTOMER_PREF_DELIVERY_DATE = C.EARLIEST_DATE GROUP BY D.CUSTOMER_ID ) ,CTE_3 AS ( SELECT COUNT(DISTINCT D.CUSTOMER_ID) SCHED_COUNT FROM DELIVERY D, CTE_1 C WHERE D.CUSTOMER_ID = C.CUSTOMER_ID AND D.CUSTOMER_PREF_DELIVERY_DATE <> C.EARLIEST_DATE AND D.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM CTE_2 ) ) SELECT ROUND((SUM(IMM_COUNT) / (SUM(IMM_COUNT) + SCHED_COUNT))*100, 2) IMMEDIATE_PERCENTAGE FROM CTE_2, CTE_3
WITH FIRST_ORDER AS ( SELECT DELIVERY_ID, CUSTOMER_ID, CASE WHEN ORDER_DATE=CUSTOMER_PREF_DELIVERY_DATE THEN 1 ELSE 0 END AS IMMEDIATE_DELIVERY, RANK() OVER(PARTITION BY CUSTOMER_ID ORDER BY ORDER_DATE) AS RN FROM DELIVERY ) SELECT ROUND(SUM(IMMEDIATE_DELIVERY)/COUNT(*)*100,2) AS IMMEDIATE_PERCENTAGE FROM FIRST_ORDER WHERE RN=1
WITH FirstOrderDetails AS (SELECT customer_id ,order_date ,customer_pref_delivery_date ,RANK() OVER (PARTITION BY customer_id ORDER BY order_date ASC) AS OrderRk FROM Delivery), FirstOrderCat AS (SELECT SUM(IF(order_date = customer_pref_delivery_date,1,0)) AS immediate ,COUNT(*) AS AllDelivery FROM FirstOrderDetails WHERE OrderRk = 1) SELECT ROUND(IFNULL(immediate*100/AllDelivery,0),2) AS immediate_percentage FROM FirstOrderCat
WITH TEMP AS (SELECT CASE WHEN order_Date=customer_pref_delivery_date THEN 1 ELSE 0 END as immediates FROM (SELECT delivery_id, customer_id, order_date, customer_pref_delivery_date, RANK () OVER (PARTITION BY customer_id ORDER BY order_date) rnk FROM delivery) a WHERE rnk=1) SELECT ROUND(SUM(immediates)/COUNT(immediates)*100,2) as immediate_percentage FROM TEMP
WITH TMP AS ( SELECT *, RANK() OVER(PARTITION BY customer_id ORDER BY order_date ASC) as r FROM Delivery d ) SELECT ROUND(100 * SUM(t.order_date = t.customer_pref_delivery_date) / COUNT(*) ,2) as immediate_percentage FROM TMP t WHERE r = 1
WITH Temp AS (SELECT customer_id, CASE WHEN order_date = customer_pref_delivery_date THEN 'immediate' ELSE 'schedule' END AS order_type, RANK() OVER(PARTITION BY customer_id ORDER BY order_date) AS order_rank FROM Delivery) SELECT ROUND(SUM(CASE WHEN order_type = 'immediate' THEN 1 END)/COUNT(*)*100,2) AS immediate_percentage FROM Temp WHERE order_rank =1
WITH base_table AS ( SELECT customer_id, delivery_id, customer_pref_delivery_date, IF(customer_pref_delivery_date = order_date, TRUE, FALSE) AS is_immediate_order, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rank_number FROM Delivery GROUP BY 1,2,3,3 ) SELECT ROUND(SUM(is_immediate_order) / COUNT(DISTINCT delivery_id) * 100, 2) AS immediate_percentage FROM base_table WHERE rank_number = 1
WITH cte AS ( SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rk FROM Delivery ) SELECT ROUND(AVG(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)*100,2) AS immediate_percentage FROM cte WHERE rk = 1
WITH cte AS ( SELECT *, ROW_NUMBER () OVER(PARTITION BY customer_id ORDER BY order_date) rnk FROM Delivery ) , cte2 AS ( SELECT sum(CASE WHEN customer_pref_delivery_date=order_date THEN 1 ELSE 0 END)*100 num, COUNT(delivery_id) den FROM cte WHERE rnk=1 ) SELECT ROUND(num/den*1.0,2) immediate_percentage FROM cte2
WITH cte AS (SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rk FROM Delivery) SELECT ROUND((SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(*))*100, 2) AS immediate_percentage FROM cte WHERE rk = 1
WITH cte AS (SELECT customer_id, delivery_id, order_date,customer_pref_delivery_date, RANK() OVER(PARTITION BY customer_id ORDER BY order_date) AS rnk FROM Delivery), a AS ( SELECT COUNT(cte.delivery_id) AS first_orders FROM cte WHERE cte.rnk=1 ), b AS( SELECT SUM(CASE WHEN cte.order_date=cte.customer_pref_delivery_date AND cte.rnk=1 THEN 1 ELSE 0 END) AS immediate_orders FROM cte ) SELECT ROUND(b.immediate_orders/a.first_orders*100,2) AS immediate_percentage FROM a,b
WITH cte AS( SELECT customer_id,order_date, rank()over(partition by customer_id order by order_date asc) as ranks From Delivery ), cte2 AS( SELECT customer_id,order_date FROM cte WHERE ranks =1 ) SELECT round(100*count(*)/(SELECT count(*) from cte2),2) as immediate_percentage FROM cte2 JOIN Delivery ON cte2.customer_id = Delivery.customer_id and cte2.order_date=Delivery.customer_pref_delivery_date
WITH cte AS( SELECT delivery_id,order_date,customer_pref_delivery_date FROM( SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date) AS order_rank FROM Delivery ) temp WHERE order_rank=1 ) SELECT ROUND(COUNT(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE NULL END)*100/COUNT(delivery_id),2) AS immediate_percentage FROM cte
WITH cte as ( SELECT *, rank() over (partition by customer_id order by order_date) as rk FROM delivery ), cte2 as ( SELECT CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END as re FROM cte WHERE rk = 1 ) SELECT round(sum(re)*100/count(re),2) as immediate_percentage FROM cte2
WITH early AS (SELECT customer_id, MIN(order_date) as min_order, MIN(customer_pref_delivery_date) AS min_pref FROM Delivery GROUP BY customer_id) SELECT ROUND(100 * SUM(CASE WHEN min_order = min_pref THEN 1 ELSE 0 END)/COUNT(*),2) AS immediate_percentage FROM early
WITH first_order AS ( SELECT * , RANK() OVER(PARTITION BY customer_id ORDER BY order_date ASC) rnk FROM Delivery ) SELECT ROUND(SUM(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)*100.00/COUNT(*),2) immediate_percentage FROM first_order WHERE rnk=1
WITH first_order AS ( SELECT customer_id, MIN(d.order_date) as first_order FROM delivery d GROUP BY 1 ) SELECT ROUND(AVG(CASE WHEN d.order_date = d.customer_pref_delivery_date THEN 1 ELSE 0 END),4)*100 as immediate_percentage FROM delivery d WHERE d.order_date = (SELECT first_order from first_order fo WHERE fo.customer_id = d.customer_id)
WITH first_order AS (SELECT customer_id, MIN(order_date) AS f_order FROM Delivery GROUP BY customer_id) SELECT ROUND((SUM(if(d.customer_pref_delivery_date IS NULL,0,1)) / COUNT(f.customer_id))*100,2) AS immediate_percentage FROM first_order AS f LEFT JOIN Delivery AS d ON f.customer_id = d.customer_id AND f.f_order = d.customer_pref_delivery_date
WITH first_order AS (select * from( SELECT customer_id,delivery_id,order_date,customer_pref_delivery_date, RANK() OVER(PARTITION BY customer_id ORDER BY order_date ASC) as first_order FROM Delivery ORDER BY customer_id , order_date)a where first_order = 1 ), immediate AS ( SELECT *, (CASE WHEN order_date = customer_pref_delivery_date THEN 'immediate' WHEN order_date <> customer_pref_delivery_date THEN 'schedule' END) AS i_s FROM first_order ) SELECT ROUND(100*( (SELECT COUNT(*) FROM immediate WHERE i_s IN ('immediate'))/ (SELECT COUNT(*) FROM immediate)),2) AS immediate_percentage
WITH first_order_per_customer AS( SELECT customer_id, MIN(order_date) AS order_date from Delivery GROUP BY 1 ) SELECT ROUND(SUM(CASE WHEN temp.status = 'immediate' THEN 1 ELSE 0 END) / COUNT(*) * 100, 2) AS immediate_percentage FROM( SELECT f.customer_id AS customer_id, f.order_date AS order_date, d.customer_pref_delivery_date AS customer_pref_delivery_date, CASE WHEN f.order_date = d.customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END AS status FROM first_order_per_customer f INNER JOIN Delivery d ON f.customer_id = d.customer_id AND f.order_date = d.order_date )temp
WITH main AS( SELECT *, (CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END ) AS immediate, RANK() OVER(PARTITION BY customer_id ORDER BY order_date) AS ranking FROM Delivery ) SELECT ROUND(SUM(immediate)*100/COUNT(*),2) AS immediate_percentage FROM main WHERE ranking = 1
WITH min_order as ( select customer_id, min(order_date) as min_order_date from Delivery group by customer_id ) select round((sum(case when customer_pref_delivery_date = Delivery.order_date then 1 else 0 end )/count(Delivery.customer_id))*100,2) as immediate_percentage from Delivery, min_order where Delivery.customer_id = min_order.customer_id and Delivery.order_date = min_order.min_order_date
WITH numbered_delivery AS ( SELECT *, (CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) immediate, ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY order_date ASC) rn FROM Delivery ) SELECT ROUND(SUM(immediate)/COUNT(immediate)*100,2) immediate_percentage FROM numbered_delivery WHERE rn = 1
WITH order_rank AS (SELECT customer_id, order_date, customer_pref_delivery_date, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS RNK FROM Delivery), first_order AS (SELECT customer_id, order_date, customer_pref_delivery_date FROM order_rank WHERE RNK = 1) SELECT ROUND((COUNT(customer_id)/(SELECT COUNT(customer_id) FROM first_order))*100,2) AS immediate_percentage FROM first_order WHERE order_date = customer_pref_delivery_date
WITH order_values as ( SELECT RANK() OVER (PARTITION BY customer_id ORDER BY order_date) as order_rank, CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END as immediate, 1 as n FROM Delivery ) SELECT ROUND(((sum(immediate) / sum(n)) * 100), 2) as immediate_percentage FROM order_values WHERE order_rank = 1
WITH s1 AS (SELECT customer_id AS id, MIN(order_date) AS d1 FROM Delivery GROUP BY customer_id) SELECT ROUND(100 * AVG(CASE WHEN d.order_date = d.customer_pref_delivery_date THEN 1 ELSE 0 END), 2) AS immediate_percentage FROM Delivery d join s1 ON s1.id = d.customer_id AND s1.d1 = d.order_date
WITH t AS ( SELECT delivery_id, CASE WHEN RANK() OVER (PARTITION BY customer_id ORDER BY order_date) = 1 THEN 1 ELSE 0 END AS is_first_order, CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END AS is_immediate FROM Delivery ) SELECT ROUND((SELECT SUM(is_immediate) FROM t WHERE is_first_order = 1) / (SELECT SUM(is_first_order) FROM t) * 100, 2) AS immediate_percentage
WITH t1 AS ( SELECT customer_id, MIN(order_date) AS firstOrderDate FROM Delivery GROUP BY customer_id), t2 AS ( SELECT d.customer_id, t1.firstOrderDate, d.customer_pref_delivery_date FROM Delivery d RIGHT JOIN t1 ON d.customer_id = t1.customer_id AND d.order_date = t1.firstOrderDate) SELECT ROUND((SUM(CASE WHEN firstOrderDate = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS immediate_percentage FROM t2
WITH t1 AS( SELECT *, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rank1 FROM delivery ORDER BY customer_id, order_date ), t2 AS ( SELECT * FROM t1 WHERE rank1 = 1 AND order_date = customer_pref_delivery_date ) SELECT ROUND((100 * COUNT(DISTINCT t2.customer_id)) / COUNT(DISTINCT delivery.customer_id),2) AS immediate_percentage FROM delivery,t2
WITH table1 AS( SELECT *, MIN(order_date) OVER(PARTITION BY customer_id) AS first_date, (CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END) AS immediate_flag FROM Delivery ), table2 AS( SELECT *, (CASE WHEN first_date=order_date THEN 1 ELSE 0 END) AS first_date_flag FROM table1 ) SELECT ROUND((SUM(first_date_flag*immediate_flag)/ SUM(first_date_flag))*100,2) AS immediate_percentage FROM table2
WITH table1 AS( SELECT delivery_id, customer_id, CASE WHEN order_date = customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END AS order_type, RANK()OVER(PARTITION BY customer_id ORDER BY order_date ASC) AS rnk FROM Delivery ) SELECT ROUND((SELECT COUNT(delivery_id) FROM table1 WHERE order_type='immediate' AND rnk=1) / (SELECT COUNT(delivery_id) FROM table1 WHERE rnk=1)*100,2) AS immediate_percentage
WITH tb AS( SELECT *, CASE WHEN order_date = customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END AS delivery_status, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rk FROM Delivery), tb2 AS( SELECT COUNT(DISTINCT customer_id) AS imm_ct FROM tb WHERE delivery_status = 'immediate' AND rk = 1), tb3 AS( SELECT COUNT(DISTINCT customer_id) AS first_ct FROM tb WHERE rk = 1) SELECT ROUND((tb2.imm_ct/tb3.first_ct)*100 ,2) AS immediate_percentage FROM tb2, tb3
WITH temp AS ( SELECT *, IF(order_date = customer_pref_delivery_date, 'immediate', 'scheduled') AS note FROM Delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM Delivery GROUP BY customer_id)) SELECT ROUND(SUM(note = 'immediate') / COUNT(delivery_id) * 100, 2) AS immediate_percentage FROM temp
WITH temp AS ( SELECT delivery_id, customer_id, CASE WHEN order_date = customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END as order_type, rank() over (PARTITION BY customer_id ORDER BY order_date) AS 'rnk' FROM Delivery ) SELECT ROUND((SELECT COUNT(delivery_id) FROM temp WHERE order_type = 'immediate' AND rnk = 1) * 100 / (SELECT COUNT(delivery_id) FROM temp WHERE rnk = 1), 2) AS immediate_percentage
WITH test AS ( SELECT customer_id, MIN(order_date) AS first_order, MIN(customer_pref_delivery_date) AS pref_delivery_date FROM Delivery GROUP BY customer_id ) SELECT ROUND( COUNT(*) / ( SELECT COUNT(DISTINCT customer_id) FROM DELIVERY ) * 100, 2) AS immediate_percentage FROM test WHERE first_order = pref_delivery_date
WITH win AS ( SELECT CASE WHEN ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date ASC) = 1 AND order_date = customer_pref_delivery_date THEN '1' ELSE 0 END AS nume, CASE WHEN ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date ASC) = 1 THEN '1' ELSE 0 END AS deno FROM delivery ) SELECT ROUND(SUM(nume) * 100 / SUM(deno), 2) AS immediate_percentage FROM win
With immediate as (Select d.customer_id From Delivery d right join (Select customer_id, min(order_date) as first_date From Delivery Group by customer_id) as f on d.customer_id = f.customer_id and d.order_date = f.first_date Where f.first_date = d.customer_pref_delivery_date) Select round(count(distinct i.customer_id)/count(distinct d.customer_id)*100,2) as immediate_percentage From Delivery d, immediate i
With nextt as ( Select customer_id, order_date, datediff(customer_pref_delivery_date,order_date) as diff from Delivery ), First_o as ( Select customer_id, min(order_date) as firstorder from Delivery group by 1 ), immid as ( Select a.customer_id, a.firstorder, Case when b.diff = 0 then 1 else 0 end as imm from First_o a left join nextt b on a.customer_id = b.customer_id and a.firstorder = b.order_Date ) Select round(100*(sum(imm)/count(imm)),2) as immediate_percentage from immid
select 100*round(count(distinct t.customer_id)/(select count(distinct customer_id) from Delivery), 4) as immediate_percentage from (select customer_id, order_date, customer_pref_delivery_date, rank()over(partition by customer_id order by order_date asc) as rnk from Delivery) t where t.order_date=t.customer_pref_delivery_date and rnk=1
select IF(immediate+sched = 0, 0, ROUND(immediate/(immediate+sched) * 100, 2)) as immediate_percentage from (select SUM(IF(d.order_date = d.customer_pref_delivery_date, 1, 0)) as immediate, SUM(IF(d.order_date = d.customer_pref_delivery_date, 0, 1)) as sched from Delivery d, (select min(order_date) order_date, customer_id from Delivery group by customer_id) as x where d.customer_id = x.customer_id and d.order_date = x.order_date) as y
select ROUND((100*SUM(case when order_date=customer_pref_delivery_date then 1 else 0 END)/count(1)),2) as 'immediate_percentage' from delivery where (customer_id,order_date) in (select customer_id,MIN(order_date) as first_order from delivery group by customer_id)
select ROUND(100*SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(DISTINCT(customer_id)),2) as immediate_percentage from Delivery where (customer_id, order_date) IN (select CUSTOMER_ID, MIN(order_date) from Delivery group by customer_id )
select ROUND(AVG(order_date = customer_pref_delivery_date)*100, 2) AS immediate_percentage FROM (select *, row_number()over(partition by customer_id order by order_date) as rk from Delivery) temp where temp.rk = 1
select cast(i.immediate / b.allFirst * 100 as DECIMAL(10,2)) immediate_percentage from (select 1 k, count(*) immediate from Delivery d join (select customer_id, min(order_date) first_date from Delivery group by customer_id) f on d.customer_id = f.customer_id where d.order_date = f.first_date and d.customer_pref_delivery_date = f.first_date) i join (select 1 k, count(*) allFirst from Delivery d join (select customer_id, min(order_date) first_date from Delivery group by customer_id) f on d.customer_id = f.customer_id where d.order_date = f.first_date) b on i.k = b.k
select ifnull(round(count(distinct temp.delivery_id) * 100 / count(distinct d.customer_id), 2), 0) as 'immediate_percentage' from (select distinct * from Delivery as d right join (select customer_id as 'customer_id_new', min(order_date) as 'first_order_date' from Delivery group by customer_id) as t on t.customer_id_new = d.customer_id and d.order_date = t.first_order_date) as temp, Delivery as d where datediff(temp.order_date, temp.customer_pref_delivery_date) = 0
select round( (select count(delivery_id) from (select *, min(order_date) over (partition by customer_id) as 'firstorder' from Delivery) as b where order_date=firstorder and order_date=customer_pref_delivery_date)*100 / (select count(delivery_id) from (select *, min(order_date) over (partition by customer_id) as 'firstorder' from Delivery) as a where order_date=firstorder ) ,2) as immediate_percentage
select round( sum(case when d1.order_date = d1.customer_pref_delivery_date then 1 else 0 end) * 100 / (count(d1.order_date)) ,2) immediate_percentage from Delivery d1 inner join (select customer_id, min(order_date) order_date from Delivery group by customer_id) d2 on d1.order_date = d2.order_date and d1.customer_id = d2.customer_id
select round( sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/ count(*) * 100,2) as immediate_percentage from (select *, DENSE_RANK() OVER (partition by customer_id order by order_date asc) as rn from Delivery) as t where rn =1
select round( sum(customer_pref_delivery_date = first_date) / count(*) *100,2) immediate_percentage from ( select *, min(order_date) over (partition by customer_id) first_date from delivery ) t where order_date = first_Date
select round(((Select count(customer_id) as c from (Select customer_id, case when order_date=customer_pref_delivery_date then 'immediate' else 'scheduled' end as date from (select *,rank() over(partition by customer_id order by order_date asc)as r from delivery)q where r=1)w where date='immediate') / (Select count(customer_id) as c from (Select customer_id, case when order_date=customer_pref_delivery_date then 'immediate' else 'scheduled' end as date from (select *,rank() over(partition by customer_id order by order_date asc)as r from delivery)q where r=1)w )*100),2) as immediate_percentage
select round((count(distinct if (order_type = 'immediate' ,customer_id,null))/count(distinct customer_id))*100,2) as immediate_percentage from (select delivery_id, customer_id, order_date, dense_rank() over(partition by customer_id order by order_date ) as rn, customer_pref_delivery_date, if (customer_pref_delivery_date = order_date, 'immediate', 'scheduled') as order_type from delivery )a where rn = 1
select round((select count(*) from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) as order_date from Delivery group by customer_id ) and order_date=customer_pref_delivery_date)/ (select count(distinct customer_id) from Delivery)*100,2) as immediate_percentage
select round((select count(*) from delivery a inner join (select customer_id, min(order_date) as first_order from delivery group by 1) as b on a.customer_id = b.customer_id and a.order_date = b.first_order where a.order_date = a.customer_pref_delivery_date)/ (select count(*) from delivery a inner join (select customer_id, min(order_date) as first_order from delivery group by 1) as b on a.customer_id = b.customer_id and a.order_date = b.first_order)*100,2) as immediate_percentage
select round((sum(case when a.order_date = a.customer_pref_delivery_date then 1 else 0 end) / count(*)) * 100, 2) as immediate_percentage from ( select *, rank() over (partition by customer_id order by order_date asc) as rank_num from Delivery ) a where rank_num = 1
select round((sum(case when a.order_date = a.customer_pref_delivery_date then 1 else 0 end) / count(*)) * 100, 2) as immediate_percentage from ( select *, row_number() over (partition by customer_id order by order_date asc) as row_num from Delivery ) a where row_num = 1
select round((sum(case when customer_pref_delivery_date=order_date then 1 else 0 end))/(select count(distinct customer_id) from Delivery)*100,2) as immediate_percentage from (select *, rank() over (partition by customer_id order by order_date) as rk from Delivery) a where rk=1
select round((sum(case when f.pref = f.first_order_date then 1 else 0 end) / count(f.pref))*100,2) as immediate_percentage from ( select customer_id, min(customer_pref_delivery_date) as pref, min(order_date) as first_order_date from delivery group by customer_id ) f
select round((sum(case when f.pref = f.first_order_date then 1 else 0 end) / count(f.pref)*100),2) as immediate_percentage from ( select customer_id, min(customer_pref_delivery_date) as pref, min(order_date) as first_order_date from delivery group by customer_id ) f
select round((sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)) / count(distinct(customer_id)) * 100, 2) as immediate_percentage from Delivery WHERE (customer_id, order_date) IN ( select customer_id, min(order_date) from Delivery group by customer_id )
select round((sum(case when order_date=customer_pref_delivery_date and rw_num=1 then 1 else 0 end)/sum(case when rw_num=1 then 1 else 0 end))*100,2) as immediate_percentage from ( select A.*, row_number() over(partition by customer_id order by order_date asc) as rw_num from Delivery A ) X
select round((sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(delivery_id)*100),2) as immediate_percentage from ( select delivery_id, customer_id,order_date, customer_pref_delivery_date, dense_rank() over(partition by customer_id order by order_date) as num from delivery) as d where d.num=1
select round((sum(case when pref = first_order_date then 1 else 0 end) / count(pref))*100,2) as immediate_percentage from ( select customer_id, min(customer_pref_delivery_date) as pref, min(order_date) as first_order_date from delivery group by customer_id ) f
select round((sum(pref = first_order_date) / count(1))*100,2) as immediate_percentage from ( select customer_id, min(customer_pref_delivery_date) as pref, min(order_date) as first_order_date from delivery group by 1 ) f
select round((sum(pref = first_order_date) / count(pref))*100,2) as immediate_percentage from ( select customer_id, min(customer_pref_delivery_date) as pref, min(order_date) as first_order_date from delivery group by customer_id ) f
select round(100 * sum(immediate_flag) / count(*), 2) as immediate_percentage from ( select delivery_id, customer_id, case when order_date = customer_pref_delivery_date then 1 else 0 end immediate_flag, rank() over (partition by customer_id order by order_date) as ranking from Delivery )_ where ranking = 1
select round(100* (select sum(c) from ( select count(distinct(customer_id)) c from delivery group by customer_id having min(order_date) = min(customer_pref_delivery_date ) ) t) / count(distinct(customer_id)),2) immediate_percentage from delivery
select round(100* sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/ count(*),2) as immediate_percentage from (select customer_id, order_date, customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date asc) as rn from Delivery) a where rn = 1
select round(100*(sum(if(order_date=customer_pref_delivery_date,1,0)))/ count(distinct customer_id),2) as immediate_percentage from delivery where (order_date,customer_id) in (select min(order_date) as a,customer_id from delivery group by customer_id)
select round(100*avg((case when order_date = customer_pref_delivery_date then 1 else 0 end)),2) as immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(100*avg(order_date = customer_pref_delivery_date),2) as immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(100*coalesce(sum(case when a.order_date = a.customer_pref_delivery_date then 1 else 0 end)/count(*), 0), 2) as immediate_percentage from delivery a inner join (select customer_id, min(order_date)as first_order from delivery group by 1)b on a.customer_id = b.customer_id and a.order_date = b.first_order
select round(100*count(distinct a.customer_id) / (select count(distinct customer_id) from delivery),2) as immediate_percentage from (select distinct(customer_id), order_date from delivery where order_date=customer_pref_delivery_date) a join (select customer_id, min(order_date) as first_date from delivery group by customer_id) b on a.customer_id=b.customer_id and a.order_date=b.first_date
select round(100*sum(c.immediate)/count(c.customer_id),2) as immediate_percentage from( select a.customer_id, case when timestampdiff(day, a.order_date, a.customer_pref_delivery_date)=0 then 1 else 0 end as immediate from Delivery as a join Delivery as b on a.customer_id = b.customer_id and a.order_date >= b.order_date group by a.customer_id, a.order_date having count(b.order_date) = 1) as c
select round(100*sum(case when (temp.order_date=temp.customer_pref_delivery_date) then 1 else 0 end)/count(*) ,2) as immediate_percentage from (select d.customer_id, d.order_date, rank() over (partition by d.customer_id order by d.order_date) as rnk, customer_pref_delivery_date from Delivery d ) temp where temp.rnk=1
select round(100*sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/ count(*), 2) as immediate_percentage from(select customer_id, order_date, customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date asc) as rnk from Delivery) x where rnk = 1
select round(100*sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(distinct customer_id),2) as immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(100*sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(distinct customer_id),2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) as mindate from delivery group by customer_id)
select round(100*sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/ count(distinct customer_id),2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) as min_data from delivery group by customer_id)
select round(100*sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(0),2) as immediate_percentage from Delivery where (customer_id,order_date) in ( select customer_id,min(order_date) as order_date from Delivery group by customer_id)
select round(100*sum(first_order=customer_pref_delivery_date)/sum(first_order=order_date), 2) as immediate_percentage from delivery d join (select distinct customer_id, min(order_date) as first_order from delivery group by customer_id) as t on d.customer_id=t.customer_id
select round(100*sum(if(order_Date = customer_pref_delivery_date ,1,0))/count(delivery_id),2)immediate_percentage from Delivery where (customer_id,order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(100.0*count(case when lag_delivery_id is null and customer_pref_delivery_date=order_date then delivery_id end)/count(case when lag_delivery_id is null then delivery_id end),2) as immediate_percentage from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, lag(delivery_id) over (partition by customer_id order by order_date asc) as lag_delivery_id from Delivery ) d
select round(Avg(order_date =customer_pref_delivery_date)*100,2) as immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date ) as order_date from Delivery group by customer_id)
select round(SUM(RN=1 &amp;&amp; order_date = customer_pref_delivery_date) * 100/SUM(RN=1),2) as immediate_percentage from (SELECT order_date, customer_pref_delivery_date , ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date ASC ) RN FROM Delivery) x
select round(avg (order_date = customer_pref_delivery_date) * 100, 2) as immediate_percentage from (select * ,row_number() over (partition by customer_id order by order_date) as rk from Delivery ) temp where temp.rk=1
select round(avg (order_date = customer_pref_delivery_date) * 100, 2) as immediate_percentage from Delivery where (customer_id , order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg( order_date = customer_pref_delivery_date)*100, 2) as 'immediate_percentage' FROM Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg(case when order_date = customer_pref_delivery_date then 1 else 0 end) * 100,2) as immediate_percentage from( select delivery_id, customer_id, order_date, customer_pref_delivery_date, rank() over (partition by customer_id order by order_date) as ranking from delivery)a where ranking = 1
select round(avg(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100, 2) "immediate_percentage" from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100, 2) 'immediate_percentage' from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100, 2) as 'immediate_percentage' from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg(first_order = customer_pref_delivery_date)*100,2) immediate_percentage from ( select *, min(order_date) over (partition by customer_id) first_order from delivery ) t where first_order = order_date
select round(avg(if( fd = customer_pref_delivery_date and order_date = fd,1,0) )*100 ,2)as immediate_percentage from(select *, min(order_date)over(partition by customer_id ) as fd from delivery )t where order_date = fd
select round(avg(if(order_date = customer_pref_delivery_date, 1, 0))*100,2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) from delivery group by customer_id)
select round(avg(immediate_type)*100,2) as immediate_percentage from ( select customer_id, case when order_date=customer_pref_delivery_date then 1 else 0 end as immediate_type, rank() over(partition by customer_id order by order_date) as rnk from Delivery ) a where rnk=1
select round(avg(order_date = customer_pref_delivery_date) * 100, 2) as immediate_percentage from Delivery WHERE (customer_id, order_date) IN ( select customer_id, min(order_date) from Delivery group by customer_id )
select round(avg(order_date = customer_pref_delivery_date)* 100,2) as immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) as min_date from Delivery group by 1)
select round(avg(order_date = customer_pref_delivery_date)*100 ,2) immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg(order_date = customer_pref_delivery_date)*100, 2) 'immediate_percentage' from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(avg(order_date = customer_pref_delivery_date)*100, 2) as immediate_percentage from Delivery where (customer_id, order_date) in (select customer_id, min(order_date) from Delivery group by customer_id)
select round(c3.cnt2/c1.cnt1*100,2) as immediate_percentage from (select count(distinct d.customer_id) as cnt1 from delivery d) c1, (select count(c2.customer_id) as cnt2 from (select d2.customer_id from delivery d2 group by d2.customer_id having min(d2.order_date) = min(customer_pref_delivery_date)) c2) c3
select round(count(*)/(select count(distinct customer_id) from delivery) * 100, 2) immediate_percentage from ( select customer_id from delivery group by customer_id having min(order_date)=min(customer_pref_delivery_date) ) a
select round(count(*)/(select count(distinct(customer_id)) from Delivery)*100,2) as immediate_percentage from Delivery where order_date = customer_pref_delivery_date and (customer_id,order_date) in ( select customer_id, min(order_date) from Delivery group by customer_id)
select round(count(case when a.order_date=a.customer_pref_delivery_date then 1 else NUll end)/count(a.delivery_id)*100,2) as immediate_percentage from (select *, rank() over (partition by customer_id order by order_date) as delivery_rank from delivery) a where a.delivery_rank=1
select round(count(case when order_date = customer_pref_delivery_date then delivery_id else null end) / count(delivery_id) *100 ,2) as immediate_percentage from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date) as rn from delivery ) as t where rn =1 ) as s
select round(count(customer_id)/(select count(distinct customer_id) from Delivery)*100,2) as immediate_percentage from(select customer_id,order_date,customer_pref_delivery_Date as d,rank() over (partition by customer_id order by order_date)as r from Delivery) as p where r=1 and datediff(order_date,d)=0
select round(count(delivery_id) / (select count(distinct customer_id) from Delivery)*100,2) as Immediate_percentage from ( select * from ( select * from ( select delivery_id, customer_id, order_date,row_number() over(partition by customer_id order by order_date) as dt,customer_pref_delivery_date from Delivery ) t1 where dt = 1 ) t2 where order_date = customer_pref_delivery_date ) t3
select round(count(delivery_id) / (select count(distinct customer_id) from Delivery)*100,2) as Immediate_percentage from ( select * from ( select delivery_id, customer_id, order_date,row_number() over(partition by customer_id order by order_date) as dt,customer_pref_delivery_date from Delivery ) t1 where dt = 1 and order_date = customer_pref_delivery_date ) t2
select round(count(distinct fo.customer_id) / count(distinct d.customer_id)*100, 2) immediate_percentage from ( select customer_id , min(order_date) first_order from delivery group by 1 ) fo right join delivery d on d.customer_id=fo.customer_id and d.customer_pref_delivery_date=fo.first_order
select round(ifnull(sum(case when a.first_order = b.customer_pref_delivery_Date then 1 else 0 end) / count(a.first_order)*100,0),2) as immediate_percentage from ( select customer_id, min(order_date) as first_order from delivery group by 1 ) as a join delivery as b on a.customer_id = b.customer_id and a.first_order = b.order_date
select round(ifnull(sum(type),0) *1.00/ count(delivery_id)*100,2) as immediate_percentage from (select delivery_id, case when order_date = customer_pref_delivery_date then 1 else 0 end as type, rank() over(partition by customer_id order by order_date asc) as rk from Delivery)s where rk = 1
select round(sum( case when order_date = customer_pref_delivery_date then 1 else 0 end)*100/ count(*),2) as immediate_percentage from (select *, rank() over(partition by customer_id order by order_date ) as rk from Delivery) t where rk = 1
select round(sum(case when b.firstday=a.customer_pref_delivery_date then 1 else 0 end)/count(distinct a.customer_id)*100,2) as immediate_percentage from Delivery a left join (select customer_id,min(order_date) firstday from Delivery group by customer_id) b on a.customer_id=b.customer_id and a.order_date=b.firstday
select round(sum(case when customer_pref_delivery_date = order_date then 1 else 0 end) / count(*) * 100, 2) as immediate_percentage from delivery d where order_date <= all ( select order_date from delivery where customer_id = d.customer_id )
select round(sum(case when delivery1.order_date = delivery1.customer_pref_delivery_date then 1 else 0 end)*100/count(delivery1.delivery_id),2) as immediate_percentage from Delivery delivery1 left join Delivery delivery2 on delivery1.customer_id = delivery2.customer_id and delivery1.order_date > delivery2.order_date where delivery2.order_date is null
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end )/count(*) * 100,2) as immediate_percentage from ( select *, dense_rank() over (partition by customer_id order by order_date) as rk from delivery ) a where rk = 1
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end) * 100/count(delivery_id),2) as 'immediate_percentage' from ( select *, dense_rank() over(partition by customer_id order by order_date) as 'rk' from delivery) as A where rk = 1
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end) / count(distinct customer_id)*100,2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) from delivery group by customer_id)
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end) /count(*) * 100,2) as immediate_percentage from (select *, dense_rank() over (partition by customer_id order by order_date) as num from delivery) a where num = 1
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100/ count(customer_id),2) as immediate_percentage from ( select customer_id, order_date,customer_pref_delivery_date,rank() over(partition by customer_id order by order_date) as abc from delivery) a where abc = 1
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/ count(order_date) * 100,2)as immediate_percentage from delivery where (customer_id, order_date) in ( select customer_id, min(order_date) from delivery group by customer_id )
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(*)*100, 2) as immediate_percentage from (select delivery_id, customer_id, order_date, customer_pref_delivery_date , rank() over (partition by customer_id order by order_date) as rnk from delivery group by delivery_id, customer_id, order_date, customer_pref_delivery_date) a where rnk = 1
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) as first_date from delivery group by 1)
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) first_order from delivery group by customer_id)
select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(customer_id) * 100,2) as 'immediate_percentage' from ( select customer_id, order_date, customer_pref_delivery_date, dense_rank() over(partition by customer_id order by order_date) as rank_order from delivery) AS A where rank_order = 1
select round(sum(case when order_date =customer_pref_delivery_date then 1 else 0 end )*100/ count(*),2) as immediate_percentage from( select customer_id ,order_date,customer_pref_delivery_date, rank() over(partition by customer_id order by order_date) as rn from Delivery )t where rn = 1
select round(sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)*100/count(*),2) as immediate_percentage from( select *,row_number() over(partition by customer_id order by order_date) as first_order from delivery)a where first_order=1
select round(sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(customer_id)*100,2) as immediate_percentage from (select customer_id, order_date, customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date) as row_num from delivery ) tmp where row_num=1
select round(sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(distinct customer_id)*100,2) as immediate_percentage from (select customer_id, delivery_id, order_date, customer_pref_delivery_date from Delivery where (customer_id,order_date) in (select customer_id, min(order_date) from Delivery group by 1) ) tmp
select round(sum(case when order_type = 'immediate' then 1 else 0 end)/count(delivery_id) * 100 , 2) as immediate_percentage from ( select drv.*, rank() over (partition by customer_id order by order_date) as rn, case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end as order_type from delivery as drv ) as a where a.rn = 1
select round(sum(case when order_type = 'immediate' then 1 else 0 end)/count(distinct customer_id)*100,2) as immediate_percentage from (select *, rank() over(partition by customer_id order by order_date) as rnk, case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end as order_type from delivery) a where rnk = 1
select round(sum(case when seq_order= 1 and immediate = 1 then 1 else 0 end)/sum(case when seq_order= 1 then 1 else 0 end)*100, 2) as immediate_percentage from (select delivery_id, customer_id, rank() over (partition by customer_id order by order_date) as seq_order, (case when order_date = customer_pref_delivery_date then 1 else 0 end) as immediate from Delivery ) sub
select round(sum(delivery_type)/count(customer_id)*100,2) as immediate_percentage from(select customer_id, order_date, customer_pref_delivery_date, rank() over(partition by customer_id order by order_date) as rnk, if(order_date=customer_pref_delivery_date,1,0) as delivery_type from Delivery) a where rnk=1
select round(sum(if(first_order = customer_pref_delivery_date ,1,0)) / count(order_date) * 100,2) as immediate_percentage from Delivery join ( select customer_id, min(order_date) as first_order from Delivery group by customer_id ) as A on Delivery.order_date = A.first_order and A.customer_id = Delivery.customer_id
select round(sum(immediate)/count(*)*100, 2) as immediate_percentage from (select customer_id, case when customer_pref_delivery_date=order_date then 1 else 0 end as immediate, rank() over(partition by customer_id order by order_date) as first_order from delivery) d where d.first_order=1
select round(sum(immediate)/count(delivery_id) * 100, 2) as immediate_percentage from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, case when order_date = customer_pref_delivery_date then 1 else 0 end as immediate, rank() over(partition by customer_id order by order_date asc) as order_rank from delivery ) as tmp where order_rank = 1
select round(sum(immediate)/sum(orders)*100,2) as immediate_percentage from (select customer_id, case when order_date is not null then 1 else 0 end as orders, case when order_date=customer_pref_delivery_date then 1 else 0 end as immediate from (select customer_id, order_date, customer_pref_delivery_date, rank()over(partition by customer_id order by order_date) as rnk from delivery ) as t where rnk=1 ) as o
select round(sum(order_date = customer_pref_delivery_date)*100/count(*),2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) as od from delivery group by customer_id)
select round(sum(order_date =customer_pref_delivery_date) / count(delivery_id) * 100,2) as immediate_percentage from delivery where (customer_id, order_date) in (select customer_id, min(order_date) as order_date from delivery group by customer_id)
select round(sum(perf=first)/count(*)*100,2) as immediate_percentage from (select customer_id, min(order_date) as perf, min(customer_pref_delivery_date) as first from delivery group by customer_id) a
select round(sum(pref = first)/count(customer_id)*100,2) as immediate_percentage from (select customer_id, min(customer_pref_delivery_date) as pref, min(order_date) as first from delivery group by 1) a
with A as( select customer_id, row_number() over(partition by customer_id order by order_date) as "date_rank", if(order_date = customer_pref_delivery_date, "immediate", "scheduled") as "delivery" from delivery ) select round(sum(if(delivery = "immediate", 1, 0))/count(*)*100, 2) as "immediate_percentage" from A where date_rank = 1
with A as( select customer_id, row_number() over(partition by customer_id order by order_date) as "date_rank", order_date, customer_pref_delivery_date from delivery ) select round(sum(if(order_date = customer_pref_delivery_date, 1, 0))/count(*)*100, 2) as "immediate_percentage" from A where date_rank = 1
with CET1 as (SELECT customer_id, order_date, customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date) as 'ranking' from Delivery) SELECT round((select count(customer_id) from CET1 where ranking = 1 and order_date=customer_pref_delivery_date )/(select count(customer_id) from CET1 where ranking = 1)*100,2) as immediate_percentage
with Earliest as ( select customer_id, order_date,customer_pref_delivery_date , rank() over(partition by customer_id order by order_date) as rnk from Delivery) select ROUND( ((select count(*) from Earliest where rnk =1 and order_date = customer_pref_delivery_date) / (select count(*) from Earliest where rnk =1))*100, 2) as immediate_percentage
with a as ( SELECT distinct(customer_id) ,order_date,customer_pref_delivery_date, RANK() OVER (PARTITION BY customer_id ORDER BY order_date ) as rnk FROM Delivery) SELECT ROUND(SUM(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)/COUNT(rnk)*100,2) AS immediate_percentage FROM a WHERE rnk =1
with a as ( select * from Delivery where (customer_id, order_date) in ( select customer_id, min(order_date) as first_order from Delivery group by customer_id ) ) select round(imm/count(delivery_id)*100,2) as immediate_percentage from a, (select count(delivery_id) as imm from a where order_date = customer_pref_delivery_date) b
with a as ( select *, case when order_date=customer_pref_delivery_date then 1 else 0 end as order_type, rank() over(partition by customer_id order by order_date) as rank_order from delivery) select round(avg(order_type)*100,2) as immediate_percentage from a where rank_order=1
with a as ( select *, row_number() over (partition by customer_id order by order_date) as row_num from Delivery ) select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end) / count(1) * 100, 2) as immediate_percentage from a where row_num = 1
with agg as (select customer_id,min(order_date)as fst_dt from delivery group by customer_id) select round(count(distinct case when order_date=customer_pref_delivery_date then delivery_id else null end)/count(distinct d.customer_id)*100,2) as immediate_percentage from agg join delivery d on agg.customer_id=d.customer_id and agg.fst_dt=d.order_date
with base as ( select * from (Select *, row_number() over (partition by customer_id order by order_date) as rk from Delivery )a where rk=1 ), base2 as (select *, case when order_date=customer_pref_delivery_date then 1 else 0 end as flag from base) select round((sum(flag)/count(*))*100,2) as immediate_percentage from base2
with cte AS( SELECT order_date, customer_pref_delivery_date, DENSE_RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS date_order FROM Delivery ) SELECT ROUND(SUM(order_date = customer_pref_delivery_date) / COUNT(*) * 100, 2) AS immediate_percentage FROM cte WHERE date_order = 1
with cte as ( SELECT *, RANK()OVER(PARTITION BY customer_id ORDER BY order_date) as 'RNK' FROM Delivery) SELECT ROUND(sum(CASE WHEN order_date=customer_pref_delivery_date THEN 1 ELSE 0 END)*100/count(*),2) as immediate_percentage FROM cte WHERE RNK=1
with cte as ( Select customer_id, delivery_id, order_date, customer_pref_delivery_date from ( Select customer_id, order_date, delivery_id, customer_pref_delivery_date , dense_rank() over ( partition by customer_id order by order_date) rnk from Delivery ) temp where rnk = 1 ) Select round(ifnull((Select count(delivery_id) from cte where order_date = customer_pref_delivery_date )/(Select count(delivery_id) from cte),0)*100,2) immediate_percentage
with cte as ( select (order_date=customer_pref_delivery_date) isimmediateorder, row_number() over(partition by customer_id order by order_date) rwnum from Delivery ) select round(sum(isimmediateorder)/count(*) * 100 ,2) immediate_percentage from cte where rwnum=1
with cte as ( select * from ( select customer_id, order_date, customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date) rk from delivery ) r1 where rk=1 ) select round(sum(imm) / count(customer_id) *100, 2) immediate_percentage from ( select customer_id, (case when order_date=customer_pref_delivery_date then 1 else 0 end) imm from cte ) r1
with cte as ( select *, case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end as status_delivery from Delivery) select round((sum(case when status_delivery = "immediate" then 1 else 0 end)/count(status_delivery)) * 100,2) as immediate_percentage from (select delivery_id, row_number() over(partition by customer_id order by order_date) as rk from Delivery ) as t join cte on t.delivery_id = cte.delivery_id where rk = 1
with cte as ( select *, case when order_date = customer_pref_delivery_date then 1 else 0 END as Immediate, rank() over(partition by customer_id order by order_date) as first_order_rank from Delivery) select round(sum(Immediate)/count(distinct customer_id),4) * 100 as immediate_percentage from cte where first_order_rank =1
with cte as ( select *, dense_rank() over(partition by customer_id order by order_date) as r from Delivery) select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100/count(distinct customer_id),2) as immediate_percentage from cte where r = 1
with cte as ( select *, row_number() over(partition by customer_id order by order_date ) as n from Delivery) select round(avg(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100,2) as immediate_percentage from cte where n = 1
with cte as ( select customer_id, min(order_date) as first_date from delivery group by 1 ) select round(sum(delivery.order_date = customer_pref_delivery_date)/count(cte.customer_id)*100,2) as immediate_percentage from cte left join delivery on cte.customer_id = delivery.customer_id and cte.first_date = delivery.order_date
with cte as ( select customer_id, min(order_date) as first_order from Delivery group by customer_id) select round(count(case when a.order_date = a.customer_pref_delivery_date then 1 end)*100/ count(a.customer_id),2) as immediate_percentage from Delivery a join cte b on a.customer_id =b.customer_id and a.order_date = b.first_order
with cte as ( select customer_id, order_date, customer_pref_delivery_date from (select d.*, rank() over(partition by customer_id order by order_date) as ranking from delivery d order by customer_id ) temp where ranking = 1 ) select round((select count(customer_id) from cte where order_date = customer_pref_delivery_date) *100 / (select count(customer_id) from cte), 2) as immediate_percentage
with cte as ( select customer_id, order_date, customer_pref_delivery_date, rank() over (partition by customer_id order by order_date asc) as rnk from Delivery ) select round(((sum(case when order_date = customer_pref_delivery_date then 1 else 0 end) / count(*))*100),2) as immediate_percentage from cte where rnk=1
with cte as ( select d.customer_id, rank() over (partition by d.customer_id order by d.order_date ASC) as 'ordernum', case when d.order_date = d.customer_pref_delivery_date then 'immediate' else 'scheduled' end as 'orderstatus' from Delivery d ) select round(100*(sum(orderstatus = 'immediate')/count(*)),2) as 'immediate_percentage' from cte where ordernum = 1
with cte as ( select delivery_id, count(delivery_id)over(order by order_date)as cnt from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, rank()over(partition by customer_id order by order_date ) as rnk from delivery)sub where rnk = 1)sub1 ),cte1 as ( select delivery_id, count(delivery_id)over(order by order_date) as cnt from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date from ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, rank()over(partition by customer_id order by order_date ) as rnk from delivery)sub where rnk = 1)sub1 where order_date = customer_pref_delivery_date ) select round(max(cte1.cnt)/max(cte.cnt)*100,2) as immediate_percentage from cte1 right join cte on cte1.delivery_id = cte.delivery_id
with cte as ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, RANK() over (partition by customer_id order by order_date) as rnk from Delivery ) select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end) * 100/count(*),2) as immediate_percentage from cte where rnk = 1
with cte as ( select delivery_id, order_date, rank() over (partition by customer_id order by order_date) "first_order" from delivery group by 1, 2 ) select round(100 * sum(case when c.order_date = d.customer_pref_delivery_date then 1 else 0 end) / count(*), 2) "immediate_percentage" from cte c join delivery d on c.delivery_id = d.delivery_id where c.first_order = 1
with cte as ( select delivery_id, order_date, rank() over (partition by customer_id order by order_date) "first_order" from delivery group by 1, 2 ) select round(100 * sum(case when c.order_date = d.customer_pref_delivery_date then 1 else 0 end) / count(d.customer_id), 2) "immediate_percentage" from cte c join delivery d on c.delivery_id = d.delivery_id where c.first_order = 1
with cte as ( select order_date, customer_pref_delivery_date, row_number() over (partition by customer_id order by order_date asc) as early from Delivery order by customer_id ) select round(count(case when order_date = customer_pref_delivery_date then 1 else null end)/(select count(case when early = 1 then 1 else null end)) *100, 2) as immediate_percentage from cte where early = 1
with cte as ( select row_number() over (partition by customer_id order by order_date asc) as early, case when order_date = customer_pref_delivery_date then 1 else 0 end as immediate from Delivery order by customer_id ) select round(count(case when immediate = 1 then 1 else null end)/(select count(case when early = 1 then 1 else null end)) *100, 2) as immediate_percentage from cte where early = 1
with cte as ( select t1.customer_id, t1.order_date, t2.first_order_date, t1.customer_pref_delivery_date, case when t1.order_date = t1.customer_pref_delivery_date then 1 else 0 end as immediate_order, case when t1.order_date = t2.first_order_date then 1 else 0 end as first_order from Delivery t1 left join ( select customer_id, min(order_date) as first_order_date from Delivery group by customer_id )t2 on t1.customer_id = t2.customer_id ) select round( 100 * sum(immediate_order) / sum(first_order), 2 ) as immediate_percentage from cte where first_order = 1
with cte as (select * from (select *,dense_rank() over(partition by customer_id order by order_date) as rn from Delivery) D where D.rn=1 ) select round(sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage from cte
with cte as (select * from delivery where (customer_id, order_date) in (select customer_id, min(order_date) from delivery group by customer_id) and order_date=customer_pref_delivery_date) select round((select count(*) from cte) *100 /count(distinct customer_id),2) as immediate_percentage from delivery
with cte as (select *, rank() over (partition by customer_id order by order_date) as my_rank from Delivery), cte2 as (select customer_id, order_date, customer_pref_delivery_date from cte where my_rank=1) select round( sum(order_date=customer_pref_delivery_date)*100/count(*),2) as immediate_percentage from cte2
with cte as (select *, rank() over (partition by customer_id order by order_date) as rnk from Delivery), cte1 as (select delivery_id, case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end as 'delivery_status' from cte where rnk = 1) select round(count(delivery_id) / (select count(*) from cte1) * 100, 2) as immediate_percentage from cte1 where delivery_status = 'immediate'
with cte as (select *, rank() over(partition by customer_id order by order_date) as date_rank from Delivery order by customer_id) select round((sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(*))*100 , 2) as immediate_percentage from cte where date_rank = 1
with cte as (select *, rank() over(partition by customer_id order by order_date) as orderrank from delivery) select round(((select count(customer_id) imm_order_cnt from cte where orderrank = 1 and order_date = customer_pref_delivery_date)/ (select count(customer_id) from cte where orderrank = 1))*100,2) as immediate_percentage
with cte as (select count(i) as cnt,o,p from (select customer_id as i,order_date as o,customer_pref_delivery_date as p,rank() over(partition by customer_id order by order_date ) rnk from delivery) d where d.rnk=1 and d.o=d.p),cte2 as (select count(distinct customer_id) as cnt2 from delivery) select round(((cte.cnt/cte2.cnt2)*100),2) as immediate_percentage from cte,cte2
with cte as (select customer_id, (order_date=customer_pref_delivery_date) is_imme, row_number()over(partition by customer_id order by order_date) as cnt from Delivery) select round(sum(is_imme)/count(*)*100,2) as immediate_percentage from cte where cnt =1
with cte as (select customer_id, min(order_date) as order_date, min(customer_pref_delivery_date) as customer_pref_delivery_date from Delivery group by customer_id order by customer_id asc) select round(100*sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(distinct customer_id),2) as immediate_percentage from cte
with cte as (select customer_id, order_date, customer_pref_delivery_date, dense_rank() over (partition by customer_id order by order_date) as ranking, case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end as timing from delivery) select round((count(*) / ( select count(*) from cte where ranking = 1))*100,2) as immediate_percentage from cte where ranking = 1 and timing = 'immediate'
with cte as (select customer_id, order_date, rank() over(partition by customer_id order by order_date ) as rk from Delivery ), etc as (select order_date, customer_id from Delivery where order_date = customer_pref_delivery_date), cte2 as (select count( etc.customer_id) as cnt from cte inner join etc on cte.order_date = etc.order_date and cte.customer_id = etc.customer_id where cte.rk = 1 ) select round((cnt/(select count(distinct customer_id) from Delivery))*100,2) as immediate_percentage from cte2
with cte as (select customer_id,delivery_id,order_date,customer_pref_delivery_date, rank () over( partition by customer_id order by order_date) as rorder from delivery) ,cte2 as (select customer_id,delivery_id, case when order_date=customer_pref_delivery_date then 'immediate' else 'scheduled' end as timeframe from cte where rorder=1) select round(((select count(delivery_id) from cte2 where timeframe='immediate')/ ((select count(delivery_id) from cte2 where timeframe='scheduled')+(select count(delivery_id) from cte2 where timeframe='immediate')))*100,2) as immediate_percentage
with cte as (select delivery_id, customer_id, order_date, customer_pref_delivery_date, rank () over (partition by customer_id order by order_date) as rn from Delivery ) select round(100*sum(order_date =customer_pref_delivery_date) /count(*), 2) as immediate_percentage from cte where rn = 1
with cte as (select delivery_id, order_date, customer_pref_delivery_date, row_number() over (partition by customer_id order by order_date) as order_number from Delivery) select round((select count(*) from cte where order_date=customer_pref_delivery_date and order_number=1) *100 / (select count(*) from cte where order_number=1),2) as immediate_percentage
with cte as (select delivery_id,customer_id, CASE WHEN order_date=customer_pref_delivery_date THEN 'immediate' ELSE 'scheduled' END as status, rank() over (partition by customer_id order by order_date) as rnk from delivery) select round((sum(case when status='immediate' THEN 1 ELSE 0 END)/COUNT(distinct customer_id))*100,2) as immediate_percentage from cte where rnk=1
with cte as( select *, case when order_date = customer_pref_delivery_date then 1 else 0 end as imm, rank() over(partition by customer_id order by order_date) rnk from Delivery) select round(sum(imm)/count(distinct customer_id)*100,2) as immediate_percentage from cte where rnk = 1
with cte as( select *, case when order_date = customer_pref_delivery_date then 1 else 0 end as imm_order, rank() over(partition by customer_id order by order_date) as order_no from delivery) select round(100*sum(imm_order)/count(1),2) as immediate_percentage from cte where order_no = 1
with cte as( select *, dense_rank() over (partition by customer_id order by order_date) as rnk from (select *, case when order_date = customer_pref_delivery_date then "Immediate" else "Scheduled" end as status from delivery) a) select round(((sum(case when status ="Immediate" then 1 else 0 end)/count(*))*100),2) as immediate_percentage from cte where rnk =1
with cte as( select *, row_number() over(partition by customer_id order by order_date) as rnk from delivery ) select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage from cte where rnk = 1
with cte as( select customer_id,order_date, customer_pref_delivery_date from Delivery where (customer_id ,order_date) in (select customer_id, min(order_date) from Delivery group by customer_id) ) select round (100*(select count(order_date) from cte where order_date = customer_pref_delivery_date) / (select count(order_date) from cte),2) as immediate_percentage
with cte as(select customer_id, (order_date = customer_pref_delivery_date) imme, row_number() over (partition by customer_id order by order_date) rnum from Delivery) select round(sum(imme)/count(*)*100,2) immediate_percentage from cte where rnum =1
with cte as(select d.customer_id, min_date, customer_pref_delivery_date from (select customer_id, min(order_date) as min_date from Delivery group by customer_id) t join Delivery d on d.customer_id = t.customer_id and d.order_date = t.min_date) select round(count(*)/(select count(*) from cte)*100,2) as immediate_percentage from cte where min_date = customer_pref_delivery_date
with cte1 as (select customer_id, min(order_date) as first_order_date from delivery group by customer_id), cte2 as (select delivery.customer_id, delivery.order_date, delivery.customer_pref_delivery_date, (case when delivery.order_date = delivery.customer_pref_delivery_date then 'immediate' else 'scheduled' end) as delivery_type from delivery join cte1 where delivery.order_date = cte1.first_order_date and delivery.customer_id = cte1.customer_id) select round(sum(case when delivery_type = 'immediate' then 1 else 0 end) / count(*) * 100, 2) as immediate_percentage from cte2
with cte1 as (select customer_id, min(order_date) as first_order_date from delivery group by customer_id), cte2 as (select delivery.customer_id, order_date, customer_pref_delivery_date, (case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end) as delivery_type from delivery join cte1 where order_date = first_order_date and delivery.customer_id = cte1.customer_id) select round(sum(case when delivery_type = 'immediate' then 1 else 0 end) / count(*) * 100, 2) as immediate_percentage from cte2
with cte_delivery as ( select customer_id, order_date, customer_pref_delivery_date, row_number() over (partition by customer_id order by order_date) as rnk from delivery ) select round( sum(datediff(order_date, customer_pref_delivery_date)=0)/count(distinct customer_id)*100, 2) as immediate_percentage from cte_delivery where rnk=1
with cte_orders as ( select customer_id, order_date, customer_pref_delivery_date, row_number() over (partition by customer_id order by order_date) as order_seq from Delivery ), cte_order_agg as ( select round( sum(if(order_date = customer_pref_delivery_date, 1, 0)) * 100 / count(*), 2 ) as immediate_percentage from cte_orders where order_seq = 1 ) select * from cte_order_agg
with delivery as ( select first_order.customer_id, first_order.min_order_date, d.customer_pref_delivery_date from Delivery d right join (select customer_id, min(order_date) as min_order_date from Delivery group by 1) first_order on first_order.customer_id = d.customer_id and first_order.min_order_date = d.order_date ) select round(sum(case when min_order_date = customer_pref_delivery_date then 1 else 0 end)/count(*) * 100, 2) as immediate_percentage from delivery
with etc as( select customer_id, min(order_date) over (partition by customer_id) as first_order, order_date, case when order_date=customer_pref_delivery_date then 1 else 0 end as "immediate" from Delivery), t2 as( select customer_id, case when order_date=first_order then 1 else 0 end as "first",immediate from etc having first=1) select round(sum(immediate)/count(customer_id)*100,2) immediate_percentage from t2
with final1 as ( with final as ( with cte as ( Select a.delivery_id,a.customer_id,a.order_date,a.customer_pref_delivery_date from ( Select *,min(order_date) over(partition by customer_id) as 'first_order_date' from Delivery )a where order_date = first_order_date ) Select * ,case when order_date = customer_pref_delivery_date then 'Immediate' else 'Scheduled' end as status from cte ) Select status,count(status) over(partition by status) as 'status_count',count(*)over() as 'total' from final ) Select distinct round((status_count / total)*100,2) as 'immediate_percentage' from final1 where status = 'Immediate'
with firsro as (select * from delivery where (customer_id,order_date) in (select customer_id, min(order_date) from delivery group by customer_id )) select round( sum( case when order_date=customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage from firsro
with firstD as ( select d1.customer_id, min(d1.order_date) as order_date from Delivery as d1 group by d1.customer_id ) select round(count(*)/(select count(*) from firstD)*100,2) as immediate_percentage from firstD as fd join Delivery as d2 on fd.customer_id = d2.customer_id and fd.order_date = d2.order_date and d2.order_date = d2.customer_pref_delivery_date
with first_order as ( select * from delivery where (customer_id, order_date) in (select customer_id, min(order_date) from delivery group by 1)), first_immidiate_order as ( select customer_id from first_order where order_date=customer_pref_delivery_date) select round(num/total*100,2) as immediate_percentage from (select count(customer_id) as total from first_order) t1 cross join (select count(customer_id) as num from first_immidiate_order) t2
with first_order as ( select customer_id, min(order_date) as first_date from Delivery group by 1 ), order_status as ( select d.delivery_id, case when d.order_date = d.customer_pref_delivery_date then 1 else 0 end status from Delivery d join first_order fo on (d.order_date = fo.first_date and d.customer_id = fo.customer_id) ), ranking as ( select delivery_id, customer_id, order_date, customer_pref_delivery_date, dense_rank() over (partition by customer_id order by order_date) as rnk from Delivery ) select round( (select count(distinct delivery_id) from order_status where status = 1) / (select count(distinct delivery_id) from order_status)*100,2) as immediate_percentage
with first_order as ( select customer_id, min(order_date) as first_date from delivery group by customer_id ) select round(sum(case when d.order_date = d.customer_pref_delivery_date then 1 else 0 end)*100.0/ count(*),2) as immediate_percentage from delivery d inner join first_order fo on d.customer_id = fo.customer_id and d.order_date = fo.first_date
with first_order as ( select customer_id, min(order_date) as first_order_date from Delivery group by 1 ) select round( (100*sum(case when a.first_order_date=b.customer_pref_delivery_date then 1 else 0 END) / count(*)) ,2) as immediate_percentage from first_order a left join Delivery b on a.customer_id = b.customer_id AND a.first_order_date = b.order_date
with first_order as ( select customer_id, min(order_date) as min_order from delivery d group by 1 ) , list_of_first_orders as ( select d.* from delivery d inner join first_order fo on fo.customer_id = d.customer_id and min_order = d.order_date ) , same_day as ( select count(distinct delivery_id) as same_day_orders from list_of_first_orders l where order_date = customer_pref_delivery_date ) , all_orders as ( select count(distinct delivery_id) as total_orders from list_of_first_orders l ) select round(same_day_orders/total_orders*100,2) as immediate_percentage from same_day sd, all_orders ao
with first_order as ( select customer_id,delivery_id,order_date,customer_pref_delivery_date, rank() over(partition by customer_id order by order_date) as rnk from delivery ) select round(sum(case when order_date=customer_pref_delivery_date then 1 else 0 end)*100/count(*),2) as immediate_percentage from first_order where rnk =1
with first_order as ( select delivery_id, customer_id, min(order_date) as order_date, customer_pref_delivery_date from Delivery group by customer_id ) SELECT ROUND(100 * SUM(CASE WHEN order_date = customer_pref_delivery_date THEN 1 ELSE 0 END) / (select count(*) from first_order), 2) AS immediate_percentage FROM Delivery WHERE (customer_id, order_date) IN (select customer_id, order_date from first_order)
with first_order as (select customer_id, min(order_date) as minorder from delivery group by customer_id) select ( ROUND((sum(case when minorder = customer_pref_delivery_date then 1 else 0 end)/ (select count(*) from first_order)) * 100,2) ) as immediate_percentage from delivery d join first_order fo on fo.customer_id = d.customer_id
with first_order as( select customer_id, min(order_date) as first_order_date from delivery group by customer_id) select round(count(case when customer_pref_delivery_date = first_order_date then 1 else null end) / count(f.customer_id)*100,2) as immediate_percentage from delivery as d right join first_order as f on f.first_order_date = d.order_date and f.customer_id = d.customer_id
with first_orders as ( select customer_id , min(order_date) order_date from delivery group by 1 ) select cast( (count(distinct case when d.order_date = customer_pref_delivery_date then delivery_id else null end) / count(distinct delivery_id))*100 as decimal(5,2)) as immediate_percentage from first_orders f inner join delivery d on f.customer_id = d.customer_id and f.order_date = d.order_date
with first_orders as (select customer_id, min(order_date) as first_order_date from Delivery group by customer_id) select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)*100/count(*),2) as immediate_percentage from first_orders f join Delivery d on f.customer_id = d.customer_id and f.first_order_date = d.order_date
with firstorder as (SELECT delivery_id, customer_id, min(order_date) as fir,min(customer_pref_delivery_date) as c FROM Delivery GROUP BY customer_id) SELECT round(sum(fir=c)/count(c) *100 ,2) as immediate_percentage FROM firstorder
with firsts as ( select delivery_id ,customer_id ,order_date ,customer_pref_delivery_date ,rank() over (partition by customer_id order by order_date) as ranking from Delivery order by 2 ) select round(first_cnt/count(distinct t1.customer_id)*100,2) as immediate_percentage from firsts t1 join ( select count(*) as first_cnt from delivery a join firsts b on a.delivery_id = b.delivery_id where b.ranking = 1 and a.order_date = a.customer_pref_delivery_date ) t2
with fobase as (select delivery_id, customer_id, rank() over(partition by customer_id order by order_date) as rnk from Delivery), firstorders as (select count(a.delivery_id) den from Delivery a, fobase b where a.delivery_id = b.delivery_id and b.rnk = 1), immediatefirstorders as (select count(a.delivery_id) num from Delivery a , fobase b where a.delivery_id = b.delivery_id and b.rnk = 1 and a.order_date = a.customer_pref_delivery_date ) select round((num/den)*100,2) as immediate_percentage from immediatefirstorders,firstorders
with nn as( select *, Case when order_date= customer_pref_delivery_date then 1 else 0 end as sch, rank() over(partition by customer_id order by order_date) rnk from delivery ) select round(sum(sch) / count(distinct customer_id), 4)*100 as immediate_percentage from nn where rnk=1
with orders_rnked as ( select *, rank() over(partition by customer_id order by order_date) as order_rnk from Delivery ) select round(100*count(distinct case when order_date = customer_pref_delivery_date then delivery_id else null end)/count(distinct delivery_id),2) as immediate_percentage from orders_rnked where order_rnk = 1
with sql1 as (select customer_id,customer_pref_delivery_date,order_date, rank() over(partition by customer_id order by order_date) as rank1 from Delivery) select round((count(distinct case when order_date = customer_pref_delivery_date then customer_id else null end)/count(distinct customer_id))*100,2) as immediate_percentage from sql1 where rank1 = 1
with st as ( select delivery_id,customer_id,rank() over (partition by customer_id order by order_date) as ranking, case when order_date = customer_pref_delivery_date then "immediate" else "scheduled" end as statues from delivery) select round(a.num / count(delivery_id) * 100, 2) as immediate_percentage from st, (select count(*) as num from st where statues = "immediate" and ranking = 1) as a where ranking = 1
with step1 as( select customer_id, case when min(order_date) = min(customer_pref_delivery_date) then 1 else 0 end immediate from delivery group by customer_id ) select round(sum(immediate)/count(distinct customer_id)*100,2) as immediate_percentage from step1
with t as ( SELECT * FROM ( SELECT *, ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY order_date) As 'rnk' FROM Delivery) As t0 WHERE rnk = 1 ) SELECT ROUND(100*SUM(immediate)/COUNT(*),2) As 'immediate_percentage' FROM ( SELECT *, IF(customer_pref_delivery_date=order_date, 1, 0) As 'immediate' FROM t ) As t1
with t as ( Select *, case when customer_pref_delivery_date = order_date then 1 else 0 end as doption from Delivery ), t1 as ( Select *, dense_rank() over(partition by customer_id order by order_date) as r from Delivery ) Select round(sum(doption)/count(doption)*100,2) as immediate_percentage from ( Select doption from t right join t1 on t1.order_date = t.order_date and t1.customer_id = t.customer_id where t1.r = 1) a
with t as ( select customer_id, min(order_date) as first_date, min(customer_pref_delivery_date) as deliv_date from delivery group by 1 ) select round(sum(case when first_date = deliv_date then 1 else 0 end) / count(*) * 100,2) as immediate_percentage from t
with t as ( with t as ( select customer_id, min(order_date) over (partition by customer_id ) as fod from delivery ) select customer_id , fod from t group by customer_id ) select round( 100 * sum( if(d.order_date = customer_pref_delivery_date, 1, 0) ) / count(*) ,2) as immediate_percentage from t join delivery d on t.fod = d.order_date and t.customer_id = d.customer_id
with t as (select delivery_id, customer_id, min(order_date) as order_date from Delivery group by customer_id) select round(100 * avg(case when d.order_date = d.customer_pref_delivery_date then 1 else 0 end),2) as immediate_percentage from Delivery d join t on d.customer_id = t.customer_id and d.order_date = t.order_date
with t as( select *, rank() over(partition by customer_id order by order_date) as 'rank_o' from delivery ) select round(sum(case when t.order_date = t.customer_pref_delivery_date then 1 else 0 end)/count(d.delivery_id)*100, 2) as 'immediate_percentage' from t join delivery d on d.delivery_id = t.delivery_id where rank_o = 1
with t as(select *,(case when order_date=customer_pref_delivery_date then 1 else 0 end)as i_s, rank() over(partition by customer_id order by order_date)as rk from delivery) select round(100*sum(case when rk=1 then i_s else 0 end)/count(distinct customer_id),2)as immediate_percentage from t
with t0 as(select delivery_id, customer_id, order_date, customer_pref_delivery_date, dense_rank() over(partition by customer_id order by order_date) as recent_orders from delivery order by customer_id), t as( select count(delivery_id) as fast from t0 where order_date = customer_pref_delivery_date and recent_orders = 1), t2 as (select count(delivery_id) as deno from t0 where recent_orders = 1) select round(fast/deno*100,2) as immediate_percentage from t,t2
with t1 as (select customer_id, min(order_date) order_date, min(customer_pref_delivery_date) customer_pref_delivery_date from delivery group by customer_id) select round(count((case when order_date = customer_pref_delivery_date then 1 else null end) * 1.0)/count(1) *100.0,2) as immediate_percentage from t1
with t1 as (select customer_id, order_date, customer_pref_delivery_date, rank() over (partition by customer_id order by order_date asc) as rn from delivery group by 1,2), t2 as (select customer_id, order_date, customer_pref_delivery_date from t1 where rn =1) select round(sum(case when order_date = customer_pref_delivery_date then 1 else 0 end)/count(*)*100,2) as immediate_percentage from t2
with t1 as( select customer_id, min(order_date), min(customer_pref_delivery_date), case when min(order_date) = min(customer_pref_delivery_date) then 1 else 0 end as pref from delivery group by customer_id ) select round(sum(pref)/count(pref) * 100, 2) as immediate_percentage from t1
with tb as ( select * from Delivery where (customer_id,order_date) in (select customer_id,min(order_date) from Delivery group by 1) and order_date=customer_pref_delivery_date) select round(((select count(*) from tb)/count(distinct customer_id))*100,2) as immediate_percentage from Delivery
with temp as ( select *, case when order_date=customer_pref_delivery_date then "immediate" else "scheduled" end as order_type from ( select delivery_id, customer_id,order_date,customer_pref_delivery_date, row_number() over(partition by customer_id order by order_date) as rnk from Delivery ) t where rnk=1 ) select round(100*(sum(case when order_type="immediate" then 1 else 0 end )/count(*)),2) as immediate_percentage from temp
with temp as ( select customer_id, min(order_date) as first_order, min(customer_pref_delivery_date) as first_pref from delivery group by customer_id ) select round(100*count(customer_id) / (select count(distinct customer_id) from delivery),2) as immediate_percentage from temp where first_order = first_pref
with temp as (select *, case when order_date = customer_pref_delivery_date then 1 else 0 end as imm, rank() over (partition by customer_id order by order_date) as rank_ from Delivery) select round(sum(imm) / count(distinct customer_id), 4)*100 as immediate_percentage from temp where rank_ = 1
with temp1 as ( select *, rank()over(partition by customer_id order by order_date) r from delivery order by customer_id, order_date ), temp2 as ( select * from temp1 where order_date=customer_pref_delivery_date and r=1 ) select round (100*count(distinct temp2.customer_id)/ count(distinct temp1.customer_id) , 2) immediate_percentage from temp1, temp2
with tmp as (select *, dense_rank() over (partition by customer_id order by order_date) as rk from delivery) select round(100 * sum(if(order_date = customer_pref_delivery_date, 1, 0)) / count(*), 2) as immediate_percentage from tmp where rk = 1
with tmp as( select delivery_id, customer_id, order_date, case when order_date = customer_pref_delivery_date then 'immediate' else 'scheduled' end as type from( select *, rank() over(partition by customer_id order by order_date) as ranks from Delivery) t where t.ranks = 1 ) select round( count(distinct delivery_id) / (select count(distinct delivery_id) from tmp) * 100, 2) as immediate_percentage from tmp where type = 'immediate'
with tmp as( select delivery_id, customer_id,order_date,customer_pref_delivery_date, row_number()over(partition by customer_id order by order_date) as rnk from delivery ) select round(sum(case when customer_pref_delivery_date=order_date then 1 else 0 end)/count(delivery_id)*100,2) as immediate_percentage from tmp where rnk=1
with x as ( select customer_id,order_date,customer_pref_delivery_date, rank() over (partition by customer_id order by order_date asc) as rnk from delivery ) select round((count(*)/(select count(distinct customer_id) from delivery))*100,2) as immediate_percentage from x where rnk = 1 and order_date = customer_pref_delivery_date
