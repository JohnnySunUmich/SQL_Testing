SELECT DISTINCT question_id AS survey_log FROM survey_log WHERE question_id = ( SELECT question_id FROM survey_log GROUP BY 1 ORDER BY SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN action = 'show' THEN 1 ELSE 0 END) DESC LIMIT 1)
SELECT QUESTION_ID AS SURVEY_LOG FROM SURVEY_LOG GROUP BY QUESTION_ID ORDER BY SUM(CASE WHEN ACTION='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ACTION='show' THEN 1 ELSE 0 END) DESC LIMIT 1
SELECT QUESTION_ID AS SURVEY_LOG FROM SURVEY_LOG WHERE ANSWER_ID IS NOT NULL GROUP BY QUESTION_ID ORDER BY COUNT(QUESTION_ID) DESC LIMIT 1
SELECT QUESTION_ID AS survey_log FROM SURVEY_LOG GROUP BY QUESTION_ID ORDER BY SUM(CASE WHEN ACTION = 'ANSWER' THEN 1 ELSE 0 END)/SUM(CASE WHEN ACTION = 'SHOW' THEN 1 ELSE 0 END) DESC LIMIT 1
SELECT QUESTION_ID AS survey_log FROM SURVEY_LOG group by question_id order by sum(case when action = 'answer' then 1 else 0 end)/sum(case when action = 'show' then 1 else 0 end) desc limit 1
SELECT a.question_id AS survey_log FROM (SELECT question_id, SUM(CASE WHEN sl.action = 'show' THEN 1 ELSE 0 END) AS show_cnt FROM survey_log sl GROUP BY question_id) s JOIN (SELECT question_id, SUM(CASE WHEN sl.action = 'answer' THEN 1 ELSE 0 END) AS answer_cnt FROM survey_log sl GROUP BY question_id) a HAVING (question_id) ORDER BY (a.answer_cnt/s.show_cnt) DESC LIMIT 1
SELECT question_id AS 'survey_log' FROM (SELECT question_id, CASE WHEN action = 'answer' THEN 1 ELSE 0 END AS num FROM survey_log) T GROUP BY question_id ORDER BY SUM(num) DESC LIMIT 1
SELECT question_id AS 'survey_log' FROM survey_log GROUP BY question_id ORDER BY COUNT(answer_id) / SUM(IF(action = 'show', 1, 0)) DESC LIMIT 1
SELECT question_id AS 'survey_log' FROM survey_log GROUP BY question_id ORDER BY SUM(case when action="answer" THEN 1 ELSE 0 END) / SUM(case when action="show" THEN 1 ELSE 0 END) DESC LIMIT 1
SELECT question_id AS survey_log FROM ( SELECT question_id, COUNT(CASE WHEN answer_id IS NOT NULL THEN id END) * 1.0 / COUNT(CASE WHEN action = 'show' THEN id END) AS ratio FROM survey_log GROUP BY 1 ) a ORDER BY ratio DESC LIMIT 1
SELECT question_id AS survey_log FROM ( SELECT question_id, SUM( CASE WHEN action="answer" THEN 1 ELSE 0 END ) AS ans_num, SUM( CASE WHEN action="show" THEN 1 ELSE 0 END ) AS show_num FROM survey_log GROUP BY question_id ) AS C ORDER BY (ans_num/show_num) DESC LIMIT 1
SELECT question_id AS survey_log FROM ( SELECT question_id, SUM(CASE WHEN action='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN action!='skip' THEN 1 ELSE 0 END) as rate FROM survey_log GROUP BY question_id ORDER BY rate DESC) ZZ LIMIT 1
SELECT question_id AS survey_log FROM ( SELECT question_id, SUM(action='answer')/SUM(action='show') AS answer_rate FROM survey_log GROUP BY 1 ORDER BY 2 DESC LIMIT 1 ) t
SELECT question_id AS survey_log FROM ( SELECT question_id, an / sh AS rate FROM (SELECT question_id, COUNT(action) AS an FROM survey_log WHERE action = 'answer' GROUP BY question_id) AS t2 NATURAL JOIN (SELECT question_id, COUNT(action) AS sh FROM survey_log WHERE action = 'show' GROUP BY question_id) AS t3 ORDER BY rate DESC ) AS t1 LIMIT 1
SELECT question_id AS survey_log FROM (SELECT question_id, SUM(IF(action='show', 1, 0)) AS num_show, SUM(IF(action='answer', 1, 0)) AS num_answer FROM survey_log GROUP BY question_id) AS t ORDER BY (num_answer/num_show) DESC LIMIT 1
SELECT question_id AS survey_log FROM (SELECT question_id, SUM(case when action="show" then 1 else 0 end) AS num_show, SUM(case when action="answer" then 1 else 0 end) AS num_ans FROM survey_log GROUP BY question_id) AS new_table ORDER BY num_ans/num_show DESC LIMIT 1
SELECT question_id AS survey_log FROM (SELECT question_id, SUM(num_answer) / SUM(num_show) AS answer_rate FROM (SELECT *, CASE WHEN action = 'show' THEN 1 ELSE 0 END AS num_show, CASE WHEN action = 'answer' THEN 1 ELSE 0 END AS num_answer FROM survey_log) AS survey_counted GROUP BY question_id) AS answer_rates ORDER BY answer_rate DESC LIMIT 1
SELECT question_id AS survey_log FROM (SELECT question_id,SUM(CASE WHEN action='answer' THEN 1 ELSE 0 END) / SUM(CASE WHEN action='show' THEN 1 ELSE 0 END) b FROM survey_log GROUP BY 1 ORDER BY 2 DESC LIMIT 1) c
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id HAVING COUNT(answer_id)/COUNT(DISTINCT id) = ( SELECT COUNT(answer_id)/COUNT(DISTINCT id) FROM survey_log GROUP BY question_id ORDER BY 1 DESC LIMIT 1 ) ORDER BY COUNT(answer_id) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id ORDER BY COUNT(CASE WHEN action="answer" THEN 1 END)/ COUNT(CASE WHEN action="show" OR action="answer" THEN 1 END) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id ORDER BY COUNT(answer_id)/(COUNT(*) ) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id ORDER BY SUM(CASE WHEN action = "answer" THEN 1 ELSE 0 END)/ SUM(CASE WHEN action = "show" THEN 1 ELSE 0 END) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id ORDER BY SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END) / SUM(CASE WHEN action = 'show' THEN 1 ELSE 0 END) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id ORDER BY SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END)*1.0/SUM(CASE WHEN action = 'show' THEN 1 ELSE 0 END) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log GROUP BY question_id ORDER BY SUM(action = 'answer') / SUM(action = 'answer' or action = 'show') DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log WHERE action = 'answer' GROUP BY question_id ORDER BY COUNT(action) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log WHERE action='answer' GROUP BY question_id ORDER BY COUNT(*) DESC LIMIT 1
SELECT question_id AS survey_log FROM survey_log WHERE action='answer' GROUP BY question_id ORDER BY COUNT(answer_id) DESC LIMIT 1
SELECT question_id as 'survey_log' FROM ( SELECT question_id, SUM(IF(action = 'answer',1,0))/COUNT(*) as arate FROM survey_log s GROUP BY question_id ) a ORDER BY a.arate DESC LIMIT 1
SELECT question_id as 'survey_log' FROM (SELECT question_id, (case when action = "show" then 1 else 0 end) AS 'showed', (case when action = "answer" then 1 else 0 end) AS 'answered' FROM survey_log) a Group by question_id Order by sum(answered)/sum(showed) DESC limit 1
SELECT question_id as survey_log FROM ( SELECT question_id, SUM(case when action="answer" THEN 1 ELSE 0 END) as num_answer, SUM(case when action="show" THEN 1 ELSE 0 END) as num_show FROM survey_log GROUP BY question_id ) as tbl ORDER BY (num_answer / num_show) DESC LIMIT 1
SELECT question_id as survey_log FROM ( SELECT question_id, SUM(case when action="show" THEN 1 ELSE 0 END) as num_show, SUM(case when action="answer" THEN 1 ELSE 0 END) as num_answer FROM survey_log GROUP BY question_id ) as tbl ORDER BY (num_answer / num_show) DESC LIMIT 1
SELECT question_id as survey_log FROM ( SELECT question_id, SUM(case when action='show' THEN 1 ELSE 0 END) as num_show, SUM(case when action='answer' THEN 1 ELSE 0 END) as num_answer FROM survey_log GROUP BY question_id ) as temp1 ORDER BY (num_answer / num_show) DESC LIMIT 1
SELECT question_id as survey_log FROM ( SELECT question_id, count(answer_id) as num_answer, SUM(case when action="show" THEN 1 ELSE 0 END) as num_show FROM survey_log GROUP BY question_id ) as tbl ORDER BY (num_answer / num_show) DESC LIMIT 1
SELECT question_id as survey_log FROM (SELECT question_id, (SUM(CASE WHEN action='answer' THEN 1 ELSE 0 END)/COUNT(*)) as num FROM survey_log GROUP BY question_id ORDER BY num DESC) t LIMIT 1
SELECT question_id as survey_log FROM (SELECT question_id, SUM(IF(action="answer",1,0))/ SUM(IF(action="show",1,0)) as answer_rate FROM survey_log GROUP BY question_id) as a ORDER BY answer_rate DESC LIMIT 1
SELECT question_id as survey_log FROM survey_log GROUP BY 1 ORDER BY SUM(CASE WHEN action='answer' THEN 1 END) DESC LIMIT 1
SELECT question_id as survey_log FROM survey_log GROUP BY question_id ORDER BY (SUM(CASE WHEN answer_id IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*)) DESC LIMIT 1
SELECT question_id as survey_log FROM survey_log GROUP BY question_id ORDER BY COUNT(IF(action = 'answer', 1, null))/COUNT(IF(action = 'show', 1, null)) desc LIMIT 1
SELECT question_id as survey_log FROM survey_log GROUP BY question_id ORDER BY COUNT(answer_id) DESC LIMIT 1
SELECT question_id as survey_log FROM survey_log GROUP BY question_id ORDER BY sum(case when action='answer' then 1 end)/sum(case when action='show' then 1 end) desc LIMIT 1
SELECT question_id survey_log FROM survey_log GROUP BY question_id ORDER BY SUM(IF(action='answer',1,0))/SUM(IF(action='show',1,0)) DESC LIMIT 1
SELECT question_id survey_log FROM survey_log WHERE answer_id IS NOT NULL GROUP BY question_id ORDER BY COUNT(answer_id) DESC LIMIT 1
SELECT sl.question_id AS survey_log from ( select question_id, sum(case when action = 'show' then 1 else 0 END ) AS TQ, sum(case when action="answer" then 1 else 0 END) AS TA from survey_log group by question_id) as sl order by (sl.TA/sl.TQ) DESC LIMIT 1
SELECT sorted_answered_questions.question_id AS survey_log FROM ( SELECT question_id, COUNT(*) AS num_times_answered FROM survey_log WHERE action = 'answer' GROUP BY question_id ORDER BY COUNT(*) DESC ) AS sorted_answered_questions LIMIT 1
SELECT survey_log FROM ( SELECT question_id AS survey_log , SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END) / SUM(CASE WHEN action = 'show' THEN 1 ELSE 0 END) AS RATIO FROM survey_log GROUP BY question_id ) TMP ORDER BY RATIO DESC LIMIT 1
SELECT survey_log FROM ( SELECT question_id survey_log, COUNT(answer_id)/COUNT(*) answer_rate FROM survey_log GROUP BY 1 ORDER BY 2 DESC LIMIT 1 ) AS rating
SELECT survey_log FROM (SELECT question_id AS survey_log, ROW_NUMBER() OVER (ORDER BY SUM(CASE WHEN answer_id IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*) DESC) AS rk FROM survey_log GROUP BY question_id) sub WHERE rk = 1
SELECT t2.question_id AS survey_log FROM ( SELECT question_id, COUNT(answer_id) AS answernum FROM survey_log WHERE action = 'answer' GROUP BY question_id )t1 RIGHT JOIN ( SELECT question_id, COUNT(question_id) AS shownum FROM survey_log WHERE action = 'show' GROUP BY question_id )t2 ON t1.question_id = t2.question_id ORDER BY (IFNULL(answernum, 0))/shownum DESC LIMIT 1
SELECT t2.question_id AS survey_log FROM (SELECT question_id, SUM(CASE WHEN s.action = 'show' THEN 1 ELSE 0 END) AS show_cnt FROM survey_log s GROUP BY question_id) t1 JOIN (SELECT question_id, SUM(CASE WHEN s.action = 'answer' THEN 1 ELSE 0 END) AS answer_cnt FROM survey_log s GROUP BY question_id) t2 HAVING (question_id) ORDER BY (t2.answer_cnt/t1.show_cnt) DESC LIMIT 1
Select question_id AS 'survey_log' FROM survey_log GROUP BY question_id Order By Count(answer_id) / COUNT(IF(action = 'show', 1, 0))DESC LIMIT 1
Select question_id AS survey_log From (Select question_id, sum(IF(action='show', 1, 0)) show_col, sum(IF(action = 'answer', 1, 0)) answer_col FROM survey_log GROUP BY (question_id)) A Order By answer_col/show_col DESC LIMIT 1
Select question_id as 'survey_log' from survey_log where answer_id is not null group by question_id order by count(answer_id) DESC LIMIT 1
Select question_id as survey_log From ( Select question_id, sum(case when action ='answer' then 1 else 0 end) as answer, sum(case when action ='show' then 1 else 0 end) as shown From survey_log Group by question_id) tmp Order by answer/shown desc limit 1
Select question_id as survey_log from ( Select question_id, (sum(case when answer_id is not null then 1 else 0 end)) / (sum(case when action = "show" then 1 else 0 end)) as answer_rate from survey_log group by question_id order by answer_rate desc ) ans limit 1
Select question_id as survey_log from ( Select question_id, ans_count/ans_show_count as highest_ans_rate from ( Select question_id, sum(case when action = 'answer' then 1 else 0 end) as ans_count, sum(case when action = 'show' or action = 'answer' then 1 else 0 end) as ans_show_count from survey_log group by question_id ) rate order by highest_ans_rate desc ) res limit 1
Select question_id as survey_log from ( Select question_id, count(case when action = 'answer' then 1 else null end) / count(case when action = 'show' then 1 else null end) as answer_rate from survey_log group by question_id order by answer_rate desc ) a limit 1
Select question_id as survey_log from ( Select question_id, count(question_id) as resp from survey_log where action='answer' group by question_id order by resp desc) as b limit 1
Select question_id as survey_log from (Select question_id, sum(action = 'answer')/sum(action='show') as rate from survey_log group by question_id order by rate desc limit 1 ) a
Select question_id as survey_log from (Select sum(Case when action ="answer" then 1 else 0 End) as num_ans, sum(Case when action ="show" then 1 else 0 End) as num_ques, question_id from survey_log group by 3) a Order by (a.num_ans/a.num_ques) DESC Limit 1
Select question_id as survey_log from survey_log group by 1 order by sum(case when action='answer' then 1 else 0 end)/sum(case when action='show' then 1 else 0 end) desc limit 1
Select question_id as survey_log from survey_log group by question_id order by sum(action = "answer") / count(action = "show") desc limit 1
Select question_id as survey_log from survey_log group by question_id order by sum(case when action='answer' then 1 else 0 end)/count(distinct question_id) desc limit 1
Select question_id as survey_log from( Select question_id, sum(case when action='answer' then 1 else 0 end) as rate From survey_log group by 1 order by 2 desc limit 1) a
WITH CTE AS ( SELECT question_id, ROW_NUMBER() OVER (ORDER BY SUM(action='answer')/SUM(action='show') DESC) AS R FROM survey_log GROUP BY question_id) SELECT question_id AS survey_log FROM CTE WHERE R=1
WITH CTE AS ( SELECT question_id, count(answer_id)/count(*) AS count_rate FROM survey_log GROUP BY question_id ORDER BY count(answer_id) desc ) SELECT question_id as survey_log FROM CTE LIMIT 1
WITH TEMP AS (SELECT QUESTION_ID AS SURVEY_LOG, SUM(CASE WHEN ACTION='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ACTION='show' THEN 1 ELSE 0 END) AS RATE FROM SURVEY_LOG WHERE ACTION IN ('show','answer') GROUP BY QUESTION_ID) SELECT SURVEY_LOG FROM TEMP ORDER BY RATE DESC LIMIT 1
WITH answer AS( select question_id,count(question_id) as answer_number FROM survey_log WHERE survey_log.action='answer' GROUP BY question_id), total AS( select question_id,count(question_id) as total_number FROM survey_log GROUP BY question_id) Select question_id as Survey_log FROM( SELECT answer.question_id,answer_number/total_number,rank()over(order by answer_number/total_number DESC ) as ranks FROM answer join total on answer.question_id = total.question_id)a WHERE ranks = 1
WITH answered AS ( SELECT question_id, COUNT(*) AS num_answered FROM survey_log WHERE action = 'answer' GROUP BY question_id ), shown AS ( SELECT question_id, COUNT(*) AS num_shown FROM survey_log WHERE action = 'show' GROUP BY question_id ) SELECT question_id AS survey_log FROM ( SELECT shown.question_id, COALESCE(num_answered/shown.num_shown, 0) AS ans_rate FROM shown LEFT JOIN answered ON shown.question_id = answered.question_id ) AS compare ORDER BY ans_rate DESC LIMIT 1
WITH base AS ( SELECT question_id , CAST(SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END) AS FLOAT) / SUM(CASE WHEN action IN ('answer', 'show') THEN 1 ELSE 0 END) AS answer_rate FROM survey_log GROUP BY question_id ) , answer_rank AS ( SELECT * , ROW_NUMBER() OVER (ORDER BY answer_rate DESC) answer_rate_rank FROM base ) SELECT question_id AS survey_log FROM answer_rank WHERE answer_rate_rank = 1
WITH base AS ( SELECT question_id , CAST(SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END) AS FLOAT) / SUM(CASE WHEN action IN ('answer', 'show') THEN 1 ELSE 0 END) AS answer_rate FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM base ORDER BY answer_rate DESC LIMIT 1
WITH cnt_ans AS ( SELECT question_id, SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END) / COUNT(*) AS rate FROM survey_log GROUP BY 1 ) SELECT question_id AS survey_log FROM cnt_ans WHERE rate = (SELECT MAX(rate) FROM cnt_ans)
WITH cnt_ans AS ( SELECT question_id, SUM(CASE WHEN answer_id IS NOT NULL THEN 1 ELSE 0 END) / COUNT(*) AS rate FROM survey_log GROUP BY 1 ) SELECT question_id AS survey_log FROM cnt_ans WHERE rate = (SELECT MAX(rate) FROM cnt_ans)
WITH cte AS ( SELECT question_id ,SUM(CASE WHEN answer_id IS NOT NULL THEN 1 ELSE 0 END ) AS cnt ,COUNT(DISTINCT question_id) AS total FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM ( SELECT question_id ,COALESCE(cnt/total,0) AS ans_rate FROM cte ) AS t ORDER BY ans_rate DESC LIMIT 1
WITH cte AS ( SELECT question_id, SUM(IF(action='show',1,0)) AS show_count, SUM(IF(action='answer',1,0)) AS ans_count FROM survey_log GROUP BY question_id ) SELECT question_id as survey_log FROM cte ORDER BY ans_count/show_count DESC LIMIT 1
WITH cte as (SELECT question_id, SUM(CASE WHEN (action ='answer') THEN 1 ELSE 0 END)/ SUM(CASE WHEN (action !='answer') THEN 1 ELSE 0 END) as rate FROM survey_log GROUP BY 1) SELECT question_id as survey_log FROM cte WHERE rate = ( select max(rate) from cte)
WITH cte1 AS ( SELECT question_id, COUNT(answer_id) AS counts FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM cte1 ORDER BY counts DESC LIMIT 1
WITH cte1 AS ( SELECT question_id, COUNT(answer_id) AS counts FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM cte1 WHERE counts = ( SELECT MAX(counts) FROM cte1 )
WITH cte1 AS ( SELECT question_id, COUNT(answer_id) AS counts FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM cte1 WHERE counts = (SELECT MAX(counts) FROM cte1)
WITH getLogs AS ( SELECT question_id, SUM(CASE WHEN action = 'show' THEN 1 ELSE 0 END) AS q_showed, SUM(CASE WHEN action = 'answer' THEN 1 ELSE 0 END) AS q_answered FROM survey_log GROUP BY 1 ) SELECT tbl.question_id AS survey_log FROM ( SELECT question_id, MAX(q_answered/q_showed) AS max_answer_rate FROM getLogs GROUP BY 1 )tbl ORDER BY tbl.max_answer_rate DESC LIMIT 1
WITH question_rate AS (SELECT question_id, ROUND(SUM(CASE WHEN answer_id IS NOT NULL THEN 1 ELSE 0 END)/ SUM(CASE WHEN question_id THEN 1 ELSE 0 END)*100,2) as rate FROM survey_log GROUP BY question_id) SELECT question_id as survey_log FROM question_rate ORDER BY rate DESC LIMIT 1
WITH status AS ( SELECT question_id, SUM( CASE WHEN action = "answer" THEN 1 ELSE 0 END ) AS Answer_status, SUM( CASE WHEN action = "show" THEN 1 ELSE 0 END ) AS Show_status FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM status ORDER BY Answer_status/show_status DESC LIMIT 1
WITH sub AS (SELECT sub_shows.question_id, sub_answers.answers / sub_shows.shows rate FROM (SELECT question_id, count(*) AS shows FROM survey_log WHERE action = 'show' GROUP BY 1 ) sub_shows JOIN ( SELECT question_id, count(*) AS answers FROM survey_log WHERE action = 'answer' GROUP BY 1 ) sub_answers ON sub_answers.question_id = sub_shows.question_id GROUP BY 1 ) SELECT sub.question_id AS survey_log FROM sub WHERE sub.rate = (SELECT max(rate) FROM sub) LIMIT 1
WITH t AS ( SELECT question_id, SUM(action = 'answer') / SUM(action = 'show' OR action = 'skip') AS ans_rate FROM survey_log GROUP BY question_id ) SELECT question_id AS survey_log FROM t WHERE ans_rate = (SELECT MAX(ans_rate) FROM t)
WITH t1 AS ( SELECT question_id, ans_cnt/show_cnt ans_rate FROM ( SELECT question_id, SUM(CASE WHEN action='show' THEN 1 ELSE 0 END) show_cnt, SUM(CASE WHEN action='answer' THEN 1 ELSE 0 END) ans_cnt FROM survey_log GROUP BY 1 ) tmp ) SELECT question_id survey_log FROM t1 GROUP BY 1 ORDER BY ans_rate DESC LIMIT 1
WITH total_count AS ( SELECT question_id, COUNT(question_id) AS total FROM survey_log WHERE action = 'show' GROUP BY question_id ), answer_count AS ( SELECT question_id, COUNT(answer_id) as answer FROM survey_log WHERE action = 'answer' GROUP BY question_id ), tbl_rate AS ( SELECT total.question_id, total.total, IFNULL(answer.answer, 0), (answer.answer / total.total) AS rate FROM total_count AS total LEFT JOIN answer_count AS answer ON total.question_id = answer.question_id ) SELECT question_id AS survey_log FROM tbl_rate WHERE rate = (SELECT MAX(rate) FROM tbl_rate) LIMIT 1
With show_table as (Select question_id, count(survey_log.action) AS show_count from survey_log WHERE survey_log.action = 'show' group by question_id ), answer_table as (Select question_id, count(survey_log.action) AS answer_count from survey_log WHERE survey_log.action = 'answer' group by question_id), rate_table as (Select A.question_id, (B.answer_count/A.show_count) AS rate from show_table A left join answer_table B on A.question_id = B.question_id) Select question_id AS survey_log from rate_table order by rate DESC Limit 1
select a.question_id as survey_log from ( select question_id , sum(case when answer_id is null then 0 else 1 end)/count(question_id) as ans_rate from survey_log group by question_id order by 2 desc ) a limit 1
select a.question_id as survey_log from ( select question_id, SUM(CASE WHEN action = 'answer' and answer_id is not null THEN 1 ELSE 0 END)/SUM(CASE WHEN action in ('answer','show') THEN 1 ELSE 0 END) as ans_rate from survey_log group by 1 ) as a order by ans_rate desc limit 1
select distinct question_id as survey_log from (select a.question_id, rank() over (order by answers_ct/show_ct desc) as ratio_rank from (select question_id, count(*) as show_ct from survey_log where action = 'show' group by 1 ) a left join (select question_id, count(*) as answers_ct from survey_log where answer_id is not null group by 1) b on a.question_id = b.question_id ) x limit 1
select distinct question_id survey_log from survey_log group by 1 order by count(answer_id) desc limit 1
select distinct s.question_id survey_log from survey_log s left join ( select question_id, sum(if(action='answer',1,0))/sum(if(action='show',1,0)) fraction from survey_log group by question_id order by fraction desc limit 1 ) t on s.question_id=t.question_id where t.fraction is not null
select drv.question_id as survey_log from (select question_id, sum(case when action='answer' then 1 else 0 end) as ans_cnt, sum(case when action='show' then 1 else 0 end) as show_cnt from survey_log group by 1) as drv group by 1 order by sum(drv.ans_cnt/drv.show_cnt) desc limit 1
select question_id 'survey_log' from (select question_id, COUNT(case when action='show' then 1 end) qu, COUNT(case when action='answer' then 1 end) ans from survey_log group by question_id ) q order by (ans/qu) desc limit 1
select question_id 'survey_log' from (select question_id, row_number() over(order by rate desc) 'rank' from (select question_id, sum(case when action='answer' then 1 else 0 end)/sum(case when action='show' then 1 else 0 end) 'rate' from survey_log group by question_id) a )b where b.rank =1
select question_id AS survey_log from ( select question_id, ( sum(action = 'answer') / (sum(action = 'answer') + sum(action = 'show') ) ) as ans_sum from survey_log group by 1 ) AS TAB order by ans_sum desc limit 1
select question_id as "survey_log" from survey_log where action != "skip" group by question_id order by sum(case when action="answer" then 1 else 0 end)/count(*) DESC limit 1
select question_id as 'survey_Log' from( select distinct question_id, dense_rank() over(order by count(answer_id)/count(action) desc) as rk from survey_log group by 1 )temp where rk = 1
select question_id as 'survey_log' from survey_log GROUP BY question_id ORDER BY COUNT(answer_id) / SUM(IF(action = 'show', 1, 0)) DESC LIMIT 1
select question_id as 'survey_log' from survey_log group by question_id order by sum(case when action = 'answer' then 1 else 0 end) / count(*) desc limit 1
select question_id as `survey_log` from survey_log group by question_id order by sum(answer_id is not null) / count(*) DESC Limit 1
select question_id as survey_log FROM survey_log GROUP BY question_id ORDER BY SUM(action='answer')/sum(action='show') DESC LIMIT 1
select question_id as survey_log from ( (select question_id, sum(case when action = 'answer' then 1 else 0 end)/ sum(case when action= 'show' then 1 else 0 end) as answer_rate from survey_log group by 1 order by answer_Rate desc)) a limit 1
select question_id as survey_log from ( select question_id , sum(case when action = 'answer' then 1 else 0 end) / sum(case when action = 'show' then 1 else 0 end) as answer_rate from survey_log group by question_id order by answer_rate desc ) sub limit 1
select question_id as survey_log from ( select question_id, case when action = 'show' then 1 else 0 end as shows, case when action = 'answer' then 1 else 0 end as answers from survey_log group by question_id order by sum(answers)/sum(shows) desc) as tmp limit 1
select question_id as survey_log from ( select question_id, case when action='show' then 1 else 0 end as show_time, case when action='answer' then 1 else 0 end as answer_time from survey_log )a group by question_id order by sum(answer_time)/sum(show_time) desc limit 1
select question_id as survey_log from ( select question_id, case when show_ct = 0 then 0 else cast(answer_ct as float)/show_ct end as r from ( select question_id, sum(case when action = 'answer' then 1 else 0 end) as answer_ct, sum(case when action = 'show' then 1 else 0 end) as show_ct from survey_log group by question_id ) a) b order by r desc limit 1
select question_id as survey_log from ( select question_id, count(answer_id)/count(action) as ratio from survey_log group by 1) as temp group by 1 order by ratio desc limit 1
select question_id as survey_log from ( select question_id, count(case when action='answer' then 1 else null end)/count(distinct question_id) as 'rate' from survey_log group by 1 order by 2 desc) as t limit 1
select question_id as survey_log from ( select question_id, dense_rank() over(order by rate desc) as 'rank' from ( select question_id, rate from ( select question_id, (sum(action='answer')/count(action)) as rate from survey_log group by question_id order by rate desc) A)B) C where C.rank = 1
select question_id as survey_log from ( select question_id, rank() over (order by (count(answer_id)/count(action)) desc) as rk from survey_log group by 1) as temp where rk=1
select question_id as survey_log from ( select question_id, rank() over (order by (count(answer_id)/count(action)) desc) from survey_log group by 1 limit 1) as temp
select question_id as survey_log from ( select question_id, rank() over (order by sum(case when action = 'answer' then 1 else 0 end)/sum(1) desc) as rnk from survey_log group by 1 ) TBL where rnk = 1
select question_id as survey_log from ( select question_id, sum(action = 'answer') / sum(action = 'show') ratio from survey_log group by 1 ) f order by ratio desc limit 1
select question_id as survey_log from ( select question_id, sum(answer_id is not null) / sum(action = 'show') ans_ratio from survey_log group by 1 ) f order by ans_ratio desc limit 1
select question_id as survey_log from ( select question_id, sum(answer_id is not null) / sum(action = 'show') ratio from survey_log group by 1 ) f order by ratio desc limit 1
select question_id as survey_log from ( select question_id, sum(answer_id is not null)/sum(action = 'show') as survey_rate from survey_log group by question_id) s order by survey_rate desc limit 1
select question_id as survey_log from ( select question_id, sum(case when action = "show" then 1 else 0 end) as show_num, sum(case when action ="answer" then 1 else 0 end) as ans_num from survey_log group by question_id ) as temp order by (ans_num/show_num) desc limit 1
select question_id as survey_log from ( select question_id, sum(case when action='show' then 1 else 0 end) num_show, sum(case when action='answer' then 1 else 0 end) num_answer from survey_log group by question_id ) temp order by num_answer/num_show desc limit 1
select question_id as survey_log from ( select show_t / total as ratio, t1.question_id from ( select count(action) as show_t, question_id from survey_log where action = 'answer' group by question_id ) t1 left join ( select count(action) as total, question_id from survey_log group by question_id ) t2 on t1.question_id = t2.question_id ) t3 order by ratio desc limit 1
select question_id as survey_log from (select distinct question_id, count(case when action='answer' then 1 end) over(partition by question_id) as answered_times_per_question from survey_log) t order by answered_times_per_question desc limit 1
select question_id as survey_log from (select question_id ,sum(case when answer_id is not null then 1 else 0 end) *100 /sum(case when answer_id is null then 1 else 0 end) as show_cnt from survey_log where action in ('show','answer') group by question_id )sub order by show_cnt desc LIMIT 1
select question_id as survey_log from (select question_id, (SUM(case when `action` = 'answer' then 1 else 0 end)/ SUM(case when action = 'show' then 1 else 0 end)) as answer_rate from survey_log group by question_id) c order by answer_rate desc limit 1
select question_id as survey_log from (select question_id, answer_rate, rank() over (order by answer_rate desc) as answer_rate_rank from (select question_id, answers/t_answers as answer_rate from (select question_id, count(answer_id) as answers from survey_log group by 1) a1 cross join (select count(answer_id) as t_answers from survey_log) a2) b) c where answer_rate_rank = 1
select question_id as survey_log from (select question_id, count(answer_id)/count(action = 'show') as rate from survey_log group by question_id order by rate desc limit 1) as temp
select question_id as survey_log from (select question_id, count(answer_id)/sum(if(action = 'show', 1, 0)) as rate from survey_log group by question_id order by rate desc limit 1) as temp
select question_id as survey_log from (select question_id, rank() over (order by count(answer_id)/count(action) desc) as rk from survey_log group by 1)s where rk = 1
select question_id as survey_log from (select question_id, sum(action = "answer") / sum(1) as ratio from survey_log group by question_id)a order by ratio desc limit 1
select question_id as survey_log from (select question_id, sum(answer_id is not null) / sum(action = 'show') ans_ratio from survey_log group by question_id) t order by ans_ratio desc limit 1
select question_id as survey_log from (select question_id, sum(answer_id is not null)/sum(action='show') as rate from survey_log group by question_id) as t1 order by rate desc limit 1
select question_id as survey_log from (select question_id, sum(case when action = "show" then 1 else 0 end) as question, sum(case when action = "answer" then 1 else 0 end) as ans from survey_log group by 1) a order by ans/question desc limit 1
select question_id as survey_log from (select question_id, sum(case when action = 'answer' then 1 else 0 end) as ans, sum(case when action='show' then 1 else 0 end) as showed from survey_log group by question_id) b order by (b.ans/b.showed) desc limit 1
select question_id as survey_log from (select question_id, sum(case when action = 'answer' then 1 else 0 end) as ans_cnt, sum(case when action = 'show' then 1 else 0 end) as total_cnt from survey_log group by question_id) tb order by (ans_cnt/total_cnt) desc limit 1
select question_id as survey_log from (select question_id, sum(case when action = 'answer' then 1 else 0 end) as num from survey_log group by question_id order by num desc limit 1) a
select question_id as survey_log from (select question_id, sum(case when action = 'show' then 1 else 0 end) as showcount, sum(case when action = 'answer' then 1 else 0 end) as answercount from survey_log group by question_id) t order by answercount/showcount desc limit 1
select question_id as survey_log from (select question_id, sum(case when action='show' then 1 else 0 end) as show_num, sum(case when action='answer' then 1 else 0 end) as ans_num from survey_log group by question_id) T order by (ans_num/show_num) desc limit 1
select question_id as survey_log from (select question_id, sum(if(action='show',1,0)) as num_show, sum(if(action='answer',1,0)) as num_answer from survey_log group by question_id) t order by (num_answer/num_show) desc limit 1
select question_id as survey_log from survey_log group by 1 order by sum(case when action='answer' then 1 else 0 end)/ sum(case when action='show' then 1 else 0 end) desc limit 1
select question_id as survey_log from survey_log group by question_id having count(answer_id) >0 order by count(answer_id) desc limit 1
select question_id as survey_log from survey_log group by question_id order by (count(case when action= "answer" then answer_id else null end) / count(case when action= "show" then 1 else null end)) desc limit 1
select question_id as survey_log from survey_log group by question_id order by SUM(action = 'answer')/ SUM(IF(action = 'show', 1, 0)) desc limit 1
select question_id as survey_log from survey_log group by question_id order by count(answer_id)/sum(if(action='show',1,0)) desc limit 1
select question_id as survey_log from survey_log group by question_id order by ifnull(count(answer_id), 0)/sum(case when action = 'show' then 1 else 0 end) desc limit 1
select question_id as survey_log from survey_log group by question_id order by ifnull(count(answer_id)/count(distinct question_id), 0) desc limit 1
select question_id as survey_log from survey_log group by question_id order by sum(action = 'answer') / sum(action = 'show') desc limit 1
select question_id as survey_log from survey_log group by question_id order by sum(action = 'answer')/count(action) desc limit 1
select question_id as survey_log from survey_log group by question_id order by sum(case when action = 'answer' then 1 else 0 end) / sum(case when action = 'show' then 1 else 0 end) desc limit 1
select question_id as survey_log from survey_log group by question_id order by sum(case when action = 'answer' then 1 else 0 end)/ sum(case when action = 'show' then 1 else 0 end) desc limit 1
select question_id as survey_log from survey_log group by question_id order by sum(case when action="answer" then 1 else 0 end) desc limit 1
select question_id as survey_log from survey_log group by question_id order by sum(if(action = 'answer',1,0))/sum(if(action = 'show', 1, 0)) desc limit 1
select question_id as survey_log from survey_log where action = 'answer' group by question_id order by count(question_id) desc limit 1
select question_id as survey_log from survey_log where answer_id IS NOT NULL group by question_id order by count(answer_id) desc limit 1
select question_id as survey_log from( select question_id, dense_rank()over(order by (coalesce(sum(case when action = 'answer' then 1 else 0 end),0)/count(distinct question_id))desc) as answer_rate from survey_log group by question_id )tmp where answer_rate = 1
select question_id as survey_log from( select question_id, rank() over (order by count desc) as rank1 from( select question_id, count(answer_id) as count from survey_log group by question_id) as d ) as d where rank1 = 1
select question_id as survey_log from( select question_id, rank() over (order by count desc) from( select question_id, count(answer_id) as count from survey_log group by question_id) as d limit 1) as d
select question_id as survey_log from( select question_id, ratio, count_tol, dense_rank() OVER (partition by ratio order by count_tol desc) as ranks from ( select a.question_id, ans_tol * 1.0 / count_tol as ratio, count_tol from (select question_id, count(distinct id) as count_tol from survey_log group by question_id) a left join (select question_id, count(answer_id) as ans_tol from survey_log group by question_id) b on a.question_id = b.question_id ) c order by ratio desc ) d where ranks = 1 order by ratio desc limit 1
select question_id as survey_log from( select question_id, sum(case when action = 'answer' then 1 else 0 end)/sum(case when action = 'show' then 1 else 0 end) as fraction from survey_log group by question_id ) asd order by fraction desc limit 1
select question_id survey_log from ( select question_id, sum(case when action = 'answer' then 1 else 0 end)/sum(case when action = 'show' then 1 else 0 end) ratio from survey_log group by question_id order by ratio desc) r limit 1
select question_id survey_log from ( select question_id, sum(case when action="answer" then 1 else 0 end)/sum(case when action = "show" then 1 else 0 end) rate from survey_log group by question_id ) T order by rate desc limit 1
select question_id survey_log from ( select question_id, sum(case when answer_id is not null then 1 else 0 end)/count(distinct id) as q_rate from survey_log group by 1 order by 2 DESC limit 1) a
select question_id survey_log from (select question_id, avg(case when action = 'answer' then 1 else 0 end) avg_ans from survey_log group by question_id) t order by avg_ans desc limit 1
select question_id survey_log from (select question_id, count(case when action='answer' then action else null end) / count(case when action='show' then action else null end) rate from survey_log group by question_id) a order by rate desc limit 1
select question_id survey_log from survey_log group by question_id order by sum(answer_id is not null)/sum(action='show') desc limit 1
select question_id survey_log from survey_log where answer_id is not null group by question_id order by count(*) desc limit 1
select question_id survey_log from survey_log where answer_id is not null group by question_id order by count(1) desc limit 1
select s.question_id as survey_log from ( select question_id, count(answer_id) as answer_time from survey_log group by question_id ) as s order by s.answer_time desc limit 1
select s.question_id as survey_log from survey_log s group by s.question_id order by (sum(s.action='answer')/sum(action='show')) desc limit 1
select s.question_id survey_log from survey_log s where answer_id is not null group by s.question_id order by count(1) desc limit 1
select sl.question_id as survey_log from survey_log sl join (select question_id, count(question_id) as tqcnt from survey_log where action = 'show' group by question_id ) as sq on sl.question_id = sq.question_id group by sl.question_id order by (count(sl.answer_id)/sq.tqcnt) DESC limit 1
select survey_log from ( select question_id as survey_log, count(answer_id) from survey_log group by 1 order by 2 desc limit 1 )a
select survey_log from (select question_id as survey_log ,rank() over (order by count(answer_id)/count(action) desc) as ranks from survey_log group by 1 ) t1 where ranks=1
select survey_log from (select question_id as survey_log, count(case when action = 'answer' then action end) / count(case when action = 'show' then action end) as ratio from survey_log group by 1 order by 2 desc limit 1) cte
select survey_log from (select question_id as survey_log, sum(case when action='answer' then 1 else 0 end)/sum(case when action='show' then 1 else 0 end) as answer_rate from survey_log group by question_id) a order by answer_rate DESC limit 1
select survey_log from (select sum(if(action='answer',1,0)) as cnt, question_id as survey_log, dense_rank() over(order by sum(if(action='answer',1,0)) desc) as r from survey_log group by 2) aaa where r = 1
select t1.question_id as survey_log from (select question_id, IFNULL(sum(CASE WHEN action='answer' then 1 else 0 end)/sum(CASE WHEN action='show' then 1 else 0 end),0) as answer_rate from survey_log group by question_id order by answer_rate desc limit 1 ) as t1
select t1.question_id survey_log from (select question_id, count(*) answer_count from survey_log where answer_id is not null group by id, question_id) t1 join (select question_id, count(*) total_count from survey_log where action = 'show' group by id, question_id) t2 on t1.question_id = t2.question_id order by answer_count/total_count desc limit 1
select tb.question_id as survey_log from (select question_id, sum(case when action='answer' then 1 else 0 end) as num_answer, sum(case when action='show' then 1 else 0 end) as num_show from survey_log group by question_id ) tb order by (num_answer/num_show) desc limit 1
select tb.question_id as survey_log from (select question_id, sum(case when s.action in ('answer') then 1 else 0 end)/sum(case when s.action in ('show') then 1 else 0 end) as ar from survey_log as s group by 1 order by 2 desc limit 1) tb
select z.question_id as survey_log from ( select question_id,sum(case when answer_id is not NULL then 1 else 0 end)/sum(case when action ='show' then 1 else 0 end) as rate from survey_log group by 1) z order by z.rate desc limit 1
with CTE as ( select question_id, round((1.0*sum(case when action='answer' then 1 else 0 end))/sum(case when action='show' then 1 end),2) as ratio from survey_log group by question_id) select question_id as survey_log from CTE order by ratio desc limit 1
with CTE1 as ( SELECT *, CASE WHEN action = 'answer' THEN 1 ELSE 0 END AS answer_stats, CASE WHEN action IN ('show', 'skip') THEN 1 ELSE 0 END AS show_stats FROM survey_log), CTE2 as ( SELECT question_id, SUM(answer_stats)/ SUM(show_stats) AS answer_rate FROM CTE1 GROUP BY question_id) SELECT question_id AS survey_log FROM CTE2 WHERE answer_rate = (SELECT MAX(answer_rate) FROM CTE2)
with a as ( select question_id, sum(case when action = 'answer' then 1 else 0 end) as answer_tot, sum(case when action = 'show' then 1 else 0 end) as show_tot from survey_log group by 1) select question_id as survey_log from a order by (answer_tot/show_tot) desc limit 1
with a as( select question_id, case when answer_id !='null' then 1 else 0 end as if_answered from survey_log) select question_id as survey_log from a group by 1 order by avg(if_answered) desc limit 1
with ans_table as (select question_id, count(*) as ans from survey_log where action = "answer" group by question_id, id), show_table as (select question_id, count(*) as sho from survey_log where action = "show" group by question_id, id ) , temp as (select a.question_id, a.ans/s.sho as ans_rate from ans_table a inner join show_table s on a.question_id = s.question_id) select distinct question_id as survey_log from temp order by ans_rate desc limit 1
with answer_rate_df as ( select question_id, count(answer_id)/count(*) as answer_rate from survey_log group by question_id ) select question_id as survey_log from answer_rate_df where answer_rate = (select max(answer_rate) from answer_rate_df)
with answerrate as( select question_id ,sum(case when answer_id is not null then 1 else 0 end)/sum(case when answer_id is null then 1 else 0 end) as answer_rate from survey_log group by question_id ) select question_id as survey_log from answerrate where answer_rate = ( select max(answer_rate) from answerrate )
with answers as ( select count(case when answer_id is not null then answer_id end)/count( case when action in ('show','skip') then question_id end) as answer_rate, question_id from survey_log group by question_id ) select question_id as survey_log from answers where answer_rate in (select max(answer_rate) from answers)
with answers as ( select count(case when answer_id is not null then answer_id end)/count( case when action in ('show','skip') then question_id end) as answer_rate, question_id from survey_log group by question_id ) select question_id as survey_log from answers where question_id in (select question_id from answers where answer_rate in (select max(answer_rate) from answers))
with answers as ( select question_id, count(answer_id) as answers from survey_log sl group by 1 ) , questions as ( select question_id, count(distinct id) as questions from survey_log sl where action = 'show' group by 1 ) , answer_rate as ( select q.question_id, answers/questions as answr_rate from questions q left join answers a on a.question_id = q.question_id ) select distinct question_id as survey_log from answer_rate ar where answr_rate = (select max(answr_rate) from answer_rate) order by answr_rate desc limit 1
with b as (select question_id, case when answer_id is null then 0 else 1 end as a, 1 as overall_response from survey_log) , c as ( select question_id, sum(a)/sum(overall_response) as rate from b group by question_id ) select question_id as survey_log from c where rate order by rate desc limit 1
with cases as ( select question_id,count(case when answer_id is not null then question_id end) as answered, count(case when action = 'show' then question_id end) as shown from survey_log group by question_id ) select distinct question_id as survey_log from cases group by 1 order by max(answered/shown) desc limit 1
with count_answer as ( SELECT question_id, COUNT(action) OVER(PARTITION BY question_id) As count_ans FROM survey_log WHERE action = 'answer' ), count_tot as ( SELECT question_id, COUNT(action) OVER(PARTITION BY question_id) As count_tot FROM survey_log) SELECT question_id As 'survey_log' FROM ( SELECT a.question_id, a.count_ans/t.count_tot As 'answer_rate' FROM count_answer a JOIN count_tot t ORDER BY answer_rate DESC LIMIT 1) As t
with cte as ( select distinct question_id, count(case when action='answer' then 1 end) over (partition by question_id) sum_answer_id from survey_log) select question_id as survey_log from cte order by sum_answer_id desc limit 1
with cte as ( select question_id, (sum(case when answer_id is null then 0 else 1 end) / count(*)) as answer_rate from survey_log group by 1 ) select question_id as survey_log from cte where answer_rate = (select max(answer_rate) from cte)
with cte as ( select question_id, sum(action ='answer')/ sum(action = 'show') as ratio from survey_log group by 1 order by 2 desc limit 1 ) select question_id as survey_log from cte
with cte as ( select question_id, sum(action ='answer')/sum(if(action='show',1,0)) as rate from survey_log group by question_id) select question_id as survey_log from cte where rate = (select max(rate) from cte) limit 1
with cte as ( select question_id, sum(case when action = "answer" then 1 else 0 end)/sum(case when action = "show" then 1 else 0 end) as rate from survey_log group by question_id ) select question_id as survey_log from cte order by rate desc limit 1
with cte as (Select question_id, sum(action = "answer") / count(action = "show") as cnt from survey_log group by question_id ) Select question_id as survey_log from cte order by cnt desc limit 1
with cte as (select question_id, sum(action = 'answer') /sum(action='show') as answer_rate from survey_log group by question_id order by 2 desc ) select question_id as survey_log from cte limit 1
with cte as (select question_id, sum(answer_id is not null) /sum(action='show') as answer_rate from survey_log group by question_id order by 2 desc ) select question_id as survey_log from cte limit 1
with cte as (select question_id, sum(case when action = "answer" then 1 else 0 end) / sum(case when action = "show" then 1 else 0 end) as answer_rate from survey_log group by question_id order by answer_rate desc) select question_id as survey_log from cte limit 1
with cte as (select question_id, sum(case when action ='answer' then 1 else 0 end) as answer_num, sum(case when action ='show' then 1 else 0 end) as show_num from survey_log group by question_id) select question_id as survey_log from cte order by answer_num/show_num desc Limit 1
with cte as (select question_id, sum(case when action='answer' then 1 end)/sum(case when action='show' then 1 end) as answer_rate from survey_log group by question_id) select question_id as survey_log from cte where answer_rate=(select max(answer_rate) from cte) order by question_id limit 1
with cte as( select question_id, count(case when answer_id is not null then 1 else null end) as answercnt, count(case when action ='show' then 1 else null end) as showcnt from survey_log group by 1 ) select a.survey_log from (select question_id as survey_log, answercnt/showcnt as ratio from cte order by 2 desc limit 1) as a
with cte as( select question_id, sum(case when action = 'answer' then 1 else 0 end) as rate from survey_log group by question_id ) select question_id 'survey_log' from cte order by rate desc limit 1
with cte as( select question_id, sum(case when action='answer' then 1 else 0 end)/sum(case when action='show' then 1 else 0 end)as ratio from survey_log group by question_id) select question_id as survey_log from cte order by ratio desc limit 1
with cte as(select question_id, sum(if(answer_id is null,0,1)) as answer_num, count(distinct id) as user_num from survey_log group by 1) select question_id as survey_log from (select question_id, answer_num/user_num as answer_rate from cte group by 1) as new order by answer_rate desc limit 1
with cte1 as ( select question_id, case when action = "answer" then 1 else 0 end flagging from survey_log ), cte2 as ( select question_id, count(question_id) count_val from cte1 where flagging = 1 group by question_id order by count_val desc ) select question_id as survey_log from cte2 having max(count_val)
with cte_answer as ( select question_id,coalesce(count(answer_id),0) as ans from survey_log where action='answer' group by question_id ), cte_question as ( select question_id, count(question_id) as shown from survey_log where action='show' group by question_id ), cte_answerrate as ( select q.question_id, ans,shown, coalesce((ans/shown),0) as answer_rate from cte_question q left join cte_answer a on q.question_id = a.question_id ) select question_id as survey_log from (select question_id, rank() over(order by answer_rate desc,shown desc) as rnk from cte_answerrate)x where rnk =1
with s as ( select count(1) as n,question_id from survey_log where action = 'show' or action ='skip' group by question_id) , a as ( select count(1)as n,question_id from survey_log where action = 'answer' group by question_id) select a.question_id as survey_log from s join a on a.question_id = s.question_id where a.n/s.n = (select max(a.n/s.n) from s join a on a.question_id = s.question_id)
with temp as ( select question_id, sum(case when answer_id IS NOT NULL THEN 1 else 0 end) as answered from survey_log group by question_id ) select question_id as survey_log from temp order by answered desc limit 1
with temp as (select question_id, count(case when action = 'answer' then 1 end)/count(*) as total from survey_log group by question_id order by 2 desc) select question_id as survey_log from temp limit 1
with temp as (select question_id, sum(case when answer_id is not null then 1 else 0 end)/count(*) as rate from survey_log group by question_id) select question_id as survey_log from temp where rate in (select max(rate) from temp)
with temp as( select question_id, count(answer_id), count(action) , rank() over (order by (count(answer_id)/count(action)) desc) from survey_log group by 1 limit 1) select question_id as survey_log from temp
with temp as(select distinct question_id, count(answer_id) over (partition by question_id) as ct from survey_log) select question_id as survey_log from temp order by ct desc limit 1
with temp as(select question_id, count(answer_id)/count(question_id) as fraction from survey_log group by 1) select question_id as survey_log from temp where fraction in (select max(fraction) from temp)
with tmp as (select question_id, count(case when action = 'answer' then answer_id else null end ) * 100.0 / count(*) as answer_rate from survey_log group by 1) , tmp2 as( select question_id as survey_log, dense_rank() over ( order by answer_rate desc ) as ranks from tmp ) select survey_log from tmp2 where ranks = 1 group by 1
with tmp as (select question_id, sum(if(action='answer', 1, 0))/sum(if(action='show', 1, 0)) rate from survey_log group by question_id) select question_id survey_log from tmp order by rate desc limit 1
with tmptable as( select *, sum(case when answer_id is not Null then 1 else 0 end) / count(*) as rate from survey_log group by question_id) select question_id as survey_log from tmptable where rate in (select max(rate) from tmptable)
