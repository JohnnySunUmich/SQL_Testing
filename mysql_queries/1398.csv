SELECT * FROM Customers WHERE customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'A' ) AND customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'B' ) AND customer_id NOT IN ( SELECT customer_id FROM Orders WHERE product_name = 'C' )
SELECT * FROM Customers WHERE customer_id IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'C')
SELECT * FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C') ORDER BY customer_id
SELECT * FROM Customers WHERE customer_id in (SELECT customer_id FROM Orders WHERE product_name = 'A') AND customer_id in (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id not in (SELECT customer_id FROM Orders WHERE product_name = 'C') ORDER BY customer_id
SELECT C.customer_id, C.customer_name FROM Customers AS C LEFT JOIN Orders AS O ON C.customer_id = O.customer_id GROUP BY C.customer_id HAVING SUM( O.product_name = 'A' ) > 0 AND SUM( O.product_name = 'B' ) > 0 AND SUM( O.product_name = 'C' ) = 0 ORDER BY C.customer_id
SELECT C.customer_id, C.customer_name FROM Customers AS C LEFT JOIN Orders AS O ON C.customer_id = O.customer_id GROUP BY C.customer_id HAVING SUM(O.product_name = 'A') > 0 AND SUM(O.product_name = 'B') > 0 AND SUM(O.product_name = 'C') = 0 ORDER BY C.customer_id
SELECT C.customer_id, C.customer_name FROM Customers C, Orders O WHERE C.customer_id = O.customer_id GROUP BY 1 HAVING SUM(O.product_name = 'A') > 0 AND SUM(O.product_name = 'B') > 0 AND SUM(O.product_name ='C') =0
SELECT DISTINCT C.customer_id AS CUSTOMER_ID ,C.customer_name AS CUSTOMER_NAME FROM Customers C inner join Orders O on C.customer_id=O.customer_id WHERE C.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name ='C') and C.customer_id IN (SELECT customer_id FROM Orders WHERE product_name ='A') and C.customer_id IN (SELECT customer_id FROM Orders WHERE product_name ='B')
SELECT DISTINCT C.customer_id, C.customer_name FROM Customers C JOIN Orders O ON C.customer_id = O.customer_id GROUP BY C.customer_id HAVING SUM(product_name = "A") > 0 AND SUM(product_name = "B") > 0 AND SUM(product_name = "C") = 0
SELECT DISTINCT C.customer_id, C.customer_name FROM Customers C JOIN Orders O ON C.customer_id = O.customer_id WHERE C.customer_id in (SELECT D.customer_id from Customers D JOIN Orders E on D.customer_id = E.customer_id WHERE E.product_name= 'A') AND C.customer_id in (SELECT D.customer_id from Customers D JOIN Orders E on D.customer_id = E.customer_id WHERE E.product_name= 'B') AND C.customer_id not in (SELECT D.customer_id from Customers D JOIN Orders E on D.customer_id = E.customer_id WHERE E.product_name= 'C') ORDER BY C.customer_id
SELECT DISTINCT Customers.customer_id, Customers.customer_name FROM Orders JOIN Customers ON Orders.customer_id = Customers.customer_id WHERE Customers.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND Customers.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND Customers.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT Customers.customer_id, Customers.customer_name FROM Orders LEFT JOIN Customers ON Orders.customer_id = Customers.customer_id WHERE Customers.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A' ) AND Customers.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND Customers.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT a.customer_id, c.customer_name FROM (SELECT o1.customer_id FROM orders o1 WHERE o1.product_name = 'A') a JOIN (SELECT o2.customer_id FROM orders o2 WHERE o2.product_name = 'B') b ON a.customer_id = b.customer_id JOIN customers c ON a.customer_id = c.customer_id WHERE a.customer_id NOT IN (SELECT o3.customer_id FROM orders o3 WHERE o3.product_name = 'C')
SELECT DISTINCT b.customer_id, b.customer_name FROM Orders a JOIN Customers b ON a.customer_id = b.customer_id WHERE a.customer_id NOT IN (select customer_id FROM Orders WHERE product_name = 'C') AND a.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND a.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B')
SELECT DISTINCT c.customer_id, c.customer_name FROM Customers c WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name='A' ) AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name='B' ) AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name='C' )
SELECT DISTINCT c.customer_id, c.customer_name FROM customers AS c INNER JOIN orders AS o ON c.customer_id = o.customer_id WHERE product_name = "A" AND c.customer_id in (SELECT o.customer_id FROM orders AS o WHERE product_name = "B") AND c.customer_id not in (SELECT o.customer_id FROM orders AS o WHERE product_name = "C")
SELECT DISTINCT c.customer_id, customer_name FROM customers c WHERE c.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND c.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND c.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT c.customer_id, customer_name FROM orders o LEFT JOIN customers c ON o.customer_id = c.customer_id WHERE c.customer_id NOT IN (SELECT customer_id FROM orders WHERE product_name = 'C') AND c.customer_id IN (SELECT customer_id FROM orders WHERE product_name = 'A') AND c.customer_id IN (SELECT customer_id FROM orders WHERE product_name = 'B')
SELECT DISTINCT customer_id , customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT customer_id , customer_name FROM Orders LEFT JOIN Customers USING(customer_id) WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT customer_id, customer_name FROM Customers WHERE customer_id in ( SELECT customer_id FROM Orders GROUP BY customer_id HAVING SUM(product_name = 'A') > 0 AND SUM(product_name = 'B') > 0 AND SUM(product_name = 'C') = 0 )
SELECT DISTINCT customer_id, customer_name FROM customers WHERE customer_id IN ( SELECT customer_id FROM orders WHERE product_name = 'A' ) AND customer_id IN ( SELECT customer_id FROM orders WHERE product_name = 'B' ) AND customer_id NOT IN ( SELECT customer_id FROM orders WHERE product_name = 'C' )
SELECT DISTINCT o.customer_id AS CUSTOMER_ID,c.customer_name AS CUSTOMER_NAME FROM Orders o LEFT JOIN Customers c ON o.customer_id=c.customer_id WHERE o.customer_id IN (SELECT customer_id FROM Orders WHERE product_name='A' ) AND o.customer_id IN (SELECT customer_id FROM Orders WHERE product_name='B' ) AND o.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name='C' )
SELECT DISTINCT o.customer_id AS customer_id, c.customer_name FROM orders o JOIN customers c ON o.customer_id = c.customer_id WHERE o.customer_id IN (SELECT DISTINCT customer_id FROM orders WHERE product_name = 'A') AND o.customer_id IN ( SELECT DISTINCT customer_id FROM orders WHERE product_name = 'B') AND o.customer_id NOT IN ( SELECT DISTINCT customer_id FROM orders WHERE product_name = 'C') ORDER BY customer_id
SELECT DISTINCT o.customer_id, c.customer_name FROM Orders AS o LEFT JOIN Customers AS c ON o.customer_id = c.customer_id WHERE (o.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = "B") AND o.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = "A")) AND o.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = "C") ORDER BY customer_id
SELECT DISTINCT o.customer_id, c.customer_name FROM Orders o LEFT JOIN Customers c ON o.customer_id = c.customer_id WHERE o.customer_id IN (SELECT customer_id FROM (SELECT customer_id, SUM(CASE WHEN product_name = 'A' OR product_name = 'B' THEN 1 ELSE 0 END) AS `both` FROM Orders GROUP BY customer_id) AS b WHERE `both` >= 2) AND o.customer_id NOT IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT o.customer_id, c.customer_name FROM orders o JOIN customers c ON o.customer_id = c.customer_id WHERE o.product_name IN ('A', 'B') AND o.customer_id NOT IN (SELECT customer_id FROM orders WHERE product_name = 'C') GROUP BY o.customer_id HAVING COUNT(o.customer_id) > 1
SELECT DISTINCT(customer_id), customer_name FROM Orders JOIN Customers USING (customer_id ) WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT DISTINCT(o.customer_id),c.customer_name FROM orders o join customers c ON o.customer_id = c.customer_id WHERE o.customer_id in (SELECT customer_id FROM orders WHERE product_name='A') AND o.customer_id in (SELECT customer_id FROM orders WHERE product_name='B') AND o.customer_id NOT IN (SELECT customer_id FROM orders WHERE product_name='C')
SELECT Orders.customer_id, customer_name FROM Orders LEFT JOIN Customers ON Customers.customer_id = Orders.customer_id WHERE product_name = "A" AND Orders.customer_id IN (SELECT customer_id FROM Orders WHERE product_name = "B") AND Orders.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = "C")
SELECT P.customer_id, C.customer_name FROM ( SELECT group_concat(DISTINCT product_name) AS allproducts, customer_id FROM orders GROUP BY customer_id ) P JOIN Customers C ON P.customer_id = C.customer_id WHERE P.allproducts LIKE '%A%B%' AND P.allproducts NOT LIKE '%C%'
SELECT T.customer_id, customer_name FROM ( SELECT customer_id, SUM(CASE WHEN product_name IN ("A", "B") THEN 1 WHEN product_name = "C" THEN -1 ELSE 0 END) AS Point FROM Orders GROUP BY customer_id) AS T JOIN Customers AS C ON T.customer_id = C.customer_id WHERE Point = 2 ORDER BY customer_id
SELECT a.customer_id, b.customer_name from (select customer_id, sum(case when product_name='A' then 1 when product_name='B' then 10 when product_name='C' then 100 ELSE 0 end) as product_score from Orders group by customer_id ) a left join Customers b on a.customer_id=b.customer_id where a.product_score=11
SELECT a.customer_id, cust.customer_name FROM ( SELECT customer_id FROM Orders WHERE product_name = 'A' ) a INNER JOIN ( SELECT customer_id FROM Orders WHERE product_name = 'B' ) b ON a.customer_id = b.customer_id INNER JOIN Customers cust ON a.customer_id = cust.customer_id WHERE a.customer_id NOT IN ( SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'C' )
SELECT c.customer_id, c.customer_name FROM (SELECT customer_id, group_concat(product_name) as product_names FROM Orders o GROUP BY 1 HAVING product_names LIKE '%A%' AND product_names LIKE '%B%' AND product_names NOT LIKE '%C%' ) o JOIN Customers c ON c.customer_id = o.customer_id
SELECT c.customer_id, c.customer_name FROM Customers c JOIN Orders a ON a.customer_id = c.customer_id AND a.product_name = "A" JOIN Orders b ON b.customer_id = c.customer_id AND b.product_name = "B" LEFT JOIN Orders o on o.customer_id = c.customer_id AND o.product_name = "C" WHERE o.order_id IS NULL
SELECT c.customer_id, c.customer_name FROM Customers c JOIN Orders a ON a.customer_id = c.customer_id AND a.product_name = "A" JOIN Orders b ON b.customer_id = c.customer_id AND b.product_name = "B" LEFT OUTER JOIN Orders o on o.customer_id = c.customer_id AND o.product_name = "C" WHERE o.order_id IS NULL
SELECT c.customer_id, c.customer_name FROM Customers c JOIN Orders o USING(customer_id) GROUP BY c.customer_id HAVING SUM(o.product_name = 'A') > 0 AND SUM(o.product_name = 'B') > 0 AND SUM(o.product_name = 'C') = 0
SELECT c.customer_id, c.customer_name FROM Customers c WHERE c.customer_id IN ( SELECT o.customer_id FROM Orders o WHERE o.product_name = 'A') AND c.customer_id IN ( SELECT o.customer_id FROM Orders o WHERE o.product_name = 'B') AND c.customer_id NOT IN ( SELECT o.customer_id FROM Orders o WHERE o.product_name = 'C') ORDER BY c.customer_id ASC
SELECT c.customer_id, c.customer_name FROM Customers c WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name='A' ) AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name='B' ) AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name='C' )
SELECT c.customer_id, c.customer_name FROM Customers c, Orders o WHERE c.customer_id = o.customer_id GROUP BY c.customer_id HAVING SUM(o.product_name = 'A') > 0 AND SUM(o.product_name = 'B') > 0 AND SUM(o.product_name = 'C') = 0
SELECT c.customer_id, c.customer_name FROM Orders as o INNER JOIN Customers as c ON o.customer_id = c.customer_id WHERE product_name in ('A','B') AND c.customer_id not in ( SELECT DISTINCT customer_id FROM orders WHERE product_name = 'C' ) GROUP BY c.customer_id , c.customer_name HAVING COUNT(c.customer_name)=2
SELECT c.customer_id, c.customer_name FROM Orders o LEFT JOIN Customers c ON o.customer_id = c.customer_id GROUP BY o.customer_id HAVING SUM(O.product_name = 'A') > 0 AND SUM(O.product_name = 'B') > 0 AND SUM(O.product_name = 'C') = 0 ORDER BY o.customer_id
SELECT c.customer_id, c.customer_name FROM customers AS c WHERE EXISTS(SELECT * FROM orders WHERE customer_id = c.customer_id AND product_name = 'A') AND EXISTS(SELECT * FROM orders WHERE customer_id = c.customer_id AND product_name = 'B') AND NOT EXISTS(SELECT * FROM orders WHERE customer_id = c.customer_id AND product_name = 'C') ORDER BY c.customer_id
SELECT c.customer_id, c.customer_name from Customers c INNER JOIN (SELECT customer_id,SUM( CASE WHEN product_name = 'A' THEN 1 Else 0 End ) as 'A', SUM(CASE WHEN product_name = 'B' THEN 1 Else 0 End) as 'B', SUM(CASE WHEN product_name = 'C' THEN 1 Else 0 End) as 'C' FROM ORDERS GROUP BY customer_id) o ON c.Customer_id = o.Customer_id where o.A >= 1 and o.B >= 1 and o.C = 0
SELECT c.customer_id, customer_name FROM Customers c LEFT JOIN ( SELECT customer_id, GROUP_CONCAT(product_name) AS products FROM Orders GROUP BY customer_id) cc ON cc.customer_id = c.customer_id WHERE products LIKE '%A%' AND products LIKE '%B%' AND products NOT LIKE '%C%'
SELECT c.customer_id, customer_name FROM Customers c LEFT JOIN Orders o ON c.customer_id = o.customer_id GROUP BY 1 HAVING SUM(CASE WHEN o.product_name = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN o.product_name = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN o.product_name = 'C' THEN 1 ELSE 0 END) = 0 ORDER BY 1
SELECT customer_id , customer_name FROM Customers WHERE customer_id NOT IN (SELECT DISTINCT(customer_id) FROM Orders WHERE product_name = 'C' ) AND customer_id IN (SELECT DISTINCT(customer_id) FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT DISTINCT(customer_id) FROM Orders WHERE product_name = 'B') ORDER BY customer_id
SELECT customer_id, customer_name FROM ( SELECT c.customer_id, c.customer_name, SUM(CASE WHEN product_name IN ('A', 'B') THEN 1 WHEN product_name IN ('C') THEN -1 END) AS Score FROM Customers c LEFT JOIN Orders o ON c.customer_id = o.customer_id GROUP BY 1,2)a WHERE Score = 2
SELECT customer_id, customer_name FROM (SELECT O.customer_id, C.customer_name, GROUP_CONCAT(DISTINCT O.product_name ORDER BY product_name) AS products FROM Orders O LEFT JOIN Customers C ON O.customer_id = C.customer_id GROUP BY O.customer_id, C.customer_name) AS cust_orders WHERE products NOT LIKE '%C%' AND products LIKE '%A,B%'
SELECT customer_id, customer_name FROM (SELECT Orders.customer_id, Customers.customer_name, Orders.product_name FROM Orders INNER JOIN Customers ON Orders.customer_id = Customers.customer_id) AS tb1 GROUP BY customer_id HAVING SUM(product_name = 'A') >0 AND SUM(product_name = 'B') >0 AND SUM(product_name = 'C') =0
SELECT customer_id, customer_name FROM Customers WHERE ( customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') ) AND ( customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') ) AND ( customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C') )
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'A' ) AND customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'B' ) AND customer_id NOT IN ( SELECT customer_id FROM Orders WHERE product_name = 'C' ) ORDER BY customer_id
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'A' )AND customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'B' )AND customer_id NOT IN ( SELECT customer_id FROM Orders WHERE product_name = 'C' )
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'A' )AND customer_id IN ( SELECT customer_id FROM Orders WHERE product_name = 'B' )AND customer_id NOT IN ( SELECT customer_id FROM Orders WHERE product_name = 'C' ) ORDER BY customer_id
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN ( SELECT customer_id FROM Orders o WHERE product_name = 'A' ) AND customer_id IN ( SELECT customer_id FROM Orders o WHERE product_name = 'B' ) AND customer_id NOT IN ( SELECT customer_id FROM Orders o WHERE product_name = 'C' )
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN ( SELECT customer_id FROM Orders where product_name ='A' ) AND customer_id in ( select customer_id from orders where product_name ='B' ) AND customer_id NOT in ( select customer_id from orders where product_name = 'C' ) ORDER BY customer_id
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN ( select customer_id from Orders where product_name='A' ) AND customer_id IN ( select customer_id from Orders where product_name='B' ) AND customer_id NOT IN ( select customer_id from Orders where product_name='C' )
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name='A' AND customer_id IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name='B')) AND customer_id NOT IN (SELECT DISTINCT customer_id From Orders WHERE product_name='C')
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN (SELECT DISTINCT(customer_id) FROM Orders where product_name = 'A' ) AND customer_id IN (SELECT DISTINCT(customer_id) FROM Orders where product_name = 'B' ) AND customer_id NOT IN (SELECT DISTINCT(customer_id) FROM Orders where product_name = 'C' )
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C')
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name='A') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name='B') AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name='C')
SELECT customer_id, customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders where product_name ='A') AND customer_id IN (SELECT customer_id FROM Orders where product_name ='B') AND customer_id NOT IN (SELECT customer_id FROM Orders where product_name = 'C') ORDER BY customer_id
SELECT customer_id, customer_name FROM Customers WHERE customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = 'C') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'B') AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = 'A')
SELECT customer_id, customer_name FROM Customers WHERE customer_id in (SELECT customer_id FROM Orders WHERE product_name = "A") AND customer_id in (SELECT customer_id FROM Orders WHERE product_name = "B") AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = "C")
SELECT customer_id, customer_name FROM Customers c WHERE 'A' IN (SELECT product_name FROM Orders WHERE customer_id = c.customer_id) AND 'B' IN (SELECT product_name FROM Orders WHERE customer_id = c.customer_id) AND 'C' NOT IN (SELECT product_name FROM Orders WHERE customer_id = c.customer_id)
SELECT customer_id, customer_name FROM Customers c WHERE customer_id IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'C') ORDER BY customer_id
SELECT customer_id, customer_name FROM Orders JOIN Customers USING(customer_id) GROUP BY 1 HAVING sum(product_name='A')>0 AND sum(product_name='B')>0 AND sum(product_name='C')=0 ORDER BY 1
SELECT customer_id, customer_name FROM Orders JOIN customers USING (customer_id) GROUP BY customer_id HAVING GROUP_CONCAT(product_name) LIKE '%A%' AND GROUP_CONCAT(product_name) LIKE '%B%' AND GROUP_CONCAT(product_name) NOT LIKE '%C%'
SELECT customer_id, customer_name FROM customers WHERE customer_id IN (SELECT DISTINCT customer_id FROM orders WHERE product_name = 'A') AND customer_id IN (SELECT DISTINCT customer_id FROM orders WHERE product_name = 'B') AND customer_id NOT IN (SELECT DISTINCT customer_id FROM orders WHERE product_name = 'C')
SELECT customer_id, customer_name FROM customers WHERE customer_id in ( SELECT customer_id FROM (SELECT customer_id, GROUP_CONCAT(product_name) AS all_products FROM orders GROUP BY customer_id ) a WHERE FIND_IN_SET("A", a.all_products) > 0 AND FIND_IN_SET("B", a.all_products) > 0 AND FIND_IN_SET("C", a.all_products) = 0 ) ORDER BY customer_id
SELECT customer_id,customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE product_name="A") AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name="B") AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name="C")
SELECT customer_id,customer_name FROM customers WHERE customer_id in ( select customer_id from orders where product_name = 'A' ) and customer_id in ( select customer_id from orders where product_name = 'B' ) and customer_id not in ( select customer_id from orders where product_name ='C' )
SELECT distinct C.customer_id, C.customer_name FROM Orders O JOIN Customers C ON O.customer_id = C.customer_id WHERE O.customer_id in (SELECT customer_id FROM Orders C WHERE product_name = 'A') AND O.customer_id in (SELECT customer_id FROM Orders C WHERE product_name = 'B') AND O.customer_id not in (SELECT customer_id FROM Orders C WHERE product_name = 'C')
SELECT distinct Orders.customer_id, customer_name FROM Orders LEFT JOIN Customers ON Customers.customer_id = Orders.customer_id WHERE Orders.customer_id IN (SELECT customer_id FROM Orders WHERE product_name ="A") AND Orders.customer_id IN (SELECT customer_id FROM Orders WHERE product_name ="B") AND Orders.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name ="C")
SELECT distinct a.customer_id, b.customer_name FROM ORDERS a JOIN Customers b on a.customer_id=b.customer_id WHERE product_name ='A' and a.customer_id in (select distinct customer_id from orders where product_name='B') and a.customer_id NOT in (select distinct customer_id from orders where product_name='C')
SELECT distinct c.customer_id, c.customer_name FROM Customers c LEFT JOIN Orders o ON o.customer_id = c.customer_id WHERE o.customer_id in (select customer_id FROM orders where product_name = 'A') AND o.customer_id in (select customer_id FROM orders where product_name = 'B') AND o.customer_id not in (select customer_id FROM orders where product_name = 'C')
SELECT o.customer_id, c.customer_name FROM (SELECT customer_id, SUM(CASE WHEN product_name IN ('A', 'B') THEN 1 WHEN product_name = 'C' THEN -1 ELSE 0 END) AS product_count FROM (SELECT DISTINCT customer_id, product_name FROM Orders) AS t1 GROUP BY customer_id) AS o INNER JOIN Customers AS c ON c.customer_id = o.customer_id WHERE o.product_count = 2
SELECT o.customer_id, c.customer_name FROM Customers c, Orders o WHERE c.customer_id = o.customer_id GROUP BY o.customer_id HAVING SUM(o.product_name = "A") > 0 AND SUM(o.product_name = "B") > 0 AND SUM(o.product_name = "C") = 0
SELECT o.customer_id, c.customer_name FROM Orders o LEFT JOIN Customers c ON o.customer_id=c.customer_id GROUP BY o.customer_id HAVING SUM(o.product_name = 'A') > 0 AND SUM(o.product_name = 'B') > 0 AND SUM(o.product_name = 'C') = 0 ORDER BY o.customer_id
SELECT o.customer_id, c.customer_name from Orders o LEFT JOIN Customers c ON o.customer_id = c.customer_id GROUP BY o.customer_id HAVING SUM(o.product_name = 'A') > 0 and SUM(o.product_name = 'B') > 0 and SUM(o.product_name = 'C') = 0
SELECT o.customer_id, customer_name FROM orders o LEFT JOIN customers c ON o.customer_id = c.customer_id GROUP BY customer_id HAVING sum(if(product_name = "A",1,0)) > 0 and sum(if(product_name = "B",1,0)) >0 and sum(if(product_name = "C",1,0)) = 0
SELECT t.customer_id, t.customer_name FROM ( SELECT o.customer_id, c.customer_name, SUM(CASE WHEN o.product_name = 'A' THEN 1 ELSE 0 END) AS prod_A, SUM(CASE WHEN o.product_name = 'B' THEN 1 ELSE 0 END) AS prod_B, SUM(CASE WHEN o.product_name = 'C' THEN 1 ELSE 0 END) AS prod_C FROM Orders o LEFT JOIN Customers c ON o.customer_id=c.customer_id GROUP BY customer_id ) t WHERE t.prod_A > 0 AND t.prod_B > 0 AND prod_C = 0 ORDER BY t.customer_id
SELECT t1.customer_id, c.customer_name FROM (SELECT t.customer_id, (CASE WHEN t.product_name = 'A' THEN 1 WHEN t.product_name = 'B' THEN 1 WHEN t.product_name = 'C' THEN 0.5 ELSE 0 END) AS index_p FROM (SELECT customer_id, product_name FROM Orders WHERE product_name IN ('A','B','C') GROUP BY customer_id, product_name) AS t) AS t1 LEFT JOIN Customers c ON t1.customer_id = c.customer_id GROUP BY t1.customer_id HAVING SUM(t1.index_p) = 2
SELECT t2.customer_id, c.customer_name FROM Customers AS c JOIN (SELECT customer_id, GROUP_CONCAT(product_name) AS products FROM Orders GROUP BY customer_id) AS t2 ON c.customer_id=t2.customer_id WHERE t2.products NOT LIKE '%C%' AND t2.products LIKE '%A%' AND t2.products LIKE '%B%'
Select Distinct A.customer_id ,customer_name from (Select * from Orders where Product_name = "A") A Join (Select * from Orders where Product_name = "B") B Using (customer_id ) Join Customers Using (customer_id ) Where customer_id NOT IN (Select Distinct customer_id from Orders where product_name = "C")
Select X.customer_id,X.customer_name from (Select Orders.customer_id,customer_name from Orders left join Customers on Orders.customer_id = Customers.customer_id where product_name = "A" and Orders.customer_id in (select customer_id from Orders where product_name = 'B')) AS X LEFT JOIN (Select customer_id,product_name from Orders where product_name = 'C') AS Y on X.customer_id = Y.customer_id where Y.product_name is null
Select c.customer_id, c.customer_name from customers c, orders o where c.customer_id=o.customer_id group by c.customer_id having sum(o.product_name='A')>0 and sum(o.product_name='B')>0 and sum(o.product_name='C')=0
Select c.customer_id,c.customer_name From Customers c JOIN Orders o ON c.customer_id=o.customer_id GROUP BY o.customer_id Having Sum(o.product_name='A')>0 and Sum(o.product_name='B')>0 and Sum(o.product_name='C')=0
Select customer_id, customer_name from (Select a.customer_id, customer_name, sum(a.type_count) over(PARTITION BY a.customer_id) as type_value from (Select o.customer_id, c.customer_name, case when o.product_name = 'A' Then 1 when o.product_name = 'B' Then 1 when o.product_name = 'c' Then -1 Else 0 End As type_count from Orders o inner join Customers c on o.customer_id = c.customer_id) a) bb Where type_value = 2 group by customer_id
Select customer_id, customer_name from customers where customer_id in (Select customer_id from orders where product_name="A") and customer_id in (Select customer_id from orders where product_name="B") and customer_id not in (Select customer_id from orders where product_name="C")
Select customer_id,customer_name from orders join customers using(customer_id) group by customer_id having sum(case when product_name = "A" then 1 else 0 end) =1 and sum(case when product_name = "B" then 1 else 0 end) =1 and sum(case when product_name = "C" then 1 else 0 end) =0
Select x.customer_id,c.customer_name from customers as c inner join (Select distinct customer_id from orders where customer_id NOT IN (Select customer_id from orders where product_name='C') AND product_name in ('A','B') group by 1 having count(*)>1) as x on x.customer_id=c.customer_id
WITH A AS ( SELECT DISTINCT(a1.customer_id) FROM Orders a1, Orders a2, Orders a3 WHERE a1.product_name='A' AND a2.product_name='B' AND a3.product_name!='C' AND a1.customer_id = a2.customer_id and a2.customer_id = a3.customer_id ) SELECT a.customer_id , c.customer_name FROM A a LEFT JOIN Customers c on a.customer_id = c.customer_id WHERE a.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name ='C')
WITH A AS ( SELECT DISTINCT(customer_id) AS custs_A FROM Orders WHERE product_name = 'A' ), B AS ( SELECT DISTINCT(customer_id) AS custs_B FROM Orders WHERE product_name = 'B' ), C AS ( SELECT DISTINCT(customer_id) AS custs_c FROM Orders WHERE product_name = 'C' ) SELECT Customers.customer_id, Customers.customer_name FROM ( SELECT A.custs_A FROM A JOIN B ON A.custs_A=B.custs_B LEFT JOIN C ON A.custs_A=C.custs_C WHERE C.custs_C IS NULL ) t JOIN Customers ON Customers.customer_id = t.custs_A
WITH A AS ( SELECT customer_id, SUM(CASE WHEN product_name = 'A' THEN 1 ELSE 0 END) AS buyA, SUM(CASE WHEN product_name = 'B' THEN 1 ELSE 0 END) AS buyB, SUM(CASE WHEN product_name = 'C' THEN 1 ELSE 0 END) AS buyC FROM Orders GROUP BY customer_id HAVING buyA>0 AND buyB>0 AND buyC=0) SELECT * FROM Customers WHERE customer_id IN (SELECT customer_id FROM A) ORDER BY customer_id
WITH A_buyer AS (SELECT customer_id FROM Orders WHERE product_name = 'A' GROUP BY customer_id), B_buyer AS (SELECT customer_id FROM Orders WHERE product_name = 'B' GROUP BY customer_id), C_buyer AS (SELECT customer_id FROM Orders WHERE product_name = 'C' GROUP BY customer_id), AB_buyer AS (SELECT a.customer_id FROM A_buyer AS a INNER JOIN B_buyer AS b ON a.customer_id = b.customer_id), Res AS (SELECT ab.customer_id FROM AB_buyer AS ab LEFT JOIN C_buyer AS c ON ab.customer_id = c.customer_id WHERE c.customer_id IS NULL) SELECT r.customer_id, c2.customer_name FROM Res AS r JOIN Customers AS c2 ON r.customer_id = c2.customer_id
WITH CTE AS ( (SELECT distinct customer_id FROM Orders WHERE product_name = 'A') UNION ALL (SELECT distinct customer_id FROM Orders WHERE product_name = 'B') UNION ALL (SELECT distinct customer_id FROM Orders WHERE customer_id not in (SELECT distinct customer_id FROM Orders WHERE product_name = 'C') ) ) SELECT c.customer_id,customer_name FROM CTE LEFT JOIN Customers c on CTE.customer_id = c.customer_id GROUP BY c.customer_id HAVING COUNT(1) = 3
WITH CTE AS ( SELECT DISTINCT O1.CUSTOMER_ID FROM ORDERS O1 LEFT JOIN ORDERS O2 ON O1.CUSTOMER_ID=O2.CUSTOMER_ID WHERE O1.PRODUCT_NAME='A' AND O2.PRODUCT_NAME='B' ) SELECT C2.CUSTOMER_ID, C2.CUSTOMER_NAME FROM CTE C1 JOIN CUSTOMERS C2 ON C1.CUSTOMER_ID=C2.CUSTOMER_ID AND C1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')
WITH CTE AS ( SELECT DISTINCT customer_id, SUM(CASE WHEN product_name IN ('A','B','C') THEN 1 ELSE 0 END) cnt, SUM(CASE WHEN product_name IN ('A','B') THEN 1 ELSE 0 END) cnt1 FROM Orders GROUP BY customer_id HAVING SUM(CASE WHEN product_name IN ('A','B','C') THEN 1 ELSE 0 END)!=3 AND SUM(CASE WHEN product_name IN ('A','B') THEN 1 ELSE 0 END)=2 ) SELECT C.customer_id,C.customer_name FROM CTE C1 INNER JOIN Customers C ON C.customer_id=C1.customer_id
WITH CTE AS ( select o.customer_id, c.customer_name, sum(product_name = 'A') as 'countA', sum(product_name = 'B') as 'countB',sum(product_name = 'C') as 'countC' from Orders o left join Customers c on o.customer_id = c.customer_id group by 1,2 ) select cte.customer_id, cte.customer_name from CTE where countA > 0 and countB > 0 and countC = 0
WITH CTE AS (SELECT customer_id FROM Orders WHERE product_name = 'A' AND customer_id IN ( SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'B' ) ) SELECT CTE.customer_id, Customers.customer_name FROM CTE LEFT JOIN Customers ON CTE.customer_id = Customers.customer_id WHERE CTE.customer_id NOT IN ( SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'C' )
WITH CTE AS (SELECT order_id, customer_id, product_name, CASE WHEN product_name='A' THEN 1 WHEN product_name='B' THEN 2 WHEN product_name='C' THEN 3 ELSE 4 END as custom_rnk FROM orders) SELECT distinct b.customer_id, customer_name FROM orders a INNER JOIN customers b ON a.customer_id=b.customer_id WHERE a.customer_id not in (SELECT distinct customer_id FROM CTE WHERE custom_rnk=3) AND a.customer_id in (SELECT distinct customer_id FROM CTE WHERE custom_rnk=1) AND a.customer_id in (SELECT distinct customer_id FROM CTE WHERE custom_rnk=2)
WITH CTE1 AS ( SELECT distinct customer_id FROM Orders WHERE customer_id not in (select distinct customer_id FROM Orders where product_name = 'C') AND customer_id IN (SELECT distinct customer_id FROM Orders where product_name = 'A') AND customer_id IN (SELECT distinct customer_id FROM Orders where product_name = 'B') ) SELECT * FROM Customers WHERE customer_id IN (SELECT * FROM CTE1)
WITH CUST_A_B AS ( SELECT DISTINCT A.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') A INNER JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')B WHERE A.CUSTOMER_ID=B.CUSTOMER_ID ) SELECT C1.CUSTOMER_ID,C2.CUSTOMER_NAME FROM CUST_A_B C1 INNER JOIN CUSTOMERS C2 ON C1.CUSTOMER_ID=C2.CUSTOMER_ID WHERE C1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')
WITH CUST_CTE AS( SELECT DISTINCT customer_id FROM Orders WHERE customer_id IN (select customer_id FROM Orders WHERE product_name = 'A') AND customer_id IN (select customer_id FROM Orders WHERE product_name = 'B') AND customer_id NOT IN (select customer_id FROM Orders WHERE product_name = 'C') ) SELECT c1.customer_id, customer_name FROM CUST_CTE c1 INNER JOIN Customers c2 ON c1.customer_id = c2.customer_id
WITH Candidates AS ( SELECT customer_id FROM Orders GROUP BY customer_id HAVING SUM(CASE WHEN product_name='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN product_name='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN product_name='C' THEN 1 ELSE 0 END)=0 ) SELECT * FROM Customers WHERE customer_id IN (SELECT customer_id FROM Candidates) ORDER BY customer_id
WITH CustomerC AS ( SELECT customer_id FROM Orders WHERE product_name = 'C' GROUP BY customer_id ), CustomerA AS ( SELECT customer_id FROM Orders WHERE product_name = 'A' GROUP BY customer_id ), CustomerB AS ( SELECT customer_id FROM Orders WHERE product_name = 'B' GROUP BY customer_id ) SELECT customer_id, customer_name FROM Customers JOIN Orders USING (customer_id) JOIN CustomerA USING (customer_id) JOIN CustomerB USING (customer_id) WHERE customer_id NOT IN (SELECT customer_id FROM CustomerC) AND customer_id GROUP BY customer_id, customer_name ORDER BY customer_id
WITH Staging AS (SELECT customer_id , COUNT(DISTINCT(CASE WHEN product_name IN ('A', 'B') THEN product_name ELSE NULL END)) AS AAndBCount , COUNT(DISTINCT(CASE WHEN product_name = 'C' THEN product_name ELSE NULL END)) AS CCount FROM Orders GROUP BY customer_id) SELECT Customers.customer_id, Customers.customer_name FROM Staging JOIN Customers ON Staging.customer_id = Customers.customer_id WHERE AAndBCount >= 2 AND CCount = 0
WITH TEMP AS ( SELECT A.customer_id, customer_name, SUM(CASE WHEN product_name = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN product_name = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN product_name = 'C' THEN 1 ELSE 0 END) AS C FROM Orders A LEFT JOIN Customers B ON A.customer_id = B.customer_id GROUP BY customer_id ) SELECT customer_id, customer_name FROM TEMP WHERE A = 1 AND B = 1 AND C = 0 ORDER BY customer_id
WITH TEMP AS ( SELECT DISTINCT customer_id FROM Orders WHERE product_name = 'A' AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name='B')) SELECT DISTINCT temp.customer_id, c.customer_name FROM TEMP JOIN Customers c ON temp.customer_id = c.customer_id WHERE temp.customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name='C')
WITH a AS ( SELECT customers.customer_id, customer_name, order_id FROM customers INNER JOIN orders ON customers.customer_id = orders.customer_id WHERE product_name = 'A'), b AS ( SELECT a.customer_id, customer_name, a.order_id FROM a INNER JOIN orders ON a.customer_id = orders.customer_id WHERE product_name = 'B' ) SELECT b.customer_id, customer_name FROM b WHERE b.customer_id NOT IN (SELECT customers.customer_id FROM customers INNER JOIN orders ON customers.customer_id = orders.customer_id WHERE product_name = 'C')
WITH a AS( SELECT customer_id FROM orders WHERE product_name = 'A' ), b AS( SELECT customer_id FROM orders WHERE product_name = 'B' ), c AS( SELECT customer_id FROM orders WHERE product_name = 'C' ) SELECT DISTINCT customer_id, customer_name FROM orders JOIN customers USING(customer_id) WHERE customer_id IN (SELECT * FROM a) AND customer_id IN (SELECT * FROM b) AND customer_id NOT IN (SELECT * FROM c) ORDER BY customer_id
WITH a as (SELECT c.customer_id, c.customer_name FROM customers c JOIN orders o ON c.customer_id = o.customer_id WHERE o.product_name = 'A') , b as ( SELECT c.customer_id, c.customer_name FROM customers c JOIN orders o ON c.customer_id = o.customer_id WHERE o.product_name = 'B'), c as ( SELECT c.customer_id, c.customer_name FROM customers c JOIN orders o ON c.customer_id = o.customer_id WHERE o.product_name = 'C') SELECT a.customer_id, a.customer_name FROM a JOIN b ON a.customer_id = b.customer_id LEFT JOIN c ON a.customer_id = c.customer_id WHERE c.customer_id is null
WITH base_table AS ( SELECT customer_id, customer_name, GROUP_CONCAT(DISTINCT product_name) AS product_lists FROM Customers LEFT JOIN Orders USING(customer_id) GROUP BY 1, 2) SELECT customer_id, customer_name FROM base_table WHERE product_lists LIKE "%A%B%" AND product_lists NOT LIKE "%C%" GROUP BY 1
WITH boughts AS ( SELECT customer_id, COUNT(DISTINCT product_name) as cnt FROM orders WHERE product_name IN ('A', 'B') GROUP BY customer_id), nots AS ( SELECT customer_id FROM orders WHERE product_name = 'C' GROUP BY customer_id) SELECT b.customer_id, c.customer_name FROM boughts as b INNER JOIN customers as c ON b.customer_id = c.customer_id LEFT JOIN nots as n ON b.customer_id = n.customer_id WHERE n.customer_id IS NULL AND b.cnt = 2
WITH cte AS (SELECT o.customer_id, c.customer_name, o.product_name, SUM(IF(product_name='A','1','0')) AS A, SUM(IF(product_name='B','1','0')) AS B, SUM(IF(product_name='C','1','0')) AS C FROM Customers c LEFT JOIN Orders o ON c.customer_id=o.customer_id GROUP BY 1) SELECT cte.customer_id, cte.customer_name FROM cte WHERE A=1 AND B=1 AND C=0
WITH cte AS( SELECT o.customer_id, c.customer_name, SUM(CASE WHEN product_name = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN product_name = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN product_name = 'C' THEN 1 ELSE 0 END) AS C, SUM(CASE WHEN product_name = 'D' THEN 1 ELSE 0 END) AS D FROM Orders o INNER JOIN Customers c USING (customer_id) GROUP BY o.customer_id ) SELECT customer_id, customer_name FROM cte WHERE A = 1 AND B = 1 AND C = 0
WITH order_cnt AS ( SELECT customer_id, SUM( CASE WHEN product_name IN ('A', 'B') THEN 1 WHEN product_name = 'C' THEN -1 ELSE 0 END ) AS cnt FROM Orders GROUP BY customer_id ) SELECT c.customer_id, c.customer_name FROM order_cnt JOIN Customers c ON c.customer_id = order_cnt.customer_id WHERE order_cnt.cnt = 2
WITH order_type AS( SELECT customer_id , CASE WHEN product_name = 'A' THEN 1 ELSE 0 END AS is_A_purchase , CASE WHEN product_name = 'B' THEN 1 ELSE 0 END AS is_B_purchase , CASE WHEN product_name = 'C' THEN 1 ELSE 0 END AS is_C_purchase FROM Orders ) SELECT customer_id , customer_name FROM order_type INNER JOIN Customers USING(customer_id) GROUP BY customer_id, customer_name HAVING (MAX(is_A_purchase)>0 AND MAX(is_B_purchase)>0 AND MAX(is_C_purchase)=0) ORDER BY customer_id ASC
WITH t1 AS ( SELECT customer_id FROM Orders WHERE product_name = "A" AND customer_id IN (SELECT customer_id FROM Orders WHERE product_name = "B") AND customer_id NOT IN (SELECT customer_id FROM Orders WHERE product_name = "C")) SELECT t1.customer_id, c.customer_name FROM t1 LEFT JOIN Customers c ON t1.customer_id = c.customer_id
WITH table1 AS (SELECT customer_id, GROUP_CONCAT(product_name ORDER BY product_name) AS total_product FROM Orders GROUP BY 1 ) SELECT table1.customer_id AS CUSTOMER_ID ,customer_name AS CUSTOMER_NAME FROM table1 LEFT JOIN Customers ON Customers.customer_id = table1.customer_id WHERE total_product LIKE '%A%' AND total_product LIKE '%B%' AND total_product NOT LIKE '%C%'
WITH temp AS ( SELECT customer_id, SUM(CASE WHEN product_name = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN product_name = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN product_name = 'C' THEN 1 ELSE 0 END) AS C FROM Orders GROUP BY customer_id ) SELECT t.customer_id, c.customer_name FROM temp t JOIN Customers c ON c.customer_id = t.customer_id WHERE t.A > 0 AND t.B > 0 AND t.C = 0
select * from Customers WHERE customer_id IN (select customer_id FROM orders WHERE product_name='A') AND customer_id IN (select customer_id FROM orders WHERE product_name='B') AND customer_id NOT IN (select customer_id FROM orders WHERE product_name='C')
select * from Customers where customer_id in ( select customer_id from Orders o group by customer_id having sum(case when o.product_name ='A' then 1 else 0 end) >0 and sum(case when o.product_name ='B' then 1 else 0 end) >0 and sum(case when o.product_name ='C' then 1 else 0 end) =0)
select * from Customers where customer_id in (select customer_id from orders where product_name= "A") and customer_id in (select customer_id from orders where product_name= "B") and customer_id not in (select customer_id from orders where product_name= "C")
select * from customers c where exists(select distinct 1 from orders where product_name='A' and customer_id=c.customer_id) and exists(select distinct 1 from orders where product_name='B' and customer_id=c.customer_id) and not exists(select distinct 1 from orders where product_name='C' and customer_id=c.customer_id) order by c.customer_id
select * from customers where customer_id in (select customer_id from orders where product_name = 'A') and customer_id in (select customer_id from orders where product_name = 'B') and customer_id not in (select customer_id from orders where product_name = 'C')
select * from customers where customer_id in (select customer_id from orders where product_name = 'A') and customer_id in (select customer_id from orders where product_name = 'B') and not customer_id in (select customer_id from orders where product_name = 'C')
select * from customers where customer_id in (select customer_id from orders where product_name in ('A')) and customer_id in (select customer_id from orders where product_name in ('B')) and customer_id not in (select customer_id from orders where product_name in ('C'))
select * from customers where customer_id in (select customer_id from orders where product_name='A') and customer_id in (select customer_id from orders where product_name='B') and customer_id not in (select customer_id from orders where product_name='C')
select * from customers where customer_id in (select distinct customer_id from orders where product_name = 'A') and customer_id in (select distinct customer_id from orders where product_name = 'B') and customer_id not in (select distinct customer_id from orders where product_name ='C') order by customer_id
select A.customer_id as customer_id ,customer_name from( select customer_id ,sum(case when product_name = 'A' or product_name = 'B' then 1 else 0 end) ABcnt ,coalesce(sum(case when product_name = 'C' then 1 end),0) as CCnt from Orders orders group by customer_id ) A join Customers customers on A.customer_id = customers.customer_id where ABcnt = 2 and CCnt = 0
select A.customer_id as customer_id ,customer_name from( select customer_id ,sum(case when product_name = 'A' or product_name = 'B' then 1 else 0 end) ABcnt ,coalesce(sum(case when product_name = 'C' then 1 end),0) as CCnt from Orders orders group by customer_id ) A join Customers customers on A.customer_id = customers.customer_id where ABcnt >= 2 and CCnt = 0
select A.customer_id, customer_name from ( select customer_id, sum(case when product_name='A' then 1 else 0 end) as prodA, sum(case when product_name='B' then 1 else 0 end) as prodB, sum(case when product_name='C' then 1 else 0 end) as prodC from orders group by customer_id) A join Customers C on A.customer_id = C.customer_id where prodA>=1 and prodB>=1 and prodC=0
select CUSTOMER_ID,CUSTOMER_name from Customers where CUSTOMER_ID in ( select CUSTOMER_ID from (SELECT CUSTOMER_ID, count(CASE WHEN product_name='A' THEN 1 end) as prod_a, count(CASE WHEN product_name='B' THEN 1 end) as prod_b, count(CASE WHEN product_name='C' THEN 1 end) as prod_c from orders group by 1)x where prod_a=1 and prod_b=1 and prod_c=0 )
select Customers.customer_id, Customers.customer_name from Customers where Customers.customer_id in (select distinct Customers.customer_id from Customers left join Orders on Customers.customer_id = Orders.customer_id where Orders.product_name="A") and Customers.customer_id in (select distinct Customers.customer_id from Customers left join Orders on Customers.customer_id = Orders.customer_id where Orders.product_name="B") and Customers.customer_id not in (select distinct Customers.customer_id from Customers left join Orders on Customers.customer_id = Orders.customer_id where Orders.product_name="C") order by customer_id
select a.customer_id , a.customer_name from customers a join (select distinct customer_id from orders where product_name in('A')) ab on a.customer_id = ab.customer_id join (select distinct customer_id from orders where product_name in('B')) ab2 on a.customer_id = ab2.customer_id left join (select distinct customer_id from orders where product_name = 'C') c on ab.customer_id = c.customer_id where c.customer_id is null
select a.customer_id, Customers.customer_name from (select customer_id from Orders where product_name = "A" )a join ( select customer_id from Orders where product_name = "B" )b on a.customer_id = b.customer_id left join Customers on a.customer_id = Customers.customer_id where a.customer_id not in ( select customer_id from Orders where product_name = "C" )
select a.customer_id, a.customer_name from customers a , orders b where a.customer_id = b.customer_id group by a.customer_id having sum(b.product_name="A") >0 and sum(b.product_name="B") > 0 and sum(b.product_name="C")=0
select a.customer_id, a.customer_name from customers a , orders b where a.customer_id = b.customer_id group by a.customer_id having sum(b.product_name="A") >0 and sum(b.product_name="B") >0 and sum(b.product_name="C") =0
select a.customer_id, a.customer_name from customers a inner join orders b where a.customer_id = b.customer_id group by a.customer_id having sum(b.product_name="A") >0 and sum(b.product_name="B") > 0 and sum(b.product_name="C")=0
select a.customer_id, a.customer_name from customers a join orders b on a.customer_id = b.customer_id group by a.customer_id having sum(b.product_name="A") >0 and sum(b.product_name="B") > 0 and sum(b.product_name="C")=0
select a.customer_id, b.customer_name from (select customer_id from orders group by customer_id having customer_id in (select distinct(customer_id) from orders where product_name='A') and customer_id in (select distinct(customer_id) from orders where product_name='B') and customer_id not in (select distinct(customer_id) from orders where product_name='C'))a inner join customers b on a.customer_id = b.customer_id
select a.customer_id, b.customer_name from (select customer_id, group_concat(distinct product_name order by product_name asc)as product_list from orders group by customer_id having find_in_set('A',product_list) >0 and find_in_set('B',product_list)>0 and find_in_set('C',product_list)=0)a inner join customers b on a.customer_id = b.customer_id
select a.customer_id, b.customer_name from orders as a left join customers as b on a.customer_id=b.customer_id group by a.customer_id having sum(if(a.product_name="A",1,0))>0 and sum(if(a.product_name="B",1,0))>0 and sum(if(a.product_name="C",1,0))=0
select a.customer_id, c.customer_name from ( select distinct customer_id, product_name from orders where product_name in ('A','B','C') )a left join Customers c on a.customer_id = c.customer_id group by a.customer_id having(sum(case when product_name = 'A' then 1 else 0 end)) =1 and (sum(case when product_name = 'B' then 1 else 0 end)) =1 and (sum(case when product_name = 'C' then 1 else 0 end)) =0
select a.customer_id, c.customer_name from (select e.customer_id from Orders e join Orders f on e.customer_id=f.customer_id where e.product_name in ('A') and f.product_name='B' ) a left join (select customer_id from Orders where product_name in ('C') ) b on a.customer_id=b.customer_id join Customers c on a.customer_id=c.customer_id where b.customer_id is null group by a.customer_id order by a.customer_id
select a.customer_id, customer_name from (select customer_id, group_concat(distinct product_name) as p from orders group by customer_id) a join customers c on a.customer_id = c.customer_id where p like '%A%B%' and p not like'%C%'
select a.customer_id, customer_name from orders a join orders b on a.customer_id = b.customer_id join customers c on a.customer_id = c.customer_id where a.product_name = 'A' and b.product_name = 'B' and a.customer_id not in (select customer_id from orders where product_name = 'C')
select a.customer_id, customers.customer_name from ( select customer_id, sum(case when product_name ="A" then 1 else 0 end) as A, sum(case when product_name ="B" then 1 else 0 end) as B, sum(case when product_name ="C" then 1 else 0 end) as C from orders group by customer_id having A=1 and B=1 and C=0) a , customers where a.customer_id=customers.customer_id
select a.customer_id,b.customer_name from orders a left join customers b on a.customer_id=b.customer_id group by 1 having (sum(product_name='A')>0 and sum(product_name='B')>0 and sum(product_name='C')=0)
select a.customer_id,c.customer_name from (select customer_id, sum(case when product_name='A' then 1 else 0 end) a_pur, sum(case when product_name='B' then 1 else 0 end) as b_pur, sum(case when product_name='C' then 1 else 0 end) as C_pur from orders group by 1) a inner join Customers c on a.customer_id=c.customer_id where a_pur >0 and b_pur>0 and c_pur=0
select b.customer_id, b.customer_name from orders a join customers b on a.customer_id = b.customer_id group by b.customer_id having sum(if(product_name = 'A',1,0)) > 0 and sum(if(product_name = 'B',1,0)) > 0 and sum(if(product_name = 'C',1,0)) = 0 order by b.customer_id
select b.customer_id, c.customer_name from (select customer_id, sum(flag) as flags from (select customer_id, case when product_name='C' then -1 when product_name='A' then 1 when product_name='B' then 1 else 0 end as flag from (select distinct customer_id, product_name from Orders where product_name = "A" or product_name = "B" or product_name = "C")d) a group by customer_id )b left join Customers c on b.customer_id = c.customer_id where flags=2
select b.customer_id,b.customer_name from ( select a.customer_id,a.customer_name, sum(case when a.product_name = 'A' then 1 else 0 end) as productA, sum(case when a.product_name = 'B' then 1 else 0 end) as productB, sum(case when a.product_name = 'C' then 1 else 0 end) as productC from (select Orders.customer_id, Orders.product_name, Customers.customer_name from orders left join customers on orders.customer_id = customers.customer_id) a group by a.customer_id,a.customer_name ) b where b.productA>0 and b.productB>0 and b.productC= 0
select c.CUSTOMER_ID, c.CUSTOMER_NAME from customers c join orders o on o.customer_id = c.customer_id group by c.customer_id having sum(o.product_name="A") > 0 and sum(o.product_name="B")>0 and sum(o.product_name="C") = 0 order by c.customer_id
select c.customer_id , c.customer_name from customers c left join orders o on c.customer_id = o.customer_id group by c.customer_id having sum(o.product_name='A')>0 and sum(o.product_name='B')>0 and sum(o.product_name ='C')= 0
select c.customer_id as CUSTOMER_ID, c.customer_name as CUSTOMER_NAME from Customers c inner join Orders o on c.customer_id = o.customer_id group by c.customer_id having sum(o.product_name='A') > 0 and sum(o.product_name='B') > 0 and sum(o.product_name='C') = 0
select c.customer_id as CUSTOMER_ID, customer_name CUSTOMER_NAME from (select a.customer_id from (select customer_id from Orders where product_name="A" group by customer_id ) a inner join (select customer_id from Orders where product_name="B" group by customer_id ) b on a.customer_id=b.customer_id inner join (select cc.customer_id from (select customer_id from Orders where product_name="C" group by customer_id) c right join Customers cc on c.customer_id= cc.customer_id where c.customer_id is null) x on b.customer_id=x.customer_id) x inner join Customers c on x.customer_id=c.customer_id order by c.customer_id
select c.customer_id as customer_id, c.customer_name as customer_name from customers c inner join orders a on c.customer_id = a.customer_id and a.product_name = 'A' inner join orders b on c.customer_id = b.customer_id and b.product_name = 'B' left outer join orders o on c.customer_id = o.customer_id and o.product_name = 'C' where o.order_id is null
select c.customer_id as customer_id, c.customer_name as customer_name from customers c left join orders a on c.customer_id = a.customer_id group by c.customer_id having sum(a.product_name = 'A' ) > 0 and sum(a.product_name = 'B') > 0 and sum(a.product_name = 'C') = 0
select c.customer_id, c.customer_name from (select customer_id, product_name, case when product_name = 'A' then 1 when product_name = 'B' then 1 else 0 end as 'tag' from orders where customer_id not in ( select customer_id from orders where product_name in ('C') )) t1 left join customers c on (t1.customer_id = c.customer_id) where t1.tag = 1 group by t1.customer_id having count(distinct product_name) = 2
select c.customer_id, c.customer_name from Customers as c inner join (select customer_id, sum(CASE WHEN product_name = 'A' THEN 1 WHEN product_name = 'B' THEN 1 WHEN product_name = 'C' THEN -1 ELSE 0 END) as tot from Orders group by customer_id having tot > 1) as o where c.customer_id = o.customer_id
select c.customer_id, c.customer_name from Customers as c join Orders as o on c.customer_id = o.customer_id group by 1 having sum(o.product_name = 'A') = 1 and sum(o.product_name = 'b') = 1 and sum(o.product_name = 'c') = 0 order by 1
select c.customer_id, c.customer_name from Customers as c left join (select customer_id, product_name from Orders where product_name = "A") as t1 On c.customer_id = t1.customer_id left join (select customer_id, product_name from Orders where product_name = "B") as t2 On c.customer_id = t2.customer_id left join (select customer_id, product_name from Orders where product_name = "C") as t3 On c.customer_id = t3.customer_id where t1.customer_id and t2.customer_id and ISNULL(t3.customer_id)
select c.customer_id, c.customer_name from Customers c left join Orders o on c.customer_id = o.customer_id group by c.customer_id having sum(product_name='A')>0 and sum(product_name='B')>0 and sum(product_name='C')=0
select c.customer_id, c.customer_name from Customers c where customer_id in (select customer_id from Orders where product_name = 'A') and customer_id in (select customer_id from Orders where product_name = 'B') and customer_id not in (select customer_id from Orders where product_name = 'C')
select c.customer_id, c.customer_name from Orders o LEFT JOIN Customers c on o.customer_id = c.customer_id where product_name = 'A' or product_name = 'B' group by customer_id having count(product_name) = 2 and customer_id not in (select customer_id from orders where product_name = 'C')
select c.customer_id, c.customer_name from Orders o join Customers c on o.customer_id = c.customer_id where c.customer_id in (select o2.customer_id from Orders o2 where o2.product_name = 'A') and c.customer_id in (select o2.customer_id from Orders o2 where o2.product_name = 'B') and c.customer_id not in (select o2.customer_id from Orders o2 where o2.product_name = 'C') group by 1,2 order by 1
select c.customer_id, c.customer_name from Orders o join Customers c using(customer_id) group by o.customer_id having sum(product_name='A') > 0 and sum(product_name='B') > 0 and sum(product_name='C') = 0
select c.customer_id, c.customer_name from Orders o join Customers c using(customer_id) group by o.customer_id having sum(product_name='A') > 0 and sum(product_name='B')>0 and sum(product_name='C') = 0
select c.customer_id, c.customer_name from customers c inner join (select customer_id, sum(case when product_name = 'A' then 1 else 0 end) as A, sum(case when product_name = 'B' then 1 else 0 end) as B, sum(case when product_name = 'C' then 1 else 0 end) as C from orders group by customer_id ) m on c.customer_id = m.customer_id where m.A > 0 and m.B > 0 and m.C = 0
select c.customer_id, c.customer_name from customers c inner join orders o using (customer_id) group by 1 having sum(o.product_name="A") >=1 and sum(o.product_name="B") >=1 and sum(o.product_name="C")=0
select c.customer_id, c.customer_name from customers c join orders o on c.customer_id = o.customer_id where o.product_name = 'A' and c.customer_id in (select b.customer_id from orders b where b.product_name = "B") and c.customer_id not in (select c1.customer_id from orders c1 where c1.product_name = "C")
select c.customer_id, c.customer_name from customers c join orders o using(customer_id) where o.product_name in ('A', 'B') and c.customer_id not in ( select customer_id from orders where product_name = 'C' ) group by o.customer_id having count(o.product_name) = 2 order by c.customer_id
select c.customer_id, c.customer_name from orders o join customers c on c.customer_id = o.customer_id group by c.customer_id, c.customer_name having sum(product_name='A')>0 and sum(product_name='B')>0 and sum(product_name='C')=0 order by c.customer_id
select c.customer_id, c.customer_name from orders o left join customers c on o.customer_id = c.customer_id group by 1,2 having sum(case when product_name = 'A' then 1 else 0 end) > 0 and sum(case when product_name = 'B' then 1 else 0 end) > 0 and sum(case when product_name = 'C' then 1 else 0 end) = 0 order by 1
select c.customer_id, cu.customer_name from (select o1.customer_id, o3.product_name from orders o1 left join orders o2 on o1.customer_id = o2.customer_id left join (select customer_id, product_name from orders where product_name = 'C') o3 on o3.customer_id = o1.customer_id where o1.product_name = 'A' and o2.product_name = 'B' ) c left join customers cu on cu.customer_id = c.customer_id where c.product_name is null
select c.customer_id, customer_name from Customers c inner join (select customer_id, sum(case when product_name = 'A' then 1 else 0 end) as count_A, sum(case when product_name = 'B' then 1 else 0 end) as count_B, sum(case when product_name = 'C' then 1 else 0 end) as count_C, sum(case when product_name = 'D' then 1 else 0 end) as count_D from Orders group by customer_id having count_A > 0 and count_B > 0 and count_C = 0)t on c.customer_id = t.customer_id order by 1
select c.customer_id, customer_name from Customers c where c.customer_id in (select customer_id from Orders where product_name = 'A') and c.customer_id in (select customer_id from Orders where product_name = 'B') and c.customer_id not in (select customer_id from Orders where product_name = 'C')
select c.customer_id, customer_name from Customers c, Orders o where c.customer_id = o.customer_id and c.customer_id in (select customer_id from Orders where product_name='A') and c.customer_id in (select customer_id from Orders where product_name='B') and c.customer_id not in (select customer_id from Orders where product_name='C') group by 1 order by 1
select c.customer_id, customer_name from customers c join orders o on c.customer_id = o.customer_id where (product_name = 'A' or product_name = 'B') and c.customer_id not in (select customer_id from orders where product_name = 'C') group by c.customer_id, customer_name having count(customer_name) = 2 order by c.customer_id
select c.customer_id, customer_name from customers c join orders o using(customer_id) group by c.customer_id having sum(case when product_name = 'A' then 1 when product_name = 'B' then 1 when product_name = 'C' then -1 else '0' end ) = 2
select c.customer_id, customer_name from orders o left join customers c on o.customer_id = c.customer_id where product_name = 'A' and c.customer_id in ( select distinct customer_id from orders where product_name = 'B' ) and c.customer_id not in ( select distinct customer_id from orders where product_name = 'C' )
select c.customer_id,c.customer_name from ( select customer_id , case when product_name = 'A' then 1 else 0 end as A , case when product_name = 'B' then 1 else 0 end as B, case when product_name = 'C' then 1 else 0 end as C, case when product_name = 'D' then 1 else 0 end as D from orders ) a inner join customers c on c.customer_id = a.customer_id group by a.customer_id having max(A) = 1 and max(B) = 1 and max(C) = 0
select c.customer_id,c.customer_name from Customers c where c.customer_id in ( select customer_id from orders where product_name ='A') and c.customer_id in ( select customer_id from orders where product_name ='B') and c.customer_id not in ( select customer_id from orders where product_name ='C')
select c.customer_id,c.customer_name from customers c join orders o on c.customer_id=o.customer_id group by c.customer_id,c.customer_name having sum(case when o.product_name ='A' then 1 else 0 end) >0 and sum(case when o.product_name ='B' then 1 else 0 end) >0 and sum(case when o.product_name ='C' then 1 else 0 end) =0
select cust.customer_id ,cust.customer_name from Customers cust join Orders ord on cust.customer_id = ord.customer_id group by customer_id having sum(case when product_name = 'A' then 1 else 0 end)>0 and sum(case when product_name = 'B' then 1 else 0 end)>0 and sum(case when product_name = 'C' then 1 else 0 end) = 0
select customer_id , customer_name from Customers where customer_id in ( select distinct customer_id from Orders where product_name = 'A') and customer_id in ( select distinct customer_id from Orders where product_name = 'B') and customer_id not in ( select distinct customer_id from Orders where product_name = 'C')
select customer_id as CUSTOMER_ID, customer_name as CUSTOMER_NAME from customers where exists(select * from orders where orders.customer_id=customers.customer_id and orders.product_name='A' ) AND exists(select * from orders where orders.customer_id=customers.customer_id and orders.product_name = 'B') AND NOT exists(select * from orders where orders.customer_id=customers.customer_id and orders.product_name= 'C')
select customer_id from orders where product_name = 'C' ) , bought_a AS ( select customer_id from orders where product_name = 'A' ) , bought_b AS ( select customer_id from orders where product_name = 'B' ) select distinct customer_id, customer_name FROM bought_a join bought_b using (customer_id) left join bought_c c using(customer_id) join customers using (customer_id) where c.customer_id is null
select customer_id, customer_name from ( select c.customer_id as customer_id, c.customer_name as customer_name, (sum(product_name = "A") >= 1) and (sum(product_name = "B") >= 1) and (sum(product_name = "C") = 0) as cond from Customers c left join Orders o on c.customer_id = o.customer_id group by c.customer_id ) d where cond = True
select customer_id, customer_name from (select o.customer_id, c.customer_name, sum(case when product_name = 'A' then 100 when product_name = 'B' then 10 when product_name = 'C' then 1 else 0 end) as product_index from Orders as o join Customers as c on o.customer_id = c.customer_id group by o.customer_id, c.customer_name) as tmp where product_index = 110
select customer_id, customer_name from Customers c where (select count(product_name) from Orders where customer_id = c.customer_id and product_name in('A', 'B')) = 2 and (select count(product_name) from Orders where customer_id = c.customer_id and product_name = 'C') = 0
select customer_id, customer_name from Customers where customer_id IN( SELECT A.customer_id FROM (select customer_id from orders where product_name ='A' ) AS A INNER JOIN (select customer_id from orders where product_name ='B' ) AS B ON A.customer_id = B.customer_id WHERE A.customer_id NOT IN( (select customer_id from orders where product_name ='C' )))
select customer_id, customer_name from Customers where customer_id in ( select customer_id from ( select customer_id, sum( CASE WHEN product_name="A" THEN 1 WHEN product_name="B" THEN 1 WHEN product_name="C" THEN 3 ELSE 0 END ) as product_sum from Orders group by customer_id) tmp where product_sum=2)
select customer_id, customer_name from Customers where customer_id in ( select customer_id from Orders where product_name = 'A' ) and customer_id in ( select customer_id from Orders where product_name = 'B' ) and customer_id not in ( select customer_id from Orders where product_name = 'C' )
select customer_id, customer_name from Customers where customer_id in ( select customer_id from Orders where product_name = 'A') and customer_id in ( select customer_id from Orders where product_name = 'B') and customer_id not in ( select customer_id from Orders where product_name = 'C')
select customer_id, customer_name from Customers where customer_id in ( select customer_id from Orders where product_name='A' ) and customer_id in ( select customer_id from Orders where product_name='B' ) and customer_id not in ( select customer_id from Orders where product_name='C' )
select customer_id, customer_name from Customers where customer_id in (select customer_id from Orders group by customer_id having sum(product_name = 'A') >0 and sum(product_name = 'B') >0 and sum(product_name = 'C') = 0)
select customer_id, customer_name from Customers where customer_id in (select customer_id from Orders where product_name = 'A' or product_name = 'B' group by customer_id having count(distinct product_name) = 2) and customer_id not in (select customer_id from Orders where product_name = 'C')
select customer_id, customer_name from Customers where customer_id in (select customer_id from Orders where product_name = 'A') and customer_id in (select customer_id from Orders where product_name = 'B') and customer_id not in (select customer_id from Orders where product_name = 'C')
select customer_id, customer_name from Customers where customer_id in (select customer_id from Orders where product_name = 'A') and customer_id in (select customer_id from Orders where product_name = 'B') and customer_id not in (select customer_id from Orders where product_name = 'C') order by 1
select customer_id, customer_name from Customers where customer_id in (select distinct customer_id from Orders where product_name = 'A') and customer_id in (select distinct customer_id from Orders where product_name = 'B') and not customer_id in (select distinct customer_id from Orders where product_name = 'C') order by customer_id
select customer_id, customer_name from Customers where customer_id not in (select customer_id from Orders where product_name = 'C') and customer_id in (select customer_id from Orders where product_name = 'A') and customer_id in (select customer_id from Orders where product_name = 'B')
select customer_id, customer_name from customers left join (select customer_id c, sum(case when product_name = "A" then 1 else 0 end) a, sum(case when product_name = "B" then 1 else 0 end) b, sum(case when product_name = "C" then 1 else 0 end) cc from orders group by customer_id) as t on customers.customer_id = t.c where a > 0 and b > 0 and cc = 0
select customer_id, customer_name from customers where customer_id in ( Select customer_id from orders group by customer_id having sum(product_name = 'A')>0 and sum(product_name = 'B')>0 and sum(product_name = 'C') = 0 )
select customer_id, customer_name from customers where customer_id in ( select customer_id from orders where product_name = "A" ) and customer_id in ( select customer_id from orders where product_name = "B" ) and customer_id not in ( select customer_id from orders where product_name = "C" )
select customer_id, customer_name from customers where customer_id in ( select customer_id from orders where product_name = 'A' ) and customer_id in ( select customer_id from orders where product_name = 'B' ) and customer_id not in ( select customer_id from orders where product_name = 'C' )
select customer_id, customer_name from customers where customer_id in ( select customer_id from orders where product_name = 'A' ) and customer_id in ( select customer_id from orders where product_name = 'B' ) and customer_id not in ( select customer_id from orders where product_name = 'C' ) order by customer_id
select customer_id, customer_name from customers where customer_id in ( select distinct customer_id from orders a where product_name = 'A' and customer_id in (select customer_id from orders where product_name = 'B') and customer_id not in (select customer_id from orders where product_name = 'C'))
select customer_id, customer_name from customers where customer_id in (select customer_id from orders where product_name = "A") and customer_id in (select customer_id from orders where product_name = "B") and customer_id not in (select customer_id from orders where product_name = "C")
select customer_id, customer_name from customers where customer_id in (select customer_id from orders where product_name = 'A') and customer_id in (select customer_id from orders where product_name = 'B') and customer_id not in (select customer_id from orders where product_name = 'C')
select customer_id, customer_name from customers where customer_id in (select distinct customer_id from orders where product_name='A') and customer_id in (select distinct customer_id from orders where product_name='B') and customer_id not in (select distinct customer_id from orders where product_name='C')
select customer_id, customer_name from customers where customer_id not in ( select customer_id from orders where product_name = 'C') and customer_id in( select customer_id from orders group by customer_id having sum(product_name = 'A') > 0 and sum(product_name = 'B') > 0) order by customer_id
select customer_id, customer_name from customers where customer_id not in (select customer_id from orders where product_name = 'C') and customer_id in (select customer_id from orders where product_name = 'A') and customer_id in (select customer_id from orders where product_name = 'B')
select customer_id, customer_name from( select C.customer_id, C.customer_name, (case when product_name = 'A' then 1 when product_name = 'B' then 1 when product_name = 'C' then 5 else 0 end) as value from Orders O join Customers C on C.customer_id = O.customer_id group by customer_id having sum(value) = 2) a
select customer_id,customer_name from Customers c where customer_id in (select distinct customer_id from Orders where product_name = 'A' and customer_id in (select distinct customer_id from Orders where product_name = 'B')) and customer_id not in (select distinct customer_id from Orders where product_name = 'C' )
select customer_id,customer_name from Customers where customer_id in (select distinct customer_id from Orders where product_name = 'A') and customer_id in (select distinct customer_id from Orders where product_name = 'B') and customer_id not in (select distinct customer_id from Orders where product_name = 'C') order by customer_id
select customer_id,customer_name from customers where customer_id in (select customer_id from orders where product_name = 'A') and customer_id in (select customer_id from orders where product_name = 'B') and customer_id not in (select customer_id from orders where product_name = 'C')
select customer_id,customer_name from customers where customer_id in (select distinct customer_id from orders where product_name = 'A') and customer_id in (select distinct customer_id from orders where product_name = 'B') and customer_id not in (select distinct customer_id from orders where product_name = 'C')
select customers.customer_id, customer_name from customers inner join orders on customers.customer_id = orders.customer_id where product_name = 'A' and customers.customer_id in (select customer_id from orders where product_name = 'B') and customers.customer_id not in (select customer_id from orders where product_name = 'C')
select distinct A1.customer_id as customer_id, customer_name from ((select customer_id from orders where customer_id not in (select customer_id from orders where product_name = 'C')) A1 join (select customer_id from orders where product_name = 'A' ) A2 on A1.customer_id = A2.customer_id join (select customer_id from orders where product_name = 'B' ) A3 on A1.customer_id = A3.customer_id) join customers c on A1.customer_id = c.customer_id
select distinct Orders.customer_id, customer_name from Customers join Orders on Orders.customer_id = Customers.customer_id where product_name in ("A","B") and Orders.customer_id not in ( select distinct customer_id from Orders where product_name in ("C") ) group by customer_id having (count(*)=2)
select distinct a.customer_id, b.customer_name from ( select customer_id from Orders where product_name='A' and customer_id in (select customer_id from Orders where product_name='B') and customer_id not in (select customer_id from Orders where product_name='C'))a left join Customers b on a.customer_id=b.customer_id
select distinct a.customer_id, b.customer_name from orders a inner join customers b on a.customer_id = b.customer_id group by 1,2 having max(case when product_name="A" then 1 else 0 end) =1 AND max(case when product_name="B" then 1 else 0 end) =1 AND max(case when product_name="C" then 1 else 0 end) =0
select distinct a.customer_id, customer_name from Orders a inner join Customers b on a.customer_id = b.customer_id where product_name = 'A' and a.customer_id in (select distinct customer_id from Orders where product_name = 'B') and a.customer_id not in (select distinct customer_id from Orders where product_name = 'C')
select distinct c.customer_id customer_id, c.customer_name from customers c inner join orders o1 on c.customer_id = o1.customer_id inner join orders o2 on c.customer_id = o2.customer_id where o1.product_name = 'A' and o2.product_name = 'B' and not exists (select customer_id from orders o3 where c.customer_id = o3.customer_id and o3.product_name = 'C')
select distinct c.customer_id, c.customer_name from customers c, orders o where c.customer_id = o.customer_id and c.customer_id in (select customer_id from orders where product_name = 'A') and c.customer_id in (select customer_id from orders where product_name = 'B') and c.customer_id not in (select customer_id from orders where product_name = 'C')
select distinct c.customer_id, customer_name from customers c, orders o where c.customer_id = o.customer_id and product_name='A' and customer_name in (select distinct customer_name from customers c, orders o where c.customer_id = o.customer_id and product_name='B') and customer_name not in (select distinct customer_name from customers c, orders o where c.customer_id = o.customer_id and product_name='C')
select distinct customer_id , customer_name from Customers where customer_id in (select distinct customer_id from Orders where product_name ='A') and customer_id in (select distinct customer_id from Orders where product_name ='B') and customer_id not in (select distinct customer_id from Orders where product_name ='C') order by customer_id
select distinct customer_id, customer_name from Customers where customer_id IN ( select customer_id from Orders where product_name = 'A' ) AND customer_id IN ( select customer_id from Orders where product_name = 'B' ) AND customer_id NOT IN ( select customer_id from Orders where product_name = 'C' )
select distinct customer_id, customer_name from Customers where customer_id in ( select customer_id from Orders where product_name='A' ) and customer_id in ( select customer_id from Orders where product_name='B' ) and customer_id not in ( select customer_id from Orders where product_name='C' )
select distinct customer_id, customer_name from Customers where customer_id in (select distinct customer_id from Orders where product_name = "A") and customer_id in (select distinct customer_id from Orders where product_name = "B") and customer_id not in (select distinct customer_id from Orders where product_name = "C") order by customer_id
select distinct customer_id, customer_name from Customers where customer_id not in (select distinct customer_id from Orders where product_name='C' ) and customer_id in (select distinct customer_id from Orders where product_name='A') and customer_id in (select distinct customer_id from Orders where product_name='B')
select distinct customer_id, customer_name from customers where customer_id in (select customer_id from orders where product_name = "A") and customer_id in (select customer_id from orders where product_name = "B") and customer_id not in (select customer_id from orders where product_name = "C")
select distinct customer_id, customer_name from customers where customer_id not in (select customer_id from Orders where product_name = 'C') and customer_id in (select customer_id from Orders where product_name = 'A' ) and customer_id in (select customer_id from Orders where product_name = 'B' )
select distinct customer_id, customer_name from orders left join customers using(customer_id) where customer_id in (select customer_id from orders where product_name = 'A') and customer_id in (select customer_id from orders where product_name = 'B') and customer_id not in (select customer_id from orders where product_name = 'C')
select distinct customer_id,customer_name from ( select c.customer_id,c.customer_name,o.product_name from orders o join customers c on o.customer_id = c.customer_id ) itm where (customer_id not in (select customer_id from orders where product_name = 'C')) group by customer_id, customer_name having sum(case when product_name = 'A' then 1 else 0 end) > 0 and sum(case when product_name = 'B' then 1 else 0 end) > 0 order by customer_id
select distinct o.customer_id as CUSTOMER_ID, c.customer_name as CUSTOMER_NAME from Orders o join Customers c on o.customer_id = c.customer_id where o.customer_id in (select customer_id from Orders where product_name='A') and o.customer_id in (select customer_id from Orders where product_name='B') and o.customer_id not in (select customer_id from Orders where product_name='C') order by o.customer_id
select distinct o.customer_id, c.customer_name from Orders o join Customers c on c.customer_id = o.customer_id where o.customer_id in (select customer_id from Orders where product_name = 'A') and o.customer_id in (select customer_id from Orders where product_name = 'B') and o.customer_id not in (select customer_id from Orders where product_name = 'C')
select distinct o.customer_id, c.customer_name from orders o join customers c on c.customer_id = o.customer_id where o.customer_id in ( select customer_id from orders where product_name = "A" ) and o.customer_id in ( select customer_id from orders where product_name = "B" ) and o.customer_id not in ( select customer_id from orders where product_name = "C" )
select distinct o.customer_id, c.customer_name from orders o join customers c on c.customer_id = o.customer_id where o.customer_id in ( select distinct customer_id from orders where product_name = "A" ) and o.customer_id in ( select distinct customer_id from orders where product_name = "B" ) and o.customer_id not in ( select distinct customer_id from orders where product_name = "C" )
select distinct o.customer_id, c.customer_name from orders o join customers c on o.customer_id = c.customer_id where o.product_name in ('A','B') group by o.customer_id having count(o.product_name) =2 and customer_id not in (select customer_id from orders where product_name = 'C')
select distinct o.customer_id, c.customer_name from orders o left join customers c ON c.customer_id = o.customer_id where o.customer_id in (select distinct customer_id from orders where product_name='A') AND o.customer_id in (select distinct customer_id from orders where product_name='B') AND o.customer_id NOT IN (select distinct customer_id FROM orders where product_name = 'C') order by customer_id
select distinct o.customer_id, c.customer_name from orders o left join customers c on o.customer_id = c.customer_id where o.customer_id in (select distinct customer_id from orders where product_name = 'A') and o.customer_id in (select distinct customer_id from orders where product_name = 'B') and o.customer_id not in (select distinct customer_id from orders where product_name = 'C')
select distinct o.customer_id,c.customer_name from Orders o left join Customers c on o.customer_id = c.customer_id where (o.customer_id,'A') in (select customer_id,product_name from orders) and (o.customer_id,'B') in (select customer_id,product_name from orders) and (o.customer_id,'C') NOT in (select customer_id,product_name from orders)
select distinct orders.customer_id, customers.customer_name from orders inner join customers on orders.customer_id = customers.customer_id where orders.customer_id in (select customer_id from orders where product_name = 'A') and orders.customer_id in (select customer_id from orders where product_name = 'B') and orders.customer_id not in (select customer_id from orders where product_name = 'C')
select distinct sub.a customer_id,sub.b customer_name from (select o.customer_id a, c.customer_name b,o.product_name c from customers c join orders o on c.customer_id=o.customer_id where c.customer_id in (select o1.customer_id from (select customer_id from orders o where product_name='A') as o1 join (select customer_id from orders where product_name='B')t1 on o1.customer_id=t1.customer_id) and c.customer_id not in (select customer_id from orders where product_name='C'))sub
select distinct t.customer_id, customer_name from customers t join (select customer_id from orders where product_name ='A' ) a using (customer_id) where customer_id in (select customer_id from orders where product_name ='B') and customer_id not in (select customer_id from orders where product_name ='C' )
select distinct temp.customer_id, c.customer_name from ( select o.customer_id from orders o where o.product_name='A' and o.customer_id in (select o.customer_id from orders o where o.product_name='B') and o.customer_id not in (select o.customer_id from orders o where o.product_name='C') ) temp inner join customers c on temp.customer_id=c.customer_id
select o.customer_id as customer_id, c.customer_name as customer_name from orders as o join customers as c on o.customer_id = c.customer_id group by o.customer_id having sum(case when o.product_name = "C" then 1 else 0 end ) = 0 and sum(case when o.product_name = "A" then 1 else 0 end ) >=1 and sum(case when o.product_name = "B" then 1 else 0 end ) >=1
select o.customer_id, c.customer_name from Orders as o join Customers as c on o.customer_id = c.customer_id group by customer_id having sum(o.product_name='A') >0 and sum(o.product_name='B') >0 and sum(o.product_name = 'C')=0
select o.customer_id, c.customer_name from Orders o join Customers c ON o.customer_id = c.customer_id group by o.customer_id having Sum(CASE WHEN product_name = 'A' THEN 1 ELSE 0 END) > 0 AND Sum(CASE WHEN product_name = 'B' THEN 1 ELSE 0 END) > 0 AND Sum(CASE WHEN product_name = 'C' THEN 1 ELSE 0 END) = 0
select o.customer_id, c.customer_name from Orders o join Customers c on c.customer_id=o.customer_id where o.product_name='A' and o.customer_id in (select o.customer_id from orders o where o.product_name='B') and o.customer_id not in (select o.customer_id from orders o where o.product_name='C')
select o.customer_id, c.customer_name from customers c left join orders o on c.customer_id = o.customer_id where o.product_name = 'A' or o.product_name = 'B' group by o.customer_id having count(o.product_name) = 2 and o.customer_id not in (select customer_id from orders where product_name = 'C' )
select o.customer_id, c.customer_name from orders as o join customers as c using(customer_id) group by o.customer_id having sum(o.product_name="A")>0 and sum(o.product_name="B")>0 and sum(o.product_name="C")=0 order by o.customer_id
select o.customer_id, c.customer_name from orders o join customers c on c.customer_id = o.customer_id where o.customer_id in (select customer_id from orders where product_name = 'A' ) and o.customer_id in (select customer_id from orders where product_name = 'B') and o.customer_id not in (select customer_id from orders where product_name = 'C') group by o.customer_id
select o.customer_id, c.customer_name from orders o join customers c on o.customer_id = c.customer_id group by o.customer_id having sum(o.product_name="A")>0 and sum(o.product_name="B")>0 and sum(o.product_name="C")=0
select o.customer_id, customer_name from Orders o inner join Customers c on o.customer_id = c.customer_id where product_name = 'A' or product_name = 'B' and o.customer_id not in (select customer_id from Orders where product_name = 'C') group by 1 having count(distinct product_name) = 2 order by 1
select o.customer_id, customer_name from Orders o join Customers c on o.customer_id = c.customer_id group by c.customer_name, o.customer_id having sum(case when o.product_name in ('A','B') then 1 when o.product_name in ('C') then 0.5 else 0 end)=2
select o.customer_id, customer_name from orders as o join customers as c on o.customer_id = c.customer_id where product_name in ('A', 'B') group by customer_id having count(product_name) = 2 and customer_id not in (select customer_id from orders where product_name = 'C')
select o.customer_id, customer_name from orders as o left join customers as c on o.customer_id = c.customer_id where product_name = 'A' or product_name = 'B' group by customer_id having count(product_name) = 2 and customer_id not in (select customer_id from orders where product_name = 'C')
select o.customer_id, customer_name from orders o join customers c on o.customer_id = c.customer_id group by o.customer_id having sum(product_name='A')>0 and sum(product_name='B')>0 and sum(product_name='C')=0
select o.customer_id, customer_name from orders o left join Customers c on c.customer_id=o.customer_id group by customer_id having sum(if(product_name = "C",1,0 )) = 0 and sum(if(product_name = "B",1,0 ))>0 and sum(if(product_name = "A",1,0 )) >0
select o.customer_id,c.customer_name from Customers c join Orders o on c.customer_id = o.customer_id where o.customer_id in (select customer_id from Orders where product_name = 'A') and o.customer_id in (select customer_id from Orders where product_name = 'B') and o.customer_id not in (select customer_id from Orders where product_name = 'C') group by o.customer_id
select o.customer_id,c.customer_name from orders o join customers c on c.customer_id = o.customer_id group by o.customer_id having sum(case when o.product_name = 'A' then 1 else 0 end) >= 1 and sum(case when o.product_name = 'B' then 1 else 0 end) >= 1 and sum(case when o.product_name = 'C' then 1 else 0 end) = 0
select o1.customer_id, c.customer_name from orders as o1, orders as o2, customers as c WHERE o1.customer_id = c.customer_id and o1.customer_id = o2.customer_id and o1.product_name = 'A' and o2.product_name = 'B' and o1.customer_id NOT in (select customer_id from orders where product_name = 'C') ORDER BY o1.customer_id
select sub1.customer_id , c.customer_name from ( select customer_id from orders where product_name = 'A') sub1 join ( select customer_id from orders where product_name = 'B') sub2 on sub1.customer_id = sub2.customer_id left join (select customer_id from orders where product_name = 'C') sub3 on sub1.customer_id = sub3.customer_id join customers c on sub1.customer_id = c.customer_id where sub3.customer_id is null
select t.customer_id, c.customer_name from (select customer_id from Orders where product_name = 'A' or product_name='B' group by customer_id having count(distinct product_name)=2 )t join Customers c on t.customer_id =c.customer_id where t.customer_id not in (select distinct customer_id from Orders where product_name ='C') order by t.customer_id
select t.customer_id, customer_name from Customers t left join (select distinct customer_id from Orders where product_name = 'A') a on t.customer_id = a.customer_id left join (select distinct customer_id from Orders where product_name = 'B') b on t.customer_id = b.customer_id left join (select distinct customer_id from Orders where product_name = 'C') c on t.customer_id = c.customer_id where a.customer_id is not null and b.customer_id is not null and c.customer_id is null
select t1.customer_id,customer_name from Orders t1 join Orders t2 join Customers on t1.customer_id = t2.customer_id and t1.product_name = 'A' and t2.product_name = 'B' and t1.customer_id = Customers.customer_id where t1.customer_id not in ( select t1.customer_id from Orders t1 join Orders t2 join Orders t3 on t1.customer_id = t2.customer_id and t3.customer_id = t2.customer_id and t1.product_name = 'A' and t2.product_name = 'B' and t3.product_name = 'C')
select tmp.customer_id, c.customer_name from( select customer_id, case when sum(bought_a)>=1 and sum(bought_b)>=1 and sum(bought_c)=0 then 1 else 0 end as bought_ab_not_c from ( select customer_id, case when product_name in ('A') then 1 else 0 end as bought_a, case when product_name in ('B') then 1 else 0 end as bought_b, case when product_name in ('C') then 1 else 0 end as bought_c from orders ) a group by 1 ) tmp left join customers c on c.customer_id=tmp.customer_id where bought_ab_not_c=1
with AB as ( Select o1.customer_id from Orders o1 inner join Orders o2 on o1.customer_id = o2.customer_id where o1.product_name = 'A' and o2.product_name = 'B' ) Select * from Customers where customer_id in (Select * from AB) and customer_id not in (Select customer_id from Orders where product_name = 'C')
with AB as (select C.customer_id ID, C.customer_name NAME from Customers C join Orders O on O.customer_id = C.customer_id join Orders O2 on O2.customer_id = C.customer_id where O.product_name = 'A' and O2.product_name = 'B'), haveC as (select C2.customer_id "ID2", C2.customer_name NAME2 from Customers C2 join Orders O4 on O4.customer_id = C2.customer_id where O4.product_name = "C"), JOINER as (select * from AB left join haveC on AB.ID = haveC.ID2) select ID "CUSTOMER_ID", NAME "CUSTOMER_NAME" from JOINER where ID2 is null
with CTE1 as (select customer_id from orders where customer_id in (select distinct customer_id from orders where product_name = 'B') and product_name = 'A' and customer_id not in (select distinct customer_id from orders where product_name = 'C')) select CTE1.customer_id, customer_name from CTE1 join Customers c on c.customer_id = CTE1.customer_id order by CTE1.customer_id
with a as ( select customer_id from orders where product_name = 'A'), b as (select customer_id from orders where product_name = 'B') select a.customer_id, c.customer_name from a join b on a.customer_id = b.customer_id join customers c on a.customer_id = c.customer_id and a.customer_id not in (select customer_id from orders where product_name = 'C')
with agg as ( select t1.customer_id, t2.customer_name, sum(case when t1.product_name = 'A' then 1 else 0 end) as num_A, sum(case when t1.product_name = 'B' then 1 else 0 end) as num_B, sum(case when t1.product_name = 'C' then 1 else 0 end) as num_C from Orders t1 inner join Customers t2 on t1.customer_id = t2.customer_id group by t1.customer_id ) select customer_id, customer_name from agg where num_A > 0 and num_B > 0 and num_C = 0
with base as ( select cc.customer_id , cc.customer_name , sum(case when oo.product_name = 'A' then 1 else 0 end) as a_count , sum(case when oo.product_name = 'B' then 1 else 0 end) as b_count , sum(case when oo.product_name = 'C' then 1 else 0 end) as c_count from customers cc join orders oo on cc.customer_id = oo.customer_id group by 1,2 ) select customer_id , customer_name from base where a_count >= 1 and b_count >= 1 and c_count = 0
with both_ab_id as (select distinct customer_id from orders where product_name = 'A' and customer_id in ( select distinct customer_id from orders where product_name = 'B') ), target_id as ( select distinct customer_id from both_ab_id where customer_id not in (select distinct customer_id from orders where product_name = 'C' ) ) select customer_id, customer_name from customers where customer_id in ( select customer_id from target_id) order by customer_id
with boughtAB as ( select customer_id from Orders where product_name in ('A','B') group by customer_id having count(distinct product_name) =2 ), boughtC as ( select distinct customer_id from Orders where product_name in ('C') ) select * from Customers where customer_id in (select * from boughtAB) and customer_id not in (select * from boughtC)
with bought_a as ( select c.customer_id ,c.customer_name, o.product_name from customers c join orders o on c.customer_id = o.customer_id where o.product_name = 'A' ), bought_b as ( select c.customer_id ,c.customer_name, o.product_name from customers c join orders o on c.customer_id = o.customer_id where o.product_name = 'B') ,bought_c as ( select c.customer_id,c.customer_name , o.product_name from customers c join orders o on c.customer_id = o.customer_id where o.product_name = 'C' ) select distinct a.customer_id, a.customer_name from bought_a a join bought_b b on a.customer_id = b.customer_id where a.customer_id not in (select customer_id from bought_c where product_name = 'C')
with bought_a as ( select distinct customer_id from orders where product_name = 'A' ), bought_b as ( select distinct customer_id from orders where product_name = 'B' ), bought_c as ( select distinct customer_id from orders where product_name = 'C' ) select bought_a.customer_id, customers.customer_name from bought_a inner join bought_b using (customer_id) inner join customers using (customer_id) where bought_a.customer_id not in (select customer_id from bought_c)
with bought_ab as (select c.customer_id, c.customer_name from customers c left join orders o using(customer_id) where product_name = 'A' or product_name = 'B' group by 1,2 having count(product_name)>=2) select customer_id, customer_name from bought_ab where customer_id not in (select customer_id from orders where product_name = 'C')
with cte as ( select a.cid as customerid from (select customer_id as cid from orders where product_name = 'A' ) a join (select customer_id as cid from orders where product_name = 'B') b on a.cid = b.cid where a.cid not in (select distinct customer_id as cid from orders where product_name = 'C') ) select distinct c.customer_id, c.customer_name from customers c join cte on c.customer_id = cte.customerid
with cte as ( select a.cid as customerid from (select customer_id as cid from orders where product_name = 'A' ) a join (select customer_id as cid from orders where product_name = 'B') b on a.cid = b.cid where a.cid not in (select distinct customer_id as cid from orders where product_name = 'C') ) select distinct c.customer_id, c.customer_name from customers c join cte on c.customer_id = cte.customerid order by c.customer_id
with cte as ( select customer_id from orders where product_name = 'C') select distinct o.customer_id, customer_name from orders o join customers c on o.customer_id = c.customer_id where o.customer_id in (select customer_id from orders where product_name = 'A') and o.customer_id in (select customer_id from orders where product_name = 'B') and o.customer_id not in (select customer_id from orders where product_name ='C')
with cte as ( select customer_id from(select customer_id, case when product_name in ('A') then 1 else 0 end as A from Orders) x where A <> 0 ), cte1 as (select customer_id from(select customer_id, case when product_name in ('B') then 1 else 0 end as B from Orders) x where B <> 0 ), cte2 as ( select customer_id from(select customer_id, case when product_name = 'C' then 1 else 0 end as C from Orders) y where C = 1) select distinct customer_id, customer_name from Customers where customer_id in (select * from cte) and customer_id in (select * from cte1) and customer_id not in (select * from cte2) order by 1
with cte as ( select customer_id, sum(case when product_name = 'A' then 1 else 0 end ) as A, sum(case when product_name = 'B' then 1 else 0 end ) as B, sum(case when product_name = 'C' then 1 else 0 end ) as C from Orders group by 1 ) select customer_id, customer_name from Customers where customer_id in ( select customer_id from cte where A > 0 and B > 0 and C = 0 ) order by 1
with cte as ( select customer_id, sum(case when product_name='A' then 1 else 0 end) prod_A, sum(case when product_name='B' then 1 else 0 end) prod_B, sum(case when product_name='C' then 1 else 0 end) prod_C from orders group by customer_id ) select cte.customer_id,customer_name from cte, customers c where c.customer_id = cte.customer_id and prod_A>0 and prod_B>0 and prod_C=0
with cte as ( select customer_name, O.customer_id, sum( case when product_name in ('A','B') then 1 when product_name = 'C' then -1 end) 'sums' from Orders O inner join Customers C on O.customer_id = C.customer_id group by customer_name, O.customer_id ) select customer_id,customer_name from cte where sums =2
with cte as ( select distinct a.customer_id from Orders a inner join Orders b on a.customer_id = b.customer_id where a.product_name = 'A' and b.product_name = 'B' and a.customer_id not in ( select distinct c.customer_id from Orders c where c.product_name = 'C' ) ) select cte.customer_id , c.customer_name from cte inner join Customers c on cte.customer_id = c.customer_id order by 1
with cte as ( select distinct customer_id from Orders where customer_id not in (select distinct customer_id from Orders where product_name = 'C') and product_name ='A' ) select customer_id,customer_name from Orders join Customers using (customer_id) where customer_id in (select * from cte ) and product_name ='B'
with cte as (select c.customer_name, o.customer_id, o.product_name, sum(if(product_name="A", 1, 0)) as A, sum(if(product_name="B", 1, 0)) as B, sum(if(product_name="C", 1, 0)) as C, sum(if(product_name="D", 1, 0)) as D from orders o join customers c on o.customer_id = c.customer_id group by o.customer_id) select customer_id, customer_name from cte where A=1 and B=1 and C=0
with cte as (select o.customer_id ,customer_name , product_name from Customers c left join Orders o on c.customer_id = o.customer_id) select distinct customer_id ,customer_name from cte where product_name in ('A') AND customer_id not in (select customer_id from cte where product_name ='C') and customer_id in (select customer_id from cte where product_name ='B')
with cte as( select customer_id from orders where product_name = 'A') , cte2 as(select customer_id from orders where product_name = 'B' ) , cte3 as( select customer_id from orders where product_name = 'C' ) select distinct customer_id, customer_name from orders join customers c using (customer_id) where customer_id in (select customer_id from cte) and customer_id in (select customer_id from cte2) and customer_id not in (select customer_id from cte3)
with cte as( select customer_id, sum(case when product_name='A' then 1 else 0 end) as A, sum(case when product_name='B' then 1 else 0 end) as B, sum(case when product_name='C' then 1 else 0 end) as C from orders group by customer_id) select cte.customer_id, c.customer_name from cte join customers c on cte.customer_id = c.customer_id where A >= 1 and B>=1 and C=0
with cte as( select order_id, customer_id, product_name from orders where product_name = 'A' OR product_name = 'B'), cte2 as( select customer_id, count(product_name) as n from cte group by 1), cte3 as( select customer_id from cte2 where n = 2), cte4 as( select customer_id from orders where product_name = 'C') select distinct o.customer_id, c.customer_name from orders o join customers c on o.customer_id = c.customer_id where o.customer_id in (select customer_id from cte3) and o.customer_id not in (select customer_id from cte4)
with cte as( select order_id, orders.customer_id, customer_name, case when product_name = 'A' then 1 else 0 end as A, case when product_name = 'B' then 1 else 0 end as B, case when product_name = 'C' then 1 else 0 end as C from Orders left join customers on orders.customer_id=customers.customer_id) select customer_id,customer_name from( select customer_id,customer_name,sum(A) as A,sum(B) as B,sum(C) as C from cte group by customer_id ) as t where a>=1 and b>=1 and c=0
with cte as(select customer_id, group_concat(product_name) as concat from orders group by customer_id) select c.customer_id as customer_id, c.customer_name as customer_name from cte join customers as c on cte.customer_id = c.customer_id where (cte.concat like "%A%B%" and cte.concat not like "%C%" or cte.concat like "%B%A%" and cte.concat not like "%C%" )
with cte1 as (select customer_id from Orders where customer_id not in (select distinct customer_id from Orders where product_name = 'C')), cte2 as (select customer_id from cte1 where customer_id in (select customer_id from Orders where product_name = 'A' )), cte3 as (select customer_id from cte2 where customer_id in (select customer_id from Orders where product_name = 'B')) select distinct cte3.customer_id, customer_name from cte3 inner join Customers on cte3.customer_id = Customers.customer_id order by 1
with cus_A as (select distinct customer_id from Orders where product_name like 'A'), cus_B as (select distinct customer_id from Orders where product_name like 'B'), cus_C as (select distinct customer_id from Orders where product_name like 'C') select distinct c.customer_id , c.customer_name from Customers c where c.customer_id in (select customer_id from cus_A) and c.customer_id in (select customer_id from cus_B) and c.customer_id not in (select customer_id from cus_C)
with cust_a as (select customer_id from orders where product_name = 'A'), cust_b as (select customer_id from orders where product_name = 'B') select cust_a.customer_id, c.customer_name from cust_a inner join cust_b on cust_a.customer_id = cust_b.customer_id inner join customers c on cust_a.customer_id = c.customer_id where cust_a.customer_id NOT IN (select customer_id from orders where product_name = 'C')
with customers_who_ordered_a as ( SELECT distinct customer_id FROM Orders WHERE product_name = 'A' ), customers_who_ordered_b as ( SELECT distinct customer_id FROM Orders WHERE product_name = 'B' ), customers_who_ordered_c as ( SELECT distinct customer_id FROM Orders WHERE product_name = 'C' ), customers_ordered_ab_not_c as ( SELECT a.customer_id FROM customers_who_ordered_a a, customers_who_ordered_b b WHERE a.customer_id = b.customer_id AND a.customer_id not in (select customer_id from customers_who_ordered_c) ) SELECT cu.customer_id, customer_name FROM customers_ordered_ab_not_c c JOIN Customers cu ON cu.customer_id = c.customer_id
with final1 as ( with final as ( with consolidated as ( Select c.customer_id,c.customer_name,o.product_name from Customers c inner join Orders o on c.customer_id = o.customer_id ) Select * , case when product_name = 'A' then 1 else 0 end as 'product_A_check', case when product_name = 'B' then 1 else 0 end as 'product_B_check', case when product_name = 'C' then 1 else 0 end as 'product_C_check' from consolidated ) Select customer_id,customer_name, sum(product_A_check) as sum_A, sum(product_B_check) as sum_B, sum(product_C_check) as sum_C from final group by customer_id ) Select customer_id,customer_name from final1 where sum_A <> 0 and sum_B <> 0 and sum_C = 0
with lefty as (select distinct c.customer_id, customer_name, o.product_name from customers c join orders o on c.customer_id = o.customer_id where o.product_name = 'A' or o.product_name = 'B') select customer_id, customer_name from lefty where customer_id not in (select distinct customer_id from orders o where product_name = 'C') group by customer_id having count(*) = 2
with lefty as (select distinct c.customer_id, customer_name, o.product_name from customers c join orders o on c.customer_id = o.customer_id where o.product_name = 'A' or o.product_name = 'B'), righty as ( select distinct customer_id from orders o where product_name = 'C' ) select customer_id, customer_name from lefty where customer_id not in (select distinct customer_id from righty) group by customer_id having count(*) = 2
with order_ab as ( select customer_id, sum(case when product_name ='C' then -1 when product_name ='A' then 0.5 when product_name ='B' then 0.5 else 0 end ) as product_count from Orders group by customer_id having product_count = 1) select a.customer_id, b.customer_name from order_ab a left join Customers b on a.customer_id = b.customer_id
with order_count as ( select customer_id, sum(case when product_name = 'A' THEN 1 else 0 end) as product_A, sum(case when product_name = 'B' THEN 1 else 0 end) as product_B, sum(case when product_name = 'C' THEN 1 else 0 end) as product_C from orders GROUP BY customer_id) select a.customer_id,a.customer_name from customers a join order_count oc on a.customer_id=oc.customer_id and oc.product_A >0 and oc.product_B >0 and oc.product_C =0
with prodA as ( SELECT customer_id FROM Orders WHERE product_name = 'A' ), prodB as ( SELECT customer_id FROM Orders WHERE product_name = 'B' ), prodC as ( SELECT customer_id FROM Orders WHERE product_name = 'C' ) SELECT u.* FROM Customers u JOIN prodA ON u.customer_id = prodA.customer_id JOIN prodB ON u.customer_id = prodB.customer_id LEFT JOIN prodC ON u.customer_id = prodC.customer_id WHERE prodC.customer_id is NULL
with refined as( select customer_id, sum(case when product_name = 'A' then 1 else 0 end) as a, sum(case when product_name = 'B' then 1 else 0 end) as b, sum(case when product_name = 'C' then 1 else 0 end) as c from Orders group by 1) select r.customer_id, c.customer_name from refined r left join Customers c on r.customer_id = c.customer_id where r.a > 0 and r.b > 0 and r.c = 0
with subtable as (select customer_id, product_name from orders group by customer_id, product_name), table2 as (select customer_id , sum(case when product_name = "A" then 1 when product_name = "B" then 1 when product_name = "C" then -1 else 0 end) as person_value from subtable group by customer_id) select t.customer_id, c.customer_name from table2 as t left join customers as c on c.customer_id = t.customer_id where person_value = 2
with t as ( select customer_id, case when product_name = "A" then 1 else 0 end as aflag, case when product_name = "B" then 1 else 0 end as bflag, case when product_name = "C" then 1 else 0 end as cflag from orders ) select c.customer_id,c.customer_name from t join customers c on c.customer_id = t.customer_id group by 1 having sum(aflag) > 0 and sum(bflag) >0 and sum(cflag) = 0
with t as ( select customer_id, sum(if(product_name='A' or product_name='B', 1, 0)) ab, sum(if(product_name='C', 1, 0)) c from orders group by customer_id ) select t.customer_id, c.customer_name from t join customers c on t.customer_id=c.customer_id where t.ab=2 and t.c=0
with t1 as ( select customer_id,product_name,count(1)cn from Orders group by customer_id,product_name ), get_trans as ( select customer_id, sum( case when product_name = 'A' then cn end ) as a, sum( case when product_name = 'B' then cn end) as b, sum(case when product_name = 'C' then cn end )c from t1 group by 1) select g.customer_id,c.customer_name from get_trans g join Customers c on g.customer_id = c.customer_id where a>0 and b>0 and c is null order by 1
with t1 as (select distinct(c.customer_id) id from customers c join orders o using(customer_id) where product_name = 'C') select o1.customer_id, c.customer_name from Orders o1 join Orders o2 using (customer_id) join customers c using(customer_id) where o1.product_name = 'A' and o2.product_name = 'B' and customer_id not in(select id from t1)
with temp as ( select distinct customer_id, product_name from Orders ) select t.customer_id, c.customer_name from temp t left join Customers c on t.customer_id = c.customer_id group by customer_id having sum(case product_name when 'A' then 1 when 'B' then 2 when 'C' then 4 else 0 end) = 3
with temp as ( select distinct customer_id, product_name from Orders ) select t.customer_id, c.customer_name from temp t left join Customers c on t.customer_id = c.customer_id group by customer_id having sum(product_name = 'A') > 0 and sum(product_name = 'B') > 0 and sum(product_name = 'C') = 0
with temp1 as ( select distinct o1.customer_id from orders o1, orders o2 where o1.customer_id = o2.customer_id and o1.product_name = 'A' and o2.product_name = 'B' ), temp2 as ( select customer_id from orders where product_name = 'C' ) select t1.customer_id, customer_name from temp1 t1 left join temp2 t2 on t1.customer_id = t2.customer_id join customers c on t1.customer_id = c.customer_id where t2.customer_id is null
with tmp as ( select distinct customer_id from Orders where product_name = 'C' ), tmp2 as ( select distinct customer_id from Orders where product_name = 'A' and not customer_id in (select customer_id from tmp) ), tmp3 as ( select distinct customer_id from Orders where product_name = 'B' and customer_id in (select customer_id from tmp2) and not customer_id in (select customer_id from tmp) ) select c.customer_id, customer_name from Customers c join tmp3 t on c.customer_id = t.customer_id order by customer_id
