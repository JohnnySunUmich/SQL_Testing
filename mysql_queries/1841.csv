SELECT *, (goal_for - goal_against) as goal_diff from ( SELECT t.team_name, count(*)as matches_played, sum(case when team_id = m.home_team_id and home_team_goals>away_team_goals then 3 when team_id = m.home_team_id and home_team_goals=away_team_goals then 1 when team_id = m.away_team_id and home_team_goals<away_team_goals then 3 when team_id = m.away_team_id and home_team_goals=away_team_goals then 1 else 0 end )as points, sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals else 0 end)as goal_for, sum(case when team_id = home_team_id then away_team_goals when team_id = away_team_id then home_team_goals else 0 end)as goal_against from Teams t join Matches m on t.team_id = m.home_team_id or t.team_id = away_team_id group by t.team_id )t ORDER BY points DESC, goal_diff DESC, team_name
SELECT *, (goal_for - goal_against) goal_diff FROM (SELECT team_name, COUNT(team_name) matches_played, SUM(CASE WHEN home_team_id = team_id AND home_team_goals > away_team_goals THEN 3 WHEN home_team_id = team_id AND home_team_goals < away_team_goals THEN 0 WHEN away_team_id = team_id AND home_team_goals < away_team_goals THEN 3 WHEN away_team_id = team_id AND home_team_goals > away_team_goals THEN 0 ELSE 1 END) points, SUM(CASE WHEN home_team_id = team_id THEN home_team_goals WHEN away_team_id = team_id THEN away_team_goals END) goal_for, SUM(CASE WHEN home_team_id = team_id THEN away_team_goals WHEN away_team_id = team_id THEN home_team_goals END) goal_against FROM Teams T1 JOIN Matches M1 ON T1.team_id = M1.home_team_id OR T1.team_id = M1.away_team_id GROUP BY T1.team_name) Temp ORDER BY points DESC, goal_diff DESC, team_name
SELECT *, (goal_for-goal_against) as goal_diff FROM (SELECT team_name, count(team_id) as matches_played, SUM(CASE WHEN team_id=home_team_id AND home_team_goals>away_team_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=home_team_id AND home_team_goals=away_team_goals THEN 1 ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id AND away_team_goals>home_team_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id AND away_team_goals=home_team_goals THEN 1 ELSE 0 END) as points, SUM(CASE WHEN team_id = away_team_id THEN away_team_goals WHEN team_id = home_team_id THEN home_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN team_id = away_team_id THEN home_team_goals WHEN team_id = home_team_id THEN away_team_goals ELSE 0 END) AS goal_against FROM Matches m LEFT JOIN Teams t ON t.team_id=m.home_team_id OR t.team_id=m.away_team_id GROUP BY team_id) t ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT *, goal_for-goal_against AS goal_diff FROM (SELECT team_name, COUNT((team_id) IN (home_team_id,away_team_id)) AS matches_played, SUM( CASE WHEN team_id = home_team_id AND home_team_goals>away_team_goals THEN 3 WHEN team_id = away_team_id AND away_team_goals>home_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals<away_team_goals THEN 0 WHEN team_id = away_team_id AND away_team_goals<home_team_goals THEN 0 ELSE 1 END) AS points, SUM( CASE WHEN team_id = home_team_id THEN home_team_goals WHEN team_id = away_team_id THEN away_team_goals END) AS goal_for, SUM( CASE WHEN team_id = home_team_id THEN away_team_goals WHEN team_id = away_team_id THEN home_team_goals END) AS goal_against FROM Teams JOIN Matches ON Teams.team_id = Matches.home_team_id OR Teams.team_id = Matches.away_team_id GROUP BY Teams.team_id) temp ORDER BY temp.points DESC, goal_diff DESC, team_name
SELECT T.*, goal_for - goal_against AS goal_diff FROM (SELECT team_name, SUM( team_id IN (home_team_id, away_team_id) ) AS matches_played, SUM(CASE WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals < away_team_goals THEN 0 WHEN team_id = away_team_id AND home_team_goals > away_team_goals THEN 0 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 ELSE 1 END) AS points, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals WHEN team_id = away_team_id THEN away_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN team_id = home_team_id THEN away_team_goals WHEN team_id = away_team_id THEN home_team_goals END) AS goal_against FROM Matches M JOIN Teams ON (team_id in (home_team_id, away_team_id)) GROUP BY team_id ) AS T ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT T.*, goal_for - goal_against AS goal_diff FROM (SELECT team_name, SUM(team_id IN (home_team_id, away_team_id)) AS matches_played, SUM(CASE WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals < away_team_goals THEN 0 WHEN team_id = away_team_id AND away_team_goals > home_team_goals THEN 3 WHEN team_id = away_team_id AND away_team_goals < home_team_goals THEN 0 ELSE 1 END) AS points, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals WHEN team_id = away_team_id THEN away_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN team_id = home_team_id THEN away_team_goals WHEN team_id = away_team_id THEN home_team_goals ELSE 0 END) AS goal_against FROM Matches M JOIN Teams ON (team_id IN (home_team_id, away_team_id)) GROUP BY team_id ) AS T ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT T.team_name, SUM(M.home_team_id = T.team_id)+SUM(M.away_team_id = T.team_id) 'matches_played', SUM(CASE WHEN M.home_team_id = T.team_id AND M.home_team_goals > M.away_team_goals THEN 3 WHEN M.home_team_id = T.team_id AND M.home_team_goals < M.away_team_goals THEN 0 WHEN M.away_team_id = T.team_id AND M.away_team_goals > M.home_team_goals THEN 3 WHEN M.away_team_id = T.team_id AND M.away_team_goals < M.home_team_goals THEN 0 ELSE 1 END) 'points', SUM(CASE WHEN M.home_team_id = T.team_id THEN M.home_team_goals ELSE M.away_team_goals END) 'goal_for', SUM(CASE WHEN M.home_team_id = T.team_id THEN M.away_team_goals ELSE M.home_team_goals END) 'goal_against', SUM(CASE WHEN M.home_team_id = T.team_id THEN M.home_team_goals ELSE M.away_team_goals END) - SUM(CASE WHEN M.home_team_id = T.team_id THEN M.away_team_goals ELSE M.home_team_goals END) 'goal_diff' FROM Matches M JOIN Teams T ON M.home_team_id = T.team_id OR M.away_team_id = T.team_id GROUP BY T.team_id ORDER BY 3 DESC, 6 DESC, 1 ASC
SELECT TEAMS.TEAM_NAME AS team_name , COUNT(B.TEAM_ID) AS matches_played, sum(CASE WHEN B.SCORED_FOR > B.SCORED_AGA THEN 3 WHEN B.SCORED_FOR = B.SCORED_AGA THEN 1 ELSE 0 END) AS points, SUM(B.SCORED_FOR) AS goal_for, SUM(B.SCORED_AGA) AS goal_against, SUM(B.SCORED_FOR-B.SCORED_AGA) AS goal_diff FROM (SELECT HOME_TEAM_ID AS TEAM_ID, HOME_TEAM_GOALS AS SCORED_FOR, AWAY_TEAM_GOALS AS SCORED_AGA FROM MATCHES UNION all SELECT AWAY_TEAM_ID AS TEAM_ID , AWAY_TEAM_GOALS AS SCORED_FOR , HOME_TEAM_GOALS AS SCORED_AGA FROM MATCHES) AS B JOIN TEAMS ON B.TEAM_ID =TEAMS.TEAM_ID GROUP BY 1, B.TEAM_ID ORDER BY POINTS DESC, GOAL_DIFF DESC, TEAM_NAME asc
SELECT TEAMS.TEAM_NAME AS team_name , COUNT(B.TEAM_ID) AS matches_played, sum(CASE WHEN B.SCORED_FOR > B.SCORED_AGA THEN 3 WHEN B.SCORED_FOR = B.SCORED_AGA THEN 1 ELSE 0 END) AS points, SUM(B.SCORED_FOR) AS goal_for, SUM(B.SCORED_AGA) AS goal_against, SUM(B.SCORED_FOR-B.SCORED_AGA) AS goal_diff FROM (SELECT HOME_TEAM_ID AS TEAM_ID, HOME_TEAM_GOALS AS SCORED_FOR, AWAY_TEAM_GOALS AS SCORED_AGA FROM MATCHES UNION all SELECT AWAY_TEAM_ID AS TEAM_ID , AWAY_TEAM_GOALS AS SCORED_FOR , HOME_TEAM_GOALS AS SCORED_AGA FROM MATCHES) AS B JOIN TEAMS ON B.TEAM_ID =TEAMS.TEAM_ID GROUP BY B.TEAM_ID ORDER BY POINTS DESC, GOAL_DIFF DESC, TEAM_NAME asc
SELECT Teams.team_name, COUNT(Matches_2.team_id) matches_played, SUM(points) points, SUM(this_team_goals) goal_for, SUM(other_team_goals) goal_against, SUM(this_team_goals)-SUM(other_team_goals) goal_diff FROM (SELECT *, CASE WHEN this_team_goals>other_team_goals THEN 3 WHEN this_team_goals=other_team_goals THEN 1 ELSE 0 END points FROM (SELECT home_team_id team_id, home_team_goals this_team_goals, away_team_goals other_team_goals FROM Matches UNION ALL SELECT away_team_id team_id, away_team_goals this_team_goals, home_team_goals other_team_goals FROM Matches)poop ) Matches_2 LEFT JOIN Teams on Matches_2.team_id=Teams.team_id GROUP BY team_name ORDER BY points desc, goal_diff desc, team_name
SELECT Teams.team_name, sub.matches_played, sub.points, sub.goal_for, sub.goal_against, sub.goal_diff FROM (SELECT home_id, COUNT(*) AS matches_played, SUM(points) AS points, SUM(home_goals) AS goal_for, SUM(away_goals) AS goal_against, SUM(home_goals) - SUM(away_goals) AS goal_diff FROM (SELECT home_team_id AS home_id, away_team_id AS away_id, home_team_goals AS home_goals, away_team_goals AS away_goals, CASE WHEN home_team_goals<away_team_goals THEN 0 WHEN home_team_goals>away_team_goals THEN 3 ELSE 1 END AS points FROM Matches UNION ALL SELECT away_team_id AS home_id, home_team_id AS away_id, away_team_goals AS home_goals, home_team_goals AS away_goals, CASE WHEN away_team_goals<home_team_goals THEN 0 WHEN away_team_goals>home_team_goals THEN 3 ELSE 1 END AS points FROM Matches) total GROUP BY home_id) sub JOIN Teams ON Teams.team_id = sub.home_id ORDER BY sub.points DESC, sub.goal_diff DESC, Teams.team_name
SELECT c.team_name, c.matches_played, c.points, d.goal_for, d.goal_against, d.goal_diff FROM (SELECT team_id, team_name, COUNT(team_id) AS matches_played, SUM(CASE WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals = away_team_goals THEN 1 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN team_id = away_team_id AND home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points FROM teams t JOIN matches m ON m.home_team_id = t.team_id OR m.away_team_id = t.team_id GROUP BY team_id) AS c JOIN (SELECT a.id, SUM(a.goal_for) AS goal_for, SUM(a.goal_against) AS goal_against, SUM(a.goal_for)-SUM(a.goal_against) AS goal_diff FROM (SELECT home_team_id AS id, home_team_goals AS goal_for, away_team_goals AS goal_against FROM matches UNION ALL SELECT away_team_id AS id, away_team_goals AS goal_for, home_team_goals AS goal_against FROM matches) AS a GROUP BY id) AS d ON c.team_id = d.id ORDER BY points DESC, goal_diff DESC, team_name
SELECT t.team_name ,COUNT(t.team_id) AS matches_played ,SUM(CASE WHEN (t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals) OR (t.team_id = m.away_team_id AND m.home_team_goals < m.away_team_goals) THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 ELSE 0 END) AS points ,SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals WHEN t.team_id = m.away_team_id THEN m.away_team_goals ELSE 0 END) AS goal_for ,SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals WHEN t.team_id = m.away_team_id THEN m.home_team_goals ELSE 0 END) AS goal_against ,SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals WHEN t.team_id = m.away_team_id THEN m.away_team_goals ELSE 0 END) - SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals WHEN t.team_id = m.away_team_id THEN m.home_team_goals ELSE 0 END) AS goal_diff FROM Teams t INNER JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_id ORDER BY points DESC, goal_diff DESC, t.team_name
SELECT t.team_name ,COUNT(t.team_id) AS matches_played ,SUM(CASE WHEN (t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals) OR (t.team_id = m.away_team_id AND m.home_team_goals < m.away_team_goals) THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 ELSE 0 END) AS points ,SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals WHEN t.team_id = m.away_team_id THEN m.away_team_goals ELSE 0 END) AS goal_for ,SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals WHEN t.team_id = m.away_team_id THEN m.home_team_goals ELSE 0 END) AS goal_against ,SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals WHEN t.team_id = m.away_team_id THEN m.away_team_goals ELSE 0 END) - SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals WHEN t.team_id = m.away_team_id THEN m.home_team_goals ELSE 0 END) AS goal_diff FROM Teams t INNER JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_id, t.team_name ORDER BY points DESC, goal_diff DESC, t.team_name
SELECT t.team_name ,IFNULL(COUNT(1), 0) AS 'matches_played' ,IFNULL(SUM(CASE WHEN t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals THEN 3 WHEN t.team_id = m.away_team_id AND m.home_team_goals < m.away_team_goals THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 ELSE 0 END), 0) AS 'points' ,IFNULL(SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals ELSE m.away_team_goals END), 0) AS 'goal_for' ,IFNULL(SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals ELSE m.home_team_goals END), 0) AS 'goal_against' ,IFNULL(SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals ELSE m.away_team_goals END), 0) - IFNULL(SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals ELSE m.home_team_goals END), 0) AS 'goal_diff' FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT t.team_name, COUNT(*) AS matches_played, SUM( CASE WHEN t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals THEN 3 WHEN t.team_id = m.home_team_id AND m.home_team_goals = m.away_team_goals THEN 1 WHEN t.team_id = m.away_team_id AND m.away_team_goals > m.home_team_goals THEN 3 WHEN t.team_id = m.away_team_id AND m.away_team_goals = m.home_team_goals THEN 1 ELSE 0 END ) AS points, SUM( CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals ELSE m.away_team_goals END ) AS goal_for, SUM( CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals ELSE m.home_team_goals END ) AS goal_against, (SUM( CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals ELSE m.away_team_goals END )-SUM( CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals ELSE m.home_team_goals END )) AS goal_diff FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, t.team_name
SELECT t.team_name, COUNT(*) AS matches_played, SUM(CASE WHEN home > away THEN 3 WHEN home = away THEN 1 ELSE 0 END) AS points, SUM(home) AS goal_for, SUM(away) AS goal_against, SUM(home) - SUM(away) AS goal_diff FROM Teams t JOIN (SELECT home_team_id, home_team_goals AS home, away_team_goals as away FROM Matches UNION ALL SELECT away_team_id AS home_team_id, away_team_goals AS home, home_team_goals as away FROM Matches) g ON t.team_id = g.home_team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, t.team_name
SELECT t.team_name, COUNT(*) AS matches_played, SUM(m.home_team_id = t.team_id AND m.home_team_goals > m.away_team_goals) * 3 + SUM(m.away_team_id = t.team_id AND m.home_team_goals < m.away_team_goals) * 3 + SUM((m.away_team_id = t.team_id OR m.home_team_id=t.team_id) AND m.home_team_goals = m.away_team_goals) AS points, SUM((m.home_team_id = t.team_id) * m.home_team_goals) + SUM((m.away_team_id = t.team_id) * m.away_team_goals) AS goal_for, SUM((m.home_team_id = t.team_id) * m.away_team_goals) + SUM((m.away_team_id = t.team_id) * m.home_team_goals) AS goal_against, SUM((m.home_team_id = t.team_id) * (m.home_team_goals - m.away_team_goals)) + SUM((m.away_team_id = t.team_id) * (m.away_team_goals - m.home_team_goals))AS goal_diff FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT t.team_name, COUNT(*) as matches_played, SUM(CASE WHEN (t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals) THEN 3 ELSE 0 END) + SUM(CASE WHEN (t.team_id = m.away_team_id AND m.away_team_goals > m.home_team_goals) THEN 3 ELSE 0 END) + SUM(CASE WHEN m.home_team_goals = m.away_team_goals THEN 1 ELSE 0 END) as points, SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals ELSE 0 END) + SUM(CASE WHEN t.team_id = m.away_team_id THEN m.away_team_goals ELSE 0 END) as goal_for, SUM(CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals ELSE 0 END) + SUM(CASE WHEN t.team_id = m.away_team_id THEN m.home_team_goals ELSE 0 END) as goal_against, SUM(CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals - m.away_team_goals ELSE 0 END) + SUM(CASE WHEN t.team_id = m.away_team_id THEN m.away_team_goals - m.home_team_goals ELSE 0 END) as goal_diff FROM Teams t INNER JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_id ORDER BY points DESC, goal_diff DESC, team_name
SELECT t.team_name, SUM( CASE WHEN t.team_id = m.home_team_id THEN 1 WHEN t.team_id = m.away_team_id THEN 1 ELSE 0 END ) AS matches_played, SUM( CASE WHEN (t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals) OR (t.team_id = m.away_team_id AND m.away_team_goals > m.home_team_goals) THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 ELSE 0 END ) AS points, SUM( CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals WHEN t.team_id = m.away_team_id THEN m.away_team_goals END ) AS goal_for, SUM( CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals WHEN t.team_id = m.away_team_id THEN m.home_team_goals END ) AS goal_against, ( SUM( CASE WHEN t.team_id = m.home_team_id THEN m.home_team_goals WHEN t.team_id = m.away_team_id THEN m.away_team_goals END ) - SUM( CASE WHEN t.team_id = m.home_team_id THEN m.away_team_goals WHEN t.team_id = m.away_team_id THEN m.home_team_goals END ) ) AS goal_diff FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT t.team_name, SUM(team_id=away_team_id OR team_id=home_team_id) matches_played, SUM(CASE WHEN team_id=home_team_id AND home_team_goals>away_team_goals THEN 3 WHEN team_id=away_team_id AND home_team_goals<away_team_goals THEN 3 WHEN team_id=home_team_id AND home_team_goals=away_team_goals THEN 1 WHEN team_id=away_team_id AND home_team_goals=away_team_goals THEN 1 ELSE 0 END) points, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals WHEN team_id=away_team_id THEN away_team_goals END) goal_for, SUM(CASE WHEN team_id=home_team_id THEN away_team_goals WHEN team_id=away_team_id THEN home_team_goals END) goal_against, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals - away_team_goals WHEN team_id=away_team_id THEN away_team_goals - home_team_goals END) goal_diff FROM Teams t JOIN Matches m ON t.team_id =m.home_team_id OR t.team_id =m.away_team_id GROUP BY 1 ORDER BY 3 DESC,6 DESC,1
SELECT t.team_name, count(*) matches_played , SUM(CASE WHEN t.team_id = m.home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN t.team_id = m.away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) points , SUM(CASE WHEN t.team_id = m.home_team_id THEN home_team_goals WHEN t.team_id = m.away_team_id THEN away_team_goals END) goal_for , SUM(CASE WHEN t.team_id = m.home_team_id THEN away_team_goals WHEN t.team_id = m.away_team_id THEN home_team_goals END) goal_against , SUM(CASE WHEN t.team_id = m.home_team_id THEN home_team_goals WHEN t.team_id = m.away_team_id THEN away_team_goals END) - SUM(CASE WHEN t.team_id = m.home_team_id THEN away_team_goals WHEN t.team_id = m.away_team_id THEN home_team_goals END) goal_diff FROM teams t JOIN matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, team_name
SELECT t.team_name, count(*) matches_played, SUM(CASE WHEN team_id=home_team_id AND home_team_goals>away_team_goals THEN 3 WHEN team_id=away_team_id AND home_team_goals<away_team_goals THEN 3 WHEN team_id=home_team_id AND home_team_goals=away_team_goals THEN 1 WHEN team_id=away_team_id AND home_team_goals=away_team_goals THEN 1 ELSE 0 END) points, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals WHEN team_id=away_team_id THEN away_team_goals END) goal_for, SUM(CASE WHEN team_id=home_team_id THEN away_team_goals WHEN team_id=away_team_id THEN home_team_goals END) goal_against, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals - away_team_goals WHEN team_id=away_team_id THEN away_team_goals - home_team_goals END) goal_diff FROM Teams t JOIN Matches m ON t.team_id =m.home_team_id OR t.team_id =m.away_team_id GROUP BY 1 ORDER BY 3 DESC,6 DESC,1
SELECT t1.*, goal_for - goal_against AS goal_diff FROM (SELECT team_name, SUM(team_id IN (away_team_id, home_team_id)) AS matches_played, SUM(CASE WHEN team_id = away_team_id AND home_team_goals > away_team_goals THEN 0 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals < away_team_goals THEN 0 ELSE 1 END) AS points, SUM(CASE WHEN team_id = away_team_id THEN away_team_goals WHEN team_id = home_team_id THEN home_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN team_id = away_team_id THEN home_team_goals WHEN team_id = home_team_id THEN away_team_goals ELSE 0 END) AS goal_against FROM Matches m JOIN Teams ON (team_id IN (away_team_id, home_team_id)) GROUP BY team_id ) AS t1 ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT t1.team_name, COUNT(t2.home_team_id) AS matches_played, SUM(CASE WHEN t2.home_team_goals > t2.away_team_goals THEN 3 WHEN t2.home_team_goals = t2.away_team_goals THEN 1 ELSE 0 END) AS points, SUM(t2.home_team_goals) AS goal_for, SUM(t2.away_team_goals) AS goal_against, SUM(t2.home_team_goals - t2.away_team_goals) AS goal_diff FROM Teams t1 JOIN (SELECT * FROM Matches UNION ALL SELECT away_team_id, home_team_id, away_team_goals, home_team_goals FROM Matches) t2 ON t1.team_id = t2.home_team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
SELECT t2.team_name, COUNT(t1.team_id) AS matches_played, SUM(CASE WHEN team_goals > away_team_goals THEN 3 WHEN team_goals < away_team_goals THEN 0 ELSE 1 END)AS points, SUM(team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(team_goals)-SUM(away_team_goals) AS goal_diff FROM( SELECT home_team_id AS team_id, home_team_goals AS team_goals, away_team_goals FROM Matches UNION all SELECT away_team_id AS team_id, away_team_goals AS team_goals, home_team_goals AS away_team_goals FROM Matches )AS t1 LEFT JOIN Teams t2 USING(team_id) GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name , IFNULL(SUM(matches_played),0) AS matches_played,IFNULL(SUM(points),0) AS points, IFNULL(SUM(goal_for),0) AS goal_for, IFNULL(SUM(goal_against),0) AS goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM Teams JOIN (SELECT home_team_id AS team_id,COUNT(home_team_id) AS matches_played, SUM(CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against FROM Matches GROUP BY home_team_id UNION ALL SELECT away_team_id AS team_id,COUNT(away_team_id) AS matches_played, SUM(CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) AS points, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against FROM Matches GROUP BY away_team_id) AS temp USING(team_id) GROUP BY team_id ORDER BY points DESC,goal_diff DESC,team_name
SELECT team_name , M.matches_played , SUM(B.Points) AS points , SUM(B.goals) AS goal_for , SUM(B.away_goals) AS goal_against , SUM(B.goals) - SUM(B.away_goals) AS goal_diff FROM Teams T JOIN (SELECT team_id , SUM(Match_CNT) AS matches_played FROM ( SELECT home_team_id AS team_id , COUNT(home_team_id) AS Match_CNT FROM Matches GROUP BY home_team_id UNION ALL SELECT away_team_id AS team_id , COUNT(away_team_id) AS Match_CNT FROM Matches GROUP BY away_team_id ) A GROUP BY team_id ) M ON T.team_id = M.team_id JOIN ( SELECT home_team_id AS team_id , home_team_goals AS goals , away_team_goals AS away_goals , CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END Points FROM Matches UNION ALL SELECT away_team_id AS team_id , away_team_goals AS goals , home_team_goals AS away_goals , CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals < away_team_goals THEN 3 ELSE 1 END Points FROM Matches ) B ON T.team_id = B.team_id GROUP BY T.team_name , M.matches_played ORDER BY points DESC , goal_diff DESC , team_name
SELECT team_name ,SUM(matches_played) AS matches_played ,SUM(points) AS points ,SUM(goal_for) AS goal_for ,SUM(goal_against) AS goal_against ,SUM(goal_diff) AS goal_diff FROM ( SELECT t.team_name ,COUNT(t.team_id) AS matches_played ,SUM(CASE WHEN m.home_team_goals > m.away_team_goals THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 ELSE 0 END) AS points ,SUM(m.home_team_goals) AS goal_for ,SUM(m.away_team_goals) AS goal_against ,SUM(m.home_team_goals) - SUM(m.away_team_goals) AS goal_diff FROM Teams t INNER JOIN Matches m ON t.team_id = m.home_team_id GROUP BY t.team_id UNION ALL SELECT t1.team_name ,COUNT(t1.team_id) AS matches_played ,SUM(CASE WHEN m1.away_team_goals > m1.home_team_goals THEN 3 WHEN m1.away_team_goals = m1.home_team_goals THEN 1 ELSE 0 END) AS points ,SUM(m1.away_team_goals) AS goal_for ,SUM(m1.home_team_goals) AS goal_against ,SUM(m1.away_team_goals) - SUM(m1.home_team_goals) AS goal_diff FROM Teams t1 INNER JOIN Matches m1 ON t1.team_id = m1.away_team_id GROUP BY t1.team_id ) t GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, COUNT(*) AS matches_played, SUM(CASE WHEN t.team_id = m.home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN t.team_id = m.home_team_id AND home_team_goals = away_team_goals THEN 1 WHEN t.team_id = m.away_team_id AND home_team_goals = away_team_goals THEN 1 WHEN t.team_id = m.away_team_id AND home_team_goals < away_team_goals THEN 3 ELSE 0 END) AS points, SUM(CASE WHEN t.team_id = m.home_team_id THEN home_team_goals WHEN t.team_id = m.away_team_id THEN away_team_goals END) AS goal_for, SUM(CASE WHEN t.team_id = m.home_team_id THEN away_team_goals WHEN t.team_id = m.away_team_id THEN home_team_goals END) AS goal_against, SUM(CASE WHEN t.team_id = m.home_team_id THEN home_team_goals WHEN t.team_id = m.away_team_id THEN away_team_goals END) - SUM(CASE WHEN t.team_id = m.home_team_id THEN away_team_goals WHEN t.team_id = m.away_team_id THEN home_team_goals END) AS goal_diff FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, COUNT(*) AS matches_played, SUM(CASE WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals ELSE away_team_goals END) AS goal_for, SUM(CASE WHEN team_id = home_team_id THEN away_team_goals ELSE home_team_goals END) AS goal_against, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals ELSE away_team_goals END) - SUM(CASE WHEN team_id = home_team_id THEN away_team_goals ELSE home_team_goals END) AS goal_diff FROM Teams INNER JOIN Matches ON team_id = home_team_id OR team_id = away_team_id GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, COUNT(*) AS matches_played, SUM(CASE WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals WHEN team_id = away_team_id THEN away_team_goals END) AS goal_for, SUM(CASE WHEN team_id = home_team_id THEN away_team_goals WHEN team_id = away_team_id THEN home_team_goals END) AS goal_against, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals WHEN team_id = away_team_id THEN away_team_goals END) - SUM(CASE WHEN team_id = home_team_id THEN away_team_goals WHEN team_id = away_team_id THEN home_team_goals END) AS goal_diff FROM teams t INNER JOIN matches m ON t.team_id IN (m.home_team_id, m.away_team_id) GROUP BY team_id, team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, COUNT(*) AS matches_played, SUM(team_id = home_team_id AND home_team_goals > away_team_goals) * 3 + SUM(team_id = away_team_id AND home_team_goals < away_team_goals) * 3 + SUM(team_id = home_team_id AND home_team_goals = away_team_goals) + SUM(team_id = away_team_id AND home_team_goals = away_team_goals) AS points, SUM((team_id = home_team_id) * home_team_goals) + SUM((team_id = away_team_id) * away_team_goals) AS goal_for, SUM((team_id = home_team_id) * away_team_goals) + SUM((team_id = away_team_id) * home_team_goals) AS goal_against, SUM((team_id = home_team_id) * (home_team_goals - away_team_goals)) + SUM((team_id = away_team_id) * (away_team_goals - home_team_goals)) as goal_diff FROM Teams JOIN Matches ON team_id = home_team_id OR team_id = away_team_id GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, COUNT(*) as matches_played, SUM(team_id = home_team_id AND home_team_goals > away_team_goals) * 3 + SUM(team_id = away_team_id AND home_team_goals < away_team_goals) * 3 + SUM(team_id = home_team_id AND home_team_goals = away_team_goals) + SUM(team_id = away_team_id AND home_team_goals = away_team_goals) as points, SUM((team_id = home_team_id) * home_team_goals) + SUM((team_id = away_team_id) * away_team_goals) as goal_for, SUM((team_id = home_team_id) * away_team_goals) + SUM((team_id = away_team_id) * home_team_goals ) as goal_against, SUM((team_id = home_team_id) * (home_team_goals - away_team_goals)) + SUM((team_id = away_team_id) * (away_team_goals - home_team_goals)) as goal_diff FROM Teams JOIN Matches ON team_id = home_team_id OR team_id = away_team_id GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, COUNT(1) AS matches_played, SUM(CASE WHEN home > away THEN 3 WHEN home = away THEN 1 ELSE 0 END) AS points, SUM(home) AS goal_for, SUM(away) AS goal_against, SUM(home - away) AS goal_diff FROM(SELECT home_team_id, home_team_goals AS home, away_team_goals AS away FROM Matches UNION ALL SELECT away_team_id AS home_team_id, away_team_goals AS home, home_team_goals AS away FROM Matches) temp JOIN Teams t ON temp.home_team_id = t.team_id GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, COUNT(a.team_id) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, (SUM(goal_for) - SUM(goal_against)) AS goal_diff FROM (SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 0 END AS points FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 3 END AS points FROM Matches) a JOIN Teams t ON a.team_id = t.team_id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, COUNT(team_name) AS matches_played, SUM(CASE WHEN status = 'home' THEN home_point ELSE away_point END) AS points, SUM(CASE WHEN status = 'home' THEN home_team_goals ELSE away_team_goals END) AS goal_for, SUM(CASE WHEN status = 'away' THEN home_team_goals ELSE away_team_goals END) AS goal_against, SUM(CASE WHEN status = 'home' THEN home_team_goals ELSE away_team_goals END)- SUM(CASE WHEN status = 'away' THEN home_team_goals ELSE away_team_goals END) AS goal_diff FROM( SELECT *, CASE WHEN team_id = home_team_id THEN 'home' ELSE 'away' END AS status, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_point, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END AS away_point FROM Teams t JOIN Matches m ON t.team_id = home_team_id or t.team_id = away_team_id )t GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, COUNT(team_name) AS matches_played, SUM(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for-goal_against) as goal_diff FROM( SELECT t.team_name, CASE WHEN t.team_id=m.home_team_id and home_team_goals>away_team_goals THEN 3 WHEN t.team_id=m.home_team_id and home_team_goals=away_team_goals THEN 1 WHEN t.team_id=m.away_team_id and home_team_goals=away_team_goals THEN 1 WHEN t.team_id=m.away_team_id and home_team_goals<away_team_goals THEN 3 ELSE 0 END as points, CASE WHEN t.team_id=m.home_team_id THEN home_team_goals ELSE away_team_goals END AS goal_for, CASE WHEN t.team_id=m.away_team_id THEN home_team_goals ELSE away_team_goals END AS goal_against FROM teams as t JOIN matches as m ON t.team_id=m.home_team_id or t.team_id=m.away_team_id )a GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, IFNULL(SUM(matches_played),0) AS matches_played, SUM(total_points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_diff) AS goal_diff FROM Teams t JOIN (SELECT home_team_id AS team_id, IFNULL(COUNT(*),0) AS matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS total_points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_team_goals) - SUM(away_team_goals) AS goal_diff FROM Matches GROUP BY home_team_id UNION ALL SELECT away_team_id AS team_id, IFNULL(COUNT(*),0) AS matches_played, SUM(CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS total_points, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM(away_team_goals) - SUM(home_team_goals) AS goal_diff FROM Matches GROUP BY away_team_id ) m ON m.team_id = t.team_id GROUP BY t.team_id ORDER BY 3 DESC, 6 DESC, 1
SELECT team_name, SUM(CASE WHEN t.team_id = home_team_id THEN 1 WHEN t.team_id = away_team_id THEN 1 ELSE 0 END) AS matches_played, SUM(CASE WHEN t.team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN t.team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) points, SUM(CASE WHEN team_id = home_team_id THEN home_team_goals ELSE away_team_goals END) AS goal_for, SUM(CASE WHEN team_id = home_team_id THEN away_team_goals ELSE home_team_goals END) AS goal_against , SUM(CASE WHEN team_id = home_team_id THEN home_team_goals ELSE away_team_goals END) - SUM(CASE WHEN team_id = home_team_id THEN away_team_goals ELSE home_team_goals END) AS goal_diff FROM teams t INNER JOIN matches m ON t.team_id IN (home_team_id, away_team_id) GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, SUM(a.team_id=b.home_team_id)+SUM(a.team_id=b.away_team_id) as matches_played, 3*SUM(a.team_id=b.home_team_id AND home_team_goals>away_team_goals)+ 3*SUM(a.team_id=b.away_team_id AND home_team_goals<away_team_goals)+ SUM(a.team_id=b.home_team_id AND home_team_goals=away_team_goals)+ SUM(a.team_id=b.away_team_id AND home_team_goals=away_team_goals) as points, SUM((a.team_id=b.home_team_id)*home_team_goals)+ SUM((a.team_id=b.away_team_id)*away_team_goals) as goal_for, SUM((a.team_id=b.home_team_id)*away_team_goals)+ SUM((a.team_id=b.away_team_id)*home_team_goals ) as goal_against, SUM((a.team_id=b.home_team_id)*(home_team_goals-away_team_goals))+ SUM((a.team_id=b.away_team_id)*(away_team_goals-home_team_goals)) as goal_diff FROM Teams as a JOIN Matches as b ON a.team_id=b.home_team_id OR a.team_id=b.away_team_id GROUP BY a.team_id ORDER BY points DESC,goal_diff DESC, team_name ASC
SELECT team_name, SUM(matched_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM (SELECT home_team_id AS team_id, team_name,count(*) as matched_played, SUM(CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals<away_team_goals THEN 0 ELSE 1 END) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against FROM Matches m JOIN Teams t ON m.home_team_id= t.team_id GROUP BY 1 union SELECT away_team_id AS team_id, team_name,count(*) as matched_played, SUM(CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals>away_team_goals THEN 0 ELSE 1 END) AS points, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against FROM Matches m JOIN Teams t ON m.away_team_id= t.team_id GROUP BY 1) tmp GROUP BY 1 ORDER BY 3 DESC,6 DESC, 1 ASC
SELECT team_name, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_diff) AS goal_diff FROM ((SELECT home_team_id AS team_id, COUNT(*) AS matches_played, SUM(CASE WHEN home_team_goals - away_team_goals > 0 THEN 3 WHEN home_team_goals - away_team_goals < 0 THEN 0 ELSE 1 END) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_team_goals) - SUM(away_team_goals) AS goal_diff FROM Matches GROUP BY home_team_id) UNION ALL (SELECT away_team_id AS team_id, COUNT(*) AS matches_played, SUM(CASE WHEN away_team_goals - home_team_goals > 0 THEN 3 WHEN away_team_goals - home_team_goals < 0 THEN 0 ELSE 1 END) AS points, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM(away_team_goals) - SUM(home_team_goals) AS goal_diff FROM Matches GROUP BY away_team_id)) AS m JOIN Teams AS t ON m.team_id = t.team_id GROUP BY m.team_id ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, SUM(matches_played) as matches_played, SUM(points) as points, SUM(goal_for) as goal_for, SUM(goal_against) as goal_against, SUM(goal_diff) as goal_diff FROM (SELECT b.team_name as team_name, COUNT(*) as matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) as points, SUM(home_team_goals) as goal_for, SUM(away_team_goals) as goal_against, SUM(home_team_goals - away_team_goals) as goal_diff FROM Matches a JOIN Teams b ON a.home_team_id = b.team_id JOIN Teams c ON a.away_team_id = c.team_id GROUP BY team_name UNION SELECT c.team_name as team_name, COUNT(*) as matches_played, SUM(CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) as points, SUM(away_team_goals) as goal_for, SUM(home_team_goals) as goal_against, SUM(away_team_goals-home_team_goals) as goal_diff FROM Matches a JOIN Teams b ON a.home_team_id = b.team_id JOIN Teams c ON a.away_team_id = c.team_id GROUP BY team_name) t GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, SUM(matches_played) matches_played, SUM(points) as points,SUM(goal_for) goal_for,SUM(goal_against) goal_against, SUM(goal_for - goal_against) as goal_diff FROM ( select team_name , COUNT(*) as matches_played, SUM(CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) as points, SUM(home_team_goals) as goal_for, SUM(away_team_goals) as goal_against FROM Teams m JOIN Matches r ON m.team_id=r.home_team_id GROUP BY team_name UNION ALL select team_name , COUNT(*) as matches_played, SUM(CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) as points,SUM(away_team_goals) as goal_for, SUM(home_team_goals) as goal_against FROM Teams m JOIN Matches r ON m.team_id=r.away_team_id GROUP BY team_name ) temp GROUP BY team_name ORDER BY points desc, goal_diff desc, team_name
SELECT team_name, SUM(team_id = home_team_id) + SUM(team_id = away_team_id) as matches_played, SUM(team_id = home_team_id AND home_team_goals > away_team_goals) * 3+ SUM(team_id = away_team_id AND home_team_goals < away_team_goals) * 3 + SUM(team_id = home_team_id AND home_team_goals = away_team_goals) + SUM(team_id = away_team_id AND home_team_goals = away_team_goals) as points, SUM((team_id = home_team_id) * home_team_goals) + SUM((team_id = away_team_id) * away_team_goals) as goal_for, SUM((team_id = home_team_id) * away_team_goals) + SUM((team_id = away_team_id) * home_team_goals ) as goal_against, SUM((team_id = home_team_id) * (home_team_goals - away_team_goals)) + SUM((team_id = away_team_id) * (away_team_goals - home_team_goals)) as goal_diff FROM Teams JOIN Matches ON team_id = home_team_id OR team_id = away_team_id GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, count(a.team_id) as matches_played, sum(case when score_for > score_against then 3 when score_for < score_against then 0 else 1 end) points, sum(score_for) as goal_for, sum(score_against) as goal_against, sum(score_for - score_against) as goal_diff from (SELECT home_team_id as team_id, home_team_goals as score_for, away_team_goals as score_against from Matches union all SELECT away_team_id as team_id, away_team_goals as score_for, home_team_goals as score_against from Matches) a join teams t on a.team_id = t.team_id group by team_name order by points desc, goal_diff desc, TEAM_NAME asc
SELECT team_name, count(team_id)as matches_played, SUM(CASE WHEN team_id=home_team_id AND home_team_goals>away_Team_goals THEN 3 WHEN team_id=home_team_id AND home_Team_Goals = away_Team_goals THEN 1 WHEN team_id=away_team_id AND home_team_goals<away_team_Goals THEN 3 WHEN team_id=away_team_id AND home_team_goals = away_team_goals THEN 1 ELSE 0 END) points, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals WHEN team_id=away_Team_id THEN away_Team_goals ELSE 0 END) goal_for, SUM(CASE WHEN team_id=home_team_id THEN away_Team_Goals WHEN team_id=away_Team_id THEN home_team_goals ELSE 0 END) goal_against, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals WHEN team_id=away_Team_id THEN away_Team_goals ELSE 0 END)- SUM(CASE WHEN team_id=home_team_id THEN away_Team_Goals WHEN team_id=away_Team_id THEN home_team_goals ELSE 0 END) goal_diff FROM Matches m JOIN Teams t on t.team_id= m.home_team_id or t.team_id=away_Team_id GROUP BY team_id ORDER BY points desc, goal_diff desc, team_name
SELECT team_name, matches_played, points, goal_for, goal_against, (goal_for - goal_against) AS goal_diff FROM( SELECT t.team_name, SUM(CASE WHEN t.team_id = m.home_team_id OR t.team_id = m.away_team_id THEN 1 ELSE 0 END) AS matches_played, SUM(CASE WHEN t.team_id = m.home_team_id AND m.home_team_goals > m.away_team_goals THEN 3 WHEN t.team_id = m.away_team_id AND m.away_team_goals > m.home_team_goals THEN 3 WHEN t.team_id = m.away_team_id AND m.away_team_goals = m.home_team_goals THEN 1 WHEN t.team_id = m.home_team_id AND m.away_team_goals = m.home_team_goals THEN 1 ELSE 0 END) AS points, SUM(CASE WHEN t.team_id = m.home_team_id THEN home_team_goals WHEN t.team_id = m.away_team_id THEN away_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN t.team_id = m.home_team_id THEN away_team_goals WHEN t.team_id = m.away_team_id THEN home_team_goals ELSE 0 END) AS goal_against FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id or t.team_id = m.away_team_id GROUP BY t.team_name) as a ORDER BY points DESC, goal_diff DESC, team_name
SELECT team_name, matches_played, points, goal_for, goal_against, goal_for - goal_against AS goal_diff FROM Teams t2 JOIN (SELECT team_id, SUM(team_id IN (away_team_id, home_team_id)) AS matches_played, SUM(CASE WHEN team_id = away_team_id AND home_team_goals > away_team_goals THEN 0 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals < away_team_goals THEN 0 ELSE 1 END) AS points, SUM(CASE WHEN team_id = away_team_id THEN away_team_goals WHEN team_id = home_team_id THEN home_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN team_id = away_team_id THEN home_team_goals WHEN team_id = home_team_id THEN away_team_goals ELSE 0 END) AS goal_against FROM Matches m JOIN Teams ON (team_id IN (away_team_id, home_team_id)) GROUP BY team_id ) AS t1 USING(team_id) ORDER BY points DESC, goal_diff DESC, team_name ASC
SELECT team_name, matches_played, points, goal_for, goal_against, goal_for-goal_against AS goal_diff FROM ( SELECT team_name, COUNT(*) AS matches_played, SUM(CASE WHEN team_id=home_team_id AND home_team_goals>away_team_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=home_team_id AND home_team_goals=away_team_goals THEN 1 ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id AND away_team_goals>home_team_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id AND away_team_goals=home_team_goals THEN 1 ELSE 0 END) AS points, SUM(CASE WHEN team_id=home_team_id THEN home_team_goals ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id THEN away_team_goals ELSE 0 END) AS goal_for, SUM(CASE WHEN team_id=home_team_id THEN away_team_goals ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id THEN home_team_goals ELSE 0 END) AS goal_against FROM Teams JOIN Matches ON team_id=home_team_id OR team_id=away_team_id GROUP BY team_name ) t ORDER BY points DESC, goal_diff DESC, team_name ASC
Select *, goal_for-goal_against as goal_diff From (Select t.team_name, SUM(case when team_id in (home_team_id, away_team_id) then 1 else 0 end) as matches_played, SUM(case when team_id=home_team_id and home_team_goals>away_team_goals then 3 when team_id=away_team_id and home_team_goals<away_team_goals then 3 when team_id=away_team_id and home_team_goals=away_team_goals then 1 when team_id=home_team_id and home_team_goals=away_team_goals then 1 else 0 end) as points, SUM(case when team_id=home_team_id then home_team_goals when team_id=away_team_id then away_team_goals else 0 end) as goal_for, SUM(case when team_id=home_team_id then away_team_goals when team_id=away_team_id then home_team_goals else 0 end) as goal_against From Matches m Cross Join Teams t On t.team_id in (m.home_team_id, m.away_team_id) Group by t.team_id) as temp Order by points desc, goal_diff desc, team_name
Select t1.*, (goal_for - goal_against) as goal_diff from (select team_name, sum(team_id in (away_team_id, home_team_id))as matches_played, Sum(case when team_id = home_team_id and home_team_goals < away_team_goals then 0 when team_id = home_team_id and home_team_goals > away_team_goals then 3 when team_id = away_team_id and home_team_goals < away_team_goals then 3 when team_id = away_team_id and home_team_goals > away_team_goals then 0 Else 1 end) as points, Sum( case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals else 0 end) as goal_for, Sum( case when team_id = home_team_id then away_team_goals when team_id = away_team_id then home_team_goals else 0 end) as goal_against From matches join teams on (team_id in ( away_team_id, home_team_id)) Group by team_id ) t1 Order by points desc, goal_diff desc, team_name
Select team_name, count(away_team_id) as matches_played, sum(points) points, sum(goal_for) goal_for , sum(goal_against) goal_against , sum(goal_diff) goal_diff from ( select home_team_id, away_team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points, home_team_goals goal_for, away_team_goals goal_against, (home_team_goals - away_team_goals) goal_diff from Matches union all select away_team_id as home_team_id, home_team_id as away_team_id, case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end as points, away_team_goals goal_for, home_team_goals goal_against, (away_team_goals - home_team_goals) goal_diff from Matches ) temp join Teams on team_id = home_team_id group by home_team_id order by points desc, goal_diff desc, team_name
Select team_name,SUM(X.f) as matches_played,SUM(X.b) as points,SUM(X.c) as goal_for ,SUM(x.d) as goal_against ,SUM(X.e) as goal_diff from (Select home_team_id as a,SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 END) AS b,SUM(home_team_goals) AS c,SUM(away_team_goals) AS d,(SUM(home_team_goals)-SUM(away_team_goals)) AS e,COUNT(home_team_id) as f from Matches as m group by home_team_id UNION ALL Select away_team_id as a,SUM(CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals < home_team_goals THEN 0 WHEN away_team_goals = home_team_goals THEN 1 END) AS b,SUM(away_team_goals) AS c,SUM(home_team_goals) AS d,(SUM(away_team_goals)-SUM(home_team_goals)) AS e,COUNT(away_team_id) as f from Matches as m1 group by away_team_id) X inner join Teams on X.a = Teams.team_id GROUP BY X.a ORDER BY points DESC,goal_diff DESC,team_name
WITH A AS ( SELECT home_team_id AS team_id , home_team_goals AS goal_for , away_team_goals AS goal_against FROM Matches m UNION ALL SELECT away_team_id AS team_id , away_team_goals AS goal_for , home_team_goals AS goal_against FROM Matches m ) , B AS ( SELECT A.team_id , CASE WHEN A.goal_for > A.goal_against THEN 3 WHEN A.goal_for < A.goal_against THEN 0 ELSE 1 END AS points , A.goal_for , A.goal_against , A.goal_for - A.goal_against AS goal_diff FROM A ) SELECT T.team_name , COUNT(B.team_id) AS matches_played , SUM(B.points) AS points , SUM(B.goal_for) AS goal_for , SUM(B.goal_against) AS goal_against , SUM(B.goal_diff) AS goal_diff FROM B JOIN Teams T ON B.team_id = T.team_id GROUP BY T.team_name ORDER BY SUM(B.points) DESC, SUM(B.goal_diff) DESC, T.team_name
WITH A AS(SELECT home_team_id AS id, home_team_goals as goal_for, away_team_goals as goal_against FROM Matches UNION ALL SELECT away_team_id AS id, away_team_goals as goal_for, home_team_goals as goal_against FROM Matches) SELECT team_name, COUNT(id) AS matches_played, SUM(CASE WHEN goal_for>goal_against THEN 3 WHEN goal_for < goal_against THEN 0 ELSE 1 END) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM Teams t JOIN A a ON t.team_id = a.id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH A AS(SELECT home_team_id AS id, home_team_goals as goal_for, away_team_goals as goal_against FROM Matches UNION ALL SELECT away_team_id AS id, away_team_goals as goal_for, home_team_goals as goal_against FROM Matches) SELECT team_name, COUNT(id) AS matches_played, SUM(CASE WHEN goal_for>goal_against THEN 3 WHEN goal_for = goal_against THEN 1 ELSE 0 END) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM Teams t JOIN A a ON t.team_id = a.id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH A1 AS ( SELECT Teams.team_id, Teams.team_name, A.scoreFor, A.scoreAga FROM (SELECT home_team_id AS team_id, home_team_goals AS scoreFor, away_team_goals AS scoreAga FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS scoreFor, home_team_goals AS scoreAga FROM Matches) AS A JOIN Teams ON A.team_id = Teams.team_id) SELECT team_name AS team_name, COUNT(team_id) AS matches_played, SUM(CASE WHEN scoreFor > scoreAga THEN 3 WHEN scoreFor = scoreAga THEN 1 ELSE 0 END ) AS points, SUM(scorefor) AS goal_for, SUM(scoreAga) AS goal_against, SUM(scorefor - scoreAga) AS goal_diff FROM A1 GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH CTE AS ( SELECT home_team_id, COUNT(*) matches_played, SUM(CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) points, SUM(home_team_goals) goal_for, SUM(away_team_goals) goal_against, SUM(home_team_goals)-SUM(away_team_goals) goal_diff FROM Matches GROUP BY home_team_id union SELECT away_team_id, COUNT(*) matches_played, SUM(CASE WHEN away_team_goals>home_team_goals THEN 3 WHEN away_team_goals=home_team_goals THEN 1 ELSE 0 END) points, SUM(away_team_goals) goal_for, SUM(home_team_goals) goal_against, SUM(away_team_goals)-SUM(home_team_goals) goal_diff FROM Matches GROUP BY away_team_id ), CTE1 AS ( SELECT home_team_id, SUM(matches_played) matches_played, SUM(points) points, SUM(goal_for) goal_for, SUM(goal_against) goal_against, SUM(goal_diff) goal_diff FROM CTE GROUP BY home_team_id ) SELECT T.team_name,C.matches_played,C.points,C.goal_for,C.goal_against,C.goal_diff FROM CTE1 C INNER JOIN Teams T ON C.home_team_id=T.team_id ORDER BY C.points DESC, C.goal_diff DESC, T.team_name
WITH CTE AS ( SELECT t.team_name, COUNT(home_team_goals) AS matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END ) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against FROM Matches m JOIN Teams t ON m.home_team_id = t.team_id GROUP BY t.team_name UNION ALL SELECT t.team_name, COUNT(away_team_goals) AS matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals < away_team_goals THEN 3 ELSE 1 END ) AS points, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against FROM Matches m JOIN Teams t ON m.away_team_id = t.team_id GROUP BY t.team_name ) SELECT team_name, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM CTE GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH CTE AS ( SELECT team_name, home_team_goals AS goal_for, away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches A LEFT JOIN Teams B ON A.home_team_id = B.team_id UNION ALL SELECT team_name, away_team_goals AS goal_for, home_team_goals AS goal_against, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches A LEFT JOIN Teams B ON A.away_team_id = B.team_id ) SELECT team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM CTE GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH CTE AS ((SELECT home_team_id id, home_team_goals goals ,away_team_goals against, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END) as points FROM Matches) UNION ALL (SELECT away_team_id id, away_team_goals goals, home_team_goals against, (CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals > away_team_goals THEN 0 ELSE 1 END) as points FROM Matches)) SELECT team_name, count(id) matches_played, sum(points) points, sum(goals) goal_for, sum(against) goal_against, (sum(goals) - sum(against)) goal_diff FROM CTE LEFT JOIN Teams t ON CTE.id = t.team_id GROUP BY id ORDER BY points DESC, goal_diff DESC, team_name
WITH CTE AS ((SELECT home_team_id id, home_team_goals goals,away_team_goals against, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END) as points FROM Matches) UNION ALL (SELECT away_team_id, away_team_goals, home_team_goals against, (CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals > away_team_goals THEN 0 ELSE 1 END) as points FROM Matches)) SELECT team_name, count(id) matches_played, sum(points) points, sum(goals) goal_for, sum(against) goal_against, (sum(goals) - sum(against)) goal_diff FROM CTE LEFT JOIN Teams t ON CTE.id = t.team_id GROUP BY id ORDER BY points DESC, goal_diff DESC, team_name
WITH CTE AS (SELECT home_team_id AS ID, home_team_goals, away_team_goals FROM Matches UNION ALL SELECT away_team_id AS ID, away_team_goals AS home_team_goals, home_team_goals AS away_team_goals FROM Matches) SELECT team_name, COUNT(*) AS matches_played, IFNULL(SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 END),0) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_team_goals - away_team_goals) AS goal_diff FROM Teams T JOIN CTE M ON T.team_id = M.ID GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH CTE AS (SELECT home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against FROM Matches UNION ALL SELECT away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against FROM Matches ) select team_name , count(*) as matches_played , SUM(CASE WHEN goal_for > goal_against THEN 3 WHEN goal_for < goal_against THEN 0 ELSE 1 END) as points , sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from cte JOIN teams t ON cte.team_id = t.team_id GROUP BY cte.team_id ORDER BY points desc, goal_diff desc, team_name
WITH CTE AS (SELECT home_team_id team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END points, home_team_goals goal_for, away_team_goals goal_against FROM Matches UNION ALL SELECT away_team_id team_id, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END points, away_team_goals goal_for, home_team_goals goal_against FROM Matches) SELECT team_name, COUNT(*) matches_played, SUM(points) points, SUM(goal_for) goal_for, SUM(goal_against) goal_against, SUM(goal_for) - SUM(goal_against) goal_diff FROM Teams T JOIN CTE ON T.team_id = CTE.team_id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH CTE as ( SELECT home_team_id as team, home_team_goals as goal_for, away_team_goals as goal_against, CASE WHEN home_team_goals > away_team_goals then 3 WHEN home_team_goals < away_team_goals then 0 ELSE 1 END AS points FROM matches UNION ALL SELECT away_team_id as team, away_team_goals as goal_for, home_team_goals as goal_against, CASE WHEN away_team_goals > home_team_goals then 3 WHEN away_team_goals < home_team_goals then 0 ELSE 1 END AS points FROM matches ) SELECT t.team_name, count(*) as matches_played, sum(points) as points, Sum(goal_for) as goal_for, sum(goal_against) as goal_against, Sum(goal_for) - sum(goal_against) as goal_diff FROM cte INNER JOIN teams t ON cte.team = t.team_id GROUP BY t.team_name order by points desc, goal_diff desc, t.team_name asc
WITH CTE1 AS ( SELECT *, (CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) AS home_team_pts, (CASE WHEN home_team_goals>away_team_goals THEN 0 WHEN home_team_goals=away_team_goals THEN 1 ELSE 3 END) AS away_team_pts FROM Matches), CTE2 AS ( SELECT home_team_id AS team_id, home_team_pts AS pts, home_team_goals AS goal_for, away_team_goals AS goal_against FROM CTE1 UNION ALL SELECT away_team_id, away_team_pts, away_team_goals, home_team_goals FROM CTE1), CTE3 AS ( SELECT team_id, SUM(pts) AS pts, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, COUNT(*) AS matches_played FROM CTE2 GROUP BY team_id) SELECT Teams.team_name, matches_played, pts AS points, goal_for, goal_against, goal_for-goal_against AS goal_diff FROM CTE3 JOIN Teams ON CTE3.team_id = Teams.team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH CTE1 AS ( SELECT home_team_id, away_team_id, home_team_goals, away_team_goals, CASE WHEN home_team_goals-away_team_goals>0 THEN 3 WHEN home_team_goals-away_team_goals=0 THEN 1 ELSE 0 END as home_points, CASE WHEN home_team_goals-away_team_goals<0 THEN 3 WHEN home_team_goals-away_team_goals=0 THEN 1 ELSE 0 END as away_points FROM matches ), CTE2 AS ( SELECT home_team_id, home_team_goals, home_points FROM CTE1 UNION ALL SELECT away_team_id, away_Team_goals, away_points FROM CTE1 ), CTE3 AS ( SELECT home_team_id, COUNT(*) as matches_played, SUM(home_points) as points, SUM(home_team_goals) as goal_for FROM CTE2 GROUP BY home_team_id ), CTE4 AS ( SELECT home_team_id, away_team_goals FROM CTE1 UNION ALL SELECT away_team_id, home_Team_goals FROM CTE1 ), CTE5 as ( SELECT home_team_id, SUM(away_team_goals) as goal_against FROM CTE4 GROUP BY home_team_id ), CTE6 as ( SELECT a.home_team_id, matches_played, points, goal_for, goal_against, (goal_for - goal_against) as goal_diff FROM CTE3 a INNER JOIN CTE5 b ON a.home_team_id = b.home_team_id ) SELECT team_name, matches_played, points, goal_for, goal_against, goal_diff FROM CTE6 a INNER JOIN teams b ON a.home_team_id=b.team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH CTE1 AS ( SELECT t.team_name, m.home_team_id AS team_id, m.home_team_goals AS goals, (CASE WHEN m.home_team_goals > m.away_team_goals THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 WHEN m.home_team_goals < m.away_team_goals THEN 0 ELSE NULL END) AS points, m.away_team_goals AS goal_against FROM Matches m LEFT JOIN Teams t ON m.home_team_id = t.team_id UNION ALL SELECT t.team_name, m.away_team_id AS team_id, m.away_team_goals AS goals, (CASE WHEN m.away_team_goals > m.home_team_goals THEN 3 WHEN m.away_team_goals = m.home_team_goals THEN 1 WHEN m.away_team_goals < m.home_team_goals THEN 0 ELSE NULL END) AS points, m.home_team_goals AS goal_against FROM Matches m LEFT JOIN Teams t ON m.away_team_id = t.team_id ) SELECT c.team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goals) AS goal_for, SUM(goal_against) AS goal_against, (SUM(goals) - SUM(goal_against)) AS goal_diff FROM CTE1 c GROUP BY c.team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH Home AS ( SELECT home_team_id AS team_id, COUNT(*) AS matches, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points FROM Matches GROUP BY 1), Away AS ( SELECT away_team_id AS team_id, COUNT(*) AS matches, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM(CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points FROM Matches GROUP BY 1) SELECT A.team_name, IFNULL(B.matches, 0) + IFNULL(C.matches, 0) AS matches_played, IFNULL(B.points, 0) + IFNULL(C.points, 0) AS points, IFNULL(B.goal_for, 0) + IFNULL(C.goal_for, 0) AS goal_for, IFNULL(B.goal_against, 0) + IFNULL(C.goal_against, 0) AS goal_against, IFNULL(B.goal_for, 0) + IFNULL(C.goal_for, 0) - IFNULL(B.goal_against, 0) - IFNULL(C.goal_against, 0) AS goal_diff FROM Teams A LEFT JOIN Home B ON A.team_id = B.team_id LEFT JOIN Away C ON A.team_id = C.team_id HAVING matches_played > 0 ORDER BY 3 DESC, 6 DESC, 1
WITH MatchesWithScore AS ( SELECT home_team_id, away_team_id, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END) AS home_team_points, (CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals < away_team_goals THEN 3 ELSE 1 END) AS away_team_points, home_team_goals, away_team_goals FROM Matches ), HomeTeamScore AS ( SELECT home_team_id AS team_id, SUM(1) AS matches_played, SUM(home_team_points) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_team_goals) - SUM(away_team_goals) AS goal_diff FROM MatchesWithScore GROUP BY home_team_id ), AwayTeamScore AS ( SELECT away_team_id AS team_id, SUM(1) AS matches_played, SUM(away_team_points) AS points, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM(away_team_goals) - SUM(home_team_goals) AS goal_diff FROM MatchesWithScore GROUP BY away_team_id ), UnionTables AS ( SELECT * FROM HomeTeamScore UNION ALL SELECT * FROM AwayTeamScore ), UnionGroupedTable AS ( SELECT team_id, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_diff) AS goal_diff FROM UnionTables GROUP BY team_id ), FinalTable AS ( SELECT team_name, matches_played, points, goal_for, goal_against, goal_diff FROM UnionGroupedTable U INNER JOIN Teams T ON U.team_id = T.team_id ) SELECT * FROM FinalTable ORDER BY points DESC, goal_diff DESC, team_name
WITH MatchesWithScores AS (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END as home_team_points, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals < home_team_goals THEN 0 ELSE 1 END as away_team_points FROM Matches), asHomeTeam AS (SELECT home_team_id as team_id, SUM(home_team_goals) as totalGoals, SUM(away_team_goals) as opponentTotalGoals, SUM(home_team_points) as totalPoints, COUNT(*) as numMatches FROM MatchesWithScores GROUP BY home_team_id), asAwayTeam AS (SELECT away_team_id as team_id, SUM(away_team_goals) as totalGoals, SUM(home_team_goals) as opponentTotalGoals, SUM(away_team_points) as totalPoints, COUNT(*) as numMatches FROM MatchesWithScores GROUP BY away_team_id), perTeamInfo AS (SELECT team_id, SUM(numMatches) as matches_played, SUM(totalPoints) as points, SUM(totalGoals) as goal_for, SUM(opponentTotalGoals) as goal_against FROM (SELECT * FROM asHomeTeam UNION SELECT * FROM asAwayTeam) as teamsInfo GROUP BY team_id) SELECT Teams.team_name as team_name, perTeamInfo.matches_played as matches_played, perTeamInfo.points as points, perTeamInfo.goal_for as goal_for, perTeamInfo.goal_against as goal_against, perTeamInfo.goal_for - perTeamInfo.goal_against as goal_diff FROM perTeamInfo INNER JOIN Teams ON perTeamInfo.team_id = Teams.team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH S0 AS (SELECT home_team_id AS team_id, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, COUNT(home_team_id) AS matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points FROM Matches GROUP BY home_team_id), S1 AS (SELECT away_team_id AS team_id, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, COUNT(away_team_id) AS matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END) AS points FROM Matches GROUP BY away_team_id), S2 AS (SELECT S0.team_id, IFNULL(S0.matches_played,0) + IFNULL(S1.matches_played,0) AS matches_played, IFNULL(S0.points,0) + IFNULL(S1.points,0) AS points, IFNULL(S0.goal_for,0) + IFNULL(S1.goal_for,0) AS goal_for, IFNULL(S0.goal_against,0) + IFNULL(S1.goal_against,0) AS goal_against, IFNULL(S0.goal_for,0) + IFNULL(S1.goal_for,0) - IFNULL(S0.goal_against,0) - IFNULL(S1.goal_against,0) AS goal_diff FROM S0 LEFT JOIN S1 ON S0.team_id = S1.team_id UNION SELECT S1.team_id, IFNULL(S0.matches_played,0) + IFNULL(S1.matches_played,0) AS matches_played, IFNULL(S0.points,0) + IFNULL(S1.points,0) AS points, IFNULL(S0.goal_for,0) + IFNULL(S1.goal_for,0) AS goal_for, IFNULL(S0.goal_against,0) + IFNULL(S1.goal_against,0) AS goal_against, IFNULL(S0.goal_for,0) + IFNULL(S1.goal_for,0) - IFNULL(S0.goal_against,0) - IFNULL(S1.goal_against,0) AS goal_diff FROM S0 RIGHT JOIN S1 ON S0.team_id = S1.team_id) SELECT team_name, matches_played, points, goal_for, goal_against, goal_diff FROM Teams LEFT JOIN S2 ON Teams.team_id = S2.team_id WHERE matches_played IS NOT NULL AND points IS NOT NULL AND goal_for IS NOT NULL AND goal_against IS NOT NULL AND goal_diff IS NOT NULL ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH Stats AS ( SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS 'home_points', CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS 'away_points' FROM Matches ), Summary AS ( SELECT home_team_id, home_team_goals, home_points, away_team_goals FROM Stats UNION ALL SELECT away_team_id, away_team_goals, away_points, home_team_goals FROM Stats ) SELECT team_name, COUNT(1) AS 'matches_played', SUM(home_points) AS 'points', SUM(home_team_goals) AS 'goal_for', SUM(away_team_goals) AS 'goal_against', SUM(home_team_goals) - SUM(away_team_goals) AS 'goal_diff' FROM Summary AS s LEFT JOIN Teams AS t ON s.home_team_id = t.team_id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH T AS( SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END home_team_score, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END away_team_score FROM Matches), T2 AS( SELECT home_team_id id, home_team_goals goal_for , away_team_goals goal_against ,home_team_score points FROM T UNION ALL SELECT away_team_id id, away_team_goals goal_for, home_team_goals goal_against ,away_team_score points FROM T ), T3 AS( SELECT id, COUNT(*) matches_played , SUM(points) points , SUM(goal_for) goal_for , SUM(goal_against) goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM T2 GROUP BY id) SELECT team_name, T3.matches_played, T3.points, T3.goal_for, T3.goal_against, T3.goal_diff FROM T3 LEFT JOIN Teams ON Teams.team_id =T3.id ORDER BY points DESC, goal_diff DESC, team_name
WITH T1 AS ( SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END AS home_team_pts, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals < home_team_goals THEN 0 ELSE 1 END AS away_team_pts FROM Matches M ), T2 AS ( SELECT home_team_id AS team_id, home_team_goals AS GF, away_team_goals AS GA, home_team_goals - away_team_goals AS GD, home_team_pts AS pt FROM T1 UNION ALL SELECT away_team_id AS team_id, away_team_goals AS GF, home_team_goals AS GA, away_team_goals - home_team_goals AS GD, away_team_pts AS pt FROM T1 ) SELECT T.team_name, COUNT(*) AS matches_played, SUM(T2.pt) AS points, SUM(T2.GF) AS goal_for, SUM(T2.GA) AS goal_against, SUM(T2.GD) AS goal_diff FROM T2 INNER JOIN Teams T ON T2.team_id = T.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH T1 AS( SELECT *, CASE WHEN home_team_goals < away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END AS home_points, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_points FROM Matches), T2 AS ( SELECT home_team_id AS team_id,home_team_goals AS goal_for,away_team_goals AS goal_against,home_points AS points FROM T1 UNION ALL SELECT away_team_id AS away_id,away_team_goals AS goal_for,home_team_goals AS goal_against,away_points AS points FROM T1) SELECT team_name,COUNT(*) AS matches_played,SUM(points) AS points,SUM(goal_for) AS goal_for,SUM(goal_against) AS goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM T2 INNER JOIN Teams T ON T2.team_id = T.team_id GROUP BY team_name ORDER BY points DESC,goal_diff DESC,team_name
WITH all_games AS (SELECT home_team_id AS a_id, away_team_id AS b_id, home_team_goals AS a_goals, away_team_goals AS b_goals FROM Matches UNION ALL SELECT away_team_id AS a_id, home_team_id AS b_id, away_team_goals AS a_goals, home_team_goals AS b_goals FROM Matches) SELECT t.team_name, COUNT(*) AS matches_played, SUM(CASE WHEN a_goals > b_goals THEN 3 WHEN a_goals = b_goals THEN 1 ELSE 0 END) AS points, SUM(a_goals) AS goal_for, SUM(b_goals) AS goal_against, SUM(a_goals - b_goals) AS goal_diff FROM all_games a JOIN Teams t ON a.a_id = t.team_id GROUP BY a_id ORDER BY points DESC, goal_diff DESC, 1
WITH all_matches AS( SELECT home_team_id as id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END as point, home_team_goals as goal_for, away_team_goals as goal_against FROM Matches UNION ALL SELECT away_team_id as id, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END as point, away_team_goals as goal_for, home_team_goals as goal_against FROM Matches ), stats AS( SELECT id, COUNT(*) as matches_played, SUM(point) as points, SUM(goal_for) as goal_for, SUM(goal_against) as goal_against FROM all_matches GROUP BY id ) SELECT team_name, matches_played, points, goal_for, goal_against, goal_for - goal_against AS goal_diff FROM stats INNER JOIN Teams ON stats.id = Teams.team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH breakdown AS ( SELECT home_team_id AS team_id, home_team_goals AS team_goals, away_team_goals AS opponent_goals, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS team_goals, home_team_goals AS opponent_goals, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches ) SELECT team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(team_goals) AS goal_for, SUM(opponent_goals) AS goal_against, SUM(team_goals) - SUM(opponent_goals) AS goal_diff FROM breakdown LEFT JOIN Teams USING (team_id) GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH cte AS ( SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against FROM Matches ) SELECT t.team_name, COUNT(*) AS matches_played, SUM( CASE WHEN c.goal_for > c.goal_against THEN 3 WHEN c.goal_for = c.goal_against THEN 1 ELSE 0 END ) AS points, SUM(c.goal_for) AS goal_for, SUM(c.goal_against) AS goal_against, SUM(c.goal_for - c.goal_against) AS goal_diff FROM Teams t JOIN cte c ON t.team_id = c.team_id GROUP BY t.team_id ORDER BY 3 DESC, 6 DESC, 1 ASC
WITH cte AS ( SELECT home_team_id as team_id, home_team_goals AS scored_for, away_team_goals AS scored_agnst FROM Matches UNION ALL SELECT away_team_id as team_id, away_team_goals AS scored_for, home_team_goals AS scored_agnst FROM Matches ), cte2 AS ( SELECT team_name, t.team_id, scored_for, scored_agnst FROM cte JOIN Teams t ON cte.team_id = t.team_id ) SELECT team_name, COUNT(team_id) matches_played, SUM(CASE WHEN scored_for > scored_agnst THEN 3 WHEN scored_for = scored_agnst THEN 1 ELSE 0 END) AS points, SUM(scored_for) AS goal_for, SUM(scored_agnst) AS goal_against, SUM(scored_for - scored_agnst) AS goal_diff FROM cte2 GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH cte AS ( SELECT home_team_id as team_id, home_team_goals AS scored_for, away_team_goals AS scored_agnst FROM Matches UNION ALL SELECT away_team_id as team_id, away_team_goals AS scored_for, home_team_goals AS scored_agnst FROM Matches ), cte2 AS ( SELECT team_name, t.team_id, scored_for, scored_agnst FROM cte JOIN Teams t ON cte.team_id = t.team_id ) SELECT team_name, COUNT(team_id) matches_played, SUM(CASE WHEN scored_for > scored_agnst THEN 3 WHEN scored_for = scored_agnst THEN 1 ELSE 0 END) AS points, SUM(scored_for) AS goal_for, SUM(scored_agnst) AS goal_against, SUM(scored_for) - SUM(scored_agnst) AS goal_diff FROM cte2 GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH cte AS ( SELECT home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 0 END as points FROM matches UNION ALL SELECT away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 3 END as points FROM matches ) SELECT t.team_name, count(cte.team_id) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff FROM cte JOIN teams as t ON cte.team_id = t.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH cte AS ( SELECT home_team_id t1_id, home_team_goals t1_goals, away_team_goals t2_goals FROM matches UNION ALL SELECT away_team_id t1_id, away_team_goals t1_goals, home_team_goals t2_goals FROM matches ) SELECT t.team_name team_name, COUNT(*) matches_played, SUM( CASE WHEN t1_goals>t2_goals THEN 3 WHEN t1_goals=t2_goals THEN 1 ELSE 0 END ) points, SUM(t1_goals) goal_for, SUM(t2_goals) goal_against, SUM(t1_goals) - SUM(t2_goals) goal_diff FROM cte c JOIN teams t ON c.t1_id=t.team_id GROUP BY t.team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH cte AS ( SELECT t.team_id, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM (SELECT home_team_id AS team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 END AS points, home_team_goals AS goal_for, away_team_goals AS goal_against FROM Matches UNION ALL SELECT away_team_id AS team_id, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 END AS points, away_team_goals AS goal_for, home_team_goals AS goal_against FROM Matches) t GROUP BY t.team_id ) SELECT ts.team_name, c.matches_played, c.points, c.goal_for, c.goal_against, c.goal_diff FROM Teams ts JOIN cte c ON ts.team_id = c.team_id ORDER BY c.points DESC, c.goal_diff DESC, ts.team_name
WITH cte AS ((SELECT home_team_id AS team_id,home_team_goals as goals_for,away_team_goals as goals_against, CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals<away_team_goals THEN 0 ELSE 1 END AS points FROM Matches) UNION ALL (SELECT away_team_id AS team_id,away_team_goals as goals_for,home_team_goals as goals_against, CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals>away_team_goals THEN 0 ELSE 1 END AS points FROM Matches)) SELECT t.team_name as team_name,COUNT(cte.goals_for) as matches_played,SUM(cte.points)as points,SUM(cte.goals_for) AS goal_for,SUM(cte.goals_against) AS goal_against,(SUM(cte.goals_for)-SUM(cte.goals_against)) as goal_diff FROM cte JOIN Teams t ON cte.team_id=t.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC,1
WITH cte AS (SELECT * FROM Matches UNION ALL SELECT away_team_id, home_team_id, away_team_goals, home_team_goals FROM Matches ) SELECT t.team_name, matches_played, points, goal_for, goal_against, goal_diff FROM Teams t JOIN (SELECT home_team_id AS id, COUNT(*) AS matches_played, SUM(CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END ) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_team_goals)-SUM(away_team_goals) AS goal_diff FROM cte GROUP BY 1 ) m ON t.team_id=m.id ORDER BY 3 DESC, 6 DESC, 1 ASC
WITH cte AS (SELECT *, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS home_points, (CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END) AS away_points FROM Matches) SELECT team_name, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM (SELECT home_team_id AS id, COUNT(home_team_id) AS matches_played, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_points) AS points FROM cte GROUP BY home_team_id UNION ALL SELECT away_team_id AS id, COUNT(away_team_id) AS matches_played, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM(away_points) AS points FROM cte GROUP BY away_team_id) AS sub JOIN Teams AS t ON t.team_id = sub.id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH cte AS (SELECT *, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS home_points, (CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END) AS away_points FROM Matches), cte2 AS (SELECT home_team_id AS id, COUNT(home_team_id) AS matches_played, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_points) AS points FROM cte GROUP BY home_team_id UNION ALL SELECT away_team_id AS id, COUNT(away_team_id) AS matches_played, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM(away_points) AS points FROM cte GROUP BY away_team_id) SELECT team_name, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM cte2 JOIN Teams AS t ON t.team_id = cte2.id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH cte AS (SELECT home_team_id AS team_id, 1 AS matches_played, home_team_goals AS goal_for, away_team_goals AS goal_against, home_team_goals - away_team_goals AS goal_diff, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT away_team_id AS team_id, 1 AS matches_played, away_team_goals AS goal_for, home_team_goals AS goal_against, away_team_goals - home_team_goals AS goal_diff, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END AS points FROM Matches) SELECT t.team_name, SUM(c.matches_played) AS matches_played, SUM(c.points) AS points, SUM(c.goal_for) AS goal_for, SUM(c.goal_against) AS goal_against, SUM(c.goal_diff) AS goal_diff FROM Teams AS t JOIN cte AS c ON t.team_id = c.team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH cte AS (SELECT home_team_id, away_team_id, home_team_goals, away_team_goals, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_team_points, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_team_points FROM Matches), cte2 AS (SELECT T.team_name, COUNT(C.home_team_id) AS matches_played, SUM(IF(C.home_team_id = t.team_id, C.home_team_points, 0)) + SUM(IF(C.away_team_id = t.team_id, C.away_team_points, 0)) AS points, SUM(IF(C.home_team_id = t.team_id, C.home_team_goals, 0)) + SUM(IF(C.away_team_id = t.team_id, C.away_team_goals, 0)) AS goal_for, SUM(IF(C.home_team_id = t.team_id, C.away_team_goals, 0)) + SUM(IF(C.away_team_id = t.team_id, C.home_team_goals, 0)) AS goal_against FROM Teams AS T LEFT JOIN cte AS C ON T.team_id = C.home_team_id OR T.team_id = C.away_team_id GROUP BY T.team_id ORDER BY points DESC) SELECT *, goal_for - goal_against AS goal_diff FROM cte2 GROUP BY team_name HAVING matches_played > 0 ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH cte AS (SELECT t.team_name, CASE WHEN t.team_id=m.home_team_id and home_team_goals>away_team_goals THEN 3 WHEN t.team_id=m.home_team_id and home_team_goals=away_team_goals THEN 1 WHEN t.team_id=m.away_team_id and home_team_goals=away_team_goals THEN 1 WHEN t.team_id=m.away_team_id and home_team_goals<away_team_goals THEN 3 ELSE 0 END as points, CASE WHEN t.team_id=m.home_team_id THEN home_team_goals ELSE away_team_goals END AS goal_for, CASE WHEN t.team_id=m.away_team_id THEN home_team_goals ELSE away_team_goals END AS goal_against FROM teams as t JOIN matches as m ON t.team_id=m.home_team_id or t.team_id=m.away_team_id ) SELECT team_name, COUNT(team_name) AS matches_played, SUM(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for-goal_against) as goal_diff FROM cte GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH cte AS (SELECT t.team_name,COUNT(*) AS matches_played, SUM( CASE WHEN team_id = home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN team_id = home_team_id AND home_team_goals = away_team_goals THEN 1 WHEN team_id = home_team_id AND home_team_goals < away_team_goals THEN 0 WHEN team_id = away_team_id AND home_team_goals < away_team_goals THEN 3 WHEN team_id = away_team_id AND home_team_goals = away_team_goals THEN 1 WHEN team_id = away_team_id AND home_team_goals > away_team_goals THEN 0 END ) AS points, SUM( CASE WHEN team_id = home_team_id THEN home_team_goals ELSE away_team_goals END ) AS goal_for, SUM( CASE WHEN team_id = home_team_id THEN away_team_goals ELSE home_team_goals END ) AS goal_against FROM Teams t JOIN Matches m ON m.home_team_id = t.team_id OR m.away_team_id = t.team_id GROUP BY 1) SELECT *, cte.goal_for - cte.goal_against AS goal_diff FROM cte ORDER BY cte.points DESC, goal_diff DESC, cte.team_name ASC
WITH cte AS( SELECT home_team_id AS team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END points, home_team_goals AS goal_for, away_team_goals AS goal_against FROM Matches UNION ALL SELECT away_team_id AS team_id, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END points, away_team_goals AS goal_for, home_team_goals AS goal_against FROM Matches ) SELECT team_name, count(*) AS matches_played, sum(points) AS points, sum(goal_for) AS goal_for, sum(goal_against) AS goal_against, sum(goal_for) - sum(goal_against) AS goal_diff FROM CTE JOIN TEAMS USING(team_id) GROUP BY team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH cte as (SELECT t5.team_id,t.team_name,t5.points FROM (SELECT t4.team_id as team_id, ((t4.wins)*3+(t4.loss)*0+(t4.draw)*1) as points FROM (SELECT t3.team_id as team_id,SUM(t3.wins) AS wins,SUM(t3.loss) as loss,SUM(t3.draw) as draw FROM ((SELECT home_team_id as team_id,SUM(CASE WHEN home_team_goals>away_team_goals THEN 1 ELSE 0 END) AS wins, SUM(CASE WHEN home_team_goals<away_team_goals THEN 1 ELSE 0 END) AS loss, SUM(CASE WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) AS draw FROM Matches GROUP BY 1) UNION ALL (SELECT away_team_id as team_id,SUM(CASE WHEN home_team_goals<away_team_goals THEN 1 ELSE 0 END) AS wins, SUM(CASE WHEN home_team_goals>away_team_goals THEN 1 ELSE 0 END) AS loss, SUM(CASE WHEN home_team_goals=away_team_goals THEN 1 ELSE 0 END) AS draw FROM Matches GROUP BY 1)) t3 GROUP BY 1) t4 ) t5 LEFT JOIN Teams t ON t.team_id=t5.team_id) SELECT cte.team_name as team_name, t6.matches_played as matches_played,cte.points as points, t6.goals_for as goal_for, t6.goals_against as goal_against,t6.goal_diff as goal_diff FROM cte JOIN (SELECT sub1.team_id as team_id,sub1.matches_played as matches_played,sub1.goals_for as goals_for ,sub2.goals_against as goals_against,sub1.goals_for-sub2.goals_against as goal_diff FROM (SELECT t1.team_id AS team_id,SUM(t1.matches_played) AS matches_played,SUM(t1.goals_for) AS goals_for FROM ((SELECT home_team_id AS team_id,COUNT(home_team_goals) AS matches_played,SUM(home_team_goals) AS goals_for FROM Matches GROUP BY 1) UNION ALL (SELECT away_team_id,COUNT(away_team_goals) AS matches_played,SUM(away_team_goals) AS goals_for FROM Matches GROUP BY 1)) t1 GROUP BY 1) sub1 JOIN (SELECT t2.team_id AS team_id,SUM(t2.matches_played) AS matches_played,SUM(t2.goals_against) AS goals_against FROM ((SELECT home_team_id AS team_id,COUNT(away_team_goals) AS matches_played,SUM(away_team_goals) AS goals_against FROM Matches GROUP BY 1) UNION ALL (SELECT away_team_id,COUNT(home_team_goals) AS matches_played ,SUM(home_team_goals) AS goals_against FROM Matches GROUP BY 1)) t2 GROUP BY 1 ) sub2 ON sub1.team_id=sub2.team_id AND sub1.matches_played=sub2.matches_played) t6 ON cte.team_id=t6.team_id ORDER BY cte.points DESC,t6.goal_diff DESC,cte.team_name
WITH cte1 AS ( SELECT *, CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals<away_team_goals THEN 0 ELSE 1 END AS home_score, CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals>away_team_goals THEN 0 ELSE 1 END AS away_score FROM Matches ), cte2 AS ( SELECT home_team_id team_id, home_team_goals team_goals, home_score score, away_team_goals against_goal FROM cte1 UNION ALL SELECT away_team_id team_id, away_team_goals team_goals, away_score score, home_team_goals against_goal FROM cte1 ) SELECT team_name, COUNT(a.team_id) matches_played, SUM(score) points, SUM(team_goals) goal_for, SUM(against_goal) goal_against, SUM(team_goals-against_goal) goal_diff FROM cte2 a LEFT JOIN Teams b ON a.team_id=b.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH cte1 AS ( SELECT home_team_id AS team FROM Matches UNION ALL SELECT away_team_id AS team FROM Matches ), cte2 AS ( SELECT team, COUNT(*) AS matches_played FROM cte1 GROUP BY team ), cte3 AS ( SELECT home_team_id AS team, home_team_goals AS goals FROM Matches UNION ALL SELECT away_team_id AS team, away_team_goals AS goals FROM Matches ), cte4 AS ( SELECT team, SUM(goals) AS goal_for FROM cte3 GROUP BY team ), cte5 AS ( SELECT home_team_id AS team, away_team_goals AS goals FROM Matches UNION ALL SELECT away_team_id AS team, home_team_goals AS goals FROM Matches ), cte6 AS ( SELECT team, SUM(goals) AS goal_against FROM cte5 GROUP BY team ), cte7 AS ( SELECT home_team_id, away_team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END home_points, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END away_points FROM Matches ), cte8 AS ( SELECT home_team_id AS team, home_points AS point FROM cte7 UNION ALL SELECT away_team_id AS team, away_points AS point FROM cte7 ), cte9 AS ( SELECT team, SUM(point) AS points FROM cte8 GROUP BY team ) SELECT team_name, matches_played, points, goal_for, goal_against, goal_for - goal_against AS goal_diff FROM cte9 JOIN cte2 ON cte9.team = cte2.team JOIN cte4 ON cte9.team = cte4.team JOIN cte6 ON cte9.team = cte6.team JOIN Teams ON cte9.team = Teams.team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH cte_all AS ( SELECT home_team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END AS home_team_points, home_team_goals, away_team_id, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals < away_team_goals THEN 3 ELSE 1 END AS away_team_points, away_team_goals FROM Matches ) SELECT t.team_name, COUNT(1) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM ( SELECT home_team_id AS team_id, home_team_points AS points, home_team_goals AS goal_for, away_team_goals AS goal_against FROM cte_all UNION ALL SELECT away_team_id AS team_id, away_team_points AS points, away_team_goals AS goal_for, home_team_goals AS goal_against FROM cte_all ) a INNER JOIN Teams t ON a.team_id = t.team_id GROUP BY t.team_name ORDER BY SUM(points) DESC, SUM(goal_for) - SUM(goal_against) DESC, t.team_name
WITH getResult AS ( SELECT home_team_id AS team_id, SUM( CASE WHEN home_team_goals > away_team_goals THEN 3 ELSE CASE WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END END ) AS points, COUNT(*) AS matches_played, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against FROM Matches GROUP BY 1 UNION ALL SELECT away_team_id AS team_id, SUM( CASE WHEN home_team_goals < away_team_goals THEN 3 ELSE CASE WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END END ) AS points, COUNT(*) AS matches_played, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against FROM Matches GROUP BY 1 ) SELECT Teams.team_name, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, (SUM(goal_for) - SUM(goal_against)) AS goal_diff FROM getResult INNER JOIN Teams ON getResult.team_id = Teams.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH goals AS (SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END AS points FROM Matches), stats AS (SELECT team_id, COUNT(*) AS matches_played, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(points) AS points FROM goals GROUP BY team_id) SELECT team_name, matches_played, points, goal_for, goal_against, goal_for - goal_against AS goal_diff FROM TEAMS JOIN stats USING(team_id) ORDER BY points DESC, goal_diff DESC, team_name
WITH h AS ( SELECT home_team_id, COUNT(*) AS matches_played, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM( CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END ) AS points FROM Matches GROUP BY home_team_id ), a AS ( SELECT away_team_id, COUNT(*) AS matches_played, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against, SUM( CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END ) AS points FROM Matches GROUP BY away_team_id ) SELECT team_name, COALESCE(h.matches_played, 0) + COALESCE(a.matches_played, 0) AS matches_played, COALESCE(h.points, 0) + COALESCE(a.points, 0) AS points, COALESCE(h.goal_for, 0) + COALESCE(a.goal_for, 0) AS goal_for, COALESCE(h.goal_against, 0) + COALESCE(a.goal_against, 0) AS goal_against, COALESCE(h.goal_for, 0) + COALESCE(a.goal_for, 0) - (COALESCE(h.goal_against, 0) + COALESCE(a.goal_against, 0)) AS goal_diff FROM ( SELECT DISTINCT home_team_id AS team_id FROM h UNION SELECT DISTINCT away_team_id AS team_id FROM a ) t INNER JOIN Teams t1 ON t.team_id = t1.team_id LEFT JOIN h ON t.team_id = h.home_team_id LEFT JOIN a ON t.team_id = a.away_team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH home AS ( SELECT b.team_id, home_team_goals AS goals_for,away_team_goals AS goals_against, b.team_name, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END as points FROM Matches a LEFT JOIN Teams b ON a.home_team_id = b.team_id ), away AS ( SELECT b.team_id, away_team_goals AS goals_for,home_team_goals AS goals_against, b.team_name, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END as points FROM Matches a LEFT JOIN Teams b ON a.away_team_id = b.team_id ) SELECT team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goals_for) AS goal_for, SUM(goals_against) AS goal_against, SUM(goals_for) - SUM(goals_against) AS goal_diff FROM( SELECT * FROM home UNION ALL SELECT * FROM away ) a GROUP BY team_name ORDER BY SUM(points) DESC, goal_diff DESC, team_name ASC
WITH home AS( SELECT home_team_id AS team_id , home_team_goals AS goal_for , away_team_goals AS goal_against , CASE WHEN home_team_goals>away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 WHEN home_team_goals<away_team_goals THEN 0 END AS points FROM matches), away AS( SELECT away_team_id AS team_id , away_team_goals AS goal_for , home_team_goals AS goal_against , CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals=away_team_goals THEN 1 WHEN home_team_goals>away_team_goals THEN 0 END AS points FROM matches), combined AS( SELECT * FROM home UNION ALL SELECT * FROM away) SELECT t.team_name , IFNULL(COUNT(c.team_id),0) AS matches_played , IFNULL(SUM(c.points),0) AS points , IFNULL(SUM(c.goal_for),0) AS goal_for , IFNULL(SUM(c.goal_against),0) AS goal_against , IFNULL(SUM(c.goal_for)-SUM(c.goal_against),0) AS goal_diff FROM combined c JOIN teams t ON c.team_id=t.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH home_table AS( SELECT team_name, home_team_id, home_team_goals AS goals_for, away_team_goals AS goals_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Teams t JOIN Matches m ON m.home_team_id = t.team_id ), away_table AS( SELECT team_name, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END AS points, away_team_goals AS goals_for, home_team_goals AS goals_against FROM Teams t JOIN Matches m ON m.away_team_id = t.team_id ) SELECT team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goals_for) AS goal_for, SUM(goals_against) AS goal_against, SUM(goal_diff) AS goal_diff FROM (SELECT team_name, points, goals_for, goals_against, goals_for - goals_against AS goal_diff FROM home_table UNION ALL SELECT team_name, points, goals_for, goals_against, goals_for - goals_against AS goal_diff FROM away_table) sub GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH home_tb AS ( SELECT Teams.team_name, Matches.home_team_goals AS goal_for, Matches.away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END AS points FROM Matches INNER JOIN Teams ON Matches.home_team_id = Teams.team_id ), away_tb AS ( SELECT Teams.team_name, Matches.away_team_goals AS goal_for, Matches.home_team_goals AS goal_against, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals > away_team_goals THEN 0 ELSE 1 END AS points FROM Matches INNER JOIN Teams ON Matches.away_team_id = Teams.team_id ), union_tb AS ( SELECT * FROM home_tb UNION ALL SELECT * FROM away_tb ) SELECT team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM union_tb GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH home_team AS ( SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM matches ), away_team AS ( SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM matches ), combined AS ( SELECT * FROM home_team UNION ALL SELECT * FROM away_team ), stats AS ( SELECT team_id, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, (SUM(goal_for) - SUM(goal_against)) AS goal_diff FROM combined GROUP BY team_id ) SELECT team_name, matches_played, points, goal_for, goal_against, goal_diff FROM stats LEFT JOIN teams ON stats.team_id = teams.team_id ORDER BY points DESC, goal_diff DESC, team_name
WITH m AS (SELECT home_team_id AS id, home_team_goals AS goals, away_team_goals AS op_goals FROM Matches UNION ALL SELECT away_team_id AS id , away_team_goals AS goals, home_team_goals AS op_goals FROM Matches) SELECT t.team_name, COUNT(t.team_name) AS matches_played, SUM(CASE WHEN goals > op_goals THEN 3 WHEN goals = op_goals THEN 1 ELSE 0 END) AS points, SUM(goals) AS goal_for, SUM(op_goals) AS goal_against, SUM(goals) - SUM(op_goals) AS goal_diff FROM m JOIN Teams t ON m.id = t.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1
WITH match_list AS ( SELECT home_team_id AS id FROM Matches UNION ALL SELECT away_team_id AS id FROM Matches ), match_played AS ( SELECT DISTINCT id, COUNT(*) OVER (PARTITION BY id) AS matches_played FROM match_list ), point_list AS ( SELECT home_team_id AS id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END AS points FROM Matches UNION ALL SELECT away_team_id AS id, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals < away_team_goals THEN 3 ELSE 1 END AS points FROM Matches ), point AS ( SELECT DISTINCT id, SUM(points) OVER(PARTITION BY id) AS points FROM point_list ), goal_list AS ( SELECT home_team_id AS id, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against FROM Matches GROUP BY home_team_id UNION ALL SELECT away_team_id AS id, SUM(away_team_goals) AS goal_for, SUM(home_team_goals) AS goal_against FROM Matches GROUP BY away_team_id ), goal AS ( SELECT DISTINCT id, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM goal_list GROUP BY id ) SELECT t.team_name AS team_name, m.matches_played AS matches_played, p.points AS points, g.goal_for AS goal_for, g.goal_against AS goal_against, g.goal_diff AS goal_diff FROM Teams AS t INNER JOIN match_played AS m ON t.team_id = m.id INNER JOIN point AS p ON t.team_id = p.id INNER JOIN goal AS g ON t.team_id = g.id ORDER BY p.points DESC, g.goal_diff DESC, t.team_name ASC
WITH match_score_cte AS (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_score, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_score FROM Matches), team_score_cte AS ( (SELECT home_team_id AS team_id, home_score AS score, home_team_goals AS goal_for, away_team_goals AS goal_against FROM match_score_cte) UNION ALL (SELECT away_team_id AS team_id, away_score AS score, away_team_goals AS goal_for, home_team_goals AS goal_against FROM match_score_cte)) SELECT t.team_name, COUNT(t.team_name) AS matches_played, SUM(s.score) AS points, SUM(s.goal_for) AS goal_for, SUM(s.goal_against) AS goal_against, SUM(s.goal_for) - SUM(s.goal_against) AS goal_diff FROM team_score_cte s INNER JOIN Teams t ON s.team_id = t.team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, t.team_name
WITH match_score_cte AS (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_score, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_score FROM Matches), team_score_cte AS ( (SELECT home_team_id AS team_id, home_score AS score, home_team_goals AS goal_for, away_team_goals AS goal_against FROM match_score_cte) UNION ALL (SELECT away_team_id AS team_id, away_score AS score, away_team_goals AS goal_for, home_team_goals AS goal_against FROM match_score_cte)) SELECT t.team_name, COUNT(t.team_name) AS matches_played, SUM(s.score) AS points, SUM(s.goal_for) AS goal_for, SUM(s.goal_against) AS goal_against, SUM(s.goal_for) - SUM(s.goal_against) AS goal_diff FROM team_score_cte s LEFT JOIN Teams t ON s.team_id = t.team_id GROUP BY t.team_name ORDER BY points DESC, goal_diff DESC, t.team_name
WITH matches2 AS ( SELECT *, ( CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END ) AS home_team_points, ( CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END ) AS away_team_points FROM Matches ), home_team AS ( SELECT home_team_id as team_id, home_team_goals as team_goals, away_team_goals as opp_team_goals, home_team_points as team_points FROM matches2 ), away_team AS ( SELECT away_team_id as team_id, away_team_goals as team_goals, home_team_goals as opp_team_goals, away_team_points as team_points FROM matches2 ), matches3 AS ( SELECT * FROM home_team UNION ALL SELECT * FROM away_team ) SELECT t.team_name, COUNT(t.team_id) AS matches_played, SUM(m.team_points) AS points, SUM(m.team_goals) AS goal_for, SUM(m.opp_team_goals) AS goal_against, SUM(m.team_goals) - SUM(m.opp_team_goals) as goal_diff FROM Teams AS t INNER JOIN matches3 AS m ON t.team_id = m.team_id GROUP BY t.team_id ORDER BY SUM(m.team_points) DESC, SUM(m.team_goals) - SUM(m.opp_team_goals) DESC, team_name
WITH matches_statistics as ( SELECT home_team_id as team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points, home_team_goals as goal_for, away_team_goals as goal_against FROM matches UNION ALL SELECT away_team_id as team_id, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points, away_team_goals as goal_for, home_team_goals as goal_against FROM matches ) SELECT t.team_name, COUNT(*) AS matches_played, SUM(points) as points, SUM(goal_for) as goal_for, SUM(goal_against) as goal_against, SUM(goal_for) - SUM(goal_against) as goal_diff FROM matches_statistics m JOIN teams t ON m.team_id = t.team_id GROUP BY m.team_id ORDER BY points desc, goal_diff desc, team_name asc
WITH points AS (SELECT home_team_id, away_team_id, home_team_goals, away_team_goals, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_team_point, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END AS away_team_point FROM Matches), unioned AS (SELECT home_team_id AS id, home_team_goals AS gf, home_team_point AS pt, away_team_goals AS ga FROM points UNION ALL SELECT away_team_id AS id, away_team_goals AS gf, away_team_point AS pt, home_team_goals AS ga FROM points) SELECT t1.team_name, t2.matches_played, t2.points, t2.goal_for, t2.goal_against, t2.goal_diff FROM Teams AS t1 JOIN (SELECT id, COUNT(*) AS matches_played, SUM(pt) AS points, SUM(gf) AS goal_for, SUM(ga) AS goal_against, SUM(gf) - SUM(ga) AS goal_diff FROM unioned GROUP BY id) AS t2 ON t1.team_id = t2.id ORDER BY t2.points DESC, t2.goal_diff DESC,t1.team_name
WITH points_results as (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 0 END as home_points, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 3 END as away_points FROM matches), long_results as (SELECT home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, home_points as points FROM points_results UNION ALL SELECT away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, away_points as points FROM points_results ) SELECT b.team_name, count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff FROM long_results as a LEFT JOIN Teams as b ON a.team_id = b.team_id GROUP BY b.team_name ORDER BY points desc, goal_diff desc, team_name
WITH points_table AS( (SELECT home_team_id AS team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_team_goals THEN 0 END AS points FROM matches) UNION ALL (SELECT away_team_id AS team_id, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 WHEN away_team_goals < home_team_goals THEN 0 END AS points FROM matches )), goals_table AS ( (SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against FROM matches) UNION ALL (SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against FROM matches) ), points_summary AS( SELECT team_id, COUNT(points) AS matches_played, SUM(points) AS points FROM points_table GROUP BY team_id ), goals_summary AS( SELECT team_id, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM goals_table GROUP BY team_id ) SELECT team_name, matches_played, points, goal_for, goal_against, goal_diff FROM teams JOIN points_summary USING(team_id) JOIN goals_summary USING(team_id) ORDER BY points DESC, goal_diff DESC, team_name
WITH raw_data AS ( SELECT home_team_id as team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END as points, home_team_goals as goal_for, away_team_goals as goal_against, (home_team_goals - away_team_goals) as goal_diff FROM matches UNION ALL SELECT away_team_id as team_id, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END as points, away_team_goals as goal_for, home_team_goals as goal_against, (away_team_goals - home_team_goals) as goal_diff FROM matches ) SELECT t.team_name, COUNT(rd.team_id) as matches_played, SUM(rd.points) as points, SUM(rd.goal_for) as goal_for, SUM(rd.goal_against) as goal_against, SUM(rd.goal_for - rd.goal_against) as goal_diff FROM teams t INNER JOIN raw_data rd on t.team_id = rd.team_id GROUP BY 1 ORDER BY 3 DESC, 6 DESC, 1 ASC
WITH report AS ( SELECT home_team_id AS team_id, home_team_goals AS team_goal, away_team_goals AS oppo_goal, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS points FROM Matches m1 UNION ALL SELECT away_team_id, away_team_goals, home_team_goals, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END AS points FROM Matches m2) SELECT team_name, COUNT(r.team_id) AS matches_played, SUM(points) AS points, SUM(team_goal) AS goal_for, SUM(oppo_goal) AS goal_against, (SUM(team_goal)-SUM(oppo_goal))AS goal_diff FROM report r INNER JOIN Teams t ON r.team_id=t.team_id GROUP BY team_name ORDER BY points DESC, (SUM(team_goal)-SUM(oppo_goal)) DESC, team_name
WITH score AS ( SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END AS point FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals > away_team_goals THEN 0 ELSE 1 END AS point FROM Matches ) SELECT t.team_name AS team_name, COUNT(s.team_id) AS matches_played, SUM(s.point) AS points, SUM(s.goal_for) AS goal_for, SUM(s.goal_against) AS goal_against, SUM(s.goal_for) - SUM(s.goal_against) AS goal_diff FROM score s JOIN Teams t ON s.team_id = t.team_id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH score AS ( SELECT home_team_id AS team_id, home_team_goals AS goal_for, away_team_goals AS goal_against, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS pt FROM Matches UNION ALL SELECT away_team_id AS team_id, away_team_goals AS goal_for, home_team_goals AS goal_against, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END AS pt FROM Matches ) SELECT t.team_name AS team_name, COUNT(s.team_id) AS matches_played, SUM(s.pt) AS points, SUM(s.goal_for) AS goal_for, SUM(s.goal_against) AS goal_against, SUM(s.goal_for) - SUM(s.goal_against) AS goal_diff FROM score s JOIN Teams t ON s.team_id = t.team_id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH scores AS ( SELECT home_team_id as team_id, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END as points, home_team_goals as goal_for, away_team_goals as goal_against, home_team_goals - away_team_goals as goal_diff FROM matches UNION ALL SELECT away_team_id as team_id, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END as points, away_team_goals as goal_for, home_team_goals as goal_against, away_team_goals - home_team_goals as goal_diff FROM matches) SELECT team_name, COUNT(*) as matches_played, SUM(points) as points, SUM(goal_for) as goal_for, SUM(goal_against) as goal_against, SUM(goal_diff) as goal_diff FROM teams INNER JOIN scores on teams.team_id = scores.team_id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH stacked AS (SELECT home_team_id AS t1, away_team_id AS t2, home_team_goals AS t1goals, away_team_goals AS t2goals FROM Matches UNION ALL SELECT away_team_id AS t1, home_team_id AS t2, away_team_goals AS t1goals, home_team_goals AS t1goals FROM Matches ) SELECT t.team_name, COUNT(team_name) as matches_played, SUM(CASE WHEN t1goals>t2goals THEN 3 WHEN t2goals=t1goals THEN 1 ELSE 0 END) points, SUM(t1goals) goal_for, SUM(t2goals) goal_against, SUM(t1goals)-SUM(t2goals) goal_diff FROM stacked s JOIN Teams t ON t.team_id = s.t1 GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH stats AS ( SELECT home_team_id AS h_id, away_team_id AS a_id, home_team_goals AS h_for, away_team_goals AS h_against, away_team_goals AS a_for, home_team_goals AS a_against, IF(home_team_goals > away_team_goals, 3, IF(home_team_goals = away_team_goals, 1, 0)) AS h_points, IF(home_team_goals < away_team_goals, 3, IF(home_team_goals = away_team_goals, 1, 0)) AS a_points FROM Matches ), h_a AS ( SELECT h_id AS team_id, COUNT(*) AS matches_played, SUM(h_for) AS goal_for, SUM(h_against) AS goal_against, SUM(h_points) AS points FROM stats GROUP BY h_id UNION SELECT a_id AS team_id, COUNT(*) AS matches_played, SUM(a_for) AS goal_for, SUM(a_against) AS goal_against, SUM(a_points) AS points FROM stats GROUP BY a_id ) SELECT team_name, SUM(matches_played) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for) - SUM(goal_against) AS goal_diff FROM h_a JOIN Teams USING(team_id) GROUP BY team_id ORDER BY 3 DESC, 6 DESC, 1
WITH t AS ( SELECT home_team_id AS id, home_team_goals AS goal_for, away_team_goals AS goal_against FROM Matches UNION ALL SELECT away_team_id AS id, away_team_goals AS goal_for, home_team_goals AS goal_against FROM Matches ) SELECT team_name, COUNT(id) AS matches_played,SUM(CASE WHEN goal_for > goal_against THEN 3 WHEN goal_for = goal_against THEN 1 ELSE 0 END) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, (SUM(goal_for) - SUM(goal_against)) AS goal_diff FROM t JOIN Teams te ON t.id = te.team_id GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH t AS (SELECT*, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_score, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_score FROM Matches), t1 AS (SELECT home_team_id AS team_id, home_score AS score, home_team_goals AS goal_for, away_team_goals AS goal_against FROM t UNION ALL SELECT away_team_id AS team_id, away_score AS score, away_team_goals AS goal_for, home_team_goals AS goal_against FROM t) SELECT b.team_name, COUNT(b.team_name) AS matches_played, SUM(a.score) AS points, SUM(a.goal_for) AS goal_for, SUM(a.goal_against) AS goal_against, SUM(a.goal_for) - SUM(a.goal_against) AS goal_diff FROM t1 a JOIN Teams b ON b.team_id = a.team_id GROUP BY b.team_name ORDER BY points DESC, goal_diff DESC, b.team_name
WITH t AS(SELECT t.team_name, m.home_team_goals wingoals, m.away_team_goals losegoals, CASE WHEN m.home_team_goals > m.away_team_goals THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 WHEN m.home_team_goals < m.away_team_goals THEN 0 END points FROM teams t JOIN matches m ON t.team_id = m.home_team_id UNION ALL SELECT t.team_name, m.away_team_goals wingoals, m.home_team_goals losegoals, CASE WHEN m.home_team_goals < m.away_team_goals THEN 3 WHEN m.home_team_goals = m.away_team_goals THEN 1 WHEN m.home_team_goals > m.away_team_goals THEN 0 END points FROM teams t JOIN matches m ON t.team_id = m.away_team_id) SELECT team_name, COUNT(team_name) matches_played, SUM(points) points, SUM(wingoals) goal_for, SUM(losegoals) goal_against, SUM(wingoals) - SUM(losegoals) goal_diff FROM t GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH t1 AS (SELECT home_team_id, away_team_id, home_team_goals, away_team_goals FROM Matches UNION ALL SELECT away_team_id home_team_id, home_team_id away_team_id, away_team_goals home_team_goals, home_team_goals away_team_goals FROM Matches) SELECT team_name, COUNT(*) matches_played, SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS points, SUM(home_team_goals) goal_for, SUM(away_team_goals) goal_against, SUM(home_team_goals) - SUM(away_team_goals) goal_diff FROM t1 LEFT JOIN Teams t ON t1.home_team_id = t.team_id GROUP BY 1 ORDER BY points DESC, goal_diff DESC, team_name
WITH table1 AS( SELECT *, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) AS home_team_points, (CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END) AS away_team_points FROM Matches ), table2 AS( SELECT home_team_id, home_team_points, home_team_goals, away_team_goals, home_team_goals - away_team_goals AS goal_diff, t.team_name FROM table1 INNER JOIN Teams t WHERE table1.home_team_id=t.team_id UNION ALL SELECT away_team_id, away_team_points, away_team_goals, home_team_goals, away_team_goals - home_team_goals AS goal_diff, t.team_name FROM table1 INNER JOIN Teams t WHERE table1.away_team_id=t.team_id ) SELECT team_name, COUNT(home_team_id) AS matches_played, SUM(home_team_points) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(goal_diff) AS goal_diff FROM table2 GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH table1 AS( SELECT home_team_id, away_team_id, home_team_goals, away_team_goals, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_team_points, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END AS away_team_points FROM Matches ), table2 AS( (SELECT home_team_id, team_name, home_team_goals, home_team_points, away_team_goals, home_team_goals-away_team_goals AS goal_diff FROM Teams t INNER JOIN table1 ON t.team_id=table1.home_team_id) UNION ALL (SELECT away_team_id, team_name, away_team_goals, away_team_points, home_team_goals, away_team_goals-home_team_goals AS goal_diff FROM Teams t INNER JOIN table1 ON t.team_id=table1.away_team_id) ) SELECT team_name, COUNT(home_team_id) AS matches_played, SUM(home_team_points) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(goal_diff) AS goal_diff FROM table2 GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH tb1 AS ( SELECT home_team_id, away_team_id, home_team_goals, away_team_goals, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_team_points, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals = away_team_goals THEN 1 ELSE 3 END AS away_team_points FROM Matches ), tb_home_points AS ( SELECT home_team_id AS team_id, SUM(home_team_points) AS total_points, SUM(home_team_goals) AS total_scored_goals, SUM(away_team_goals) AS total_conceded_goals, COUNT(*) AS total_matches FROM tb1 GROUP BY home_team_id ), tb_away_points AS ( SELECT away_team_id AS team_id, SUM(away_team_points) AS total_points, SUM(away_team_goals) AS total_scored_goals, SUM(home_team_goals) AS total_conceded_goals, COUNT(*) AS total_matches FROM tb1 GROUP BY away_team_id ), tb_points AS ( SELECT * FROM tb_home_points UNION ALL SELECT * FROM tb_away_points ), tb_points_summary AS ( SELECT team_id, SUM(total_points) AS points, SUM(total_matches) AS matches_played, SUM(total_scored_goals) AS goal_for, SUM(total_conceded_goals) AS goal_against FROM tb_points GROUP BY team_id ) SELECT t.team_name, tb.matches_played, tb.points, tb.goal_for, tb.goal_against, (tb.goal_for - tb.goal_against) AS goal_diff FROM tb_points_summary tb INNER JOIN Teams t ON tb.team_id = t.team_id ORDER BY tb.points DESC, goal_diff DESC, t.team_name
WITH temp AS ( SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals < away_team_goals THEN 0 ELSE 1 END AS home_team_points, CASE WHEN home_team_goals > away_team_goals THEN 0 WHEN home_team_goals < away_team_goals THEN 3 ELSE 1 END AS away_team_points FROM Matches ), temp2 AS ( SELECT home_team_id AS team_id, home_team_points AS points, home_team_goals AS goal_for, away_team_goals AS goal_against FROM temp UNION ALL SELECT away_team_id AS team_id, away_team_points AS points, away_team_goals AS goal_for, home_team_goals AS goal_against FROM temp ) SELECT team_name, COUNT(temp2.team_id) AS matches_played, SUM(points) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(goal_for)-SUM(goal_against) AS goal_diff FROM temp2 INNER JOIN teams ON temp2.team_id = teams.team_id GROUP BY temp2.team_id ORDER BY points DESC, goal_diff DESC, team_name ASC
WITH temp AS( SELECT home_team_id AS id, home_team_goals - away_team_goals AS diff, home_team_goals AS goal_for, away_team_goals AS goal_against FROM Matches UNION ALL SELECT away_team_id AS id, away_team_goals - home_team_goals AS diff, away_team_goals AS goal_for, home_team_goals AS goal_against FROM Matches ) SELECT team_name, COUNT(*) AS matches_played, SUM(CASE WHEN diff > 0 THEN 3 WHEN diff = 0 THEN 1 ELSE 0 END) AS points, SUM(goal_for) AS goal_for, SUM(goal_against) AS goal_against, SUM(diff) AS goal_diff FROM temp t JOIN Teams te ON te.team_id = t.id GROUP BY team_name ORDER BY points DESC, goal_diff DESC, team_name
WITH temp1 AS (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_points, CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END AS away_points FROM matches) SELECT team_name, COUNT(*) AS matches_played, SUM(points) AS points, SUM(goals) AS goal_for, SUM(oppo_goals) AS goal_against, SUM(goals) - SUM(oppo_goals) AS goal_diff FROM (SELECT home_team_id AS team_id, home_team_goals AS goals, away_team_goals AS oppo_goals, home_points AS points FROM temp1 UNION ALL SELECT away_team_id AS team_id, away_team_goals AS goals, home_team_goals AS oppo_goals, away_points AS points FROM temp1) t1 JOIN teams t on t1.team_id = t.team_id GROUP BY t1.team_id ORDER BY 3 DESC, 6 DESC, 1
With A AS (SELECT *, (CASE WHEN home_team_goals<away_team_goals THEN 0 WHEN home_team_goals>away_team_goals THEN 3 ELSE 1 END) AS home_team_points, (CASE WHEN home_team_goals<away_team_goals THEN 3 WHEN home_team_goals>away_team_goals THEN 0 ELSE 1 END) AS away_team_points FROM Matches ), B AS (SELECT home_team_id, home_team_goals, away_team_goals, home_team_points FROM A UNION ALL SELECT away_team_id, away_team_goals, home_team_goals, away_team_points FROM A) SELECT team_name, matches_played, points, goal_for, goal_against, goal_diff FROM (SELECT home_team_id, COUNT(*) AS matches_played, SUM(home_team_points) AS points, SUM(home_team_goals) AS goal_for, SUM(away_team_goals) AS goal_against, SUM(home_team_goals) - SUM(away_team_goals) AS goal_diff FROM B GROUP BY home_team_id) C INNER JOIN Teams ON C.home_team_id = Teams.team_id ORDER BY points DESC, goal_diff DESC, team_name
With Table1 as ( SELECT home_team_id as team_id ,home_team_goals ,away_team_goals FROM Matches a UNION ALL SELECT away_team_id as team_id ,away_team_goals as home_team_goals ,home_team_goals as away_team_goals FROM Matches b ) SELECT b.team_name ,COUNT(*) as matches_played ,SUM(CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 WHEN home_team_goals < away_Team_goals THEN 0 END) as points ,SUM(home_team_goals) as goal_for ,SUM(away_team_goals) as goal_against ,SUM(home_team_goals) - SUM(away_team_goals) as goal_diff FROM Table1 a INNER JOIN teams b on a.team_id = b.team_id GROUP BY b.team_name ORDER BY 3 DESC,6 DESC, 1 ASC
With cte as ( Select team_name, count(*) as matches_played, SUM(Case When team_id = home_team_id And home_team_goals > away_team_goals Then 3 When team_id = home_team_id And home_team_goals < away_team_goals Then 0 When team_id = away_team_id And home_team_goals < away_team_goals Then 3 When team_id = away_team_id And home_team_goals > away_team_goals Then 0 Else 1 END ) as points, SUM(Case When team_id = home_team_id Then home_team_goals When team_id = away_team_id Then away_team_goals Else 0 END ) goal_for, SUM( Case When team_id = home_team_id Then away_team_goals When team_id = away_team_id Then home_team_goals Else 0 END) goal_against From Matches m join Teams t on t.team_id = m.home_team_id Or t.team_id = m.away_team_id Group by team_id ) Select *, (goal_for - goal_against) as goal_diff From cte Group by team_name Order by points DESC, goal_diff DESC, team_name
With cte as (SELECT A.team,A.points,A.goals,T.team_name,A.goal from (select home_team_id as team,(case when home_team_goals = away_team_goals then 1 when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 end)points,home_team_goals as goals,away_team_goals as goal from Matches Union all select away_team_id as team,(case when away_team_goals = home_team_goals then 1 when away_team_goals > home_team_goals then 3 when away_team_goals < home_team_goals then 0 end)points,away_team_goals as goals,home_team_goals as goal from Matches)A left join Teams T ON A.team =T.team_id) SELECT *,(goal_for - goal_against)as goal_diff from (select team_name ,count(team)as matches_played,sum(points)as points,sum(goals)goal_for,sum(goal)goal_against from cte group by team_name)B order by points desc ,goal_diff desc,team_name asc
With cte as (select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, Case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points from Matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goals_against , Case when away_team_goals>home_team_goals then 3 when away_team_goals=home_team_goals then 1 else 0 end as points from Matches) select team_name,count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for-goal_against) as goal_diff from cte C join Teams T on C.team_id= T.team_id group by team_name order by points desc, goal_diff desc, team_name
select (select team_name from Teams where team_id = A.team_id ) as team_name ,count(*) as matches_played , sum(points ) as points , sum(goal_for ) as goal_for , sum(goal_against ) as goal_against , sum(goal_diff ) as goal_diff from ( (select home_team_id as team_id , (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points , home_team_goals as goal_for , away_team_goals as goal_against , (home_team_goals - away_team_goals) as goal_diff from Matches ) union all (select away_team_id as team_id , (case when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end) as points , away_team_goals as goal_for , home_team_goals as goal_against ,(away_team_goals - home_team_goals ) as goal_diff from Matches) ) A group by team_id order by points desc, goal_diff desc, team_name
select * from (select b.team_name, sum(a.matches_played) as matches_played, sum(a.points) as points, sum(a.goal_for) as goal_for, sum(a.goal_against) as goal_against, sum(a.goal_for) - sum(a.goal_against) as goal_diff from ((select home_team_id as team_id, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, count(away_team_id) as matches_played from Matches group by home_team_id) union all (select away_team_id as team_id, sum(case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, count(home_team_id) as matches_played from Matches group by away_team_id)) a join Teams b on a.team_id = b.team_id group by a.team_id) c order by points desc, goal_diff desc, team_name asc
select *, (goal_for - goal_against) as goal_diff from (select team_name, SUM(team_id = home_team_id) + SUM(team_id = away_team_id) AS matches_played, SUM(CASE WHEN team_id = home_team_id and home_team_goals>away_team_goals THEN 3 WHEN team_id = home_team_id and home_team_goals<away_team_goals THEN 0 WHEN team_id = away_team_id and home_team_goals<away_team_goals THEN 3 WHEN team_id = away_team_id and home_team_goals>away_team_goals THEN 0 ELSE 1 END) AS points, sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals end ) as goal_for , SUM(case when team_id = away_team_id then home_team_goals when team_id = home_team_id then away_team_goals end ) as goal_against from Teams t join Matches m on team_id = home_team_id or team_id = away_team_id group by team_name) sub order by points desc, goal_diff desc, team_name asc
select *, goal_for - goal_against as goal_diff from ( select t.team_name, count(*) as matches_played, SUM(IF(t.team_id = m2.home_team_id, m2.home_team_points, m2.away_team_points)) as points, SUM(IF(t.team_id = m2.home_team_id, m2.home_team_goals, m2.away_team_goals)) as goal_for, SUM(IF(t.team_id = m2.home_team_id, m2.away_team_goals, m2.home_team_goals)) as goal_against from Teams t join ( select *, IF(home_team_goals > away_team_goals, 3, 0) + IF(home_team_goals = away_team_goals, 1, 0) as home_team_points, IF(away_team_goals > home_team_goals, 3, 0) + IF(home_team_goals = away_team_goals, 1, 0) as away_team_points from Matches m ) m2 on t.team_id = m2.home_team_id or t.team_id = m2.away_team_id group by t.team_id ) t2 order by t2.points desc, (goal_for - goal_against) desc, t2.team_name
select *,goal_for-goal_against as goal_diff from( select T.team_name,count(*) as matches_played, sum(case when home_team_goals>away_team_goals and t.team_id=m.home_team_id then 3 when away_team_goals>home_team_goals and t.team_id=m.away_team_id then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(case when t.team_id=m.home_team_id then home_team_goals when t.team_id=m.away_team_id then away_team_goals end) as goal_for, sum(case when t.team_id=m.home_team_id then away_team_goals when t.team_id=m.away_team_id then home_team_goals end) as goal_against from Teams T left join Matches m on t.team_id=m.home_team_id or t.team_id=m.away_team_id group by T.team_name) as f where goal_for is not null order by points desc,goal_diff desc,team_name
select T.team_name, sum(case when T.team_id = M.home_team_id then 1 when T.team_id = M.away_team_id then 1 else 0 end) as matches_played, sum(case when T.team_id = M.home_team_id and M.home_team_goals > M.away_team_goals then 3 when T.team_id = M.away_team_id and M.away_team_goals > M.home_team_goals then 3 when T.team_id = M.home_team_id and M.home_team_goals = M.away_team_goals then 1 when T.team_id = M.away_team_id and M.away_team_goals = M.home_team_goals then 1 else 0 end) as points, sum(case when T.team_id = M.home_team_id then M.home_team_goals when T.team_id = M.away_team_id then M.away_team_goals else 0 end) as goal_for, sum(case when T.team_id = M.home_team_id then M.away_team_goals when T.team_id = M.away_team_id then M.home_team_goals else 0 end) as goal_against, sum(case when T.team_id = M.home_team_id then M.home_team_goals when T.team_id = M.away_team_id then M.away_team_goals else 0 end) - sum(case when T.team_id = M.home_team_id then M.away_team_goals when T.team_id = M.away_team_id then M.home_team_goals else 0 end) as goal_diff from Teams as T inner join Matches as M on T.team_id = M.home_team_id or T.team_id = M.away_team_id group by T.team_name order by points desc, goal_diff desc, T.team_name asc
select U.team_name, count(*) as matches_played, sum(U.points) as points, sum(U.goal_for) as goal_for, sum(U.goal_against) as goal_against, sum(U.goal_for - U.goal_against) as goal_diff from ( select T.team_name, case when M.home_team_goals > M.away_team_goals then 3 else (case when M.home_team_goals = M.away_team_goals then 1 else 0 end) end as points, M.home_team_goals as goal_for, M.away_team_goals as goal_against from Teams as T inner join Matches as M on T.team_id = M.home_team_id union all select T.team_name, case when M.away_team_goals > M.home_team_goals then 3 else (case when M.away_team_goals = M.home_team_goals then 1 else 0 end) end as points, M.away_team_goals as goal_for, M.home_team_goals as goal_against from Teams as T inner join Matches as M on T.team_id = M.away_team_id ) as U group by team_name order by points desc, goal_diff desc, team_name asc
select a.team_name, count(1) as matches_played , sum(points) as points , sum(goal_for) goal_for, sum(goal_against) goal_against, sum(goal_for)-sum(goal_against) goal_diff from ( select home_team_id as team_id , case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points, home_team_goals as goal_for, away_team_goals as goal_against from Matches union all select away_team_id team_id, case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points, away_team_goals as goal_for, home_team_goals as goal_against from Matches ) t join Teams a on t.team_id=a.team_id group by a.team_name order by points desc, goal_diff desc, a.team_name
select c.team_name,c.matches_played,c.points,c.goal_for,c.goal_against, (c.goal_for-c.goal_against) as goal_diff from ( select team_name , sum(case when t.team_id =home_team_id then 1 when t.team_id =away_team_id then 1 else 0 end) matches_played , sum(case when t.team_id =home_team_id and home_team_goals > away_team_goals then 3 when t.team_id =home_team_id and home_team_goals < away_team_goals then 0 when t.team_id =home_team_id and home_team_goals = away_team_goals then 1 when t.team_id =away_team_id and away_team_goals > home_team_goals then 3 when t.team_id =away_team_id and away_team_goals < home_team_goals then 0 when t.team_id =away_team_id and away_team_goals = home_team_goals then 1 end) as points , sum(case when t.team_id =home_team_id then home_team_goals when t.team_id =away_team_id then away_team_goals else 0 end) as goal_for , sum(case when t.team_id =away_team_id then home_team_goals when t.team_id =home_team_id then away_team_goals end) as goal_against from Teams t, Matches m where t.team_id =home_team_id or t.team_id =away_team_id group by team_id )c order by c.points desc, (c.goal_for-c.goal_against) desc, c.team_name
select distinct team_name, sum(matches_played) "matches_played", sum(points) "points", sum(goal_for) "goal_for", sum(goal_against) "goal_against", sum(goal_diff) "goal_diff" from( select distinct t.team_name, count(h.home_team_id) "matches_played", sum(case when h.home_team_goals > h.away_team_goals then 3 when h.home_team_goals = h.away_team_goals then 1 else 0 end) "points", sum(h.home_team_goals) "goal_for", sum(h.away_team_goals) "goal_against", sum(h.home_team_goals) - sum(h.away_team_goals)"goal_diff" from teams t join matches h on h.home_team_id = t.team_id group by t.team_id union select distinct t.team_name, count(a.away_team_id) "matches_played", sum(case when a.home_team_goals < a.away_team_goals then 3 when a.home_team_goals = a.away_team_goals then 1 else 0 end) "points", sum(a.away_team_goals) "goal_for", sum(a.home_team_goals) "goal_against", sum(a.away_team_goals) - sum(a.home_team_goals) "goal_diff" from teams t join matches a on a.away_team_id = t.team_id group by t.team_name ) result_table group by team_name order by 3 desc, 6 desc, 1
select e.team_name ,d.matches_played ,d.points ,d.goal_for ,d.goal_against ,d.goal_diff from (select team_id,count(team_id) as matches_played ,sum(points) as points ,sum(goal_for) as goal_for ,sum(goal_against) as goal_against ,sum(goal_for)-sum(goal_against) as goal_diff from (select home_team_id as team_id,home_team_points as points ,home_team_goals as goal_for,away_team_goals as goal_against from (select *,case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as home_team_points ,case when home_team_goals>away_team_goals then 0 when home_team_goals=away_team_goals then 1 else 3 end as away_team_points from Matches) a union all select away_team_id as team_id,away_team_points as points ,away_team_goals as goal_for,home_team_goals as goal_against from (select *,case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as home_team_points ,case when home_team_goals>away_team_goals then 0 when home_team_goals=away_team_goals then 1 else 3 end as away_team_points from Matches) a)b group by team_id)d left join Teams e on d.team_id=e.team_id order by points desc,goal_diff desc,team_name
select l.team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for)-sum(goal_against) as goal_diff from (select team_name, count(*) as matches_played, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) points, sum( home_team_goals ) goal_for, sum( away_team_goals ) goal_against from Matches h left join Teams t on t.team_id=h.home_team_id group by home_team_id union all select team_name, count(*) as matches_played, sum(case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) points, sum( away_team_goals ) goal_for , sum( home_team_goals ) goal_against from Matches a left join Teams t on t.team_id=a.away_team_id group by away_team_id ) as l group by l.team_name order by points desc, goal_diff desc, team_name asc
select sub.*, (goal_for - goal_against) as goal_diff FROM ( SELECT team_name, SUM(team_id = home_team_id) + SUM(team_id = away_team_id) AS matches_played, SUM( CASE WHEN team_id = home_team_id and home_team_goals>away_team_goals THEN 3 WHEN team_id = home_team_id and home_team_goals<away_team_goals THEN 0 WHEN team_id = away_team_id and home_team_goals<away_team_goals THEN 3 WHEN team_id = away_team_id and home_team_goals>away_team_goals THEN 0 ELSE 1 END) AS points, sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals end ) as goal_for , SUM(case when team_id = away_team_id then home_team_goals when team_id = home_team_id then away_team_goals end ) as goal_against FROM Teams t JOIN Matches m ON t.team_id = m.home_team_id OR t.team_id = m.away_team_id GROUP BY t.team_name) sub order by points desc, goal_diff desc, team_name asc
select t.team_name as team_name, count(m.team_id) as matches_played, sum(m.points) as points, sum(m.goal_for) as goal_for, sum(m.goal_against) as goal_against, sum(m.goal_for)-sum(m.goal_against) as goal_diff from Teams as t inner join ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points from Matches union all select away_team_id, away_team_goals, home_team_goals, case when away_team_goals>home_team_goals then 3 when away_team_goals=home_team_goals then 1 else 0 end from Matches ) as m on (t.team_id=m.team_id) group by t.team_id order by 3 desc,6 desc,1
select t.team_name, count(*) as matches_played, sum(case when (t.team_id=m.home_team_id and m.home_team_goals > m.away_team_goals) then 3 else 0 end) + sum(case when (t.team_id=m.away_team_id and m.away_team_goals>m.home_team_goals) then 3 else 0 end) + sum(case when m.home_team_goals=m.away_team_goals then 1 else 0 end) as points, sum(case when t.team_id=m.home_team_id then m.home_team_goals else 0 end) + sum(case when t.team_id=m.away_team_id then m.away_team_goals else 0 end) as goal_for, sum(case when t.team_id=m.home_team_id then m.away_team_goals else 0 end)+ sum(case when t.team_id=m.away_team_id then m.home_team_goals else 0 end) as goal_against, sum(case when t.team_id=m.home_team_id then m.home_team_goals - m.away_team_goals else 0 end)+ sum(case when t.team_id=m.away_team_id then m.away_team_goals - m.home_team_goals else 0 end) as goal_diff from Teams t join Matches m on t.team_id=m.home_team_id or t.team_id=m.away_team_id group by t.team_id order by points desc,goal_diff desc, team_name
select t.team_name, count(*) matches_played, sum(case when t.team_id = m.home_team_id and home_team_goals>away_team_goals then 3 when t.team_id = m.home_team_id and home_team_goals=away_team_goals then 1 when t.team_id = m.away_team_id and home_team_goals=away_team_goals then 1 when t.team_id = m.away_team_id and home_team_goals<away_team_goals then 3 else 0 end) as points, sum(case when t.team_id = m.home_team_id then home_team_goals when t.team_id = m.away_team_id then away_team_goals end) as goal_for, sum(case when t.team_id = m.home_team_id then away_team_goals when t.team_id = m.away_team_id then home_team_goals end) as goal_against, (sum(case when t.team_id = m.home_team_id then home_team_goals when t.team_id = m.away_team_id then away_team_goals end) - sum(case when t.team_id = m.home_team_id then away_team_goals when t.team_id = m.away_team_id then home_team_goals end) ) as goal_diff from Teams t join Matches m where t.team_id = m.home_team_id or t.team_id = m.away_team_id group by 1 order by points desc, goal_diff desc,team_name
select t.team_name, count(t.team_name) as matches_played, sum(if(t.goal_for > t.goal_against, 3, 0)) + sum(if(t.goal_for = t.goal_against, 1, 0)) as points, sum(t.goal_for) as goal_for, sum(t.goal_against) as goal_against, sum(t.goal_for) - sum(t.goal_against) as goal_diff from ((select t1.team_name, m.home_team_goals as goal_for, m.away_team_goals as goal_against from Matches m join Teams t1 on m.home_team_id = t1.team_id) union all (select t2.team_name, m.away_team_goals as goal_for, m.home_team_goals as goal_against from Matches m join Teams t2 on m.away_team_id = t2.team_id)) t group by t.team_name order by sum(if(t.goal_for > t.goal_against, 3, 0)) + sum(if(t.goal_for = t.goal_against, 1, 0)) desc, sum(t.goal_for) - sum(t.goal_against) desc, t.team_name
select t.team_name, hh.game_played as matches_played, hh.points as points, hh.goals as goal_for, hh.goals_against goal_against, hh.goals - hh.goals_against as goal_diff from teams t inner join ( select a.team_id, sum(a.game_played) as game_played, sum(a.points) as points , sum(a.goals) as goals, sum(a.goals_against) as goals_against, sum(a.goals)- sum(a.goals_against) as goals_diff from ( select away_team_id as team_id, count( away_team_id) as game_played, sum(away_team_goals) as goals, sum(home_team_goals) as goals_against, sum(case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end ) as points from Matches group by away_team_id union all select home_team_id as team_id, count( home_team_id) as game_played, sum(home_team_goals) as goals, sum(away_team_goals) as goals_against, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end ) as points from Matches group by home_team_id ) a group by a.team_id ) hh on hh.team_id = t.team_id order by 3 desc, 6 desc, 1 asc
select t.team_name, m.matches_played,m.points, m.goal_for,m.goal_against,m.goal_diff from Teams t join ( select team_id, sum(matches_played) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against, sum(goal_diff) as goal_diff from ( select home_team_id as team_id, sum(1) as matches_played, sum(case when home_team_goals> away_team_goals then 3 when home_team_goals< away_team_goals then 0 else 1 end) as points, sum(home_team_goals) as goals_for, sum(away_team_goals) as goals_against, sum(home_team_goals - away_team_goals) as goal_diff from Matches group by 1 union all select away_team_id as team_id, sum(1) as matches_played, sum(case when home_team_goals< away_team_goals then 3 when home_team_goals> away_team_goals then 0 else 1 end) as points, sum(away_team_goals) as goals_for, sum(home_team_goals) as goals_against, sum(away_team_goals - home_team_goals) as goal_diff from Matches group by 1 ) tmp group by 1 ) m on t.team_id = m.team_id order by m.points desc, m.goal_diff desc, t.team_name asc
select t.team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff from ( select home_team_id as team_id, 1 as matches_played, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points, home_team_goals as goal_for, away_team_goals as goal_against, home_team_goals - away_team_goals as goal_diff from matches union all select away_team_id as team_id, 1 as matches_played, case when away_team_goals > home_team_goals then 3 when away_team_goals < home_team_goals then 0 else 1 end as points, away_team_goals as goal_for, home_team_goals as goal_against, away_team_goals - home_team_goals as goal_diff from matches ) a left join teams t using(team_id) group by team_id order by points desc, goal_diff desc, t.team_name
select t.team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff from ( select home_team_id as team_id, count(1) as matches_played, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals) - sum(away_team_goals) as goal_diff from matches group by home_team_id union all select away_team_id as team_id, count(1) as matches_played, sum(case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, sum(away_team_goals) - sum(home_team_goals) as goal_diff from matches group by away_team_id ) a left join teams t using(team_id) group by team_id order by points desc, goal_diff desc, team_name
select t.team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff from (select home_team_id as team_id, 1 as matches_played, (case when home_team_goals > away_team_goals then 3 when home_team_goals <away_team_goals then 0 else 1 end) as points, home_team_goals as goal_for, away_team_goals as goal_against, home_team_goals - away_team_goals as goal_diff from Matches UNION all select away_team_id as team_id, 1 as matches_played, (case when away_team_goals > home_team_goals then 3 when away_team_goals <home_team_goals then 0 else 1 end) as points, away_team_goals as goal_for, home_team_goals as goal_against, away_team_goals - home_team_goals as goal_diff from Matches) a left join Teams t using (team_id) group by team_id order by points desc, goal_diff desc, t.team_name
select t.team_name,count(*) as matches_played, sum(case when temp.goal_a>temp.goal_b then 3 when temp.goal_a=temp.goal_b then 1 else 0 end) as points, sum(temp.goal_a) as goal_for, sum(temp.goal_b) as goal_against, (sum(temp.goal_a)-sum(temp.goal_b)) as goal_diff from (select home_team_id as team_a,away_team_id as team_b,home_team_goals as goal_a, away_team_goals as goal_b from Matches union all select away_team_id as team_a, home_team_id as team_b, away_team_goals as goal_a,home_team_goals as goal_b from Matches) temp join Teams t on temp.team_a=t.team_id group by 1 order by points desc, goal_diff desc, t.team_name
select t3.team_name, matches_played, points, goal_for, goal_against, goal_diff from (select t.home_team_id, sum(t.n_home) matches_played, sum(homescores) points, sum(homegoals) as goal_for, sum(awaygoals) as goal_against, sum(homegoals) -sum(awaygoals) as goal_diff from ( select home_team_id, count(away_team_id) n_home, sum(home_team_goals) as homegoals, sum(away_team_goals) as awaygoals, sum(if(home_team_goals > away_team_goals, 3, if(home_team_goals = away_team_goals, 1, 0))) as homescores from Matches group by home_team_id union all (select away_team_id, count(away_team_id) n_home, sum(away_team_goals) homegoals, sum(home_team_goals) awaygoals, sum(if(home_team_goals > away_team_goals, 0, if(home_team_goals = away_team_goals, 1, 3))) as homescores from Matches group by away_team_id) ) t group by t.home_team_id) t2 left join Teams t3 on t2.home_team_id = t3.team_id order by points desc, goal_diff desc, t3.team_name asc
select team_name , count(*) as matches_played , sum(case when a > b then 3 when a = b then 1 else 0 end) as points , sum(a) as goal_for , sum(b) as goal_against , sum(a) - sum(b) as goal_diff from (select home_team_id, home_team_goals a, away_team_goals b from matches union all select away_team_id as home_team_id, away_team_goals a, home_team_goals b from matches) g join teams t on g.home_team_id = t.team_id group by 1 order by 3 desc, 6 desc, 1
select team_name , count(*) as matches_played , sum(case when home > away then 3 when home = away then 1 else 0 end) as points , sum(home) as goal_for , sum(away) as goal_against , sum(home) - sum(away) as goal_diff from (select home_team_id, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as home_team_id, away_team_goals as home, home_team_goals as away from matches ) g join teams t on g.home_team_id = t.team_id group by 1 order by 3 desc, 6 desc, 1
select team_name , count(home_team_id) as matches_played , sum(case when home > away then 3 when home = away then 1 else 0 end) as points , sum(home) as goal_for , sum(away) as goal_against , sum(home) - sum(away) as goal_diff from (select home_team_id, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as home_team_id, away_team_goals as home, home_team_goals as away from matches ) g join teams t on g.home_team_id = t.team_id group by 1 order by 3 desc, 6 desc, 1
select team_name , count(team_name) as matches_played , sum(case when team_id = home_team_id and home_team_goals < away_team_goals then 0 when team_id = away_team_id and home_team_goals > away_team_goals then 0 when team_id = home_team_id and home_team_goals = away_team_goals then 1 when team_id = home_team_id and home_team_goals > away_team_goals then 3 when team_id = away_team_id and home_team_goals < away_team_goals then 3 when team_id = away_team_id and home_team_goals = away_team_goals then 1 end) as points , sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals else 0 end) as goal_for , sum(case when team_id = home_team_id then away_team_goals when team_id = away_team_id then home_team_goals else 0 end) as goal_against , (sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals else 0 end) - sum(case when team_id = home_team_id then away_team_goals when team_id = away_team_id then home_team_goals else 0 end) ) as goal_diff from teams t join matches m on team_id = home_team_id or team_id = away_team_id group by 1 ORDER BY points DESC, goal_diff DESC, team_name ASC
select team_name, count(*) 'matches_played', sum(case when team_id=home_team_id then home_point else away_point end) 'points', sum(case when team_id=home_team_id then home_team_goals else away_team_goals end) 'goal_for', sum(case when team_id=home_team_id then away_team_goals else home_team_goals end) 'goal_against', sum(case when team_id=home_team_id then home_team_goals else away_team_goals end) - sum(case when team_id=home_team_id then away_team_goals else home_team_goals end) 'goal_diff' from (select *, if(home_team_goals>away_team_goals,3,if(home_team_goals=away_team_goals,1,0)) 'home_point', if(away_team_goals>home_team_goals,3,if(away_team_goals=home_team_goals,1,0)) 'away_point' from matches m join teams t on t.team_id in (m.home_team_id, m.away_team_id)) ff group by team_name order by points desc, goal_diff desc, team_name
select team_name, count(*) as matches_played, sum(case when goal_for > goal_against then 3 when goal_for = goal_against then 1 else 0 end) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from teams t join (select 'home' as type, home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select 'away' as type, away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against from matches) m on t.team_id = m.team_id group by 1 order by points DESC, goal_diff DESC, team_name ASC
select team_name, count(*) as matches_played, sum(case when home > away then 3 when home = away then 1 else 0 end) as points, sum(home) as goal_for, sum(away) as goal_against, sum(home) - sum(away) as goal_diff from (select home_team_id as id, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as id, away_team_goals as home, home_team_goals as away from matches) c join teams t on c.id = t.team_id group by team_name order by 3 desc, 6 desc, 1 asc
select team_name, count(*) as matches_played, sum(case when home > away then 3 when home = away then 1 else 0 end) as points, sum(home) as goal_for, sum(away) as goal_against, sum(home) -sum(away) as goal_diff from ( select home_team_id, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as home_team_id, away_team_goals as home, home_team_goals as away from matches ) g join teams t on g.home_team_id = t.team_id group by 1 order by 3 desc, 6 desc, 1
select team_name, count(*) as matches_played, sum(case when home > away then 3 when home = away then 1 else 0 end) as points, sum(home) as goal_for, sum(away) as goal_against, sum(home)-sum(away) as goal_diff from (select home_team_id, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as home_team_id, away_team_goals as home, home_team_goals as away from matches) as p join teams on home_team_id = team_id group by team_name order by points desc, goal_diff desc, team_name
select team_name, count(*) as matches_played, sum(case when home>away then 3 when home=away then 1 else 0 end) as points, sum(home) as goal_for, sum(away) as goal_against, sum(home)-sum(away) as goal_diff from ( select home_team_id as team_id, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as home_team_id, away_team_goals as home, home_team_goals as away from matches ) a join teams t on t.team_id=a.team_id group by 1 order by points desc, goal_diff desc, team_name
select team_name, count(*) as matches_played, sum(case when t.team_id = m.home_team_id and home_team_goals> away_team_goals then 3 when t.team_id = m.away_team_id and home_team_goals< away_team_goals then 3 when t.team_id = m.home_team_id and home_team_goals = away_team_goals then 1 when t.team_id = m.away_team_id and home_team_goals = away_team_goals then 1 else 0 end ) as points, sum(case when t.team_id = m.home_team_id then home_team_goals when t.team_id = m.away_team_id then away_team_goals else 0 end ) as goal_for, sum(case when t.team_id = m.home_team_id then away_team_goals when t.team_id = m.away_team_id then home_team_goals else 0 end ) as goal_against, sum(case when t.team_id = m.home_team_id then home_team_goals when t.team_id = m.away_team_id then away_team_goals else 0 end ) - sum(case when t.team_id = m.home_team_id then away_team_goals when t.team_id = m.away_team_id then home_team_goals else 0 end ) as goal_diff from matches m join teams t on (m.home_team_id = t.team_id) or (m.away_team_id = t.team_id) group by 1 order by 3 desc, 6 desc,1
select team_name, count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches ) as p_m join teams on p_m.team_id = teams.team_id group by team_name order by points desc, goal_diff desc, team_name
select team_name, count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from (SELECT t.team_name, CASE WHEN t.team_id=m.home_team_id and home_team_goals>away_team_goals THEN 3 WHEN t.team_id=m.home_team_id and home_team_goals=away_team_goals THEN 1 WHEN t.team_id=m.away_team_id and home_team_goals=away_team_goals THEN 1 WHEN t.team_id=m.away_team_id and home_team_goals<away_team_goals THEN 3 ELSE 0 END as points, CASE WHEN t.team_id=m.home_team_id THEN home_team_goals ELSE away_team_goals END AS goal_for, CASE WHEN t.team_id=m.away_team_id THEN home_team_goals ELSE away_team_goals END AS goal_against from Teams t join Matches m on t.team_id = m.home_team_id or t.team_id = m.away_team_id) tb group by team_name order by points desc, goal_diff desc, team_name
select team_name, count(*) as matches_played, sum(points) as points, sum(goals_scored) as goal_for, sum(goals_conceaded) as goal_against, sum(goals_scored)-sum(goals_conceaded) as goal_diff from teams t inner join ( select case when home_team_goals>away_team_goals then home_team_id when home_team_goals<away_team_goals then away_team_id end as team_id, 3 as points, case when home_team_goals<away_team_goals then away_team_goals when home_team_goals>away_team_goals then home_team_goals end as goals_scored, case when home_team_goals<away_team_goals then home_team_goals when home_team_goals>away_team_goals then away_team_goals end as goals_conceaded from matches where home_team_goals!=away_team_goals union all select case when home_team_goals<away_team_goals then home_team_id when home_team_goals>away_team_goals then away_team_id end as team_id, 0 as points, case when home_team_goals<away_team_goals then home_team_goals when home_team_goals>away_team_goals then away_team_goals end as goals_scored, case when home_team_goals<away_team_goals then away_team_goals when home_team_goals>away_team_goals then home_team_goals end as goals_conceaded from matches where home_team_goals!=away_team_goals union all select home_team_id as team_id, 1 as points, home_team_goals as goals_scored, away_team_goals as goals_conceaded from matches where home_team_goals=away_team_goals union all select away_team_id as team_id, 1 as points, away_team_goals as goals_scored, home_team_goals as goals_conceaded from matches where home_team_goals=away_team_goals ) team_points using(team_id) group by t.team_id, t.team_name order by sum(points) desc, goal_diff desc, team_name
select team_name, count(*) matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from ( select t.team_name, case when t.team_id = m.home_team_id and home_team_goals > away_team_goals then 3 when t.team_id = m.home_team_id and home_team_goals = away_team_goals then 1 when t.team_id = m.away_team_id and home_team_goals < away_team_goals then 3 when t.team_id = m.away_team_id and home_team_goals = away_team_goals then 1 else 0 end as points, case when t.team_id = m.home_team_id then home_team_goals else away_team_goals end as goal_for, case when t.team_id = m.away_team_id then home_team_goals else away_team_goals end as goal_against from Teams t join Matches m on t.team_id = m.home_team_id or t.team_id = away_team_id ) tb group by team_name order by points desc, goal_diff desc, team_name
select team_name, count(*) matches_played, sum(points) points, sum(goal_for) goal_for, sum(goal_against) goal_against, sum(goal_for) -sum(goal_against) goal_diff from (select home_team_id id, case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points, home_team_goals goal_for, away_team_goals goal_against from Matches union all select away_team_id id, case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points, away_team_goals goal_for, home_team_goals goal_against from Matches ) t1 join Teams t2 on t1.id=t2.team_id group by 1 order by 3 desc, 6 desc, 1
select team_name, count(*) matches_played, sum(points) points, sum(goal_for) goal_for, sum(goal_against) goal_against, sum(goal_for)-sum(goal_against) goal_diff from teams t join ( select home_team_id team_id, home_team_goals goal_for, away_team_goals goal_against, if(home_team_goals>away_team_goals,3,if(home_team_goals=away_team_goals,1,0)) points from matches union all select away_team_id team_id, away_team_goals goal_for, home_team_goals goal_against, if(away_team_goals>home_team_goals,3,if(away_team_goals=home_team_goals,1,0)) points from matches) f1 on t.team_id = f1.team_id group by t.team_id order by points desc, goal_diff desc, team_name
select team_name, count(1) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against, sum(goals_for-goals_against) as goal_diff from teams t join ( select case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end as points, away_team_id as team_id, away_team_goals as goals_for, home_team_goals as goals_against from matches union all select (case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end) as points, home_team_id as team_id, home_team_goals as goals_for, away_team_goals as goals_against from matches ) p on t.team_id = p.team_id group by team_name order by points desc,goal_diff desc,team_name asc
select team_name, count(all_teams.team_id) matches_played, SUM(points_got) points, SUM(goals_by) goal_for, SUM(goals_away) goal_against, SUM(goals_d) goal_diff FROM ((select home_team_id team_id, home_team_goals goals_by, away_team_goals goals_away, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) points_got, home_team_goals - away_team_goals goals_d from Matches) UNION ALL (select away_team_id team_id, away_team_goals goals_by, home_team_goals goals_away, ( CASE WHEN away_team_goals > home_team_goals THEN 3 WHEN away_team_goals = home_team_goals THEN 1 ELSE 0 END) points_got, away_team_goals - home_team_goals goals_d from Matches) ) all_teams JOIN Teams t ON all_teams.team_id = t.team_id group by team_name order by points desc, goal_diff desc, team_name
select team_name, count(away_team_id) as matches_played,sum(case when home_team_goals> away_team_goals then 3 when home_team_goals< away_team_goals then 0 else 1 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)- sum(away_team_goals) as goal_diff from ( select home_team_id, away_team_id, home_team_goals, away_team_goals from matches union all select away_team_id,home_team_id,away_team_goals,home_team_goals from matches ) as t join teams on teams.team_id = t.home_team_id group by team_name order by 3 desc, 6 desc, 1
select team_name, count(id) as matches_played, sum(case when hgoals>agoals then 3 when hgoals<agoals then 0 else 1 end) as points, sum(hgoals) as goal_for, sum(agoals) as goal_against, sum(hgoals-agoals) as goal_diff from( select home_team_id as id, home_team_goals as hgoals, away_team_goals as agoals from Matches MH union all select away_team_id as id, away_team_goals as hgoals, home_team_goals as agoals from Matches MA ) A join Teams T on T.team_id = A.id group by id order by points desc, goal_diff desc, team_name asc
select team_name, count(oppo) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from ( select home_team_id as team_id, away_team_id as oppo, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 when home_team_goals < away_team_goals then 0 end as points from matches union all select away_team_id as team_id, home_team_id as oppo, away_team_goals as goal_for, home_team_goals as goal_against, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 when away_team_goals < home_team_goals then 0 end as points from matches ) as a left join teams as b on a.team_id = b.team_id group by 1 order by points desc, goal_diff desc, team_name
select team_name, count(points) matches_played, sum(points) points,sum(goals) goal_for, sum(goal_against) goal_against, sum(goals)-sum(goal_against) goal_diff from ( select home_team_id as team_id, case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points, home_team_goals as goals, away_team_goals as goal_against from Matches union all select away_team_id as team_id, case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as points, away_team_goals as goals, home_team_goals as goal_against from Matches ) as t join Teams on teams.team_id=t.team_id group by t.team_id order by points desc, goal_diff desc, team_name
select team_name, count(team) as matches_played, sum(case when home > away then 3 when home = away then 1 else 0 end) as points, sum(home) as goal_for, sum(away) as goal_against, sum(home-away) as goal_diff from (select home_team_id as team, home_team_goals as home, away_team_goals as away from matches union all select away_team_id as team, away_team_goals as home, home_team_goals as away from matches) g join teams t on g.team = t.team_id group by 1 order by 3 desc, 6 desc, 1
select team_name, matches_played, points, goal_for, goal_against, (goal_for - goal_against) as goal_diff from (select t.team_name as team_name, sum(case when t.team_id = m.home_team_id then 1 when t.team_id = m.away_team_id then 1 else 0 end) as matches_played, sum(case when t.team_id = m.home_team_id and m.home_team_goals > m.away_team_goals then 3 when t.team_id = m.away_team_id and m.away_team_goals > m.home_team_goals then 3 when m.home_team_goals = m.away_team_goals then 1 else 0 end) as points, sum(case when t.team_id = m.home_team_id then m.home_team_goals when t.team_id = m.away_team_id then m.away_team_goals else 0 end) as goal_for, sum(case when t.team_id = m.home_team_id then m.away_team_goals when t.team_id = m.away_team_id then m.home_team_goals else 0 end) as goal_against from teams t join matches m on m.home_team_id = t.team_id or m.away_team_id = t.team_id group by t.team_id) a order by points desc, goal_diff desc, team_name asc
select team_name, matches_played, points, goal_for, goal_against, goal_diff from ( select team_id, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff from ( select home_team_id as team_id, count(*) as matches_played, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)-sum(away_team_goals) as goal_diff from Matches group by home_team_id union all select away_team_id as team_id, count(*) as matches_played, sum(case when away_team_goals>home_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, sum(away_team_goals)-sum(home_team_goals) as goal_diff from Matches group by away_team_id ) sub1 group by team_id ) sub2 left join Teams on sub2.team_id=Teams.team_id order by points desc, goal_diff desc, team_name
select team_name, matches_played, points, goals_for as goal_for, goals_against as goal_against, goals_for-goals_against as goal_diff from ( select team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goals_for) as goals_for, sum(goals_against) as goals_against from( select t.team_id, t.team_name, case when team_id=home_team_id or team_id=away_team_id then 1 else null end as matches_played, case when team_id=winning_team then 3 when winning_team is null then 1 else 0 end points, case when team_id=home_team_id then home_team_goals when team_id=away_team_id then away_team_goals end as goals_for, case when team_id=home_team_id then away_team_goals when team_id=away_team_id then home_team_goals end as goals_against from teams t inner join (select *, case when home_team_goals>away_team_goals then home_team_id when home_team_goals<away_team_goals then away_team_id when home_team_goals=away_team_goals then null end as winning_team from matches) derived_matches on t.team_id=derived_matches.away_team_id or t.team_id=derived_matches.home_team_id )A group by A.team_name )B order by points desc,goals_for-goals_against desc,team_name asc
select team_name, sum(case when home_team_id = team_id or away_team_id = team_id then 1 else 0 end) as matches_played, sum(case when team_id = home_team_id and home_team_goals > away_team_goals then 3 when team_id = away_team_id and home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(case when home_team_id = team_id then home_team_goals when away_team_id = team_id then away_team_goals end) as goal_for, sum(case when home_team_id = team_id then away_team_goals else home_team_goals end) as goal_against, sum(case when home_team_id = team_id then home_team_goals-away_team_goals else away_team_goals-home_team_goals end) as goal_diff from matches m join teams t on m.home_team_id = t.team_id or m.away_team_id = t.team_id group by team_name order by points desc, goal_diff desc, team_name
select team_name, sum(match_count) as matches_played,sum(total) as points, sum(home_goals) as goal_for, sum(away_goals) as goal_against, sum(home_goals) - sum(away_goals) as goal_diff from (select home_team_id as team_id,count(*) as match_count, sum(home_team_goals) as home_goals, sum(away_team_goals) as away_goals, sum(home_points) as total from (select home_team_id, home_team_goals, away_team_goals, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as home_points from Matches) a group by home_team_id union select away_team_id as team_id ,count(*) as match_count, sum(away_team_goals) as home_goals, sum(home_team_goals) as away_goals, sum(away_points) as total from (select home_team_id,away_team_id, home_team_goals, away_team_goals, (case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as away_points from Matches) b group by away_team_id) x inner join Teams t on x.team_id = t.team_id group by team_name order by points desc, goal_diff desc,team_name
select team_name, sum(matches_played) "matches_played", sum(points) "points", sum(goal_for) "goal_for", sum(goal_against) "goal_against", sum(goal_diff) "goal_diff" from( select distinct t.team_name, count(h.home_team_id) "matches_played", sum(case when h.home_team_goals > h.away_team_goals then 3 when h.home_team_goals = h.away_team_goals then 1 else 0 end) "points", sum(h.home_team_goals) "goal_for", sum(h.away_team_goals) "goal_against", sum(h.home_team_goals) - sum(h.away_team_goals)"goal_diff" from teams t join matches h on h.home_team_id = t.team_id group by t.team_id union select distinct t.team_name, count(a.away_team_id) "matches_played", sum(case when a.home_team_goals < a.away_team_goals then 3 when a.home_team_goals = a.away_team_goals then 1 else 0 end) "points", sum(a.away_team_goals) "goal_for", sum(a.home_team_goals) "goal_against", sum(a.away_team_goals) - sum(a.home_team_goals) "goal_diff" from teams t join matches a on a.away_team_id = t.team_id group by t.team_name ) result_table group by team_name order by 3 desc, 6 desc, 1
select team_name, sum(matches_played) "matches_played", sum(points) "points", sum(goal_for) "goal_for", sum(goal_against) "goal_against", sum(goal_diff) "goal_diff" from( select t.team_name, count(h.home_team_id) "matches_played", sum(case when h.home_team_goals > h.away_team_goals then 3 when h.home_team_goals = h.away_team_goals then 1 else 0 end) "points", sum(h.home_team_goals) "goal_for", sum(h.away_team_goals) "goal_against", sum(h.home_team_goals) - sum(h.away_team_goals)"goal_diff" from teams t join matches h on h.home_team_id = t.team_id group by t.team_id union select t.team_name, count(a.away_team_id) "matches_played", sum(case when a.home_team_goals < a.away_team_goals then 3 when a.home_team_goals = a.away_team_goals then 1 else 0 end) "points", sum(a.away_team_goals) "goal_for", sum(a.home_team_goals) "goal_against", sum(a.away_team_goals) - sum(a.home_team_goals) "goal_diff" from teams t join matches a on a.away_team_id = t.team_id group by t.team_name ) result_table group by team_name order by 3 desc, 6 desc, 1
select team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff from Teams t inner join ( (select home_team_id as team_id, count(*) as matches_played, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(home_team_goals - away_team_goals) as goal_diff from Matches group by home_team_id ) union all (select away_team_id as team_id, count(*) as matches_played, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, sum(case when home_team_goals>away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end) as points, sum(-home_team_goals + away_team_goals) as goal_diff from Matches group by away_team_id ) ) as tab on t.team_id = tab.team_id group by t.team_id order by points desc, goal_diff desc, team_name asc
select team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from (select home_team_id as team_id, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, count(*) as matches_played, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from Matches group by home_team_id union all select away_team_id, sum(case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end) as points, count(*) as matches_played, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from Matches group by away_team_id) sub join Teams t on t.team_id = sub.team_id group by sub.team_id order by points desc, goal_diff desc, team_name asc
select team_name, sum(matches_played) matches_played, sum(points) points, sum(goal_for) goal_for, sum(goal_against) goal_against, sum(goal_for)-sum(goal_against) goal_diff from (select home_team_id team_id, count(*) matches_played, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end) points, sum(home_team_goals) goal_for, sum(away_team_goals) goal_against from matches group by home_team_id union all select away_team_id team_id, count(*) matches_played, sum(case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end) points, sum(away_team_goals) goal_for, sum(home_team_goals) goal_against from matches group by away_team_id )t1 join teams t2 on t1.team_id = t2.team_id group by team_name order by points desc, goal_diff desc, team_name
select team_name,SUM(matches_played) as matches_played,SUM(points) as points,SUM(goals_for) as goal_for,SUM(goals_against) as goal_against, (SUM(goals_for)-SUM(goals_against)) as goal_diff from (select team_id,team_name,count(1) as matches_played,SUM(home_team_goals) as goals_for, SUM(away_team_goals) as goals_against, SUM(IF(home_team_goals > away_team_goals,3,(IF(home_team_goals < away_team_goals,0,1)))) as points from teams JOIN matches ON team_id = home_team_id group by team_id,team_name UNION ALL select team_id,team_name,count(1) as matches_played,SUM(away_team_goals) as goals_for, SUM(home_team_goals) as goals_against, SUM(IF(away_team_goals > home_team_goals,3,(IF(away_team_goals < home_team_goals,0,1)))) as points from teams JOIN matches ON team_id = away_team_id group by team_id,team_name ) t group by team_id,team_name order by points desc,goal_diff desc,team_name
select team_name,SUM(matches_played) as matches_played,SUM(points) as points,SUM(goals_for) as goal_for,SUM(goals_against) as goal_against, (SUM(goals_for)-SUM(goals_against)) as goal_diff from (select team_id,team_name,count(1) as matches_played,SUM(home_team_goals) as goals_for, SUM(away_team_goals) as goals_against, SUM(IF(home_team_goals > away_team_goals,3,(IF(home_team_goals < away_team_goals,0,1)))) as points from teams JOIN matches ON team_id = home_team_id group by team_id,team_name UNION select team_id,team_name,count(1) as matches_played,SUM(away_team_goals) as goals_for, SUM(home_team_goals) as goals_against, SUM(IF(away_team_goals > home_team_goals,3,(IF(away_team_goals < home_team_goals,0,1)))) as points from teams JOIN matches ON team_id = away_team_id group by team_id,team_name ) t group by team_id,team_name order by points desc,goal_diff desc,team_name
select team_name,count(*) as matches_played, sum(case when team_id=home_team_id and home_team_goals > away_team_goals then 3 when team_id=home_team_id and home_team_goals = away_team_goals then 1 when team_id=away_team_id and home_team_goals = away_team_goals then 1 when team_id=away_team_id and away_team_goals > home_team_goals then 3 else 0 end ) as points, sum(case when team_id= home_team_id then home_team_goals when team_id=away_team_id then away_team_goals end) as goal_for, sum(case when team_id= home_team_id then away_team_goals when team_id=away_team_id then home_team_goals end) as goal_against, sum(case when team_id= home_team_id then home_team_goals when team_id=away_team_id then away_team_goals end) - sum(case when team_id= home_team_id then away_team_goals when team_id=away_team_id then home_team_goals end) as goal_diff from teams join matches on teams.team_id = matches.home_team_id or teams.team_id = matches.away_team_id group by 1 order by points desc,goal_diff desc,team_name
select team_name,matches_played, points,goal_for,goal_against,goal_diff from (select home_team_id, count(home_team_id) as matches_played, sum(points) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, (sum(home_team_goals) - sum(away_team_goals)) as goal_diff from (select home_team_id,away_team_id, away_team_goals, home_team_goals, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 when home_team_goals < away_team_goals then 0 end) as points from (select * from Matches union all select away_team_id, home_team_id, away_team_goals, home_team_goals from Matches) temp1) temp group by 1) temp12 left join Teams on Teams.team_id = temp12.home_team_id order by points desc, goal_diff desc,team_name
select teams.team_name ,count(team1) as matches_played ,sum(case when goal1>goal2 then 3 when goal1=goal2 then 1 else 0 end) as points ,sum(goal1) as goal_for ,sum(goal2) as goal_against ,sum(goal1-goal2) as goal_diff from Teams teams join ( select home_team_id as team1 ,away_team_id as team2 ,home_team_goals as goal1 ,away_team_goals as goal2 from Matches union all select away_team_id as team1 ,home_team_id as team2 ,away_team_goals as goal1 ,home_team_goals as goal2 from Matches )union_team on teams.team_id = union_team.team1 group by teams.team_id order by points desc,goal_diff desc,team_name
select teams.team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff from ( Select home_team_id as team_id, count(*) as matches_played, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 when home_team_goals<away_team_goals then 0 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)-sum(away_team_goals) as goal_diff from matches group by home_team_id union select away_team_Id as team_id, count(*) as matches_played, sum(case when away_team_goals>home_team_goals then 3 when away_team_goals=home_team_goals then 1 when away_team_goals<home_team_goals then 0 else 0 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, sum(away_team_goals)-sum(home_team_goals) as goal_diff from matches group by away_team_id ) as a left join teams on teams.team_id=a.team_id group by team_name order by points desc, goal_diff desc, team_name
select temp.*, (temp.goal_for - temp.goal_against) as goal_diff FROM (SELECT t.team_name, COUNT(*) as matches_played, SUM(CASE WHEN home_team_id=team_id AND home_team_goals > away_Team_goals THEN 3 WHEN home_team_id=team_id AND home_team_goals < away_Team_goals THEN 0 WHEN away_team_id=team_id AND home_team_goals > away_Team_Goals THEN 0 WHEN away_Team_id=team_id AND home_Team_goals < away_Team_Goals THEN 3 ELSE 1 END) as points, SUM(CASE WHEN home_team_id=team_id THEN home_Team_goals WHEN away_Team_id=team_id THEN away_Team_Goals ELSE 0 END) as goal_for, SUM(CASE WHEN home_team_id=team_id THEN away_Team_goals WHEN away_Team_id=team_id THEN home_Team_Goals ELSE 0 END) as goal_against FROM Teams t JOIN Matches m ON t.team_id=m.home_team_id OR t.team_id=m.away_team_id group by team_id) as temp order by points desc, goal_diff desc, team_name asc
select temp.*, goal_for-goal_against goal_diff from (select team_name, sum(team_id in (home_team_id,away_team_id)) matches_played, sum(case when team_id=home_team_id and home_team_goals>away_team_goals then 3 when team_id=home_team_id and home_team_goals<away_team_goals then 0 when team_id=away_team_id and home_team_goals>away_team_goals then 0 when team_id=away_team_id and home_team_goals<away_team_goals then 3 else 1 end) points, sum(case when team_id=home_team_id then home_team_goals when team_id=away_team_id then away_team_goals end) goal_for, sum(case when team_id=home_team_id then away_team_goals when team_id=away_team_id then home_team_goals end) goal_against from Matches m join Teams t on t.team_id = m.home_team_id or t.team_id = m.away_team_id group by team_id) temp order by points desc, goal_diff desc, team_name
with CTE as (select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals=away_team_goals then 1 when home_team_goals>away_team_goals then 3 else 0 end as points from Matches union all select away_team_id, away_team_goals, home_team_goals, case when home_team_goals=away_team_goals then 1 when away_team_goals>home_team_goals then 3 else 0 end as points from matches ) select t.team_name, count(t.team_id) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for)-sum(goal_against) as goal_diff from cte c inner join teams t on c.team_id=t.team_id group by t.team_id order by points desc,goal_diff desc,team_name
with CTE1 as (select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_team_point, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as away_team_point from matches), CTE2 as (select home_team_id as team_id, home_team_goals as h_goals, home_team_point as points, away_team_goals as a_goals from CTE1 union all select away_team_id as team_id, away_team_goals as h_goals, away_team_point as points, home_team_goals as a_goals from CTE1) select t.team_name, count(c.team_id) as matches_played, sum(c.points) as points, sum(c.h_goals) as goal_for, sum(c.a_goals) as goal_against, sum(c.h_goals)- sum(c.a_goals) as goal_diff from teams t join CTE2 c on t.team_id = c.team_id group by 1 order by 3 desc, 6 desc, 1 asc
with CTE_points as ( Select *, CASE WHEN home_team_goals > away_team_goals then 3 WHEN home_team_goals = away_team_goals then 1 else 0 end AS home_team_points, CASE WHEN home_team_goals < away_team_goals then 3 WHEN home_team_goals = away_team_goals then 1 else 0 end AS away_team_points from Matches ), cte as ( Select id, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against from ( Select home_team_id as id, count(*) as matches_played, sum(home_team_points) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from CTE_points group by id UNION ALL Select away_team_id as id, count(*) as matches_played, sum(away_team_points) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from CTE_points group by id) t group by id ) Select t.team_name, c.matches_played, c.points, c.goal_for, c.goal_against, (c.goal_for - c.goal_against) as goal_diff from cte c inner join teams t on t.team_id = c.id order by points DESC, goal_diff DESC, team_name ASC
with Scores(team_id, points, goals_for, goals_against, goals_diff, matches) as ( select home_team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end, home_team_goals, away_team_goals, home_team_goals - away_team_goals, 1 from Matches union all select away_team_id, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end, away_team_goals, home_team_goals, away_team_goals - home_team_goals, 1 from Matches ) select t.team_name, sum(matches) matches_played, sum(points) points, sum(goals_for) goal_for, sum(goals_against) goal_against, sum(goals_diff) goal_diff from Teams t inner join Scores s on t.team_id = s.team_id group by t.team_id order by sum(points) desc, sum(goals_diff) desc, t.team_name
with a as ( select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_points, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as away_points from matches), b as ( select home_team_id as team_id, home_points as points, home_team_goals as goal_for, away_team_goals as goal_against from a union all select away_team_id as team_id, away_points as points, away_team_goals as goal_for, home_team_goals as goal_against from a), c as ( select t.team_name, b.points, b.goal_for, b.goal_against from teams t right join b on t.team_id = b.team_id) select team_name, count(team_name) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for)-sum(goal_against)) as goal_diff from c group by 1 order by 3 desc,6 desc,1 asc
with a as ( select home_team_id, away_team_id, home_team_goals, away_team_goals, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_team_points, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as away_team_points from matches) select t1.team_name, coalesce(count(*), 0) as matches_played, coalesce(sum(points), 0) as points, coalesce(sum(goal_for), 0) as goal_for, coalesce(sum(goal_against), 0) as goal_against, coalesce(sum(goal_for) - sum(goal_against), 0) as goal_diff from teams t1 join ( select home_team_id as team_id, home_team_points as points, home_team_goals as goal_for, away_team_goals as goal_against from a union all select away_team_id as team_id, away_team_points as points, away_team_goals as goal_for, home_team_goals as goal_against from a) t2 on t1.team_id = t2.team_id group by 1 order by sum(points) desc, sum(goal_for) - sum(goal_against) desc, team_name
with a as (select home_team_id team, case when home_team_goals >away_team_goals then 3 when home_team_goals =away_team_goals then 1 else 0 end pts from Matches union all select away_team_id team, case when home_team_goals <away_team_goals then 3 when home_team_goals =away_team_goals then 1 else 0 end pts from Matches ), b as (select team ,count(*)matches_played from (select home_team_id team from Matches union all select away_team_id team from Matches )s group by 1), c as (select team,sum(goal_for) goal_for,sum(goal_against) goal_against from (select home_team_id team ,sum(home_team_goals) goal_for , sum(away_team_goals) goal_against from Matches group by 1 union all select away_team_id team ,sum(away_team_goals) goal_for , sum(home_team_goals) goal_against from Matches group by 1) z group by 1) select t.team_name ,matches_played,sum(pts) points,goal_for,goal_against ,goal_for- goal_against goal_diff from a join b on a.team=b.team join c on a.team=c.team join Teams t on t.team_id= a.team group by 1 order by points desc, goal_diff desc ,1
with a as( select *, case when home_team_goals<away_team_goals then 0 when home_team_goals=away_team_goals then 1 else 3 end as 'home_score', case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end as 'away_score' from matches), b as( select home_team_id, home_score from a union all select away_team_id, away_score from a), c as( select home_team_id, count(home_team_id) as matches_played, sum(home_score) as points from b group by 1), points as ( select home_team_id, home_team_goals from matches union all select away_team_id, away_team_goals from matches), points_against as ( select home_team_id, away_team_goals from matches union all select away_team_id, home_team_goals from matches), goal_for as( select home_team_id, sum(home_team_goals) as goal_for from points group by 1), goal_against as( select home_team_id, sum(away_team_goals) as goal_against from points_against group by 1), temp1 as( select teams.team_name, c.matches_played, c.points, gf.goal_for, ga.goal_against from c join teams on c.home_team_id=teams.team_id join goal_for gf on c.home_team_id=gf.home_team_id join goal_against ga on c.home_team_id=ga.home_team_id) select *, goal_for-goal_against as goal_diff from temp1 order by points desc, goal_diff desc, team_name
with agg as ( select home_team_id as team_id, away_team_id as team_against, home_team_goals as goal, away_team_goals as goal_against from Matches union all select away_team_id as team_id, home_team_id as team_against, away_team_goals, home_team_goals from Matches ) select t.team_name, count(agg.team_id) as matches_played, sum(case when goal > goal_against then 3 when goal = goal_against then 1 else 0 end) as points, sum(goal) as goal_for, sum(goal_against) as goal_against, sum(goal) - sum(goal_against) as goal_diff from agg join Teams as t on t.team_id = agg.team_id group by 1 order by 3 desc, 6 desc, 1 asc
with base as( select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end home_score, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end away_score from matches ), unioned as( select home_team_id as team_id, home_team_goals as goals_for, away_team_goals as goals_against, home_score as points from base union all select away_team_id as team_id, away_team_goals as goals_for, home_team_goals as goals_against, away_score as points from base ) select *, goal_for - goal_against as goal_diff from( select team_name, count(*) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against from unioned u join teams t on u.team_id = t.team_id group by u.team_id ) sub order by points desc, goal_diff desc, team_name
with calc as ( select home_team_id as team_id, home_team_goals as goals, away_team_goals as against, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points from matches UNION ALL select away_team_id as team_id, away_team_goals as goals, home_team_goals as against, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end as points from matches ) select team_name, count(*) as matches_played, sum(points) as points, sum(goals) as goal_for, sum(against) as goal_against, sum(goals) - sum(against) as goal_diff from Teams t join calc on t.team_id = calc.team_id group by 1 order by points desc, goal_diff desc, team_name
with cte as ( SELECT team_name, count(team_id) as matches_played, SUM(CASE WHEN team_id=home_team_id AND home_team_goals>away_team_goals THEN 3 ELSE 0 END)+SUM(CASE WHEN team_id=home_team_id AND home_team_goals=away_team_goals THEN 1 ELSE 0 END)+SUM(CASE WHEN team_id=away_team_id AND away_team_goals>home_team_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=away_team_id AND away_team_goals=home_team_goals THEN 1 ELSE 0 END) as 'points', SUM(CASE WHEN team_id=away_team_id THEN away_team_goals WHEN team_id=home_team_id THEN home_team_goals ELSE 0 END) as goal_for, SUM(CASE WHEN team_id=away_team_id THEN home_team_goals WHEN team_id=home_team_id THEN away_team_goals ELSE 0 END) as goal_against FROM Matches m LEFT JOIN Teams t ON t.team_id=m.home_team_id OR t.team_id=m.away_team_id GROUP BY team_id) SELECT *, (goal_for-goal_against) as goal_diff FROM cte ORDER BY points DESC, goal_diff DESC, team_name ASC
with cte as ( select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end home_team_point, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end away_team_point from matches ), cte2 as ( select home_team_id firstteam, away_team_id secondteam, home_team_goals firstteamgoals, away_team_goals secondteamgoals, home_team_point firstteampoint, away_team_point secondteampoint from cte union all select away_team_id firstteam, home_team_id secondteam, away_team_goals firstteamgoals, home_team_goals secondteamgoals, away_team_point firstteampoint, home_team_point secondteampoint from cte ) select t.team_name team_name, count(ifnull(firstteam,0)) matches_played, sum(ifnull(firstteampoint,0)) points, sum(ifnull(firstteamgoals,1)) goal_for, sum(ifnull(secondteamgoals,0)) goal_against, sum(ifnull(firstteamgoals,0)) - sum(ifnull(secondteamgoals,0)) goal_diff from cte2 join Teams t on cte2.firstteam = t.team_id group by firstteam order by points desc, goal_diff desc, team_name
with cte as ( select T.team_name, T.team_id, sum(case when M.home_team_id = T.team_id then + 1 when M.away_team_id = T.team_id then +1 else + 0 end) as matches_played, sum(case when M.home_team_id = T.team_id then + M.home_team_goals when M.away_team_id = T.team_id then + M.away_team_goals else + 0 end) as goal_for, sum(case when M.home_team_id = T.team_id then + M.away_team_goals when M.away_team_id = T.team_id then + M.home_team_goals else + 0 end) as goal_against, sum(case when M.home_team_goals > M.away_team_goals and M.home_team_id = T.team_id then +3 when M.away_team_goals > M.home_team_goals and M.away_team_id = T.team_id then +3 when M.home_team_goals = M.away_team_goals then +1 else +0 end) as points from Teams T join Matches M on T.team_id = M.home_team_id or T.team_id = M.away_team_id group by 1, 2) select team_name, matches_played, points, goal_for, goal_against, (goal_for - goal_against) as goal_diff from cte group by 1 order by 3 desc, 6 desc, 1 asc
with cte as ( select home_team_id , away_team_id , home_team_goals , away_team_goals , case when home_team_goals<away_team_goals then 0 when home_team_goals=away_team_goals then 1 when home_team_goals>away_team_goals then 3 end as home_team_points , case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 when home_team_goals>away_team_goals then 0 end as away_team_points from Matches), cte2 as ( select home_team_id as team_id , home_team_goals as team_goals , away_team_goals as away_goals , home_team_points as team_points from cte union all select away_team_id as team_id , away_team_goals as team_goals , home_team_goals as away_goals , away_team_points as team_points from cte) select t.team_name , count(*) as matches_played , sum(c.team_points) as points , sum(c.team_goals) as goal_for , sum(c.away_goals) as goal_against , sum(c.team_goals)-sum(c.away_goals) as goal_diff from cte2 c inner join Teams t on c.team_id=t.team_id group by 1 order by 3 desc, 6 desc, 1
with cte as ( select home_team_id as 'team_id', home_team_goals 'goals', case when home_team_goals > away_team_goals then 'win' when home_team_goals = away_team_goals then 'tie' else 'loss' end as 'result', home_team_goals as 'goals_for', away_team_goals as 'goals_against' from matches union all select away_team_id as 'team_id', away_team_goals 'goals', case when away_team_goals > home_team_goals then'win' when away_team_goals = home_team_goals then 'tie' else 'loss' end as 'result', away_team_goals as 'goals_for', home_team_goals as 'goals_against' from matches ) select t.team_name, count(c1.team_id) as 'matches_played', sum(case when result='win' then 3 when result='tie' then 1 else 0 end) as 'points', sum(goals_for) as 'goal_for', sum(goals_against) 'goal_against', sum(goals_for)-sum(goals_against) as 'goal_diff' from cte c1 inner join teams t on t.team_id = c1.team_id group by t.team_name order by points desc, goal_diff desc, team_name
with cte as ( select home_team_id as team_id , count( away_team_id) as matches , sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points , sum(home_team_goals) as goal_for , sum(away_team_goals) as goal_against from matches group by 1 union select away_team_id as team_id , count(home_team_id) as matches , sum(case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points , sum(away_team_goals) as goal_for , sum(home_team_goals) as goal_against from matches group by 1 ) select t.team_name , sum(matches) as matches_played , sum(points) as points , sum(goal_for) as goal_for , sum(goal_against) as goal_against , sum(goal_for) - sum(goal_against) as goal_diff from teams t left join cte on t.team_id = cte.team_id group by 1 having matches_played > 0 order by points desc, goal_diff desc, team_name
with cte as ( select home_team_id as team_id , count(*) as num_match , sum(if(home_team_goals>away_team_goals, 3, if(home_team_goals=away_team_goals, 1, 0))) as points , sum(home_team_goals) as goal_for , sum(away_team_goals) as goal_against , sum(home_team_goals) - sum(away_team_goals) as goal_diff from matches group by 1 union all select away_team_id , count(*) as num_match , sum(if(away_team_goals>home_team_goals, 3, if(away_team_goals=home_team_goals, 1, 0))) as points , sum(away_team_goals) as goal_for , sum(home_team_goals) as goal_against , sum(away_team_goals) - sum(home_team_goals) as goal_diff from matches group by 1 ) select team_name , sum(num_match) as matches_played , sum(points) as points , sum(goal_for) as goal_for , sum(goal_against) as goal_against , sum(goal_diff) as goal_diff from cte join teams t on t.team_id=cte.team_id group by 1 order by points desc, goal_diff desc, team_name asc
with cte as ( select home_team_id as team_id, home_team_goals as goals, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches union all select away_team_id as team_id, away_team_goals as goals, home_team_goals as goal_against, case when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end as points from matches ) select team_name, count(*) as matches_played, sum(points) as points, sum(goals) as goal_for, sum(goal_against) as goal_against, sum(goals) - sum(goal_against) as goal_diff from cte left join teams using (team_id) group by 1 order by 3 desc, 6 desc, 1
with cte as ( select home_team_id as tid, home_team_goals as mg, away_team_goals as gg, case when home_team_goals = away_team_goals then 1 when home_team_goals > away_team_goals then 3 else 0 end as pts from matches union all select away_team_id as tid, away_team_goals as mg, home_team_goals as gg, case when home_team_goals = away_team_goals then 1 when home_team_goals < away_team_goals then 3 else 0 end as pts from matches ), cte2 as ( Select t.team_name, c.* from Teams t right join cte c on T.team_id = c.tid ) select team_name, count(*) as matches_played, sum(pts) as points, sum(mg)as goal_for, sum(gg) as goal_against, sum(mg)-sum(gg) as goal_diff from cte2 group by team_name order by 3 desc, 6 desc, 1
with cte as ( select home_team_id team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end points, home_team_goals goal_for, away_team_goals goal_against from matches union all select away_team_id team_id, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end points, away_team_goals goal_for, home_team_goals goal_against from matches ) select team_name, count(*) matches_played, sum(points) points, sum(goal_for) goal_for, sum(goal_against) goal_against, sum(goal_for) - sum(goal_against) goal_diff from cte join teams using(team_id) group by team_id order by points desc, goal_diff desc, team_name
with cte as ( select home_team_id team_id, home_team_goals team_goals, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from Matches union all select away_team_id, away_team_goals, home_team_goals as goal_against, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as points from Matches ) select team_name, count(*) as matches_played, sum(points) as points, sum(team_goals) as goal_for, sum(goal_against) as goal_against, sum(team_goals) - sum(goal_against) as goal_diff from cte c1 join Teams t on c1.team_id = t.team_id group by c1.team_id order by points desc, goal_diff desc, team_name asc
with cte as ( select home_team_id, away_team_id, home_team_goals, away_team_goals, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as score from Matches union all select away_team_id as home_team_id, home_team_id as away_team_id, away_team_goals as home_team_goals, home_team_goals as away_team_goals, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as score from Matches ) select team_name, count(*) as matches_played, sum(score) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals) - sum(away_team_goals) as goal_diff from cte left join Teams on cte.home_team_id = Teams.team_id group by team_name order by points desc, goal_diff desc, team_name asc
with cte as ( select home_team_id,away_team_id,home_team_goals,away_team_goals from Matches UNION ALL select away_team_id as home_team_id,home_team_id as away_team_id, away_team_goals as home_team_goals,home_team_goals as away_team_goals from Matches ) select team_name,count(home_team_id) as matches_played, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 when home_team_goals=away_team_goals then 1 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)-sum(away_team_goals) as goal_diff from Teams as A inner join cte as B on A.team_id=B.home_team_id group by 1 order by 3 desc,6 desc,1
with cte as ( select t.team_name, count(*) as matches_played, SUM(CASE WHEN t.team_id = m.home_team_id AND home_team_goals > away_team_goals THEN 3 WHEN t.team_id = m.home_team_id AND home_team_goals = away_team_goals THEN 1 WHEN t.team_id = m.away_team_id AND home_team_goals = away_team_goals THEN 1 WHEN t.team_id = m.away_team_id AND home_team_goals < away_team_goals THEN 3 ELSE 0 END) as points, sum(case when t.team_id = m.home_team_id then m.home_team_goals else m.away_team_goals end) as goal_for, sum(case when t.team_id = m.home_team_id then m.away_team_goals else m.home_team_goals end) as goal_against from Teams t join Matches m on t.team_id = m.home_team_id or t.team_id = m.away_team_id group by t.team_id ) select *, goal_for - goal_against as goal_diff from cte group by 1 order by points desc, goal_diff desc, team_name
with cte as ( select team_name, sum(case when team_id = home_team_id then 1 when team_id = away_team_id then 1 else 0 end) as matches_played, sum(case when team_id =home_team_id and home_team_goals > away_team_goals then 3 when team_id =home_team_id and home_team_goals < away_team_goals then 0 when team_id =home_team_id and home_team_goals = away_team_goals then 1 when team_id =away_team_id and away_team_goals > home_team_goals then 3 when team_id =away_team_id and away_team_goals < home_team_goals then 0 when team_id =away_team_id and away_team_goals = home_team_goals then 1 end) as points, sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals else 0 end ) as goal_for , sum(case when team_id = home_team_id then away_team_goals when team_id = away_team_id then home_team_goals else 0 end ) as goal_against from Teams a join Matches b group by team_name ) select team_name, matches_played, points, goal_for,goal_against, (goal_for - goal_against) as goal_diff from cte order by points desc , (goal_for - goal_against) desc, team_name
with cte as (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_score, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_score FROM Matches) , cte2 as (SELECT home_team_id as team_id, home_score as score, home_team_goals as goal_for, away_team_goals as goal_against FROM cte UNION ALL SELECT away_team_id as team_id, away_score as score, away_team_goals as goal_for, home_team_goals as goal_against FROM cte) SELECT b.team_name, COUNT(b.team_name) as matches_played, SUM(a.score) as points, SUM(a.goal_for) as goal_for, SUM(a.goal_against) as goal_against, SUM(a.goal_for) - SUM(a.goal_against) as goal_diff FROM cte2 a JOIN Teams b ON b.team_id = a.team_id GROUP BY b.team_name ORDER BY points DESC, goal_diff DESC, b.team_name
with cte as (SELECT *, CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS home_score, CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END AS away_score FROM Matches), cte2 as (SELECT home_team_id as team_id, home_score as score, home_team_goals as goal_for, away_team_goals as goal_against FROM cte UNION ALL SELECT away_team_id as team_id, away_score as score, away_team_goals as goal_for, home_team_goals as goal_against FROM cte) SELECT b.team_name, COUNT(b.team_name) as matches_played, SUM(a.score) as points, SUM(a.goal_for) as goal_for, SUM(a.goal_against) as goal_against, SUM(a.goal_for) - SUM(a.goal_against) as goal_diff FROM cte2 a JOIN Teams b ON b.team_id = a.team_id GROUP BY b.team_name ORDER BY points DESC, goal_diff DESC, b.team_name
with cte as (select *, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) homepoint, (case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) awaypoint from matches), cte2 as (select home_team_id team_id, home_team_goals sel, away_team_goals opponent, homepoint points from cte union all select away_team_id team_id, away_team_goals, home_team_goals, awaypoint from cte ) select t.team_name, count(t2.team_id) matches_played , sum(t2.points) points, sum(t2.sel) goal_for, sum(t2.opponent) goal_against, sum(t2.sel)-sum(t2.opponent) goal_diff from teams t join cte2 t2 using(team_id) group by 1 order by 3 desc, 6 desc, 1
with cte as (select *, (case when home_team_goals> away_team_goals then 3 when home_team_goals< away_team_goals then 0 else 1 end) as home_score, (case when home_team_goals< away_team_goals then 3 when home_team_goals> away_team_goals then 0 else 1 end) as away_score from matches ), cte2 as (select home_team_id, home_team_goals, home_score, away_team_goals from cte union all select away_team_id, away_team_goals, away_score, home_team_goals from cte ) select t.team_name, count(c.home_team_goals) as matches_played, sum(c.home_score) as points, sum(c.home_team_goals) as goal_for, sum(away_team_goals) as goal_against, (sum(c.home_team_goals) - sum(away_team_goals)) as goal_diff from cte2 c join teams t on t.team_id = c.home_team_id group by 1 order by points desc, goal_diff desc, team_name asc
with cte as (select *, (case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as home_team_pts, (case when away_team_goals>home_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as away_team_pts from matches), cte1 as ( select home_team_id as team_id,count(*) as matches,sum(home_team_pts) as Pts, sum(home_team_goals) as for_goals, sum(away_team_goals) as against_goals from cte group by home_team_id union all select away_team_id,count(*) as matches,sum(away_team_pts) as Pts, sum(away_team_goals) as for_goals, sum(home_team_goals) as against_goals from cte group by away_team_id ) select team_name,sum(matches) as matches_played,sum(pts) as points, sum(for_goals) as goal_for, sum(against_goals) as goal_against, sum(for_goals)-sum(against_goals) as goal_diff from cte1 a join teams b on a.team_id=b.team_id group by a.team_id order by points desc,goal_diff desc,team_name
with cte as (select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_score, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as away_score from matches), cte2 as ( select home_team_id as team_id, home_score as score, home_team_goals as goal_for, away_team_goals as goal_against FROM cte union all SELECT away_team_id as team_id, away_score as score, away_team_goals as goal_for, home_team_goals as goal_against FROM cte) SELECT b.team_name, COUNT(b.team_name) as matches_played, SUM(a.score) as points, SUM(a.goal_for) as goal_for, SUM(a.goal_against) as goal_against, SUM(a.goal_for) - SUM(a.goal_against) as goal_diff FROM cte2 a JOIN Teams b ON b.team_id = a.team_id GROUP BY b.team_name ORDER BY points DESC, goal_diff DESC, b.team_name
with cte as (select home_team_id as home_id, away_team_id as cpn_id, home_team_goals as home_goals, away_team_goals as cpn_goals from matches union all select away_team_id as home_id, home_team_id as cpn_id, away_team_goals as home_goals, home_team_goals as cpn_goals from matches) , tab as (select a.team_name, a.team_id, b.cpn_id, b.home_goals, b.cpn_goals, case when home_goals > cpn_goals then 3 when home_goals < cpn_goals then 0 else 1 end as point from teams a, cte b where a.team_id = b.home_id) select team_name, count(team_name) as matches_played, sum(point) as points, sum(home_goals) as goal_for, sum(cpn_goals) as goal_against, sum(home_goals-cpn_goals) as goal_diff from tab group by team_id order by sum(point) desc, sum(home_goals)-sum(cpn_goals) desc, team_name
with cte as (select home_team_id as team, home_team_goals as goals, away_team_goals as away, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches union all select away_team_id as team, away_team_goals as goals, home_team_goals as away, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches) select team_name, count(team) as matches_played, sum(points) as points, sum(goals) as goal_for, sum(away) as goal_against , (sum(goals) - sum(away)) as goal_diff from teams inner join cte on teams.team_id = cte.team group by team order by points desc, goal_diff desc, team_name
with cte as (select home_team_id as team_id, home_team_goals as goals, away_team_goals as oppgoals from Matches union all select away_team_id as team_id, away_team_goals as goals, home_team_goals as oppgoals from Matches) select team_name, count(*) as matches_played, sum(case when goals>oppgoals then 3 when goals<oppgoals then 0 else 1 end) as points, sum(goals) as goal_for, sum(oppgoals) as goal_against, sum(goals) - sum(oppgoals) as goal_diff from cte join Teams t on t.team_id = cte.team_id group by 1 order by points desc, goal_diff desc, team_name
with cte as (select home_team_id as team_id,case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end as points,home_team_goals,away_team_goals from Matches union all select away_team_id as team_id,case when home_team_goals<away_team_goals then 3 when home_team_goals>away_team_goals then 0 else 1 end as points,away_team_goals ,home_team_goals from Matches ) select team_name,count(team_name) as matches_played, sum(points)as points, sum(home_team_goals)as goal_for,sum(away_team_goals)as goal_against, (sum(home_team_goals)-sum(away_team_goals)) as goal_diff from cte c left join Teams using(team_id) group by 1 order by points desc,goal_diff desc,team_name asc
with cte as (select home_team_id, away_team_id, (case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end)as home_goals, (case when home_team_goals>away_team_goals then 0 when home_team_goals<away_team_goals then 3 else 1 end)as away_goals from Matches) select t.team_name, t1.matches_played, t2.points, t3.goal_for, t4.goal_against, (goal_for-goal_against) as goal_diff from Teams as t join (select id, count(*)as matches_played from (select home_team_id as id from Matches union all select away_team_id as id from Matches)t group by id)t1 on t.team_id=t1.id join (select id, sum(goals) as points from (select home_team_id as id, home_goals as goals from cte union all select away_team_id as id, away_goals as goals from cte)t group by id)t2 on t.team_id=t2.id join (select id, sum(goal_for) as goal_for from (select home_team_id as id, home_team_goals as goal_for from Matches union all select away_team_id as id, away_team_goals as goal_for from Matches)a group by id)t3 on t.team_id=t3.id join (select id, sum(goal_against) as goal_against from (select home_team_id as id, away_team_goals as goal_against from Matches union all select away_team_id as id, home_team_goals as goal_against from Matches)b group by id)t4 on t.team_id=t4.id order by points desc, goal_diff desc, team_name
with cte as (select team_name, count(case when team_id=home_team_id or team_id=away_team_id then 1 end) as matches_played, sum(case when team_id=home_team_id and home_team_goals > away_team_goals then 3 when team_id=home_team_id and home_team_goals = away_team_goals then 1 when team_id=away_team_id and away_team_goals > home_team_goals then 3 when team_id=away_team_id and away_team_goals = home_team_goals then 1 else 0 end) as points, sum(case when team_id=home_team_id then home_team_goals when team_id=away_team_id then away_team_goals end) as goal_for, sum(case when team_id=home_team_id then away_team_goals when team_id=away_team_id then home_team_goals end) as goal_against from teams t join matches m on t.team_id = m.home_team_id or t.team_id = m.away_team_id group by 1) select team_name, matches_played, points, goal_for, goal_against, (goal_for - goal_against) as goal_diff from cte order by 3 desc,6 desc, 1
with cte as( SELECT t.team_name, COUNT(DISTINCT m.home_team_id, m.away_team_id) as matches_played, SUM(CASE WHEN m.home_team_id = t.team_id and m.home_team_goals > m.away_team_goals THEN 3 WHEN m.home_team_id = t.team_id and m.home_team_goals = m.away_team_goals THEN 1 WHEN m.away_team_id = t.team_id and m.home_team_goals = m.away_team_goals THEN 1 WHEN m.away_team_id = t.team_id and m.home_team_goals < m.away_team_goals THEN 3 ELSE 0 END) as points, SUM(CASE WHEN t.team_id = m.home_team_id THEN home_team_goals ELSE away_team_goals END) as goal_for, SUM(CASE WHEN t.team_id = m.home_team_id THEN away_team_goals ELSE home_team_goals END) as goal_against FROM teams as t JOIN matches as m ON t.team_id=m.home_team_id or t.team_id=m.away_team_id GROUP BY 1 ) SELECT *, goal_for - goal_against as goal_diff FROM cte ORDER BY points DESC, goal_diff DESC, team_name ASC
with cte as( select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_team_points, case when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end as away_team_points from matches), allteam as( select home_team_id as team_id, home_team_goals as team_goals, away_team_goals as against_goals, home_team_points as team_points from cte union all select away_team_id, away_team_goals, home_team_goals, away_team_points from cte) select team_name, count(allteam.team_id) as matches_played, sum(team_points) as points, sum(team_goals) as goal_for, sum(against_goals) as goal_against, sum(team_goals) - sum(against_goals) as goal_diff from allteam join teams on allteam.team_id = teams.team_id group by allteam.team_id order by points desc, goal_diff desc, team_name asc
with cte as( select home_team_id as team_id, (case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, home_team_goals as goal_for, away_team_goals as goal_against from Matches union all select away_team_id as team_id, (case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, away_team_goals as goal_for, home_team_goals as goal_against from Matches ) select team_name, count(cte.team_id) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for)-sum(goal_against)) as goal_diff from cte left join Teams as t on cte.team_id = t.team_id group by cte.team_id order by points desc, goal_diff desc, team_name
with cte as(select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points from Matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, (case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points from Matches ) select team_name, count(cte.team_id) as matches_played , sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from cte left join Teams on cte.team_id = Teams.team_id group by cte.team_id order by points desc, goal_diff desc, team_name
with cte1 as ( select home_team_id , home_team_goals ,away_team_goals , case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 when home_team_goals < away_team_goals then 0 end as home_points from matches union all select away_team_id , away_team_goals ,home_team_goals, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 when home_team_goals > away_team_goals then 0 end as away_points from matches ) select a.team_name, count(home_team_id) as matches_played, sum(home_points) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals) - sum(away_team_goals) as goal_diff from teams a inner join cte1 b on a.team_id=b.home_team_id group by a.team_name order by 3 desc,6 desc,1
with cte1 as ( select home_team_id as team_id, count(home_team_goals) as home_matches, sum(case when home_team_goals=away_team_goals then 1 else case when home_team_goals<away_team_goals then 0 else case when home_team_goals>away_team_goals then 3 end end end) as points, sum(home_team_goals) as home_goals, sum(away_team_goals) as away_goals from Matches group by home_team_id ), cte2 as ( select away_team_id as team_id, count(away_team_goals) as away_matches, sum(case when home_team_goals=away_team_goals then 1 else case when home_team_goals<away_team_goals then 3 else case when home_team_goals>away_team_goals then 0 end end end) as points, sum(home_team_goals) as home_goals, sum(away_team_goals) as away_goals from Matches group by away_team_id ), cte3 as ( select t.team_name, ((case when home_matches is null then 0 else home_matches end)+(case when away_matches is null then 0 else away_matches end)) as matches_played, ((case when c1.points is null then 0 else c1.points end)+(case when c2.points is null then 0 else c2.points end)) as points, ((case when c1.home_goals is null then 0 else c1.home_goals end)+(case when c2.away_goals is null then 0 else c2.away_goals end)) as goal_for, ((case when c1.away_goals is null then 0 else c1.away_goals end)+(case when c2.home_goals is null then 0 else c2.home_goals end)) as goal_against from Teams t left join cte1 c1 on t.team_id=c1.team_id left join cte2 c2 on t.team_id=c2.team_id ), cte4 as ( select team_name, matches_played, points, goal_for, goal_against, (goal_for-goal_against) as goal_diff from cte3 ) select * from cte4 where matches_played<>0 order by points desc, goal_diff desc, team_name asc
with cte1 as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against from matches ), cte2 as ( select team_id,count(*) as matches_played, sum(case when goal_for > goal_against then 3 when goal_for < goal_against then 0 else 1 end) as points,sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from cte1 group by team_id ) select b.team_name,a.matches_played,a.points,a.goal_for,a.goal_against,a.goal_diff from cte2 a inner join Teams b on a.team_id=b.team_id order by a.points desc, goal_diff desc,b.team_name
with cte1 as ( select home_team_id as team_id, home_team_goals as goals_for, away_team_goals as goals_against, (home_team_goals-away_team_goals) as goal_diff, case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 when home_team_goals=away_team_goals then 1 end as points from matches union all select away_team_id as team_id, away_team_goals as goals_for, home_team_goals as goals_against, (away_team_goals-home_team_goals) as goal_diff, case when home_team_goals<away_team_goals then 3 when home_team_goals>away_team_goals then 0 when home_team_goals=away_team_goals then 1 end as points from matches) select team_name,count(team_name) as matches_played,sum(points) as points,sum(goals_for) as goal_for,sum(goals_against) as goal_against,sum(goal_diff) as goal_diff from cte1 c left join teams t on c.team_id = t.team_id group by team_name order by points desc, goal_diff desc, team_name asc
with cte1 as ( select home_team_id as team_id, sum(home_team_goals) as goals_for, sum(away_team_goals) as goal_against, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end) as points, count(home_team_id) as matches_played from Matches group by home_team_id ) , cte2 as ( select away_team_id as team_id, sum(away_team_goals) as goals_for, sum(home_team_goals) as goal_against, sum(case when away_team_goals>home_team_goals then 3 when away_team_goals<home_team_goals then 0 else 1 end) as points, count(away_team_id) as matches_played from Matches group by away_team_id ) select T.team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goal_against) as goal_against, sum(goals_for) - sum(goal_against) as goal_diff from (select * from cte1 union select * from cte2)sub join Teams T on sub.team_id=T.team_id group by team_name order by sum(points) desc, (sum(goals_for) - sum(goal_against)) desc, team_name asc
with cte1 as ( select home_team_id as tn, count(home_team_id) as mp, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as pt, sum(home_team_goals) as gf, sum(away_team_goals) as ga from matches group by home_team_id union all select away_team_id as tn, count(away_team_id) as mp, sum(case when away_team_goals > home_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as pt, sum(away_team_goals) as gf, sum(home_team_goals) as ga from matches group by away_team_id) select t.team_name as team_name, sum(mp) as matches_played, sum(pt) as points, sum(gf) as goal_for, sum(ga) as goal_against, sum(gf-ga) as goal_diff from cte1 left join teams t on cte1.tn=t.team_id group by t.team_name order by points desc, 6 desc, team_name
with cte1 as (select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as points from matches), cte2 as( select team_id, count(*) as matches_played , sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from cte1 group by team_id ) select teams.team_name, matches_played, points, goal_for, goal_against,goal_diff from teams inner join cte2 on teams.team_id = cte2.team_id order by points desc, goal_diff desc, team_name
with cte1 as (select team, sum(matches_played) matches_played from (select home_team_id as team,count(home_team_id) as matches_played from matches group by 1 union all select away_team_id as team,count(away_team_id) as matches_played from matches group by 1)c group by 1), cte2 as (select team, sum(points) as points from (select home_team_id as team, sum(case when home_team_goals<away_team_goals then 0 when home_team_goals>away_team_goals then 3 else 1 end ) as points from matches group by 1 union all select away_team_id as team, sum(case when home_team_goals<away_team_goals then 3 when home_team_goals>away_team_goals then 0 else 1 end ) as points from matches group by 1)c group by 1), cte3 as (select team, sum(goals_for) goal_for,sum(goals_against) goal_against from (select home_team_id team, home_team_goals as goals_for, away_team_goals as goals_against from matches union all select away_team_id team, away_team_goals as goals_for, home_team_goals as goals_against from matches)c group by 1) select team_name, matches_played,points,goal_for,goal_against,(goal_for-goal_against) as goal_diff from teams inner join cte1 on teams.team_id=cte1.team inner join cte2 on teams.team_id=cte2.team inner join cte3 on teams.team_id=cte3.team order by points desc,goal_diff desc, team_name
with cte1 as (select team, sum(matches_played) matches_played from (select home_team_id as team,count(home_team_id) as matches_played from matches group by 1 union all select away_team_id as team,count(away_team_id) as matches_played from matches group by 1)c group by 1), cte2 as (select team, sum(points) as points from (select home_team_id as team, sum(case when home_team_goals<away_team_goals then 0 when home_team_goals>away_team_goals then 3 else 1 end ) as points from matches group by 1 union all select away_team_id as team, sum(case when home_team_goals<away_team_goals then 3 when home_team_goals>away_team_goals then 0 else 1 end ) as points from matches group by 1)c group by 1), cte3 as (select team, sum(goals_for) goal_for,sum(goals_against) goal_against from (select home_team_id team, home_team_goals as goals_for, away_team_goals as goals_against from matches union all select away_team_id team, away_team_goals as goals_for, home_team_goals as goals_against from matches)c group by 1) select team_name, matches_played,points,goal_for,goal_against,(goal_for-goal_against) as goal_diff from teams join cte1 on teams.team_id=cte1.team join cte2 on teams.team_id=cte2.team join cte3 on teams.team_id=cte3.team order by points desc,goal_diff desc, team_name
with cte1 as (select team_name, (sum(case when team_id = home_team_id then 1 else 0 end)+ sum(case when team_id = away_team_id then 1 else 0 end)) as matches_played , (sum(case when team_id = home_team_id and home_team_goals > away_team_goals then 3 else 0 end)+ sum(case when team_id = home_team_id and home_team_goals = away_team_goals then 1 else 0 end)+ sum(case when team_id = away_team_id and away_team_goals > home_team_goals then 3 else 0 end)+ sum(case when team_id = away_team_id and away_team_goals = home_team_goals then 1 else 0 end)) as points, (sum(case when team_id = home_team_id then home_team_goals else 0 end)+ sum(case when team_id = away_team_id then away_team_goals else 0 end)) as goal_for, (sum(case when team_id = home_team_id then away_team_goals else 0 end)+ sum(case when team_id = away_team_id then home_team_goals else 0 end)) as goal_against from teams t left join matches m on t.team_id = m.home_team_id or t.team_id = away_team_id group by 1) select *, (goal_for-goal_against) as goal_diff from cte1 where matches_played != 0 order by 3 desc, 6 desc, 1
with cte1 as( select home_team_id team_id, sum(home_team_goals) goal_for, sum(away_team_goals) goal_against from matches group by home_team_id union all select away_team_id team_id, sum(away_team_goals) goal_for, sum(home_team_goals) goal_against from matches group by away_team_id ), cte2 as ( select team_id, sum(goal_for) goal_for, sum(goal_against) goal_against from cte1 group by team_id ), cte3 as ( select team_id, count(team_id) matches_played from (select home_team_id team_id from matches union all select away_team_id team_id from matches ) r1 group by team_id ), cte4 as ( select home_team_id team_id, (case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) points from matches union all select away_team_id team_id, (case when away_team_goals>home_team_goals then 3 when away_team_goals=home_team_goals then 1 else 0 end) points from matches ), cte5 as ( select team_id, sum(points) points from cte4 group by team_id ) select team_name, matches_played, points, goal_for, goal_against, goal_for-goal_against goal_diff from teams natural join cte2 natural join cte3 natural join cte5 order by 3 DESC, 6 DESC, 1
with cte_allteam as ( select home_team_id plyr1, away_team_id plyr2, home_team_goals plyr1goals, away_team_goals plyr2goals from matches union all select away_team_id plyr1, home_team_id plyr2, away_team_goals plyr1goals, home_team_goals plyr2goals from matches ) select team_name, count(team_name) matches_played, sum( case when plyr1goals > plyr2goals then 3 when plyr1goals < plyr2goals then 0 else 1 end ) points, sum(plyr1goals) goal_for, sum(plyr2goals) goal_against, sum(plyr1goals)-sum(plyr2goals) goal_diff from cte_allteam ca join Teams t on ca.plyr1 = t.team_id group by team_name order by points desc, goal_diff desc, team_name
with cte_allteam as ( select home_team_id plyr1, away_team_id plyr2, home_team_goals plyr1goals, away_team_goals plyr2goals from matches union all select away_team_id plyr1, home_team_id plyr2, away_team_goals plyr1goals, home_team_goals plyr2goals from matches ), cte_score as ( select *, case when plyr1goals>plyr2goals then 3 when plyr1goals < plyr2goals then 0 else 1 end score from cte_allteam ) select team_name, count(team_name) matches_played, sum(score) points, sum(plyr1goals) goal_for, sum(plyr2goals) goal_against, sum(plyr1goals)-sum(plyr2goals) goal_diff from cte_score cs join Teams t on cs.plyr1 = t.team_id group by team_name order by points desc, goal_diff desc, team_name
with cte_points as ( select home_team_id, away_team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 when home_team_goals = away_team_goals then 1 end as home_team_points, case when away_team_goals > home_team_goals then 3 when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 end as away_team_points, home_team_goals, away_team_goals from matches ), cte_unionpoints as ( select Id, count(Id) as matches_played, sum(points) as points,sum(goals) as goal_for from (select home_team_id as Id,home_team_points as points,home_team_goals as goals from cte_points union all select away_team_id,away_team_points,away_team_goals from cte_points)x group by ID ), cte_goalsagainst as ( select Id, sum(goals) as goal_against from (select home_team_id as Id,away_team_goals as goals from cte_points union all select away_team_id,home_team_goals from cte_points)x group by Id ) select t.team_name,matches_played,points, goal_for,goal_against, (goal_for-goal_against) as goal_diff from teams t join cte_unionpoints p on t.team_id = p.ID join cte_goalsagainst g on g.Id = t.team_id order by points desc, goal_diff desc, team_name
with expanded_matches as ( ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches ) UNION ALL ( select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, case when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end as points from matches ) ) select t.team_name, count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from expanded_matches m left join Teams t on m.team_id = t.team_id group by m.team_id, t.team_name order by 3 desc, 6 desc, 1 asc
with final as ( with cte as ( Select t.team_id as 'id_first',t.team_name,m.* from teams t inner join matches m on t.team_id = m.home_team_id or t.team_id = m.away_team_id ) Select *, case when id_first = home_team_id then home_team_goals when id_first = away_team_id then away_team_goals end as updated_for_goals, case when id_first = home_team_id then away_team_goals when id_first = away_team_id then home_team_goals end as updated_against_goals, case when id_first = home_team_id and home_team_goals > away_team_goals then 3 when id_first = home_team_id and home_team_goals < away_team_goals then 0 when id_first = away_team_id and home_team_goals < away_team_goals then 3 when id_first = away_team_id and home_team_goals > away_team_goals then 0 else 1 end as updated_points from cte ) Select team_name, count(team_name) as 'matches_played',sum(updated_points) as 'points', sum(updated_for_goals) as 'goal_for',sum(updated_against_goals) as'goal_against',sum(updated_for_goals) - sum(updated_against_goals) as 'goal_diff' from final group by team_name order by points desc ,sum(updated_for_goals) - sum(updated_against_goals) desc,team_name
with goal_for as( select team_id, sum(score) as goal_for, count(team_id) as matches_played from( select home_team_id as team_id, home_team_goals as score from matches union all select away_team_id as team_id, away_team_goals as score from matches) as a group by team_id), against as( select team_id, sum(score) as goal_against from( select home_team_id as team_id, away_team_goals as score from matches union all select away_team_id as team_id, home_team_goals as score from matches) as a group by team_id), points as( select team_id, sum(points) as points from( select home_team_id as team_id, case when home_team_goals > away_team_goals then '3' when home_team_goals < away_team_goals then '0' when home_team_goals = away_team_goals then '1' else null end as points from matches union all select away_team_id as team_id, case when away_team_goals > home_team_goals then '3' when away_team_goals < home_team_goals then '0' when away_team_goals = away_team_goals then '1' else null end as points from matches) as a group by team_id) select t.team_name, matches_played, points, goal_for, goal_against, (goal_for-goal_against) as goal_diff from teams as t join goal_for as gf on t.team_id = gf.team_id join against as ga on t.team_id = ga.team_id join points as p on t.team_id = p.team_id order by points desc, goal_diff desc, team_name
with goalfor as ( select home_team_id, sum(goals) as goal_for,sum(game) as game from ( select home_team_id, sum(home_team_goals ) as goals ,count(*) as game from matches group by home_team_id union all select away_team_id , sum(away_team_goals ),count(*) as game from matches group by away_team_id)k group by home_team_id ), goalagainst as( select home_team_id, sum(goals) as goal_against, sum(game) from ( select home_team_id, sum(away_team_goals ) as goals,count(*) as game from matches group by home_team_id union all select away_team_id , sum(home_team_goals ),count(*) as game from matches group by away_team_id)k group by home_team_id ), point as ( select home_team_id , sum(points) as points from ( select home_team_id , case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points from matches union all select away_team_id, case when away_team_goals > home_team_goals then 3 when away_team_goals < home_team_goals then 0 else 1 end as points from matches)l group by home_team_id ) select Teams.team_name,goalfor.game as matches_played , point.points, goalfor.goal_for , goalagainst.goal_against, goalfor.goal_for -goalagainst.goal_against as goal_diff from Teams join goalfor on Teams.team_id = goalfor.home_team_id join point on point.home_team_id = goalfor.home_team_id join goalagainst on goalagainst.home_team_id = point.home_team_id order by points desc, goal_diff desc, team_name asc
with h as ( select home_team_id, count(*) as matches_played, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from Matches group by home_team_id ), a as ( select away_team_id, count(*) as matches_played, sum(case when away_team_goals > home_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from Matches group by away_team_id ) select t.team_name, coalesce(h.matches_played, 0) + coalesce(a.matches_played, 0) as matches_played, coalesce(h.points, 0) + coalesce(a.points, 0) as points, coalesce(h.goal_for, 0) + coalesce(a.goal_for, 0) as goal_for, coalesce(h.goal_against, 0) + coalesce(a.goal_against, 0) as goal_against, coalesce(h.goal_for, 0) + coalesce(a.goal_for, 0) - coalesce(h.goal_against, 0) - coalesce(a.goal_against, 0) as goal_diff from Teams t left join h on t.team_id = h.home_team_id left join a on t.team_id = a.away_team_id where h.home_team_id is not null or a.away_team_id is not null order by points desc, goal_diff desc, team_name asc
with home as ( select home_team_id, count(home_team_id) as mp, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from Matches group by home_team_id union all select away_team_id, count(away_team_id) as mp, sum(case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from Matches group by away_team_id) select Teams.team_name, sum(mp) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from home join Teams on home.home_team_id = Teams.team_id group by home_team_id order by points desc, goal_diff desc, Teams.team_name
with home as( select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches ), against as( select *, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches ) select team_name, sum(matches) as matches_played, sum(point) as points, sum(goal) as goal_for, sum(against) as goal_against, sum(goal) - sum(against) as goal_diff from( select home_team_id as team_id, count(*) as matches, sum(points) as point, sum(home_team_goals) as goal, sum(away_team_goals) as against from home group by home_team_id UNION ( select away_team_id as team_id, count(*) as matches, sum(points) as point, sum(away_team_goals) as goal, sum(home_team_goals) as against from against group by away_team_id ) ) t inner join Teams on t.team_id = Teams.team_id group by team_name order by points DESC , goal_diff DESC, team_name
with home_away_teams as ( select home_team_id as team_id, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, SUM( CASE WHEN home_team_goals > away_team_goals THEN 3 ELSE CASE WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END END ) AS points, count(*) as matches_played from matches group by 1 UNION ALL select away_team_id as team_id, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, SUM( CASE WHEN home_team_goals < away_team_goals THEN 3 ELSE CASE WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END END ) AS points, count(*) as matches_played from matches group by 1 ) select team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for) - sum(goal_against)) as goal_diff from home_away_teams a JOIN teams b ON a.team_id = b.team_id group by 1 order by points desc,goal_diff desc,team_name
with home_score as ( select home_team_id as team_id, (CASE WHEN home_team_goals > away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) score, home_team_goals goal_for, away_team_goals goal_against, (home_team_goals - away_team_goals) goal_diff from Matches ), away_score as (select away_team_id as team_id, (CASE WHEN home_team_goals < away_team_goals THEN 3 WHEN home_team_goals = away_team_goals THEN 1 ELSE 0 END) score, away_team_goals goal_for, home_team_goals goal_against, (away_team_goals - home_team_goals) goal_diff from Matches ), allscore as ( select * from home_score union all select * from away_score ), ans as ( select team_name, count(1) matches_played, sum(score) points, sum(goal_for) goal_for, sum(goal_against) goal_against, sum(goal_diff) goal_diff from teams inner join allscore on teams.team_id = allscore.team_id group by team_name order by points desc, goal_diff desc, team_name asc ) select * from ans
with home_team as( select home_team_id as id, count(*) as matches_played, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from matches group by home_team_id), away_team as ( select away_team_id as id, count(*) as matches_played, sum(case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from matches group by away_team_id) select t.team_name, sum(tt.matches_played) as matches_played, sum(tt.points) as points, sum(tt.goal_for) as goal_for, sum(tt.goal_against) as goal_against, sum(tt.goal_for)-sum(tt.goal_against) as goal_diff from teams t inner join ( select * from home_team union all select * from away_team) tt on t.team_id=tt.id group by t.team_name order by 3 desc, 6 desc,1
with home_team_goals as ( select team_id,team_name, home_team_goals as goals_for, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points, away_team_goals as goals_against from Teams t join Matches m on t.team_id = m.home_team_id ) ,away_team_goals as ( select team_id,team_name,away_team_goals as goals_for, case when away_team_goals > home_team_goals then 3 when away_team_goals < home_team_goals then 0 else 1 end as points, home_team_goals as goals_against from Teams t join Matches m on t.team_id = m.away_team_id ) ,summary as ( select team_id,team_name,goals_for,points,goals_against from home_team_goals union all select team_id,team_name,goals_for, points,goals_against from away_team_goals) ,pre_finalas as ( select team_id, team_name, count(team_id) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against from summary group by 1,2) select team_name,matches_played,points,goal_for,goal_against, goal_for-goal_against as goal_diff from pre_finalas order by 3 desc, goal_diff desc,1
with host as( select home_team_id as id, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)-sum(away_team_goals) as goal_diff, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 when home_team_goals < away_team_goals then 0 end ) as points from matches group by 1) , away as( select away_team_id as id, sum(away_team_goals) as goal_for, sum(home_team_goals ) as goal_against, sum(away_team_goals )-sum(home_team_goals ) as goal_diff, sum(case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 when home_team_goals > away_team_goals then 0 end ) as points from matches group by 1) , team_info as( select id, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_diff) as goal_diff, sum(points) as points from (select id, goal_for, goal_against, goal_diff, points from host union all select id, goal_for, goal_against, goal_diff, points from away) as temp group by 1) , h_count as( select home_team_id as id, count(*) as matches_num from matches group by 1) , a_count as ( select away_team_id as id, count(*) as matches_num from matches group by 1) , matches_count as( select id, sum(matches_num) as matches_num from( select id, matches_num from h_count h union all select id, matches_num from a_count h ) as temp2 group by 1 ) select t.team_name, mc.matches_num as matches_played, tf.points, tf.goal_for, tf.goal_against, tf.goal_diff from team_info tf join teams t on tf.id = t. team_id join matches_count mc on t.team_id = mc.id order by tf.points desc, tf.goal_diff desc, t.team_name
with m as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as score from Matches union all select away_team_id, away_team_goals, home_team_goals, case when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end from Matches) select team_name, count(m.team_id) as matches_played, sum(score) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from m join Teams on m.team_id = Teams.team_id group by m.team_id order by points desc, goal_diff desc, team_name asc
with match_long as ( select home_team_id as team_id, home_team_goals as goals_for, away_team_goals as goals_against, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points from matches union all select away_team_id as team_id, away_team_goals as goals_for, home_team_goals as goals_against, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end as points from matches) select team_name, count(*) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against, sum(goals_for) - sum(goals_against) as goal_diff from match_long ml join teams t using (team_id) group by 1 order by 3 desc, 6 desc, 1
with match_scores as ( select *, (case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end ) as home_team_score, (case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end) as away_team_score from Matches ) select a.team_name, (count(*)) as matches_played, sum(a.score) as points, sum(a.goal_for) as goal_for, sum(a.goal_against) as goal_against, (sum(a.goal_for) - sum(a.goal_against)) as goal_diff from ( select t.team_id, t.team_name, case when t.team_id = m.home_team_id then m.home_team_score when t.team_id = m.away_team_id then m.away_team_score else 0 end as score, case when t.team_id = m.home_team_id then m.home_team_goals when t.team_id = m.away_team_id then m.away_team_goals else 0 end as goal_for, case when t.team_id = m.home_team_id then m.away_team_goals when t.team_id = m.away_team_id then m.home_team_goals else 0 end as goal_against from Teams t join match_scores m on t.team_id = m.home_team_id or t.team_id = m.away_team_id ) a group by a.team_name order by points desc, goal_diff desc, a.team_name asc
with matches_summary as (select home_team_id team_id, home_team_goals goals, away_team_goals against_goals, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end points, 1 matches from matches union all select away_team_id team_id, away_team_goals goals, home_team_goals against_goals, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end points, 1 matches from matches ) select t1.team_name, matches_played, points, goal_for, goal_against, goal_for-goal_against goal_diff from teams t1 right join (select team_id, sum(matches) matches_played, sum(points) points, sum(goals) goal_for, sum(against_goals) goal_against from matches_summary group by team_id)t2 on t1.team_id = t2.team_id order by points desc, goal_diff desc, team_name asc
with matchs as (select *, case when home_team_goals<away_team_goals then 0 when home_team_goals=away_team_goals then 1 else 3 end home_team_points, case when home_team_goals<away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end away_team_points from Matches), cte1 as (select home_team_id, count(home_team_id) cnt, sum(home_team_goals) gol, sum(away_team_goals) awa, sum(home_team_points) p from matchs group by home_team_id), cte2 as (select away_team_id, count(away_team_id), sum(away_team_goals), sum(home_team_goals), sum(away_team_points) from Matchs group by away_team_id), cte3 as (select * from cte1 union all select * from cte2) select tb1.team_name, tb2.matches_played,tb2.points, tb2.goal_for, tb2.goal_against, (tb2.goal_for-tb2.goal_against) goal_diff from (select home_team_id, sum(cnt) matches_played, sum(p) points, sum(gol) goal_for, sum(awa) goal_against from cte3 group by home_team_id) tb2 join Teams tb1 on tb2.home_team_id = tb1.team_id order by tb2.points desc, goal_diff desc, tb1.team_name asc
with mp as ( select team_id, sum(matches_played) as matches_played from ( select home_team_id as team_id, count(*) as matches_played from matches group by 1 union all select away_team_id as team_id, count(*) as matches_played from matches group by 1 ) a group by 1 ), p as ( select *, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as home_points, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end as away_points from matches ), p1 as ( select team_id, sum(points) as points from ( select home_team_id as team_id, sum(home_points) as points from p group by 1 union all select away_team_id as team_id, sum(away_points) as points from p group by 1 ) a group by 1 ), gf as ( select team_id, sum(goal_for) as goal_for from ( select home_team_id as team_id, sum(home_team_goals) as goal_for from matches group by 1 union all select away_team_id as team_id, sum(away_team_goals) as goal_for from matches group by 1 ) a group by 1 ), ga as ( select team_id, sum(goal_against) as goal_against from ( select home_team_id as team_id, sum(away_team_goals) as goal_against from matches group by 1 union all select away_team_id as team_id, sum(home_team_goals) as goal_against from matches group by 1 ) a group by 1 ) select a.team_name, b.matches_played, c.points, d.goal_for, e.goal_against, d.goal_for - e.goal_against as goal_diff from Teams a join mp b on a.team_id = b.team_id join p1 c on a.team_id = c.team_id join gf d on a.team_id = d.team_id join ga e on a.team_id = e.team_id order by 3 desc, 6 desc, 1
with normalized_goal as ( select m.home_team_id as team_id ,case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points ,home_team_goals as goal_for ,away_team_goals as goal_against from matches m union all select m.away_team_id as team_id ,case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as points ,away_team_goals as goal_for ,home_team_goals as goal_against from matches m ) select t.team_name ,count(*) as matches_played ,sum(a.points) as points ,sum(a.goal_for) as goal_for ,sum(a.goal_against) as goal_against ,sum(a.goal_for) - sum(a.goal_against) as goal_diff from normalized_goal a inner join teams t on t.team_id = a.team_id group by 1 order by 3 desc , 6 desc, 1
with normalized_goal as ( select t.team_id ,case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points ,home_team_goals as goal_for ,away_team_goals as goal_against from teams t inner join matches m on m.home_team_id = t.team_id union all select t.team_id ,case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as points ,away_team_goals as goal_for ,home_team_goals as goal_against from teams t inner join matches m on m.away_team_id = t.team_id ) select t.team_name ,count(*) as matches_played ,sum(a.points) as points ,sum(a.goal_for) as goal_for ,sum(a.goal_against) as goal_against ,sum(a.goal_for) - sum(a.goal_against) as goal_diff from normalized_goal a inner join teams t on t.team_id = a.team_id group by 1 order by 3 desc , 6 desc, 1
with points as ( select *, (case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as home_wins, (case when away_team_goals>home_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as away_wins from matches group by home_team_id, away_team_id ), played as ( select id, sum(cnt) as matches_played, sum(wins) as points from ( select home_team_id as id, count(home_team_id) as cnt, sum(home_wins) as wins from points group by home_team_id union all select away_team_id as id, count(away_team_id) as cnt, sum(away_wins) as wins from points group by away_team_id ) a group by id ), goal_for as ( select home_team_id as id, sum(s) as goal_for from ( select home_team_id, sum(home_team_goals) as s from matches group by home_team_id union all select away_team_id, sum(away_team_goals) as s from matches group by away_team_id ) a group by home_team_id ), goal_against as ( select id, sum(s) as goal_against from ( select home_team_id as id, sum(away_team_goals) as s from matches group by home_team_id union all select away_team_id as id, sum(home_team_goals) as s from matches group by away_team_id ) a group by id ), final as ( select played.id, matches_played, points, goal_for,goal_against,(goal_for-goal_against) as goal_diff from played join goal_for on played.id=goal_for.id join goal_against on goal_for.id=goal_against.id ) select team_name, matches_played, points, goal_for, goal_against,goal_diff from teams join final on teams.team_id = final.id order by points desc, goal_diff desc, team_name
with points as ( select home_team_id, away_team_id, home_team_goals, away_team_goals, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_points , case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as away_points from matches ), points_stats as ( select team_id, sum(points) as points ,count(*) as matches_played,sum(goals) as goal_for,sum(goal_aganist)as goal_against from ( select home_team_id as team_id, home_points as points, home_team_goals as goals ,away_team_goals as goal_aganist from points union all ( select away_team_id as team_id, away_points as points ,away_team_goals as goals,home_team_goals as goal_aganist from points ) ) tmp group by team_id ) select t3.team_name, t1.matches_played,t1.points,t1.goal_for, t1.goal_against, t1.goal_for - t1.goal_against as goal_diff from points_stats t1 join teams t3 on t1.team_id = t3.team_id order by points desc , goal_diff desc, team_name
with records as (select home_team_id as team_id, home_team_goals as gain, away_team_goals as lost, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points from matches union all select away_team_id as team_id, away_team_goals as gain, home_team_goals as lost, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end as points from matches ) select t.team_name, count(*) as matches_played, sum(r.points) as points, sum(r.gain) as goal_for, sum(r.lost) as goal_against, sum(r.gain) - sum(r.lost) as goal_diff from teams t right join records r using (team_id) group by t.team_name, r.team_id order by points desc, goal_diff desc, team_name
with result as (select home_team_id, away_team_id, home_team_goals, away_team_goals, (case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end) as home_team_score, (case when home_team_goals<away_team_goals then 3 when home_team_goals>away_team_goals then 0 else 1 end) as away_team_score from matches) select team_name,sum(matches_played) as matches_played, sum(team_score) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from (select home_team_id as team_id, sum(home_team_score) as team_score, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, count(home_team_id) as matches_played from result group by 1 UNION ALL select away_team_id as team_id, sum(away_team_score) as team_score, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against, count(away_team_id) as matches_played from result group by 1) as B INNER JOIN teams ON teams.team_id = B.team_id group by 1 order by points desc, goal_diff desc, team_name asc
with result_base as ( select home_team_id as team_id, home_team_goals as goals, away_team_goals as against, (case when home_team_goals>away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points from matches union all select away_team_id as team_id, away_team_goals as goals, home_team_goals as against, (case when away_team_goals>home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end) as points from matches ) select b.team_name, count(a.team_id) as matches_played , sum(points) as points, sum(goals) as goal_for, sum(against) as goal_against, (sum(goals) - sum(against))as goal_diff from result_base a , teams b where a.team_id = b.team_id group by a.team_id order by points desc, (sum(goals) - sum(against)) desc, team_name
with result_base as ( select home_team_id as team_id, home_team_goals as goals, away_team_goals as against, (case when home_team_goals>away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points from matches union all select away_team_id as team_id, away_team_goals as goals, home_team_goals as against, (case when away_team_goals>home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end) as points from matches ) select b.team_name, count(a.team_id) as matches_played , sum(points) as points, sum(goals) as goal_for, sum(against) as goal_against, (sum(goals) - sum(against))as goal_diff from result_base a left join teams b on a.team_id = b.team_id group by a.team_id order by points desc, (sum(goals) - sum(against)) desc, team_name
with s0 as ( select t.team_id, count(*) as matches_played, sum(case when home_team_goals>away_team_goals then 1 else 0 end) as wins, sum(case when home_team_goals<away_team_goals then 1 else 0 end) as losses, sum(case when home_team_goals=away_team_goals then 1 else 0 end) as ties, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from teams t join matches m on t.team_id=m.home_team_id group by 1), s1 as ( select t.team_id, count(*) as matches_played, sum(case when home_team_goals<away_team_goals then 1 else 0 end) as wins, sum(case when home_team_goals>away_team_goals then 1 else 0 end) as losses, sum(case when home_team_goals=away_team_goals then 1 else 0 end) as ties, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from teams t join matches m on t.team_id=m.away_team_id group by 1), s9 as ( select * from s0 union all select * from s1), s2 as ( select team_id, sum(matches_played) as matches_played, 3*sum(wins) + sum(ties) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) -sum(goal_against) as goal_diff from s9 group by 1) select team_name, matches_played, points, goal_for, goal_against, goal_diff from s2 join teams using(team_id) order by points desc, goal_diff desc, team_name asc
with score as ( select home_team_id as id, home_team_goals as for_goals, away_team_goals as against_goals from matches union all select away_team_id as id, away_team_goals as for_goals, home_team_goals as against_goals from matches) select team_name, count(id) as matches_played, sum(case when for_goals > against_goals then 3 when for_goals=against_goals then 1 else 0 end) as points, sum(for_goals) as goal_for, sum(against_goals) as goal_against, sum(for_goals) - sum(against_goals) as goal_diff from score s left join teams t on s.id = t.team_id group by id order by points desc, goal_diff desc, team_name
with score as (select *, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_score, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as away_score from Matches), home as (select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, home_score as gain_score from score union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, away_score as gain_score from score), matches_play as (select h.team_id, team_name, count(*) as matches_played from home h left join Teams t on h.team_id = t.team_id group by team_id), team_points_goal as (select team_id, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(gain_score) as points from home group by 1) select team_name, matches_played, points, goal_for, goal_against, goal_for - goal_against as goal_diff from team_points_goal t join matches_play m on t.team_id= m.team_id order by 3 desc, 6 desc, 1
with score as( select t.team_name, count(*) as matches_played, sum(case when t.team_id=m.home_team_id and home_team_goals > away_team_goals then 3 when t.team_id=m.away_team_id and home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(case when t.team_id=m.home_team_id then home_team_goals else away_team_goals end) as goal_for, sum(case when t.team_id=m.home_team_id then away_team_goals else home_team_goals end) as goal_against from teams as t join matches as m on t.team_id=m.home_team_id or t.team_id=m.away_team_id group by t.team_id ) select *, goal_for-goal_against as goal_diff from score order by points desc, goal_diff desc, team_name
with stat as (select home_team_id, case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end as point,home_team_goals as goal_for,away_team_goals as goal_against from matches union all select away_team_id, case when home_team_goals>away_team_goals then 0 when home_team_goals<away_team_goals then 3 else 1 end as away_point,away_team_goals,home_team_goals from matches) select team_name,count(home_team_id) as matches_played,sum(point) as points,sum(goal_for) as goal_for ,sum(goal_against) as goal_against,sum(goal_for - goal_against) as goal_diff from stat a inner join teams b on a.home_team_id=b.team_id group by team_name order by sum(point) desc,sum(goal_for - goal_against) desc,team_name asc
with statsTable as(select t1.team_name,case when m1.home_team_id=t1.team_id and m1.home_team_goals>m1.away_team_goals then 3 when m1.away_team_id=t1.team_id and m1.away_team_goals>m1.home_team_goals then 3 when m1.home_team_goals=m1.away_team_goals then 1 else 0 end as points,case when m1.home_team_id=t1.team_id then m1.home_team_goals else 0 end as homeGoals,case when m1.away_team_id=t1.team_id then m1.away_team_goals else 0 end as homeGoals2,case when m1.home_team_id=t1.team_id then m1.away_team_goals else 0 end as awayGoals,case when m1.away_team_id=t1.team_id then m1.home_team_goals else 0 end as awayGoals2, m1.away_team_id,m1.home_team_id from Teams t1 left join Matches m1 on t1.team_id=m1.home_team_id or t1.team_id=m1.away_team_id) select team_name,count(*) as matches_played,SUM(points) as points,SUM(homeGoals+homeGoals2) as goal_for,SUM(awayGoals+awayGoals2) as goal_against,SUM(homeGoals+homeGoals2-awayGoals-awayGoals2) as goal_diff from statsTable where away_team_id is not null or home_team_id is not null group by 1 order by 3 desc,6 desc,1
with t as ( select *, case when home_team_goals=away_team_goals then 1 when home_team_goals> away_team_goals then 3 else 0 end as home_points, case when home_team_goals=away_team_goals then 1 when home_team_goals< away_team_goals then 3 else 0 end as away_points from matches), new as ( select t.home_team_id as team_id, t.home_team_goals as team_goals, t.home_points as points from t union all select t.away_team_id as team_id, t.away_team_goals as team_goals, t.away_points as points from t ), against as ( select tb.team_id, sum(tb.goals) as goal_against from ( select home_team_id as team_id,away_team_goals as goals from matches union all select away_team_id as team_id,home_team_goals as goals from matches ) as tb group by tb.team_id ) select teams.team_name, count(new.team_id) as matches_played, sum(new.points) as points, sum(new.team_goals) as goal_for, against.goal_against as goal_against, sum(new.team_goals)- against.goal_against as goal_diff from new inner join teams on teams.team_id = new.team_id inner join against on against.team_id = new.team_id group by new.team_id order by sum(new.points) desc, goal_diff desc, teams.team_name asc
with t as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against from Matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against from Matches) select team_name, count(t.team_id) as matches_played, sum( case when goal_for>goal_against then 3 when goal_for=goal_against then 1 else 0 end) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from t join Teams te on t.team_id = te.team_id group by t.team_id order by points desc, goal_diff desc, team_name
with t as (select home_team_id as id, home_team_goals as goal_for, away_team_goals as goal_against,if(home_team_goals >away_team_goals,3,if(home_team_goals= away_team_goals,1, 0)) as point from matches union all select away_team_id as id, away_team_goals as goal_for, home_team_goals as goal_against,if(home_team_goals <away_team_goals,3,if(home_team_goals= away_team_goals,1 ,0)) as point from matches ) select team_name ,count(*) as matches_played , sum(point) as points, sum(goal_for ) as goal_for , sum(goal_against) as goal_against , sum(goal_for )- sum(goal_against ) as goal_diff from t inner join teams as m on t.id = m.team_id group by 1 order by 3 desc,6 desc, 1
with t as( select home_team_id from matches union all select away_team_id from matches ),matches_played as( select home_team_id team,count(*) matches_played from t group by home_team_id ), t2 as( select home_team_id team, case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end points from matches union all select away_team_id team, case when home_team_goals<away_team_goals then 3 when home_team_goals>away_team_goals then 0 else 1 end points from matches ), points as( select team, sum(points) points from t2 group by team ), t3 as( select home_team_id team, home_team_goals goals from matches union all select away_team_id team, away_team_goals goals from matches ),goals_for as( select team,sum(goals) goals_for from t3 group by team ),t4 as( select home_team_id team, away_team_goals goals from matches union all select away_team_id team, home_team_goals goals from matches ), goals_against as( select team,sum(goals) goals_against from t4 group by team ), goal_diff as( select a.team,a.goals_for-b.goals_against goal_diff from goals_for a join goals_against b on a.team=b.team ) select teams.team_name,matches_played,points, goals_for as goal_for, goals_against as goal_against, goal_diff from matches_played join points on matches_played.team=points.team join goals_for on goals_for.team=matches_played.team join goals_against on goals_against.team = matches_played.team join goal_diff on goal_diff.team=matches_played.team join teams on teams.team_id=matches_played.team order by points desc,goal_diff desc,team_name
with t1 as ( SELECT home_team_id, away_team_id, home_team_goals, away_team_goals, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_points, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as away_points FROM Matches ), t2 as ( SELECT home_team_id team_id, home_team_goals goals, away_team_goals op_goals, home_points points From t1 UNION ALL SELECT away_team_id, away_team_goals, home_team_goals, away_points From t1 ), t3 as ( select team_name, count(*) as matches_played, sum(t2.points) as points, sum(t2.goals) as goal_for, sum(t2.op_goals) as goal_against FROM Teams t join t2 USING (team_id) group by team_id ) select *, goal_for - goal_against as goal_diff from t3 order by points desc, goal_diff desc, team_name
with t1 as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against from Matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against from Matches) select b.team_name, count(*) as matches_played, sum(case when goal_for>goal_against then 3 when goal_for=goal_against then 1 else 0 end) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for) - sum(goal_against)) as goal_diff from t1 left join Teams b on t1.team_id=b.team_id group by b.team_name order by sum(case when goal_for>goal_against then 3 when goal_for=goal_against then 1 else 0 end) desc, (sum(goal_for) - sum(goal_against)) desc, team_name
with t1 as (select home_team_id as team_id, count(home_team_id) as matches_played from (select home_team_id, away_team_id from Matches union all select away_team_id, home_team_id from Matches) temp group by 1), t2 as (select team_id, sum(team_points) as points from (select home_team_id as team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as team_points from Matches union all select away_team_id as team_id, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end as team_points from Matches) temp group by 1), t3 as (select team_id, sum(goal_for) as goal_for from (select home_team_id as team_id, home_team_goals as goal_for from Matches union all select away_team_id, away_team_goals from Matches) temp group by 1), t4 as (select team_id, sum(goal_against) as goal_against from (select home_team_id as team_id, away_team_goals as goal_against from Matches union all select away_team_id, home_team_goals from Matches) temp group by 1) select t.team_name, matches_played, points, goal_for, goal_against, goal_for-goal_against as goal_diff from t1 join t2 on t1.team_id = t2.team_id join t3 on t2.team_id = t3.team_id join t4 on t3.team_id = t4.team_id join Teams t on t4.team_id = t.team_id order by points desc, goal_diff desc, team_name
with t1 as (select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select away_team_id, away_team_goals, home_team_goals from matches) select team_name, count(*) as matches_played, sum(case when goal_for > goal_against then 3 when goal_for < goal_against then 0 else 1 end) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from t1 join teams b on t1.team_id = b.team_id group by 1 order by 3 desc, 6 desc, 1
with t1 as (select home_team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as home_team_point, home_team_goals, away_team_id, case when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 else 3 end as away_team_point, away_team_goals from Matches) , t2 as (select home_team_id as team_id, home_team_point as points, home_team_goals as goal_for, away_team_goals as goal_against from t1 union all select away_team_id as team_id, away_team_point as points, away_team_goals as goal_for, home_team_goals as goal_against from t1) , t3 as (select team_id, count(team_id) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against from t2 group by 1) select T.team_name, matches_played, points, goal_for, goal_against, t3.goal_for - t3.goal_against as goal_diff from Teams T join t3 on T.team_id = t3.team_id order by points DESC, goal_diff DESC, team_name
with t1 as(select id, count(id) as matches_played, sum(goal_for) as goal_for, sum(goal_against) as goal_against from (select home_team_id as id, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select away_team_id as id, away_team_goals as goal_for, home_team_goals as goal_against from matches) as tmp1 group by id ), t2 as(select id, sum(points) as points from ( select home_team_id as id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches union all select away_team_id as id, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches) as tmp2 group by id ) select t.team_name, t1.matches_played, t2.points, t1.goal_for, t1.goal_against, (t1.goal_for - t1.goal_against) as goal_diff from teams as t join t1 on t.team_id = t1.id join t2 on t.team_id = t2.id order by points desc, goal_diff desc, team_name asc
with t1 as(select id, count(id) as matches_played, sum(goal_for) as goal_for, sum(goal_against) as goal_against from (select home_team_id as id, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select away_team_id as id, away_team_goals as goal_for, home_team_goals as goal_against from matches) as tmp1 group by id ), t2 as(select id, sum(points) as points from ( select home_team_id as id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches union all select away_team_id as id, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points from matches) as tmp2 group by id ) select t.team_name, t1.matches_played, t2.points, t1.goal_for, t1.goal_against, (t1.goal_for - t1.goal_against) as goal_diff from teams as t join t1 on t.team_id = t1.id join t2 on t1.id = t2.id order by points desc, goal_diff desc, team_name asc
with t1_points as (select *, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as home_pt, case when away_team_goals > home_team_goals then 3 when away_team_goals < home_team_goals then 0 else 1 end as away_pt from matches), t2_goalfor as (select teamid, sum(goalf) as goal_for, count(*) as matches_played from (select home_team_id as teamid, home_team_goals as goalf from matches union all select away_team_id as teamid, away_team_goals as goalf from matches) temp1 group by teamid), t3_goalagainst as (select teamid, sum(goalag) as goal_against from (select home_team_id as teamid, away_team_goals as goalag from matches union all select away_team_id as teamid, home_team_goals as goalag from matches) temp2 group by teamid), t4_totalpts as (select tid, sum(pt) as points from (select home_team_id as tid, home_pt as pt from t1_points union all select away_team_id as tid, away_pt as pt from t1_points) temp3 group by 1) select t.team_name, t2.matches_played, t4.points, t2.goal_for, t3.goal_against, (t2.goal_for - t3.goal_against) as goal_diff from teams t join t2_goalfor t2 on t.team_id = t2.teamid join t3_goalagainst t3 on t.team_id = t3.teamid join t4_totalpts t4 on t.team_id = t4.tid order by points desc, goal_diff desc, team_name
with tb1 as (select home_team_id as id, home_team_goals as g1, away_team_goals as g2 from Matches union all select away_team_id as id, away_team_goals as g1, home_team_goals as g2 from Matches) select team_name, count(tb1.id) matches_played,sum(case when g1>g2 then 3 when g1=g2 then 1 else 0 end) points, sum(g1) as goal_for,sum(g2) as goal_against, sum(g1)-sum(g2) as goal_diff from tb1 join Teams on Teams.team_id=tb1.id group by id order by points desc, goal_diff desc, team_name
with tbP as ( select t.team_name, (case when ((t.team_id = m.home_team_id and m.home_team_goals > m.away_team_goals) or (t.team_id = m.away_team_id and m.home_team_goals < m.away_team_goals)) then 3 when ((t.team_id = m.home_team_id and m.home_team_goals = m.away_team_goals) or (t.team_id = m.away_team_id and m.home_team_goals = m.away_team_goals)) then 1 else 0 end) as points, (case when t.team_id = m.home_team_id then m.home_team_goals when t.team_id = m.away_team_id then m.away_team_goals end) as goals_for, (case when t.team_id = m.home_team_id then m.away_team_goals when t.team_id = m.away_team_id then m.home_team_goals end) as goals_against from teams as t join matches as m on t.team_id = m.home_team_id or t.team_id = m.away_team_id ) select team_name, count(*) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against, (sum(goals_for) - sum(goals_against)) as goal_diff from tbP group by team_name order by points desc, goal_diff desc, team_name
with tbP as ( select t.team_name, (case when ((t.team_id = m.home_team_id and m.home_team_goals > m.away_team_goals) or (t.team_id = m.away_team_id and m.home_team_goals < m.away_team_goals)) then 3 when ((t.team_id = m.home_team_id and m.home_team_goals = m.away_team_goals) or (t.team_id = m.away_team_id and m.home_team_goals = m.away_team_goals)) then 1 else 0 end) as points, (case when t.team_id = m.home_team_id then m.home_team_goals when t.team_id = m.away_team_id then m.away_team_goals end) as goals_for, (case when t.team_id = m.home_team_id then m.away_team_goals when t.team_id = m.away_team_id then m.home_team_goals end) as goals_against from teams as t left join matches as m on t.team_id = m.home_team_id or t.team_id = m.away_team_id ) select team_name, count(*) as matches_played, sum(points) as points, sum(goals_for) as goal_for, sum(goals_against) as goal_against, (sum(goals_for) - sum(goals_against)) as goal_diff from tbP group by team_name having goal_diff is not null order by points desc, goal_diff desc, team_name
with team_match as ( select home_team_id as team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as score, home_team_goals as goal_for, away_team_goals as goal_against from Matches union all select away_team_id as team_id, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as score, away_team_goals as goal_for, home_team_goals as goal_against from Matches ) select t.team_name, count(*) as matches_played, sum(m.score) as points, sum(m.goal_for) as goal_for, sum(m.goal_against) as goal_against, sum(m.goal_for - goal_against) as goal_diff from Teams t join team_match m on t.team_id = m.team_id group by t.team_id order by points desc, goal_diff desc, team_name
with team_match as( select team_id, count(*) as matches_played from (select home_team_id as team_id, away_team_id as match_id from matches union all select away_team_id as tem_id, home_team_id as match_id from matches) m group by team_id ), goals as( select team_id, sum(goal_for) as goal_for, sum(goal_against) as goal_against from (select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against from matches) m group by team_id ), points as ( select p.team_id, sum(p.points) as points from ( select tie.team_id, 1 as points from (select home_team_id as team_id from (select home_team_id, away_team_id from matches where home_team_goals = away_team_goals) t1 union all select away_team_id as team_id from (select home_team_id, away_team_id from matches where home_team_goals = away_team_goals) t2) tie union all select home_team_id as team_id, 3 as points from matches where home_team_goals > away_team_goals union all select away_team_id as team_id, 3 as points from matches where away_team_goals > home_team_goals) p group by p.team_id ) select t.team_name, coalesce(tm.matches_played,0) as matches_played, coalesce(p.points, 0) as points, coalesce(g.goal_for,0) as goal_for, coalesce(g.goal_against,0) as goal_against, coalesce(goal_for - goal_against, 0) as goal_diff from team_match tm left join points p on tm.team_id = p.team_id left join goals g on tm.team_id = g.team_id left join teams t on t.team_id = tm.team_id order by points desc, goal_diff desc, team_name
with teams1 as(select home_team_id as id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points from Matches union all select away_team_id as id, away_team_goals as goal_for, home_team_goals as goal_against, case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end as points from Matches) select team_name, count(teams1.id) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for)- sum(goal_against) as goal_diff from teams1 join Teams on teams1.id = Teams.team_id group by teams1.id order by points desc, goal_diff desc, team_name
with teams_id as (select home_team_id id , case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points , home_team_goals as goal_for , away_team_goals as goal_against from matches union all select away_team_id as id , case when away_team_goals > home_team_goals then 3 when away_team_goals = home_team_goals then 1 else 0 end as points , away_team_goals as goal_for , home_team_goals as goal_against from matches ) select t2.team_name , count(*) as matches_played , sum(points) as points , sum(goal_for) as goal_for , sum(goal_against) as goal_against , sum(goal_for - goal_against) as goal_diff from teams_id t1 join teams t2 on t1.id = t2.team_id group by t1.id order by points desc, goal_diff desc, team_name asc
with temp as ( select *, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as home_points, (case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as away_points from Matches), score_table as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, home_points as score from temp union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, away_points as score from temp) select team_name, count(team_name) as matches_played, sum(score) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for) - sum(goal_against)) as goal_diff from( select Teams.team_name, score_table.goal_for, score_table.goal_against, score_table.score from score_table left join Teams on Teams.team_id = score_table.team_id) as join_score group by 1 order by 3 desc, 6 desc, 1
with temp as ( select *, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as home_points, (case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as away_points from Matches), score_table as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, home_points as score from temp union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, away_points as score from temp) select team_name, count(team_name) as matches_played, sum(score) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for) - sum(goal_against)) as goal_diff from( select Teams.team_name, score_table.goal_for, score_table.goal_against, score_table.score from score_table left join Teams on Teams.team_id = score_table.team_id) as join_score group by team_name order by points desc, goal_diff desc, team_name
with temp as ( select home_team_id as team_id , home_team_goals as team_goals , case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as score , away_team_goals as op_goal from matches union all select away_team_id as team_id , away_team_goals as team_goals , case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end as score , home_team_goals as op_goal from matches ) select t.team_name , count(temp.team_id) as matches_played , sum(score) as points , sum(team_goals) as goal_for , sum(op_goal) as goal_against , sum(team_goals)- sum(op_goal) as goal_diff from teams as t join temp on t.team_id = temp.team_id group by t.team_name order by points desc, goal_diff desc, team_name asc
with temp as ( select home_team_id as team_id, count(*) as matches_played, sum(case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against from matches group by 1 union all select away_team_id as team_id, count(*) as matches_played, sum(case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) as points, sum(away_team_goals) as goal_for, sum(home_team_goals) as goal_against from matches group by 1) select team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for) - sum(goal_against) as goal_diff from temp te left join teams tm on te.team_id = tm.team_id group by 1 order by points desc, goal_diff desc, 1
with temp as ( select home_team_id, away_team_id, home_team_goals, away_team_goals, if(home_team_goals = away_team_goals, 1, if(home_team_goals > away_team_goals, 3, 0) ) as home_team_points, if(home_team_goals = away_team_goals, 1, if(away_team_goals > home_team_goals, 3, 0) ) as away_team_points from matches ) select t.team_name, count(*) as matches_played, sum(points) as points, sum(goals) as goal_for, sum(oppo_goals) as goal_against, (sum(goals) - sum(oppo_goals)) as goal_diff from (select home_team_id as team_id, home_team_goals as goals, away_team_goals as oppo_goals, home_team_points as points from temp union all select away_team_id as team_id, away_team_goals as goals, home_team_goals as oppo_goals, away_team_points as points from temp) m join teams t on m.team_id = t.team_id group by t.team_id, t.team_name order by points desc, goal_diff desc, t.team_name
with temp as ( select home_team_id, sum(home_team_goals) as 'home_team_goals', sum(away_team_goals) 'away_team_goals', count(home_team_id) matches_played, sum(case when home_team_goals>away_team_goals then 3 else 0 end)+ sum(case when home_team_goals = away_team_goals then 1 else 0 end) points from Matches group by home_team_id union select away_team_id as home_team_id, sum(away_team_goals) as home_team_goals, sum(home_team_goals) as away_team_goals, count(away_team_id) matches_played, sum(case when home_team_goals<away_team_goals then 3 else 0 end)+ sum(case when home_team_goals = away_team_goals then 1 else 0 end) points from Matches group by away_team_id) select t.team_name, sum(d.matches_played) 'matches_played', sum(points) as 'points', sum(d.home_team_goals) goal_for, sum(d.away_team_goals) goal_against, sum(d.home_team_goals) - sum(d.away_team_goals) goal_diff from temp d join Teams t on d.home_team_id = t.team_id group by home_team_id order by points desc, goal_diff desc, team_name
with temp as (select * from (select home_team_id as team_id, (case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end) as points, home_team_goals as goal_for, away_team_goals as goal_against from Matches union all select away_team_id as team_id, (case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end) as points, away_team_goals as goal_for, home_team_goals as goal_against from Matches ) sub) select t.team_name, count(t.team_name) as matches_played, sum(te.points) as points, sum(te.goal_for) as goal_for, sum(te.goal_against) as goal_against, (sum(te.goal_for)-sum(te.goal_against)) as goal_diff from Teams t right join temp te on t.team_id = te.team_id group by 1 order by 3 desc, 6 desc, 1
with temp as (select home_team_id as p1, away_team_id as p2, home_team_goals as score, away_team_goals as lost from matches union all select away_team_id as p1, home_team_id as p2, away_team_goals as score, home_team_goals as lost from matches) select team_name, count(team_name) as matches_played, sum( case when score > lost then 3 when score < lost then 0 else 1 end ) as points, sum(score) goal_for, sum(lost) goal_against, sum(score) - sum(lost) goal_diff from temp tp join teams t on tp.p1 = t.team_id group by 1 order by 3 desc, 6 desc, 1
with temp as (select home_team_id as p1, home_team_goals as score, away_team_goals as lost from matches union all select away_team_id as p1, away_team_goals as score, home_team_goals as lost from matches) select team_name, count(team_name) as matches_played, sum( case when score > lost then 3 when score < lost then 0 else 1 end ) as points, sum(score) goal_for, sum(lost) goal_against, sum(score) - sum(lost) goal_diff from temp tp join teams t on tp.p1 = t.team_id group by 1 order by 3 desc, 6 desc, 1
with temp as (select home_team_id as team_id, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end as points, home_team_goals as goal_for, away_team_goals as goal_against from matches union all select away_team_id, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 else 1 end as points, away_team_goals as goal_for, home_team_goals as goal_against from matches) select team_name, count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, (sum(goal_for) - sum(goal_against)) as goal_diff from temp join teams on teams.team_id = temp.team_id group by temp.team_id order by points desc, goal_diff desc, team_name
with temp as (select home_team_id as team_id, home_team_goals as goals_for, away_team_goals as goals_against, case when home_team_goals>away_team_goals then 3 when home_team_goals<away_team_goals then 0 else 1 end num_points from matches union all select away_team_id as team_id, away_team_goals as goals_for, home_team_goals as goals_against, case when home_team_goals>away_team_goals then 0 when home_team_goals<away_team_goals then 3 else 1 end num_points from matches) select t.team_name, count(*) as matches_played, sum(t2.num_points) as points, sum(t2.goals_for) as goal_for, sum(t2.goals_against) as goal_against, sum(t2.goals_for) - sum(t2.goals_against) as goal_diff from teams t, temp t2 where t.team_id = t2.team_id group by t.team_name order by 3 desc,6 desc,1
with temp as (select home_team_id,away_team_id,home_team_goals,away_team_goals from matches union all select away_team_id,home_team_id,away_team_goals,home_team_goals from matches) select t1.team_name as team_name, count(home_team_id) as matches_played, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)-sum(away_team_goals) as goal_diff from temp t join teams t1 on t.home_team_id=t1.team_id group by t.home_team_id order by points desc, goal_diff desc, team_name
with temp as (select team_id, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, count(team_id) matches_played from ((select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, (case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) points from matches) union all (select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, (case when away_team_goals > home_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end) points from matches)) t group by t.team_id) select t1.team_name, matches_played, points, goal_for, goal_against, (goal_for-goal_against) as goal_diff from teams t1 join temp on t1.team_id=temp.team_id order by points desc, goal_diff desc,team_name
with temp1 as ( select team, count(*) as matches_played from ( select home_team_id as team from Matches union all select away_team_id from Matches ) t group by 1 ) ,temp2 as ( select home_team_id, away_team_id, case when home_team_goals>away_team_goals then "home" when home_team_goals = away_team_goals then "tie" when home_team_goals<away_team_goals then "away" end as match_result from Matches ) ,temp3 as ( select team, sum(points) as points from ( select home_team_id as team, sum( case when match_result="home" then 3 when match_result="tie" then 1 else 0 end) as points from temp2 group by 1 union all select away_team_id as team, sum( case when match_result="away" then 3 when match_result="tie" then 1 else 0 end) as points from temp2 group by 1 ) g group by 1 ) , temp4 as (select team, sum(goals) as goal_for from ( select home_team_id as team, home_team_goals as goals from Matches union all select away_team_id as team, away_team_goals as goals from Matches ) t group by 1 ) ,temp5 as (select team, sum(goals) as goal_against from ( select home_team_id as team, away_team_goals as goals from Matches union all select away_team_id as team, home_team_goals as goals from Matches ) t group by 1 ) select team_name,matches_played,points,goal_for,goal_against, goal_for-goal_against as goal_diff from temp1 inner join Teams on temp1.team=Teams.team_id inner join temp3 on temp1.team=temp3.team inner join temp4 on temp1.team=temp4.team inner join temp5 on temp1.team=temp5.team order by 3 desc,6 desc, 1
with tmp as ( select home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_againt, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 when home_team_goals = away_team_goals then 1 end as points from Matches union all select away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_againt, case when home_team_goals < away_team_goals then 3 when home_team_goals > away_team_goals then 0 when home_team_goals = away_team_goals then 1 end as points from Matches ) , tmp2 as ( select team_id, count(*) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_againt) as goal_against, sum(goal_for) - sum(goal_againt) as goal_diff from tmp group by team_id ) select Teams.team_name, tmp2.matches_played, tmp2.points, tmp2.goal_for, tmp2.goal_against, tmp2.goal_diff from tmp2 left join Teams on tmp2.team_id = Teams.team_id order by points desc, goal_diff desc, team_name
with tmp as ( select team_name, count(*) as matches_played, sum(case when team_id = home_team_id and home_team_goals > away_team_goals then 3 when team_id = home_team_id and home_team_goals = away_team_goals then 1 when team_id = away_team_id and home_team_goals < away_team_goals then 3 when team_id = away_team_id and home_team_goals = away_team_goals then 1 else 0 end) as points, sum(case when team_id = home_team_id then home_team_goals when team_id = away_team_id then away_team_goals end) as goal_for, sum(case when team_id = home_team_id then away_team_goals when team_id = away_team_id then home_team_goals end) as goal_against from teams join matches on team_id = home_team_id or team_id = away_team_id group by 1) select *, goal_for - goal_against as goal_diff from tmp order by 3 desc, 6 desc, 1
with tmp as (select * from matches union all select away_team_id as home_team_id, home_team_id as away_team_id, away_team_goals as home_team_goals, home_team_goals as away_team_goals from matches ) select team_name, count(*) as matches_played, sum(case when home_team_goals>away_team_goals then 3 when home_team_goals=away_team_goals then 1 else 0 end) as points, sum(home_team_goals) as goal_for, sum(away_team_goals) as goal_against, sum(home_team_goals)-sum(away_team_goals) as goal_diff from tmp a inner join teams b on a.home_team_id=b.team_id group by 1 order by points desc, goal_diff desc, team_name
with tmp as( select home_team_id as team, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals = away_team_goals then 1 end as score from matches union all select away_team_id as team, away_team_goals as goal_for, home_team_goals as goal_against, case when home_team_goals < away_team_goals then 3 when home_team_goals = away_team_goals then 1 end as score from matches ) select t.team_name, ifnull(count(tmp.team),0) as matches_played, coalesce(sum(score),0) as points, coalesce(sum(goal_for),0) as goal_for, coalesce(sum(goal_against),0) as goal_against, coalesce(sum(goal_for)-sum(goal_against),0) as goal_diff from teams as t join tmp on t.team_id = tmp.team group by tmp.team order by points desc, goal_diff desc, team_name
with totalpoints as( select team_id ,sum(points) as points ,count(team_id) as matches_played ,sum(goal_for) as goal_for ,sum(goal_against) as goal_against from( select home_team_id as team_id ,case when home_team_goals> away_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points ,home_team_goals as goal_for ,away_team_goals as goal_against from Matches union all select away_team_id as team_id ,case when away_team_goals> home_team_goals then 3 when home_team_goals = away_team_goals then 1 else 0 end as points ,away_team_goals as goal_for ,home_team_goals as goal_against from Matches ) A group by team_id ) select teams.team_name ,tp.matches_played ,tp.points ,tp.goal_for ,tp.goal_against ,tp.goal_for - tp.goal_against as goal_diff from Teams teams join totalpoints tp on teams.team_id = tp.team_id order by points desc, goal_diff desc, team_name
with win_or_lose as ( select team_id, sum(matches) as matches_played, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(points) as points from ( select 1 as matches, home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 end as points from matches where home_team_goals <> away_team_goals union all select 1 as matches, away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, case when away_team_goals > home_team_goals then 3 when away_team_goals < home_team_goals then 0 end as points from matches where home_team_goals <> away_team_goals ) f group by 1 ), tie as ( select team_id, sum(matches) as matches_played, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(points) as points from ( select 1 as matches, home_team_id as team_id, home_team_goals as goal_for, away_team_goals as goal_against, 1 as points from matches where home_team_goals = away_team_goals union all select 1 as matches, away_team_id as team_id, away_team_goals as goal_for, home_team_goals as goal_against, 1 as points from matches where home_team_goals = away_team_goals ) f group by 1 ) select team_name, sum(matches_played) as matches_played, sum(points) as points, sum(goal_for) as goal_for, sum(goal_against) as goal_against, sum(goal_for - goal_against) as goal_diff from ( select team_id, matches_played, goal_for, goal_against, points from tie union all select team_id, matches_played, goal_for, goal_against, points from win_or_lose ) f join teams t on t.team_id = f.team_id group by 1 order by points desc, goal_diff desc, team_name
