SELECT CATEGORY, SUM(IF (WEEKDAY='MONDAY', TOTAL,0)) AS 'MONDAY', SUM(IF (WEEKDAY='TUESDAY', TOTAL,0)) AS 'TUESDAY', SUM(IF (WEEKDAY='WEDNESDAY', TOTAL,0)) AS 'WEDNESDAY', SUM(IF (WEEKDAY='THURSDAY', TOTAL,0)) AS 'THURSDAY', SUM(IF (WEEKDAY='FRIDAY', TOTAL,0)) AS 'FRIDAY', SUM(IF (WEEKDAY='SATURDAY', TOTAL,0)) AS 'SATURDAY', SUM(IF (WEEKDAY='SUNDAY', TOTAL,0)) AS 'SUNDAY' FROM( SELECT ITEM_CATEGORY AS CATEGORY, DATE_FORMAT(ORDER_DATE, '%W') AS WEEKDAY, SUM(QUANTITY) AS TOTAL FROM ITEMS LEFT JOIN ORDERS USING (ITEM_ID) GROUP BY ITEM_CATEGORY, DATE_FORMAT(ORDER_DATE, '%W')) SUB GROUP BY CATEGORY ORDER BY CATEGORY
SELECT CATEGORY, SUM(IFNULL(Monday,0)) AS MONDAY, SUM(IFNULL(Tuesday,0)) AS TUESDAY, SUM(IFNULL(Wednesday,0)) AS WEDNESDAY, SUM(IFNULL(Thursday,0)) AS THURSDAY, SUM(IFNULL(Friday,0)) AS FRIDAY, SUM(IFNULL(Saturday,0)) AS SATURDAY, SUM(IFNULL(Sunday,0)) AS SUNDAY FROM (SELECT item_category AS CATEGORY, (CASE WHEN order_date = 'Monday' THEN quantity END) Monday, (CASE WHEN order_date = 'Tuesday' THEN quantity END) Tuesday, (CASE WHEN order_date = 'Wednesday' THEN quantity END) Wednesday, (CASE WHEN order_date = 'Thursday' THEN quantity END) Thursday, (CASE WHEN order_date = 'Friday' THEN quantity END) Friday, (CASE WHEN order_date = 'Saturday' THEN quantity END) Saturday, (CASE WHEN order_date = 'Sunday' THEN quantity END) Sunday FROM (SELECT i.item_category, SUM(IFNULL(o.quantity,0)) AS quantity, DAYNAME(IFNULL(o.order_date,0)) AS order_date FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY i.item_category, o.order_date) pivot_table) n GROUP BY CATEGORY ORDER BY CATEGORY
SELECT Category, SUM(CASE WHEN DAY = 2 THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN Day = 3 THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAY = 4 THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAY = 5 THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN Day = 6 THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAY = 7 THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN Day = 1 THEN quantity ELSE 0 END) AS Sunday FROM ( SELECT a.*, DAYOFWEEK(a.order_date) AS DAY, b.item_category AS Category FROM Orders a RIGHT JOIN Items b ON a.item_id = b.item_id ) c GROUP BY 1 ORDER BY 1
SELECT DISTINCT i.item_category Category, SUM(CASE WHEN DAYNAME(o.order_date) = 'Monday' THEN o.quantity ELSE 0 END) AS Monday, SUM(CASE WHEN DAYNAME(o.order_date) = 'Tuesday' THEN o.quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAYNAME(o.order_date) = 'Wednesday' THEN o.quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAYNAME(o.order_date) = 'Thursday' THEN o.quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN DAYNAME(o.order_date) = 'Friday' THEN o.quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAYNAME(o.order_date) = 'Saturday' THEN o.quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN DAYNAME(o.order_date) = 'Sunday' THEN o.quantity ELSE 0 END) AS Sunday FROM Items i LEFT JOIN Orders o USING(item_id) GROUP BY 1 ORDER BY Category
SELECT I.ITEM_CATEGORY AS CATEGORY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=2 THEN QUANTITY ELSE 0 END) AS MONDAY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=3 THEN QUANTITY ELSE 0 END) AS TUESDAY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=4 THEN QUANTITY ELSE 0 END) AS WEDNESDAY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=5 THEN QUANTITY ELSE 0 END) AS THURSDAY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=6 THEN QUANTITY ELSE 0 END) AS FRIDAY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=7 THEN QUANTITY ELSE 0 END) AS SATURDAY, SUM(CASE WHEN DAYOFWEEK(O.ORDER_DATE)=1 THEN QUANTITY ELSE 0 END) AS SUNDAY FROM Orders O RIGHT JOIN ITEMS I ON O.item_id=I.item_id GROUP BY I.ITEM_CATEGORY ORDER BY 1
SELECT I.ITEM_CATEGORY AS CATEGORY, sum(case when dayname(o.order_date) = 'Monday' then quantity else 0 end) Monday, sum(case when dayname(o.order_date) = 'Tuesday' then quantity else 0 end) Tuesday, sum(case when dayname(o.order_date) = 'Wednesday' then quantity else 0 end) Wednesday, sum(case when dayname(o.order_date) = 'Thursday' then quantity else 0 end) Thursday, sum(case when dayname(o.order_date) = 'Friday' then quantity else 0 end) Friday, sum(case when dayname(o.order_date) = 'Saturday' then quantity else 0 end) Saturday, sum(case when dayname(o.order_date) = 'Sunday' then quantity else 0 end) Sunday FROM Orders O RIGHT JOIN ITEMS I ON O.item_id=I.item_id GROUP BY I.ITEM_CATEGORY ORDER BY 1
SELECT I.item_category AS Category ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 2,quantity,0)),0) AS Monday ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 3,quantity,0)),0) AS Tuesday ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 4,quantity,0)),0) AS Wednesday ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 5,quantity,0)),0) AS Thursday ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 6,quantity,0)),0) AS Friday ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 7,quantity,0)),0) AS Saturday ,IFNULL(SUM(IF(DAYOFWEEK(O.order_date) = 1,quantity,0)),0) AS Sunday FROM Items I LEFT JOIN Orders O ON O.item_id = I.item_id GROUP BY I.item_category ORDER BY 1 ASC
SELECT I.item_category AS Category ,SUM(IF(DAYNAME(order_date) = 'Monday',quantity,0)) AS Monday ,SUM(IF(DAYNAME(order_date) = 'Tuesday',quantity,0)) AS Tuesday ,SUM(IF(DAYNAME(order_date) = 'Wednesday',quantity,0)) AS Wednesday ,SUM(IF(DAYNAME(order_date) = 'Thursday',quantity,0)) AS Thursday ,SUM(IF(DAYNAME(order_date) = 'Friday',quantity,0)) AS Friday ,SUM(IF(DAYNAME(order_date) = 'Saturday',quantity,0)) AS Saturday ,SUM(IF(DAYNAME(order_date) = 'Sunday',quantity,0)) AS Sunday FROM Orders O RIGHT JOIN Items I ON I.item_id = O.item_id GROUP BY I.item_category ORDER BY 1 ASC
SELECT I.item_category as Category, sum(CASE WHEN DAYOFWEEK(O.order_date) = 2 THEN O.quantity ELSE 0 END) as Monday, sum(CASE WHEN DAYOFWEEK(O.order_date) = 3 THEN O.quantity ELSE 0 END) as Tuesday, sum(CASE WHEN DAYOFWEEK(O.order_date) = 4 THEN O.quantity ELSE 0 END) as Wednesday, sum(CASE WHEN DAYOFWEEK(O.order_date) = 5 THEN O.quantity ELSE 0 END) as Thursday, sum(CASE WHEN DAYOFWEEK(O.order_date) = 6 THEN O.quantity ELSE 0 END) as Friday, sum(CASE WHEN DAYOFWEEK(O.order_date) = 7 THEN O.quantity ELSE 0 END) as Saturday, sum(CASE WHEN DAYOFWEEK(O.order_date) = 1 THEN O.quantity ELSE 0 END) as Sunday FROM Orders O Right JOIN Items I ON O.item_id = I.item_id GROUP BY I.item_category ORDER BY I.item_category
SELECT a.Category, SUM(CASE WHEN day = 'Monday' THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN day = 'Tuesday' THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN day = 'Wednesday' THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN day = 'Thursday' THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN day = 'Friday' THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN day = 'Saturday' THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN day = 'Sunday' THEN quantity ELSE 0 END) AS Sunday FROM ( SELECT item_category AS Category, item_id FROM Items ) a LEFT JOIN ( SELECT i.item_id, i.item_category AS Category, DAYNAME(o.order_date) AS day, o.quantity FROM Orders o INNER JOIN Items i ON o.item_id = i.item_id ) t ON a.item_id = t.item_id GROUP BY a.Category ORDER BY a.Category
SELECT b.item_category as 'CATEGORY', sum(case when weekday(a.order_date) = 0 then a.quantity else 0 end) as 'MONDAY', sum(case when weekday(a.order_date) = 1 then a.quantity else 0 end) as 'TUESDAY', sum(case when weekday(a.order_date) = 2 then a.quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(a.order_date) = 3 then a.quantity else 0 end) as 'THURSDAY', sum(case when weekday(a.order_date) = 4 then a.quantity else 0 end) as 'FRIDAY', sum(case when weekday(a.order_date) = 5 then a.quantity else 0 end) as 'SATURDAY', sum(case when weekday(a.order_date) = 6 then a.quantity else 0 end) as 'SUNDAY' FROM orders a RIGHT JOIN items b on a.item_id = b.item_id GROUP BY b.item_category ORDER BY b.item_category
SELECT b.item_category as 'CATEGORY', sum(case when weekday(a.order_date) = 0 then a.quantity else 0 end) as 'MONDAY', sum(case when weekday(a.order_date) = 1 then a.quantity else 0 end) as 'TUESDAY', sum(case when weekday(a.order_date) = 2 then a.quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(a.order_date) = 3 then a.quantity else 0 end) as 'THURSDAY', sum(case when weekday(a.order_date) = 4 then a.quantity else 0 end) as 'FRIDAY', sum(case when weekday(a.order_date) = 5 then a.quantity else 0 end) as 'SATURDAY', sum(case when weekday(a.order_date) = 6 then a.quantity else 0 end) as 'SUNDAY' from orders a right join items b on a.item_id = b.item_id group by b.item_category order by b.item_category
SELECT category, SUM(CASE WHEN week = 'Monday' THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN week = 'Tuesday' THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN week = 'Wednesday' THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN week = 'Thursday' THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN week = 'Friday' THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN week = 'Saturday' THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN week = 'Sunday' THEN quantity ELSE 0 END) AS Sunday FROM (SELECT Date_Format(order_date, '%W') AS week, item_category AS category, quantity FROM Orders RIGHT JOIN Items ON Orders.item_id = Items.item_id) NewT GROUP BY category ORDER BY category
SELECT i.item_category AS "CATEGORY", SUM(CASE WHEN DAYOFWEEK(o.order_date)=2 THEN quantity ELSE 0 END) AS 'Monday', SUM(CASE WHEN DAYOFWEEK(o.order_date)=3 THEN quantity ELSE 0 END) AS 'Tuesday', SUM(CASE WHEN DAYOFWEEK(o.order_date)=4 THEN quantity ELSE 0 END) AS 'Wednesday', SUM(CASE WHEN DAYOFWEEK(o.order_date)=5 THEN quantity ELSE 0 END) AS 'Thursday', SUM(CASE WHEN DAYOFWEEK(o.order_date)=6 THEN quantity ELSE 0 END) AS 'Friday', SUM(CASE WHEN DAYOFWEEK(o.order_date)=7 THEN quantity ELSE 0 END) AS 'Saturday', SUM(CASE WHEN DAYOFWEEK(o.order_date)=1 THEN quantity ELSE 0 END) AS 'Sunday' FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY i.item_category ORDER BY i.item_category
SELECT i.item_category AS CATEGORY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN o.quantity ELSE 0 END) as MONDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN o.quantity ELSE 0 END) as TUESDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN o.quantity ELSE 0 END) as WEDNESDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN o.quantity ELSE 0 END) as THURSDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN o.quantity ELSE 0 END) as FRIDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN o.quantity ELSE 0 END) as SATURDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN o.quantity ELSE 0 END) as SUNDAY FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY 1 ORDER BY 1
SELECT i.item_category AS CATEGORY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN quantity ELSE 0 END) AS MONDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN quantity ELSE 0 END) AS TUESDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN quantity ELSE 0 END) AS WEDNESDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN quantity ELSE 0 END) AS THURSDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN quantity ELSE 0 END) AS FRIDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN quantity ELSE 0 END) AS SATURDAY, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN quantity ELSE 0 END) AS SUNDAY FROM items i LEFT JOIN orders o ON i.item_id = o.item_id GROUP BY i.item_category ORDER BY i.item_category
SELECT i.item_category AS Category ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN o.quantity ELSE 0 END) AS 'Monday' ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN o.quantity ELSE 0 END) AS 'Tuesday' ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN o.quantity ELSE 0 END) AS 'Wednesday' ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN o.quantity ELSE 0 END) AS 'Thursday' ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN o.quantity ELSE 0 END) AS 'Friday' ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN o.quantity ELSE 0 END) AS 'Saturday' ,SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN o.quantity ELSE 0 END) AS 'Sunday' FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY 1 ORDER BY 1
SELECT i.item_category AS Category, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 2 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Monday`, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 3 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Tuesday`, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 4 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Wednesday`, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 5 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Thursday`, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 6 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Friday`, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 7 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Saturday`, COALESCE(SUM((SELECT SUM(o.quantity) FROM Orders o WHERE DAYOFWEEK(order_date) = 1 AND o.item_id = i.item_id GROUP BY o.item_id)), 0) AS `Sunday` FROM Items i GROUP BY i.item_category Order BY Category
SELECT i.item_category AS Category, SUM( CASE WHEN WEEKDAY(o.order_date) = 0 THEN o.quantity ELSE 0 END) AS Monday, SUM( CASE WHEN WEEKDAY(o.order_date) = 1 THEN o.quantity ELSE 0 END) AS Tuesday, SUM( CASE WHEN WEEKDAY(o.order_date) = 2 THEN o.quantity ELSE 0 END) AS Wednesday, SUM( CASE WHEN WEEKDAY(o.order_date) = 3 THEN o.quantity ELSE 0 END) AS Thursday, SUM( CASE WHEN WEEKDAY(o.order_date) = 4 THEN o.quantity ELSE 0 END) AS Friday, SUM( CASE WHEN WEEKDAY(o.order_date) = 5 THEN o.quantity ELSE 0 END) AS Saturday, SUM( CASE WHEN WEEKDAY(o.order_date) = 6 THEN o.quantity ELSE 0 END) AS Sunday FROM items i LEFT JOIN orders o ON i.item_id = o.item_id GROUP BY i.item_category ORDER BY Category
SELECT i.item_category AS Category, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN o.quantity ELSE 0 END) AS Monday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN o.quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN o.quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN o.quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN o.quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN o.quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN o.quantity ELSE 0 END) AS Sunday FROM Items i LEFT JOIN Orders o ON o.item_id=i.item_id GROUP BY i.item_category Order by i.item_category
SELECT i.item_category AS Category, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN quantity ELSE 0 END) AS Sunday FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY i.item_category ORDER BY i.item_category
SELECT i.item_category AS Category, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN quantity ELSE 0 END) AS Sunday FROM Items i left JOIN Orders o ON i.item_id = o.item_id GROUP BY i.item_category ORDER BY i.item_category
SELECT i.item_category AS Category, SUM(CASE WHEN T.weekday =0 THEN T.quantity ELSE 0 END) AS 'MONDAY', SUM(CASE WHEN T.weekday=1 THEN T.quantity ELSE 0 END) AS 'Tuesday', SUM(CASE WHEN T.weekday =2 THEN T.quantity ELSE 0 END) AS 'WEDNESDAY', SUM(CASE WHEN T.weekday =3 THEN T.quantity ELSE 0 END) AS 'THURSDAY', SUM(CASE WHEN T.weekday =4 THEN T.quantity ELSE 0 END) AS 'FRIDAY', SUM(CASE WHEN T.weekday =5 THEN T.quantity ELSE 0 END) AS 'SATURDAY', SUM(CASE WHEN T.weekday =6 THEN T.quantity ELSE 0 END) AS 'SUNDAY' FROM Items i LEFT JOIN (SELECT o.item_id, i1.item_category, WEEKDAY(o.order_date) as weekday, SUM(o.quantity) AS quantity FROM Orders o LEFT JOIN Items i1 USING(item_id) GROUP BY weekday, i1.item_category) AS T USING(item_id) GROUP BY 1 ORDER BY 1
SELECT i.item_category AS Category, SUM(CASE WHEN weekday(o.order_date) = 0 THEN o.quantity ELSE 0 END) AS Monday, SUM(CASE WHEN weekday(o.order_date) = 1 THEN o.quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN weekday(o.order_date) = 2 THEN o.quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN weekday(o.order_date) = 3 THEN o.quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN weekday(o.order_date) = 4 THEN o.quantity ELSE 0 END) AS Friday, SUM(CASE WHEN weekday(o.order_date) = 5 THEN o.quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN weekday(o.order_date) = 6 THEN o.quantity ELSE 0 END) AS Sunday FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY i.item_category ORDER BY i.item_category
SELECT i.item_category AS category, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN o.quantity ELSE 0 END) AS "Monday", SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN o.quantity ELSE 0 END) AS "Tuesday", SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN o.quantity ELSE 0 END) AS "Wednesday", SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN o.quantity ELSE 0 END) AS "Thursday", SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN o.quantity ELSE 0 END) AS "Friday", SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN o.quantity ELSE 0 END) AS "Saturday", SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN o.quantity ELSE 0 END) AS "Sunday" FROM orders o RIGHT JOIN items i ON o.item_id = i.item_id GROUP BY i.item_category ORDER BY category
SELECT i.item_category AS category, SUM(CASE WHEN WEEKDAY(order_date) = 0 THEN quantity ELSE 0 END) AS 'Monday', SUM(CASE WHEN WEEKDAY(order_date) = 1 THEN quantity ELSE 0 END) AS 'Tuesday', SUM(CASE WHEN WEEKDAY(order_date) = 2 THEN quantity ELSE 0 END) AS 'Wednesday', SUM(CASE WHEN WEEKDAY(order_date) = 3 THEN quantity ELSE 0 END) AS 'Thursday', SUM(CASE WHEN WEEKDAY(order_date) = 4 THEN quantity ELSE 0 END) AS 'Friday', SUM(CASE WHEN WEEKDAY(order_date) = 5 THEN quantity ELSE 0 END) AS 'Saturday', SUM(CASE WHEN WEEKDAY(order_date) = 6 THEN quantity ELSE 0 END) AS 'Sunday' FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY i.item_category ORDER BY category
SELECT i.item_category As Category, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN o.quantity ELSE 0 END) As Monday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN o.quantity ELSE 0 END) As Tuesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN o.quantity ELSE 0 END) As Wednesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN o.quantity ELSE 0 END) As Thursday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN o.quantity ELSE 0 END) As Friday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN o.quantity ELSE 0 END) As Saturday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN o.quantity ELSE 0 END) As Sunday from Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY i.item_category ORDER BY i.item_category ASC
SELECT i.item_category as Category, SUM(CASE WHEN DAYOFWEEK(order_date) = 2 THEN quantity ELSE 0 END) as Monday, SUM(CASE WHEN DAYOFWEEK(order_date) = 3 THEN quantity ELSE 0 END) as Tuesday, SUM(CASE WHEN DAYOFWEEK(order_date) = 4 THEN quantity ELSE 0 END) as Wednesday, SUM(CASE WHEN DAYOFWEEK(order_date) = 5 THEN quantity ELSE 0 END) as Thursday, SUM(CASE WHEN DAYOFWEEK(order_date) = 6 THEN quantity ELSE 0 END) as Friday, SUM(CASE WHEN DAYOFWEEK(order_date) = 7 THEN quantity ELSE 0 END) as Saturday, SUM(CASE WHEN DAYOFWEEK(order_date) = 1 THEN quantity ELSE 0 END) as Sunday FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY 1 ORDER BY 1
SELECT i.item_category as Category, SUM(CASE WHEN DAYOFWEEK(order_date)=2 THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN DAYOFWEEK(order_date)=3 THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAYOFWEEK(order_date)=4 THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAYOFWEEK(order_date)=5 THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN DAYOFWEEK(order_date)=6 THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAYOFWEEK(order_date)=7 THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN DAYOFWEEK(order_date)=1 THEN quantity ELSE 0 END) AS Sunday FROM Items i LEFT JOIN Orders o ON i.item_id=o.item_id GROUP BY i.item_category ORDER BY 1
SELECT i.item_category as Category, sum(case when weekday(o.order_date)=0 then o.quantity else 0 end) as 'Monday', sum(case when weekday(o.order_date)=1 then o.quantity else 0 end) as 'Tuesday', sum(case when weekday(o.order_date)=2 then o.quantity else 0 end) as 'Wednesday', sum(case when weekday(o.order_date)=3 then o.quantity else 0 end) as 'Thursday', sum(case when weekday(o.order_date)=4 then o.quantity else 0 end) as 'Friday', sum(case when weekday(o.order_date)=5 then o.quantity else 0 end) as 'Saturday', sum(case when weekday(o.order_date)=6 then o.quantity else 0 end) as 'Sunday' FROM Items as i LEFT JOIN ORDERS AS o on i.item_id = o.item_id Group by Category ORDER BY Category
SELECT ic.item_category AS 'Category', SUM(IF(DAYOFWEEK(o.order_date) = 2, o.quantity, 0)) AS 'Monday', SUM(IF(DAYOFWEEK(o.order_date) = 3, o.quantity, 0)) AS 'Tuesday', SUM(IF(DAYOFWEEK(o.order_date) = 4, o.quantity, 0)) AS 'Wednesday', SUM(IF(DAYOFWEEK(o.order_date) = 5, o.quantity, 0)) AS 'Thursday', SUM(IF(DAYOFWEEK(o.order_date) = 6, o.quantity, 0)) AS 'Friday', SUM(IF(DAYOFWEEK(o.order_date) = 7, o.quantity, 0)) AS 'Saturday', SUM(IF(DAYOFWEEK(o.order_date) = 1, o.quantity, 0)) AS 'Sunday' FROM Orders o LEFT JOIN Items i ON o.item_id = i.item_id RIGHT JOIN (SELECT DISTINCT item_category FROM Items ) ic ON ic.item_category = i.item_category GROUP BY i.item_category ORDER BY ic.item_category
SELECT item_Category 'CATEGORY', SUM(CASE WHEN DAYOFWEEK(order_date)=2 THEN quantity ELSE 0 END) 'MONDAY', SUM(CASE WHEN DAYOFWEEK(order_date)=3 THEN quantity ELSE 0 END) 'TUESDAY', SUM(CASE WHEN DAYOFWEEK(order_date)=4 THEN quantity ELSE 0 END) 'WEDNESDAY', SUM(CASE WHEN DAYOFWEEK(order_date)=5 THEN quantity ELSE 0 END) 'THURSDAY', SUM(CASE WHEN DAYOFWEEK(order_date)=6 THEN quantity ELSE 0 END) 'FRIDAY', SUM(CASE WHEN DAYOFWEEK(order_date)=7 THEN quantity ELSE 0 END) 'SATURDAY', SUM(CASE WHEN DAYOFWEEK(order_date)=1 THEN quantity ELSE 0 END) 'SUNDAY' FROM Items i LEFT JOIN Orders o ON i.item_id=o.item_id GROUP BY i.item_Category ORDER BY i.item_Category
SELECT item_category 'CATEGORY', SUM(IF(dayofweek(order_date) = 2, quantity,0)) AS 'MONDAY', SUM(IF(dayofweek(order_date) = 3, quantity,0)) AS 'TUESDAY', SUM(IF(dayofweek(order_date) = 4, quantity,0)) AS 'WEDNESDAY', SUM(IF(dayofweek(order_date) = 5, quantity,0)) AS 'THURSDAY', SUM(IF(dayofweek(order_date) = 6, quantity,0)) AS 'FRIDAY', SUM(IF(dayofweek(order_date) = 7, quantity,0)) AS 'SATURDAY', SUM(IF(dayofweek(order_date) = 1, quantity,0)) AS 'SUNDAY' FROM Items LEFT JOIN Orders USING(item_id) GROUP BY 1 ORDER BY 1
SELECT item_category AS 'Category', SUM(IF(WEEKDAY(o.order_date) = 0, o.quantity, 0)) AS 'Monday', SUM(IF(WEEKDAY(o.order_date) = 1, o.quantity, 0)) AS 'Tuesday', SUM(IF(WEEKDAY(o.order_date) = 2, o.quantity, 0)) AS 'Wednesday', SUM(IF(WEEKDAY(o.order_date) = 3, o.quantity, 0)) AS 'Thursday', SUM(IF(WEEKDAY(o.order_date) = 4, o.quantity, 0)) AS 'Friday', SUM(IF(WEEKDAY(o.order_date) = 5, o.quantity, 0)) AS 'Saturday', SUM(IF(WEEKDAY(o.order_date) = 6, o.quantity, 0)) AS 'Sunday' FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY Category ORDER BY Category
SELECT item_category AS CATEGORY, SUM(CASE WHEN dow = 2 THEN sales ELSE 0 END) AS 'MONDAY', SUM(CASE WHEN dow = 3 THEN sales ELSE 0 END) AS 'TUESDAY', SUM(CASE WHEN dow = 4 THEN sales ELSE 0 END) AS 'WEDNESDAY', SUM(CASE WHEN dow = 5 THEN sales ELSE 0 END) AS 'THURSDAY', SUM(CASE WHEN dow = 6 THEN sales ELSE 0 END) AS 'FRIDAY', SUM(CASE WHEN dow = 7 THEN sales ELSE 0 END) AS 'SATURDAY', SUM(CASE WHEN dow = 1 THEN sales ELSE 0 END) AS 'SUNDAY' FROM( SELECT DAYOFWEEK(order_date) AS dow, item_category, SUM(quantity) AS sales FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY 1,2 ) t1 GROUP BY item_category ORDER BY item_category
SELECT item_category AS Category, SUM(CASE WHEN WEEKDAY(order_date) = 0 THEN quantity ELSE 0 END) AS "Monday", SUM(CASE WHEN WEEKDAY(order_date) = 1 THEN quantity ELSE 0 END) AS "Tuesday", SUM(CASE WHEN WEEKDAY(order_date) = 2 THEN quantity ELSE 0 END) AS "Wednesday", SUM(CASE WHEN WEEKDAY(order_date) = 3 THEN quantity ELSE 0 END) AS "Thursday", SUM(CASE WHEN WEEKDAY(order_date) = 4 THEN quantity ELSE 0 END) AS "Friday", SUM(CASE WHEN WEEKDAY(order_date) = 5 THEN quantity ELSE 0 END) AS "Saturday", SUM(CASE WHEN WEEKDAY(order_date) = 6 THEN quantity ELSE 0 END) AS "Sunday" FROM Orders A RIGHT JOIN Items B ON A.item_id = B.item_id GROUP BY item_category ORDER BY item_category
SELECT item_category AS Category, SUM(IF(DAYOFWEEK(order_date) = 2, o.quantity, 0)) AS `Monday`, SUM(IF(DAYOFWEEK(order_date) = 3, o.quantity, 0)) AS `Tuesday`, SUM(IF(DAYOFWEEK(order_date) = 4, o.quantity, 0)) AS `Wednesday`, SUM(IF(DAYOFWEEK(order_date) = 5, o.quantity, 0)) AS `Thursday`, SUM(IF(DAYOFWEEK(order_date) = 6, o.quantity, 0)) AS `Friday`, SUM(IF(DAYOFWEEK(order_date) = 7, o.quantity, 0)) AS `Saturday`, SUM(IF(DAYOFWEEK(order_date) = 1, o.quantity, 0)) AS `Sunday` FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY i.item_category Order BY Category
SELECT item_category AS Category, SUM(IF(DAYOFWEEK(order_date) = 2, quantity, 0)) AS Monday, SUM(IF(DAYOFWEEK(order_date) = 3, quantity, 0)) AS Tuesday, SUM(IF(DAYOFWEEK(order_date) = 4, quantity, 0)) AS Wednesday, SUM(IF(DAYOFWEEK(order_date) = 5, quantity, 0)) AS Thursday, SUM(IF(DAYOFWEEK(order_date) = 6, quantity, 0)) AS Friday, SUM(IF(DAYOFWEEK(order_date) = 7, quantity, 0)) AS Saturday, SUM(IF(DAYOFWEEK(order_date) = 1, quantity, 0)) AS Sunday FROM Items LEFT JOIN Orders USING(item_id) GROUP BY Category ORDER BY Category
SELECT item_category AS Category, SUM(IF(DAYOFWEEK(order_date)=2, quantity, 0)) AS Monday, SUM(IF(DAYOFWEEK(order_date)=3, quantity, 0)) AS Tuesday, SUM(IF(DAYOFWEEK(order_date)=4, quantity, 0)) AS Wednesday, SUM(IF(DAYOFWEEK(order_date)=5, quantity, 0)) AS Thursday, SUM(IF(DAYOFWEEK(order_date)=6, quantity, 0)) AS Friday, SUM(IF(DAYOFWEEK(order_date)=7, quantity, 0)) AS Saturday, SUM(IF(DAYOFWEEK(order_date)=1, quantity, 0)) AS Sunday FROM Orders A RIGHT JOIN Items B ON A.item_id = B.item_id GROUP BY item_category ORDER BY item_category
SELECT item_category AS Category, SUM(IF(WEEKDAY(order_date) = 0, quantity, 0)) AS Monday, SUM(IF(WEEKDAY(order_date) = 1, quantity, 0)) AS Tuesday, SUM(IF(WEEKDAY(order_date) = 2, quantity, 0)) AS Wednesday, SUM(IF(WEEKDAY(order_date) = 3, quantity, 0)) AS Thursday, SUM(IF(WEEKDAY(order_date) = 4, quantity, 0)) AS Friday, SUM(IF(WEEKDAY(order_date) = 5, quantity, 0)) AS Saturday, SUM(IF(WEEKDAY(order_date) = 6, quantity, 0)) AS Sunday FROM Items LEFT JOIN Orders USING(item_id) GROUP BY Category ORDER BY Category
SELECT item_category AS Category, SUM(IF(WEEKDAY(order_date)=0, quantity, 0)) AS Monday, SUM(IF(WEEKDAY(order_date)=1, quantity, 0)) AS Tuesday, SUM(IF(WEEKDAY(order_date)=2, quantity, 0)) AS Wednesday, SUM(IF(WEEKDAY(order_date)=3, quantity, 0)) AS Thursday, SUM(IF(WEEKDAY(order_date)=4, quantity, 0)) AS Friday, SUM(IF(WEEKDAY(order_date)=5, quantity, 0)) AS Saturday, SUM(IF(WEEKDAY(order_date)=6, quantity, 0)) AS Sunday FROM items i LEFT JOIN orders o ON i.item_id = o.item_id GROUP BY item_category ORDER BY item_category
SELECT item_category AS category, SUM(CASE WHEN DAYOFWEEK(order_Date) = 2 THEN quantity ELSE 0 END) AS 'Monday', SUM(CASE WHEN DAYOFWEEK(order_Date) = 3 THEN quantity ELSE 0 END) AS 'Tuesday', SUM(CASE WHEN DAYOFWEEK(order_Date) = 4 THEN quantity ELSE 0 END) AS 'Wednesday', SUM(CASE WHEN DAYOFWEEK(order_Date) = 5 THEN quantity ELSE 0 END) AS 'Thursday', SUM(CASE WHEN DAYOFWEEK(order_Date) = 6 THEN quantity ELSE 0 END) AS 'Friday', SUM(CASE WHEN DAYOFWEEK(order_Date) = 7 THEN quantity ELSE 0 END) AS 'Saturday', SUM(CASE WHEN DAYOFWEEK(order_Date) = 1 THEN quantity ELSE 0 END) AS 'Sunday' FROM orders o RIGHT JOIN items i ON o.item_id = i.item_id GROUP BY item_category ORDER BY 1
SELECT item_category CATEGORY, SUM(CASE WHEN DAYOFWEEK(order_date)=2 THEN quantity ELSE 0 END) MONDAY, SUM(CASE WHEN DAYOFWEEK(order_date)=3 THEN quantity ELSE 0 END) TUESDAY, SUM(CASE WHEN DAYOFWEEK(order_date)=4 THEN quantity ELSE 0 END) WEDNESDAY, SUM(CASE WHEN DAYOFWEEK(order_date)=5 THEN quantity ELSE 0 END) THURSDAY, SUM(CASE WHEN DAYOFWEEK(order_date)=6 THEN quantity ELSE 0 END) FRIDAY, SUM(CASE WHEN DAYOFWEEK(order_date)=7 THEN quantity ELSE 0 END) SATURDAY, SUM(CASE WHEN DAYOFWEEK(order_date)=1 THEN quantity ELSE 0 END) SUNDAY FROM Items LEFT JOIN Orders USING (item_id) GROUP BY Category ORDER BY Category
SELECT item_category as 'CATEGORY', sum(case when weekday(a.order_date) = 0 then a.quantity else 0 end) as 'MONDAY', sum(case when weekday(a.order_date) = 1 then a.quantity else 0 end) as 'TUESDAY', sum(case when weekday(a.order_date) = 2 then a.quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(a.order_date) = 3 then a.quantity else 0 end) as 'THURSDAY', sum(case when weekday(a.order_date) = 4 then a.quantity else 0 end) as 'FRIDAY', sum(case when weekday(a.order_date) = 5 then a.quantity else 0 end) as 'SATURDAY', sum(case when weekday(a.order_date) = 6 then a.quantity else 0 end) as 'SUNDAY' FROM ORDERS AS A RIGHT JOIN ITEMS AS B ON A.ITEM_ID = B.ITEM_ID GROUP BY item_category ORDER BY item_category
SELECT item_category as CATEGORY, SUM(CASE WHEN DAYOFWEEK(order_date) = 2 THEN quantity ELSE 0 END) as MONDAY, SUM(CASE WHEN DAYOFWEEK(order_date) = 3 THEN quantity ELSE 0 END) as TUESDAY, SUM(CASE WHEN DAYOFWEEK(order_date) = 4 THEN quantity ELSE 0 END) as WEDNESDAY, SUM(CASE WHEN DAYOFWEEK(order_date) = 5 THEN quantity ELSE 0 END) as THURSDAY, SUM(CASE WHEN DAYOFWEEK(order_date) = 6 THEN quantity ELSE 0 END) as FRIDAY, SUM(CASE WHEN DAYOFWEEK(order_date) = 7 THEN quantity ELSE 0 END) as SATURDAY, SUM(CASE WHEN DAYOFWEEK(order_date) = 1 THEN quantity ELSE 0 END) as SUNDAY FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY item_category ORDER BY item_category
SELECT item_category as Category , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 2 then quantity else 0 end),0) as Monday , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 3 then quantity else 0 end),0) as Tuesday , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 4 then quantity else 0 end),0) as Wednesday , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 5 then quantity else 0 end),0) as Thursday , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 6 then quantity else 0 end),0) as Friday , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 7 then quantity else 0 end),0) as Saturday , coalesce(sum(CASE WHEN DAYOFWEEK(order_date) = 1 then quantity else 0 end),0) as Sunday FROM Items i LEFT JOIN Orders o on i.item_id = o.item_id GROUP BY category order BY category
SELECT item_category as Category, SUM(CASE WHEN DAYNAME(order_date) = 'Monday' THEN quantity ELSE 0 END) as Monday, SUM(CASE WHEN DAYNAME(order_date) = 'Tuesday' THEN quantity ELSE 0 END) as Tuesday, SUM(CASE WHEN DAYNAME(order_date) = 'Wednesday' THEN quantity ELSE 0 END) as Wednesday, SUM(CASE WHEN DAYNAME(order_date) = 'Thursday' THEN quantity ELSE 0 END) as Thursday, SUM(CASE WHEN DAYNAME(order_date) = 'Friday' THEN quantity ELSE 0 END) as Friday, SUM(CASE WHEN DAYNAME(order_date) = 'Saturday' THEN quantity ELSE 0 END) as Saturday, SUM(CASE WHEN DAYNAME(order_date) = 'Sunday' THEN quantity ELSE 0 END) as Sunday FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY item_category ORDER BY item_category
SELECT item_category as Category, sum(case when weekday(order_date) = 0 THEN quantity ELSE 0 END ) as Monday, sum(case when weekday(order_date) = 1 THEN quantity ELSE 0 END ) as Tuesday, sum(case when weekday(order_date) = 2 THEN quantity ELSE 0 END ) as Wednesday, sum(case when weekday(order_date) = 3 THEN quantity ELSE 0 END ) as Thursday, sum(case when weekday(order_date) = 4 THEN quantity ELSE 0 END ) as Friday, sum(case when weekday(order_date) = 5 THEN quantity ELSE 0 END ) as Saturday, sum(case when weekday(order_date) = 6 THEN quantity ELSE 0 END ) as Sunday FROM items left join orders using (item_id) group by item_category order by item_category
SELECT item_category as category, SUM(CASE WHEN day = 2 THEN quantity ELSE 0 END) as Monday, SUM(CASE WHEN day = 3 THEN quantity ELSE 0 END) as Tuesday, SUM(CASE WHEN day = 4 THEN quantity ELSE 0 END) as Wednesday, SUM(CASE WHEN day = 5 THEN quantity ELSE 0 END) as Thursday, SUM(CASE WHEN day = 6 THEN quantity ELSE 0 END) as Friday, SUM(CASE WHEN day = 7 THEN quantity ELSE 0 END) as Saturday, SUM(CASE WHEN day = 1 THEN quantity ELSE 0 END) as Sunday FROM (SELECT dayofweek(order_date) as day, item_category, quantity FROM items i LEFT JOIN orders o ON o.item_id = i.item_id) a GROUP BY 1 ORDER BY 1
SELECT item_category as category, SUM(CASE WHEN dayofweek(order_date) = 2 THEN COALESCE(quantity, 0) ELSE 0 END) as Monday, SUM(CASE WHEN dayofweek(order_date) = 3 THEN COALESCE(quantity, 0) ELSE 0 END) as Tuesday, SUM(CASE WHEN dayofweek(order_date) = 4 THEN COALESCE(quantity, 0) ELSE 0 END) as Wednesday, SUM(CASE WHEN dayofweek(order_date) = 5 THEN COALESCE(quantity, 0) ELSE 0 END) as Thursday, SUM(CASE WHEN dayofweek(order_date) = 6 THEN COALESCE(quantity, 0) ELSE 0 END) as Friday, SUM(CASE WHEN dayofweek(order_date) = 7 THEN COALESCE(quantity, 0) ELSE 0 END) as Saturday, SUM(CASE WHEN dayofweek(order_date) = 1 THEN COALESCE(quantity, 0) ELSE 0 END) as Sunday FROM items as i LEFT JOIN orders as o ON o.item_id = i.item_id GROUP BY category ORDER BY category
SELECT item_category as category, sum(case when weekday(order_date) = 0 then quantity else 0 end) as 'Monday', sum(case when weekday(order_date) = 1 then quantity else 0 end) as 'Tuesday', sum(case when weekday(order_date) = 2 then quantity else 0 end) as 'Wednesday', sum(case when weekday(order_date) = 3 then quantity else 0 end) as 'Thursday', sum(case when weekday(order_date) = 4 then quantity else 0 end) as 'Friday', sum(case when weekday(order_date) = 5 then quantity else 0 end) as 'Saturday', sum(case when weekday(order_date) = 6 then quantity else 0 end) as 'Sunday' FROM items i left JOIN orders o ON i.item_id = o.item_id group by item_category order by item_category
SELECT k.item_category as Category, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=2 THEN k.quantity END),0) as Monday, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=3 THEN k.quantity END),0) as Tuesday, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=4 THEN k.quantity END),0) as Wednesday, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=5 THEN k.quantity END),0) as Thursday, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=6 THEN k.quantity END),0) as Friday, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=7 THEN k.quantity END),0) as Saturday, COALESCE(SUM(CASE WHEN DAYOFWEEK(k.order_date)=1 THEN k.quantity END),0) as Sunday FROM (SELECT a.item_id, a.item_category, b.order_id, b.order_date,b.quantity FROM items a LEFT JOIN orders b ON a.item_id=b.item_id)k GROUP BY k.item_category ORDER BY k.item_category
SELECT t1.item_category AS Category, SUM(CASE WHEN WEEKDAY(t2.order_date) = 0 THEN t2.quantity ELSE 0 END) AS Monday, SUM(CASE WHEN WEEKDAY(t2.order_date) = 1 THEN t2.quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN WEEKDAY(t2.order_date) = 2 THEN t2.quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN WEEKDAY(t2.order_date) = 3 THEN t2.quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN WEEKDAY(t2.order_date) = 4 THEN t2.quantity ELSE 0 END) AS Friday, SUM(CASE WHEN WEEKDAY(t2.order_date) = 5 THEN t2.quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN WEEKDAY(t2.order_date) = 6 THEN t2.quantity ELSE 0 END) AS Sunday FROM items AS t1 LEFT JOIN orders AS t2 ON t1.item_id = t2.item_id GROUP BY t1.item_category ORDER BY t1.item_category
SELECT t1.item_category AS Category, SUM(CASE WHEN dayname(t2.order_date) = 'Monday' THEN t2.quantity ELSE 0 END) AS Monday, SUM(CASE WHEN dayname(t2.order_date) = 'Tuesday' THEN t2.quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN dayname(t2.order_date) = 'Wednesday' THEN t2.quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN dayname(t2.order_date) = 'Thursday' THEN t2.quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN dayname(t2.order_date) = 'Friday' THEN t2.quantity ELSE 0 END) AS Friday, SUM(CASE WHEN dayname(t2.order_date) = 'Saturday' THEN t2.quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN dayname(t2.order_date) = 'Sunday' THEN t2.quantity ELSE 0 END) AS Sunday FROM items AS t1 LEFT JOIN orders AS t2 ON t1.item_id = t2.item_id GROUP BY t1.item_category ORDER BY t1.item_category
SELECT tb1.item_category as 'CATEGORY', SUM(CASE WHEN weekday(tb2.order_date) = 0 THEN tb2.quantity ELSE 0 END) AS 'MONDAY', SUM(CASE WHEN weekday(tb2.order_date) = 1 THEN tb2.quantity ELSE 0 END) AS 'TUESDAY', SUM(CASE WHEN weekday(tb2.order_date) = 2 THEN tb2.quantity ELSE 0 END) AS 'WEDNESDAY', SUM(CASE WHEN weekday(tb2.order_date) = 3 THEN tb2.quantity ELSE 0 END) AS 'THURSDAY', SUM(CASE WHEN weekday(tb2.order_date) = 4 THEN tb2.quantity ELSE 0 END) AS 'FRIDAY', SUM(CASE WHEN weekday(tb2.order_date) = 5 THEN tb2.quantity ELSE 0 END) AS 'SATURDAY', SUM(CASE WHEN weekday(tb2.order_date) = 6 THEN tb2.quantity ELSE 0 END) AS 'SUNDAY' FROM items AS tb1 LEFT JOIN Orders AS tb2 ON tb1.item_id = tb2.item_id GROUP BY tb1.item_category ORDER BY tb1.item_category
SELECT tb1.item_category as 'CATEGORY', SUM(CASE WHEN weekday(tb2.order_date) = 0 THEN tb2.quantity ELSE 0 END) AS 'MonDAY', SUM(CASE WHEN weekday(tb2.order_date) = 1 THEN tb2.quantity ELSE 0 END) AS 'Tuesday', SUM(CASE WHEN weekday(tb2.order_date) = 2 THEN tb2.quantity ELSE 0 END) AS 'Wednesday', SUM(CASE WHEN weekday(tb2.order_date) = 3 THEN tb2.quantity ELSE 0 END) AS 'Thursday', SUM(CASE WHEN weekday(tb2.order_date) = 4 THEN tb2.quantity ELSE 0 END) AS 'Friday', SUM(CASE WHEN weekday(tb2.order_date) = 5 THEN tb2.quantity ELSE 0 END) AS 'Saturday', SUM(CASE WHEN weekday(tb2.order_date) = 6 THEN tb2.quantity ELSE 0 END) AS 'Sunday' FROM items AS tb1 LEFT JOIN Orders AS tb2 ON tb1.item_id = tb2.item_id GROUP BY tb1.item_category ORDER BY tb1.item_category
Select B.category, SUM(Case when order_date=2 then quantity else 0 end) as Monday, SUM(Case when order_date=3 then quantity else 0 end) as Tuesday, SUM(Case when order_date=4 then quantity else 0 end) as Wednesday, SUM(Case when order_date=5 then quantity else 0 end) as Thursday, SUM(Case when order_date=6 then quantity else 0 end) as Friday, SUM(Case when order_date=7 then quantity else 0 end) as Saturday, SUM(Case when order_date=1 then quantity else 0 end) as Sunday From (Select I.item_category as category, DAYOFWEEK(O.order_date) as order_date, O.quantity From Orders O Join Items I On O.item_id=I.item_id) A Right Join (Select distinct item_category as category From Items) B On A.category = B.category Group by B.category Order by B.category
Select I.item_category as category, SUM(Case when DAYOFWEEK(O.order_date)=2 then quantity else 0 end) as Monday, SUM(Case when DAYOFWEEK(O.order_date)=3 then quantity else 0 end) as Tuesday, SUM(Case when DAYOFWEEK(O.order_date)=4 then quantity else 0 end) as Wednesday, SUM(Case when DAYOFWEEK(O.order_date)=5 then quantity else 0 end) as Thursday, SUM(Case when DAYOFWEEK(O.order_date)=6 then quantity else 0 end) as Friday, SUM(Case when DAYOFWEEK(O.order_date)=7 then quantity else 0 end) as Saturday, SUM(Case when DAYOFWEEK(O.order_date)=1 then quantity else 0 end) as Sunday From Orders O Right Join Items I On O.item_id=I.item_id Group by I.item_category Order by I.item_category
Select b.item_category as category, sum(case when weekday(order_date)=0 then quantity else 0 end ) as 'Monday', sum(case when weekday(order_date)=1 then quantity else 0 end ) as 'Tuesday', sum(case when weekday(order_date)=2 then quantity else 0 end ) as 'Wednesday', sum(case when weekday(order_date)=3 then quantity else 0 end ) as 'Thursday', sum(case when weekday(order_date)=4 then quantity else 0 end ) as 'Friday', sum(case when weekday(order_date)=5 then quantity else 0 end ) as 'Saturday', sum(case when weekday(order_date)=6 then quantity else 0 end ) as 'Sunday' from orders as a right join items b on a.item_id=b.item_id group by b.item_category order by b.item_category
Select i.item_category as CATEGORY, IFNULL(SUM(case when DayName(o.order_date) = 'Monday' then o.quantity end),0) as 'MONDAY', IFNULL(SUM(case when DayName(o.order_date) = 'Tuesday' then o.quantity end),0) as 'TUESDAY', IFNULL(SUM(case when DayName(o.order_date) = 'Wednesday' then o.quantity end),0) as 'WEDNESDAY', IFNULL(SUM(case when DayName(o.order_date) = 'Thursday' then o.quantity end),0) as 'THURSDAY', IFNULL(SUM(case when DayName(o.order_date) = 'Friday' then o.quantity end),0) as 'FRIDAY', IFNULL(SUM(case when DayName(o.order_date) = 'Saturday' then o.quantity end),0) as 'SATURDAY', IFNULL(SUM(case when DayName(o.order_date) = 'Sunday' then o.quantity end),0) as 'SUNDAY' From Orders as o Right Join Items as i Using (item_id) Group By CATEGORY ORDER BY CATEGORY
Select i.item_category as CATEGORY, SUM(CASE when DAYOFWEEK(o.order_date)=2 then (o.quantity) else 0 end) as MONDAY,SUM(case when DAYOFWEEK(o.order_date)=3 then (o.quantity) else 0 end) as TUESDAY,SUM(case when DAYOFWEEK(o.order_date)=4 then (o.quantity) else 0 end) as WEDNESDAY,SUM(case when DAYOFWEEK(o.order_date)=5 then (o.quantity) else 0 end) as THURSDAY,SUM(case when DAYOFWEEK(o.order_date)=6 then (o.quantity) else 0 end) as FRIDAY,SUM(case when DAYOFWEEK(o.order_date)=7 then (o.quantity) else 0 end) as SATURDAY,SUM(case when DAYOFWEEK(o.order_date)=1 then (o.quantity) else 0 end) as SUNDAY from Orders o right join Items i on o.item_id=i.item_id group by i.item_category order by i.item_category
Select i.item_category as Category, sum(case dayofweek(o.order_date) when 2 then quantity else 0 end) as Monday, sum(case dayofweek(o.order_date) when 3 then quantity else 0 end) as Tuesday, sum(case dayofweek(o.order_date) when 4 then quantity else 0 end) as Wednesday, sum(case dayofweek(o.order_date) when 5 then quantity else 0 end) as Thursday, sum(case dayofweek(o.order_date) when 6 then quantity else 0 end) as Friday, sum(case dayofweek(o.order_date) when 7 then quantity else 0 end) as Saturday, sum(case dayofweek(o.order_date) when 1 then quantity else 0 end) as Sunday from Orders o right outer join Items i on o.item_id=i.item_id group by i.item_category order by i.item_category
Select item_category as CATEGORY, SUM(CASE WHEN (weekday(order_date) = 0) THEN quantity ELSE 0 END ) AS 'MONDAY', SUM(CASE WHEN (weekday(order_date) = 1) THEN quantity ELSE 0 END ) AS 'TUESDAY', SUM(CASE WHEN (weekday(order_date) = 2) THEN quantity ELSE 0 END ) AS 'WEDNESDAY', SUM(CASE WHEN (weekday(order_date) = 3) THEN quantity ELSE 0 END ) AS 'THURSDAY', SUM(CASE WHEN (weekday(order_date) = 4) THEN quantity ELSE 0 END ) AS 'FRIDAY', SUM(CASE WHEN (weekday(order_date) = 5) THEN quantity ELSE 0 END ) AS 'SATURDAY', SUM(CASE WHEN (weekday(order_date) = 6) THEN quantity ELSE 0 END ) AS 'SUNDAY' from items i left join orders o on i.item_id = o.item_id group by category order by category
Select item_category as category, SUM(CASE WHEN DAyNAME( order_date) = 'Monday' THEN quantity ELSE 0 END) as Monday, SUM(CASE WHEN DAyNAME( order_date) = 'Tuesday' THEN quantity ELSE 0 END) as Tuesday, SUM(CASE WHEN DAyNAME( order_date) = 'Wednesday' THEN quantity ELSE 0 END) as Wednesday, SUM(CASE WHEN DAyNAME( order_date) = 'Thursday' THEN quantity ELSE 0 END) as Thursday, SUM(CASE WHEN DAyNAME( order_date) = 'Friday' THEN quantity ELSE 0 END) as Friday, SUM(CASE WHEN DAyNAME( order_date) = 'Saturday' THEN quantity ELSE 0 END) as Saturday, SUM(CASE WHEN DAyNAME(order_date) = 'Sunday' THEN quantity ELSE 0 END) as Sunday FROM Orders as o RIGHT JOIN Items as i ON o.item_id = i.item_id GROUP BY item_category ORDER BY item_category
VALUES ROW(1),ROW(2), ROW(3), ROW(4), ROW(5), ROW(6), ROW(7) ), day_cat as ( SELECT * FROM (SELECT DISTINCT item_category as category FROM items) a, dayofweek d), day_sale as ( SELECT DAYOFWEEK(ORDER_DATE) as day, i.item_category as category, sum(quantity) as amount FROM Orders o JOIN Items i ON i.item_id = o.item_id GROUP BY day, i.item_category ), day_sale_complete as ( SELECT dc.day, dc.category, IFNULL(ds.amount,0) as amount FROM day_cat dc LEFT JOIN day_sale ds ON dc.day = ds.day AND dc.category = ds.category ) SELECT category, sum(IF(day = 2, amount,0)) as MONDAY, sum(IF(day = 3, amount,0)) as TUESDAY, sum(IF(day = 4, amount,0)) as WEDNESDAY, sum(IF(day = 5, amount,0)) as THURSDAY, sum(IF(day = 6, amount,0)) as FRIDAY, sum(IF(day = 7, amount,0)) as SATURDAY, sum(IF(day = 1, amount,0)) as SUNDAY FROM day_sale_complete GROUP BY category ORDER BY category
WITH CTE AS ( SELECT Orders.order_id, Orders.customer_id, Orders.order_date, Orders.item_id, Orders.quantity, Items.item_name, Items.item_category FROM Items LEFT JOIN Orders ON Items.item_id = Orders.item_id ) SELECT item_category as Category, SUM(CASE WHEN DAYNAME(order_date) = 'Monday' THEN quantity ELSE 0 END) as 'MONDAY', SUM(CASE WHEN DAYNAME(order_date) = 'Tuesday' THEN quantity ELSE 0 END) as 'TUESDAY', SUM(CASE WHEN DAYNAME(order_date) = 'Wednesday' THEN quantity ELSE 0 END) as 'WEDNESDAY', SUM(CASE WHEN DAYNAME(order_date) = 'Thursday' THEN quantity ELSE 0 END) as 'THURSDAY', SUM(CASE WHEN DAYNAME(order_date) = 'Friday' THEN quantity ELSE 0 END) as 'FRIDAY', SUM(CASE WHEN DAYNAME(order_date) = 'Saturday' THEN quantity ELSE 0 END) as 'SATURDAY', SUM(CASE WHEN DAYNAME(order_date) = 'Sunday' THEN quantity ELSE 0 END) as 'SUNDAY' FROM CTE GROUP BY item_category ORDER BY item_category
WITH CTE AS ( SELECT i.item_category, DATE_FORMAT(o.order_date, '%W') AS day, IFNULL(SUM(o.quantity), 0) AS total FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id GROUP BY i.item_category, day ) SELECT item_category AS Category, IFNULL(SUM(CASE WHEN day = 'Monday' THEN total END), 0) AS Monday, IFNULL(SUM(CASE WHEN day = 'Tuesday' THEN total END), 0) AS Tuesday, IFNULL(SUM(CASE WHEN day = 'Wednesday' THEN total END), 0) AS Wednesday, IFNULL(SUM(CASE WHEN day = 'Thursday' THEN total END), 0) AS Thursday, IFNULL(SUM(CASE WHEN day = 'Friday' THEN total END), 0) AS Friday, IFNULL(SUM(CASE WHEN day = 'Saturday' THEN total END), 0) AS Saturday, IFNULL(SUM(CASE WHEN day = 'Sunday' THEN total END), 0) AS Sunday FROM CTE GROUP BY Category ORDER BY Category
WITH CTE AS ( SELECT item_category ,DayOfWeek(order_date) as DOW, Coalesce(Sum(quantity),0) as qty From Orders O Left Join Items Using(item_id) Group by item_category,DayOfWeek(order_date) ), ItemCategory as (Select ItemC.item_category , DOW , SUM(qty) as QTY_N From (Select DISTINCT item_category from Items) ItemC Left Join CTE USING(item_category) Group by ItemC.item_category , DOW ) Select item_category as Category, coalesce(SUM(CASE WHEN DOW =2 then QTY_N END),0) AS "Monday", coalesce(SUM(CASE WHEN DOW =3 then QTY_N END),0) AS "Tuesday", coalesce(SUM(CASE WHEN DOW =4 then QTY_N END),0) AS "Wednesday", coalesce(SUM(CASE WHEN DOW =5 then QTY_N END),0) AS "Thursday", coalesce(SUM(CASE WHEN DOW =6 then QTY_N END),0) AS "Friday", coalesce(SUM(CASE WHEN DOW =7 then QTY_N End),0) AS "Saturday", coalesce(SUM(CASE WHEN DOW =1 then QTY_N END),0) AS "Sunday" FROM ItemCategory Group by item_category Order by item_category
WITH CategoryTable AS (SELECT t1.item_category, t2.order_date, SUM(t2.quantity) AS quantity FROM Items t1 LEFT JOIN Orders t2 ON t1.item_id = t2.item_id GROUP BY t1.item_category, t2.order_date) SELECT item_category AS Category, SUM(CASE WHEN DAYOFWEEK(order_date) = 2 THEN quantity ELSE 0 END) Monday, SUM(CASE WHEN DAYOFWEEK(order_date) = 3 THEN quantity ELSE 0 END) Tuesday, SUM(CASE WHEN DAYOFWEEK(order_date) = 4 THEN quantity ELSE 0 END) Wednesday, SUM(CASE WHEN DAYOFWEEK(order_date) = 5 THEN quantity ELSE 0 END) Thursday, SUM(CASE WHEN DAYOFWEEK(order_date) = 6 THEN quantity ELSE 0 END) Friday, SUM(CASE WHEN DAYOFWEEK(order_date) = 7 THEN quantity ELSE 0 END) Saturday, SUM(CASE WHEN DAYOFWEEK(order_date) = 1 THEN quantity ELSE 0 END) Sunday FROM CategoryTable GROUP BY item_category ORDER BY Category
WITH RECURSIVE cte AS (SELECT MIN(order_date) AS min_date, MAX(order_date) AS max_date FROM Orders), cte2 AS (SELECT min_date AS order_date, max_date FROM cte UNION SELECT DATE_ADD(order_date, INTERVAL 1 DAY) AS order_date, max_date FROM cte2 WHERE order_date < max_date ), cte3 AS (SELECT order_date, DAYNAME(order_date) AS day FROM cte2) SELECT I.item_category AS category, SUM(IF(C.day = 'Monday', O.quantity, 0)) AS Monday, SUM(IF(C.day = 'Tuesday', O.quantity, 0)) AS Tuesday, SUM(IF(C.day = 'Wednesday', O.quantity, 0)) AS Wednesday, SUM(IF(C.day = 'Thursday', O.quantity, 0)) AS Thursday, SUM(IF(C.day = 'Friday', O.quantity, 0)) AS Friday, SUM(IF(C.day = 'Saturday', O.quantity, 0)) AS Saturday, SUM(IF(C.day = 'Sunday', O.quantity, 0)) AS Sunday FROM cte3 AS C LEFT JOIN Orders AS O ON C.order_date = O.order_date RIGHT JOIN Items AS I ON O.item_id = I.item_id GROUP BY I.item_category ORDER BY I.item_category
WITH SALES as ( SELECT dayname(order_date) as day_of_week, coalesce(sum(quantity),0) as total_sales, item_category FROM items left outer join orders ON items.item_id = orders.item_id group by day_of_week, item_category ) SELECT item_category as category, SUM(CASE WHEN day_of_week = 'Monday' THEN total_sales ELSE 0 END) as Monday, SUM(CASE WHEN day_of_week = 'Tuesday' THEN total_sales ELSE 0 END) as Tuesday, SUM(CASE WHEN day_of_week = 'Wednesday' THEN total_sales ELSE 0 END) as Wednesday, SUM(CASE WHEN day_of_week = 'Thursday' THEN total_sales ELSE 0 END) as Thursday, SUM(CASE WHEN day_of_week = 'Friday' THEN total_sales ELSE 0 END) as Friday, SUM(CASE WHEN day_of_week = 'Saturday' THEN total_sales ELSE 0 END) as Saturday, SUM(CASE WHEN day_of_week = 'Sunday' THEN total_sales ELSE 0 END) as Sunday FROM SALES GROUP BY item_category order by item_category
WITH a AS ( SELECT Orders.order_date, Orders.quantity, Items.item_category FROM Orders RIGHT JOIN Items ON Orders.item_id = Items.item_id), b AS ( SELECT (CASE WHEN WEEKDAY(order_date) = 0 THEN quantity ELSE 0 END) AS Monday, (CASE WHEN WEEKDAY(order_date) = 1 THEN quantity ELSE 0 END) AS Tuesday, (CASE WHEN WEEKDAY(order_date) = 2 THEN quantity ELSE 0 END) AS Wednesday, (CASE WHEN WEEKDAY(order_date) = 2+1 THEN quantity ELSE 0 END) AS Thursday, (CASE WHEN WEEKDAY(order_date) = 4 THEN quantity ELSE 0 END) AS Friday, (CASE WHEN WEEKDAY(order_date) = 5 THEN quantity ELSE 0 END) AS Saturday, (CASE WHEN WEEKDAY(order_date) = 6 THEN quantity ELSE 0 END) AS Sunday, item_category FROM a) SELECT item_category AS CATEGORY, SUM(Monday) AS MONDAY, SUM(Tuesday) AS TUESDAY, SUM(Wednesday) AS WEDNESDAY, SUM(Thursday) AS THURSDAY, SUM(Friday) AS FRIDAY, SUM(Saturday) AS SATURDAY, SUM(Sunday) AS SUNDAY FROM b GROUP BY item_category ORDER BY Category
WITH by_weekday AS ( SELECT CASE WHEN WEEKDAY(Orders.order_date) = 0 THEN "Monday" WHEN WEEKDAY(Orders.order_date) = 1 THEN "Tuesday" WHEN WEEKDAY(Orders.order_date) = 2 THEN "Wednesday" WHEN WEEKDAY(Orders.order_date) = 3 THEN "Thursday" WHEN WEEKDAY(Orders.order_date) = 4 THEN "Friday" WHEN WEEKDAY(Orders.order_date) = 5 THEN "Saturday" WHEN WEEKDAY(Orders.order_date) = 6 THEN "Sunday" END AS day_of_week, Orders.quantity, Items.item_category AS Category FROM Orders INNER JOIN Items ON Orders.item_id = Items.item_id ), grouped AS ( SELECT Category, day_of_week, SUM(quantity) AS quantity FROM by_weekday GROUP BY Category, day_of_week ), weekday_in_column AS ( SELECT Category, IF(day_of_week = "Monday", quantity, 0) AS Monday, IF(day_of_week = "Tuesday", quantity, 0) AS Tuesday, IF(day_of_week = "Wednesday", quantity, 0) AS Wednesday, IF(day_of_week = "Thursday", quantity, 0) AS Thursday, IF(day_of_week = "Friday", quantity, 0) AS Friday, IF(day_of_week = "Saturday", quantity, 0) AS Saturday, IF(day_of_week = "Sunday", quantity, 0) AS Sunday FROM grouped ), weekday_in_column_grped AS ( SELECT Category AS CATEGORY, SUM(Monday) AS MONDAY, SUM(Tuesday) AS TUESDAY, SUM(Wednesday) AS WEDNESDAY, SUM(Thursday) AS THURSDAY, SUM(Friday) AS FRIDAY, SUM(Saturday) AS SATURDAY, SUM(Sunday) AS SUNDAY FROM weekday_in_column GROUP BY Category ) SELECT DISTINCT(Items.item_category) AS CATEGORY, IFNULL(MONDAY, 0) AS MONDAY, IFNULL(TUESDAY, 0) AS TUESDAY, IFNULL(WEDNESDAY, 0) AS WEDNESDAY, IFNULL(THURSDAY, 0) AS THURSDAY, IFNULL(FRIDAY, 0) AS FRIDAY, IFNULL(SATURDAY, 0) AS SATURDAY, IFNULL(Sunday, 0) AS SUNDAY FROM Items LEFT JOIN weekday_in_column_grped ON Items.item_category = weekday_in_column_grped.CATEGORY ORDER BY CATEGORY
WITH cte AS ( SELECT dayofweek(order_date) as dow, item_category, quantity FROM orders o JOIN items i ON o.item_id = i.item_id ), cte1 AS ( SELECT item_category, dow, sum(quantity) as total FROM cte GROUP BY 1,2 ), cte2 AS ( SELECT item_category, sum(CASE WHEN cte1.dow = 2 THEN total ELSE 0 END) AS Monday, sum(CASE WHEN cte1.dow = 3 THEN total ELSE 0 END) AS Tuesday, sum(CASE WHEN cte1.dow = 4 THEN total ELSE 0 END) AS Wednesday, sum(CASE WHEN cte1.dow = 5 THEN total ELSE 0 END) AS Thursday, sum(CASE WHEN cte1.dow = 6 THEN total ELSE 0 END) AS Friday, sum(CASE WHEN cte1.dow = 7 THEN total ELSE 0 END) AS Saturday, sum(CASE WHEN cte1.dow = 1 THEN total ELSE 0 END) AS Sunday FROM cte1 GROUP BY 1 ) SELECT distinct i.item_category AS Category, IFNULL(Monday, 0) AS Monday, IFNULL(Tuesday, 0) AS Tuesday, IFNULL(Wednesday, 0) AS Wednesday, IFNULL(Thursday, 0) AS Thursday, IFNULL(Friday, 0) AS Friday, IFNULL(Saturday, 0) AS Saturday, IFNULL(Sunday, 0) AS Sunday FROM items as i LEFT JOIN cte2 ON i.item_category = cte2.item_category ORDER BY 1
WITH cte AS ( SELECT i.item_category AS Category, SUM(CASE WHEN dayname(o.order_date) = 'Monday' THEN o.quantity ELSE 0 END) AS Monday, SUM(CASE WHEN dayname(o.order_date) = 'Tuesday' THEN o.quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN dayname(o.order_date) = 'Wednesday' THEN o.quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN dayname(o.order_date) = 'Thursday' THEN o.quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN dayname(o.order_date) = 'Friday' THEN o.quantity ELSE 0 END) AS Friday, SUM(CASE WHEN dayname(o.order_date) = 'Saturday' THEN o.quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN dayname(o.order_date) = 'Sunday' THEN o.quantity ELSE 0 END) AS Sunday FROM Orders o JOIN Items i ON o.item_id = i.item_id GROUP BY Category ) SELECT t.Category, COALESCE(cte.Monday, 0) AS Monday, COALESCE(cte.Tuesday, 0) AS Tuesday, COALESCE(cte.Wednesday, 0) AS Wednesday, COALESCE(cte.Thursday, 0) AS Thursday, COALESCE(cte.Friday, 0) AS Friday, COALESCE(cte.Saturday, 0) AS Saturday, COALESCE(cte.Sunday, 0) AS Sunday FROM (SELECT DISTINCT item_category AS Category FROM Items) t LEFT JOIN cte ON t.Category = cte.Category ORDER BY t.Category
WITH cte AS( SELECT a.*,b.item_category FROM Orders a RIGHT JOIN Items b ON a.item_id = b.item_id ) SELECT item_category AS Category, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=2 THEN quantity ELSE 0 END),0) AS Monday, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=3 THEN quantity ELSE 0 END),0) AS Tuesday, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=4 THEN quantity ELSE 0 END),0) AS Wednesday, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=5 THEN quantity ELSE 0 END),0) AS Thursday, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=6 THEN quantity ELSE 0 END),0) AS Friday, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=7 THEN quantity ELSE 0 END),0) AS Saturday, COALESCE(SUM(CASE WHEN DAYOFWEEK(order_date)=1 THEN quantity ELSE 0 END),0) AS Sunday FROM cte GROUP BY item_category ORDER BY item_category
WITH d AS (SELECT CASE WHEN weekday(order_date)=0 THEN 'Monday' WHEN weekday(order_date)=1 THEN 'Tuesday' WHEN weekday(order_date)=2 THEN 'Wednesday' WHEN weekday(order_date)=3 THEN 'Thursday' WHEN weekday(order_date)=4 THEN 'Friday' WHEN weekday(order_date)=5 THEN 'Saturday' WHEN weekday(order_date)=6 THEN 'Sunday' END wday, item_category, quantity FROM Orders o JOIN Items i ON o.item_id = i.item_id ) SELECT i.item_category Category, SUM(IF(d.wday='Monday',quantity,0)) 'Monday', SUM(IF(d.wday='Tuesday',quantity,0)) 'Tuesday', SUM(IF(d.wday='Wednesday',quantity,0)) 'Wednesday', SUM(IF(d.wday='Thursday',quantity,0)) 'Thursday', SUM(IF(d.wday='Friday',quantity,0)) 'Friday', SUM(IF(d.wday='Saturday',quantity,0)) 'Saturday', SUM(IF(d.wday='Sunday',quantity,0)) 'Sunday' FROM d RIGHT JOIN (SELECT DISTINCT item_category FROM Items) i ON d.item_category = i.item_category GROUP BY Category ORDER BY Category
WITH my_table AS(SELECT item_category, CASE WHEN WEEKDAY(order_date)=0 THEN quantity ELSE 0 END Monday, CASE WHEN WEEKDAY(order_date)=1 THEN quantity ELSE 0 END Tuesday, CASE WHEN WEEKDAY(order_date)=2 THEN quantity ELSE 0 END Wednesday, CASE WHEN WEEKDAY(order_date)=3 THEN quantity ELSE 0 END Thursday, CASE WHEN WEEKDAY(order_date)=4 THEN quantity ELSE 0 END Friday, CASE WHEN WEEKDAY(order_date)=5 THEN quantity ELSE 0 END Saturday, CASE WHEN WEEKDAY(order_date)=6 THEN quantity ELSE 0 END Sunday FROM Orders o RIGHT JOIN Items i ON o.item_id=i.item_id) SELECT item_category category, SUM(Monday) Monday, SUM(Tuesday) Tuesday, SUM(Wednesday) Wednesday, SUM(Thursday) Thursday, SUM(Friday) Friday,SUM(Saturday) Saturday,SUM(Sunday) Sunday FROM my_table GROUP BY 1 ORDER BY 1
WITH orders_dow AS ( SELECT item_id, DAYNAME(order_date) AS dow, quantity FROM orders ), orders_grouped AS ( SELECT item_id, SUM(CASE WHEN dow = 'Monday' THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN dow = 'Tuesday' THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN dow = 'Wednesday' THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN dow = 'Thursday' THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN dow = 'Friday' THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN dow = 'Saturday' THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN dow = 'Sunday' THEN quantity ELSE 0 END) AS Sunday FROM orders_dow GROUP BY item_id ) SELECT items.item_category as category, COALESCE(SUM(Monday), 0) AS Monday, COALESCE(SUM(Tuesday), 0) AS Tuesday, COALESCE(SUM(Wednesday), 0) AS Wednesday, COALESCE(SUM(Thursday), 0) AS Thursday, COALESCE(SUM(Friday), 0) AS Friday, COALESCE(SUM(Saturday), 0) AS Saturday, COALESCE(SUM(Sunday), 0) AS Sunday FROM orders_grouped AS og RIGHT JOIN items ON og.item_id = items.item_id GROUP BY items.item_category ORDER BY items.item_category
WITH sale_by_weekday_tbl AS ( SELECT CASE WHEN DAYOFWEEK(order_date) = 2 THEN 'Monday' WHEN DAYOFWEEK(order_date) = 3 THEN 'Tuesday' WHEN DAYOFWEEK(order_date) = 4 THEN 'Wednesday' WHEN DAYOFWEEK(order_date) = 5 THEN 'Thursday' WHEN DAYOFWEEK(order_date) = 6 THEN 'Friday' WHEN DAYOFWEEK(order_date) = 7 THEN 'Saturday' ELSE 'Sunday' END AS WeekDay, item_category as Category, SUM(IFNULL(quantity, 0)) quantity FROM Orders A RIGHT JOIN Items B ON A.item_id = B.item_id GROUP BY WeekDay, Category ) SELECT Category, SUM(CASE WHEN WeekDay = 'Monday' THEN quantity else 0 END) Monday, SUM(CASE WHEN WeekDay = 'Tuesday' THEN quantity else 0 END) Tuesday, SUM(CASE WHEN WeekDay = 'Wednesday' THEN quantity else 0 END) Wednesday, SUM(CASE WHEN WeekDay = 'Thursday' THEN quantity else 0 END) Thursday, SUM(CASE WHEN WeekDay = 'Friday' THEN quantity else 0 END) Friday, SUM(CASE WHEN WeekDay = 'Saturday' THEN quantity else 0 END) Saturday, SUM(CASE WHEN WeekDay = 'Sunday' THEN quantity else 0 END) Sunday FROM sale_by_weekday_tbl GROUP BY Category ORDER BY Category
WITH sales AS ( SELECT Items.item_category, DAYOFWEEK(Orders.order_date) AS day, COALESCE(SUM(Orders.quantity), 0) AS sales FROM Items LEFT JOIN Orders ON Items.item_id = Orders.item_id GROUP BY 1, 2 ) SELECT ITEM_CATEGORY AS "CATEGORY", SUM(CASE WHEN DAY <> 2 THEN 0 ELSE SALES END) AS "MONDAY", SUM(CASE WHEN DAY <> 3 THEN 0 ELSE SALES END) AS "TUESDAY", SUM(CASE WHEN DAY <> 4 THEN 0 ELSE SALES END) AS "WEDNESDAY", SUM(CASE WHEN DAY <> 5 THEN 0 ELSE SALES END) AS "THURSDAY", SUM(CASE WHEN DAY <> 6 THEN 0 ELSE SALES END) AS "FRIDAY", SUM(CASE WHEN DAY <> 7 THEN 0 ELSE SALES END) AS "SATURDAY", SUM(CASE WHEN DAY <> 1 THEN 0 ELSE SALES END) AS "SUNDAY" FROM SALES GROUP BY 1 ORDER BY 1
WITH t AS (SELECT item_category, SUM(quantity) s, DAYNAME(order_date) day FROM orders o JOIN items i ON o.item_id = i.item_id GROUP BY 1, DAYNAME(order_date)), n AS (SELECT item_category CATEGORY, CASE WHEN day = 'Monday' THEN s ELSE 0 END AS Monday, CASE WHEN day = 'Tuesday' THEN s ELSE 0 END AS Tuesday, CASE WHEN day = 'Wednesday' THEN s ELSE 0 END AS Wednesday, CASE WHEN day = 'Thursday' THEN s ELSE 0 END AS Thursday, CASE WHEN day = 'Friday' THEN s ELSE 0 END AS Friday, CASE WHEN day = 'Saturday' THEN s ELSE 0 END AS Saturday, CASE WHEN day = 'Sunday' THEN s ELSE 0 END AS Sunday FROM t), r AS (SELECT CATEGORY, SUM(Monday) MONDAY, SUM(Tuesday) TUESDAY, SUM(Wednesday) WEDNESDAY, SUM(Thursday) THURSDAY, SUM(Friday) FRIDAY, SUM(Saturday) SATURDAY, SUM(Sunday) SUNDAY FROM n GROUP BY 1 ) SELECT DISTINCT item_category CATEGORY, IFNULL(Monday, 0) Monday, IFNULL(Tuesday, 0) Tuesday, IFNULL(Wednesday, 0) Wednesday, IFNULL(Thursday, 0) Thursday, IFNULL(Friday, 0) Friday, IFNULL(Saturday, 0) Saturday, IFNULL(Sunday, 0) Sunday FROM items i LEFT JOIN r ON i.item_category = r.CATEGORY ORDER BY 1
WITH t AS (SELECT item_category, SUM(quantity) s, DAYNAME(order_date) day FROM orders o JOIN items i ON o.item_id = i.item_id GROUP BY 1, DAYNAME(order_date)), n AS (SELECT item_category CATEGORY, SUM(CASE WHEN day = 'Monday' THEN s ELSE 0 END) AS Monday, SUM(CASE WHEN day = 'Tuesday' THEN s ELSE 0 END) AS Tuesday, SUM(CASE WHEN day = 'Wednesday' THEN s ELSE 0 END) AS Wednesday, SUM(CASE WHEN day = 'Thursday' THEN s ELSE 0 END) AS Thursday, SUM(CASE WHEN day = 'Friday' THEN s ELSE 0 END) AS Friday, SUM(CASE WHEN day = 'Saturday' THEN s ELSE 0 END) AS Saturday, SUM(CASE WHEN day = 'Sunday' THEN s ELSE 0 END) AS Sunday FROM t GROUP BY 1), r AS (SELECT CATEGORY, SUM(Monday) MONDAY, SUM(Tuesday) TUESDAY, SUM(Wednesday) WEDNESDAY, SUM(Thursday) THURSDAY, SUM(Friday) FRIDAY, SUM(Saturday) SATURDAY, SUM(Sunday) SUNDAY FROM n GROUP BY 1 ) SELECT DISTINCT item_category CATEGORY, IFNULL(Monday, 0) Monday, IFNULL(Tuesday, 0) Tuesday, IFNULL(Wednesday, 0) Wednesday, IFNULL(Thursday, 0) Thursday, IFNULL(Friday, 0) Friday, IFNULL(Saturday, 0) Saturday, IFNULL(Sunday, 0) Sunday FROM items i LEFT JOIN n ON i.item_category = n.CATEGORY ORDER BY 1
WITH t AS( SELECT item_category, IFNULL(SUM(quantity),0) total, DAYNAME(order_date) weekday FROM Items i LEFT JOIN Orders o ON i.item_id = o.item_id GROUP BY 1, 3 ) SELECT item_category AS Category ,sum(case when weekday='Monday' then total else 0 end) as Monday ,sum(case when weekday='Tuesday' then total else 0 end) as Tuesday ,sum(case when weekday='Wednesday' then total else 0 end) as Wednesday ,sum(case when weekday='Thursday' then total else 0 end) as Thursday ,sum(case when weekday='Friday' then total else 0 end) as Friday ,sum(case when weekday='Saturday' then total else 0 end) as Saturday ,sum(case when weekday='Sunday' then total else 0 end) as Sunday FROM t GROUP BY 1 ORDER BY 1
WITH t1 AS ( SELECT o.*, DAYNAME(o.order_date) AS day, i.item_category FROM Orders o RIGHT JOIN Items i ON o.item_id = i.item_id ), t2 AS ( SELECT item_category AS Category, SUM(IF(day = 'Monday',quantity,0)) AS Monday, SUM(IF(day = 'Tuesday',quantity,0)) AS Tuesday, SUM(IF(day = 'Wednesday',quantity,0)) AS Wednesday, SUM(IF(day = 'Thursday',quantity,0)) AS Thursday, SUM(IF(day = 'Friday',quantity,0)) AS Friday, SUM(IF(day = 'Saturday',quantity,0)) AS Saturday, SUM(IF(day = 'Sunday',quantity,0)) AS Sunday FROM t1 GROUP BY 1 ORDER BY 1 ) SELECT * FROM t2
WITH temp AS ( SELECT day, item_category FROM ( SELECT 'Monday' AS day UNION SELECT 'Tuesday' AS day UNION SELECT 'Wednesday' AS day UNION SELECT 'Thursday' AS day UNION SELECT 'Friday' AS day UNION SELECT 'Saturday' AS day UNION SELECT 'Sunday' AS day ) sub1 CROSS JOIN (SELECT DISTINCT item_category FROM Items) sub2 ) SELECT item_category AS Category, SUM(CASE WHEN day = 'Monday' THEN quant ELSE 0 END) AS Monday, SUM(CASE WHEN day = 'Tuesday' THEN quant ELSE 0 END) AS Tuesday, SUM(CASE WHEN day = 'Wednesday' THEN quant ELSE 0 END) AS Wednesday, SUM(CASE WHEN day = 'Thursday' THEN quant ELSE 0 END) AS Thursday, SUM(CASE WHEN day = 'Friday' THEN quant ELSE 0 END) AS Friday, SUM(CASE WHEN day = 'Saturday' THEN quant ELSE 0 END) AS Saturday, SUM(CASE WHEN day = 'Sunday' THEN quant ELSE 0 END) AS Sunday FROM ( SELECT temp.item_category, temp.day, COALESCE(quant,0) AS quant FROM temp LEFT JOIN ( SELECT item_category, DAYNAME(order_date) AS day, SUM(quantity) AS quant FROM Orders o INNER JOIN Items i ON o.item_id = i.item_id GROUP BY item_category, DAYNAME(order_date) ) sub ON temp.item_category = sub.item_category AND temp.day = sub.day ) sub GROUP BY item_category ORDER BY item_category
WITH temp AS ( SELECT item_id, DAYOFWEEK(order_date) AS order_dayofweek, SUM(quantity) AS orders FROM Orders GROUP BY item_id, order_dayofweek ), daysofweek AS ( SELECT 1 AS dayofweek UNION ALL SELECT 2 AS dayofweek UNION ALL SELECT 3 AS dayofweek UNION ALL SELECT 4 AS dayofweek UNION ALL SELECT 5 AS dayofweek UNION ALL SELECT 6 AS dayofweek UNION ALL SELECT 7 AS dayofweek ), itemcategory_with_dayofweek AS ( SELECT item_category, item_id, dayofweek FROM Items JOIN daysofweek ORDER BY item_category, dayofweek ), temp1 AS ( SELECT I.item_category, I.dayofweek, SUM(T.orders) AS orders FROM itemcategory_with_dayofweek I LEFT OUTER JOIN temp T ON I.item_id = T.item_id AND I.dayofweek = order_dayofweek GROUP BY I.item_category, I.dayofweek ), temp2 AS ( SELECT item_category AS CATEGORY, SUM(IF(dayofweek = 2, orders, 0)) AS MONDAY, SUM(IF(dayofweek = 3, orders, 0)) AS TUESDAY, SUM(IF(dayofweek = 4, orders, 0)) AS WEDNESDAY, SUM(IF(dayofweek = 5, orders, 0)) AS THURSDAY, SUM(IF(dayofweek = 6, orders, 0)) AS FRIDAY, SUM(IF(dayofweek = 7, orders, 0)) AS SATURDAY, SUM(IF(dayofweek = 1, orders, 0)) AS SUNDAY FROM temp1 GROUP BY item_category ORDER BY item_category ) SELECT * FROM temp2
WITH temp_table as ( SELECT i.item_category Category, WEEKDAY(order_date) wd, sum(quantity) quantity FROM Orders o right outer join Items i on o.item_id = i.item_id group by i.item_category, WEEKDAY(order_date) ) SELECT Category, SUM(CASE WHEN wd=0 THEN QUANTITY ELSE 0 END) MONDAY, sum(CASE WHEN wd=1 THEN QUANTITY ELSE 0 END) TUESDAY, sum(CASE WHEN wd=2 THEN QUANTITY ELSE 0 END) WEDNESDAY, sum(CASE WHEN wd=3 THEN QUANTITY ELSE 0 END) THURSDAY, sum(CASE WHEN wd=4 THEN QUANTITY ELSE 0 END) FRIDAY, sum(CASE WHEN wd=5 THEN QUANTITY ELSE 0 END) Saturday, sum(CASE WHEN wd=6 THEN QUANTITY ELSE 0 END) Sunday from temp_table GROUP BY Category ORDER BY Category
WITH tmp as (select item_id, SUM(case when dayofweek(order_date) = 2 then quantity else 0 end) as MONDAY, SUM(case when dayofweek(order_date) = 3 then quantity else 0 end) as TUESDAY, SUM(case when dayofweek(order_date) = 4 then quantity else 0 end) AS WEDNESDAY, SUM(case when dayofweek(order_date) = 5 then quantity else 0 end) AS THURSDAY, SUM(case when dayofweek(order_date) = 6 then quantity else 0 end) AS FRIDAY, SUM(case when dayofweek(order_date) = 7 then quantity else 0 end) AS SATURDAY, SUM(case when dayofweek(order_date) = 1 then quantity else 0 end) AS SUNDAY from orders GROUP BY item_id) SELECT item_category as CATEGORY, COALESCE(SUM(MONDAY),0) as MONDAY, COALESCE(SUM(TUESDAY),0) as TUESDAY, COALESCE(SUM(WEDNESDAY),0) as WEDNESDAY, COALESCE(SUM(THURSDAY),0) as THURSDAY, COALESCE(SUM(FRIDAY),0) as FRIDAY, COALESCE(SUM(SATURDAY),0) as SATURDAY, COALESCE(SUM(SUNDAY),0) as SUNDAY from items t left join tmp on t.item_id = tmp.item_id GROUP BY item_category ORDER BY item_category
WITH tmp1 AS ( SELECT CASE DAYOFWEEK(order_date) WHEN 1 THEN "Sunday" WHEN 2 THEN "Monday" WHEN 3 THEN "Tuesday" WHEN 4 THEN "Wednesday" WHEN 5 THEN "Thursday" WHEN 6 THEN "Friday" WHEN 7 THEN "Saturday" END AS Day, item_category, SUM(quantity) AS n FROM Orders AS ina, Items AS inb WHERE ina.item_id = inb.item_id GROUP BY item_category, day ), tmp2 AS ( SELECT DISTINCT item_category AS category FROM Items ), tmp3 AS ( SELECT "Monday" AS day UNION SELECT "Tuesday" UNION SELECt "Wednesday" UNION SELECt "Thursday" UNION SELECt "Friday" UNION SELECt "Saturday" UNION SELECt "Sunday" ), tmp4 AS ( SELECT * FROM tmp2, tmp3 ) SELECT ina.Category, max(CASE inb.Day WHEN "Monday" THEN inb.n ELSE 0 END) AS MONDAY, max(CASE inb.Day WHEN "Tuesday" THEN n ELSE 0 END) AS TUESDAY, max(CASE inb.Day WHEN "Wednesday" THEN n ELSE 0 END) AS WEDNESDAY, max(CASE inb.Day WHEN "Thursday" THEN n ELSE 0 END) AS THURSDAY, max(CASE inb.Day WHEN "Friday" THEN n ELSE 0 END) AS FRIDAY, max(CASE inb.Day WHEN "Saturday" THEN n ELSE 0 END) AS SATURDAY, max(CASE inb.Day WHEN "Sunday" THEN n ELSE 0 END) AS SUNDAY FROM tmp4 AS ina LEFT JOIN tmp1 AS inb ON ina.category = inb.item_category AND ina.Day = inb.Day GROUP BY ina.Category ORDER BY ina.Category
WITH weeknum as ( select o.item_id, o.order_date, dayofweek(o.order_date) as day, o.quantity from orders as o ) select i.item_category as CATEGORY, sum(case when w.day = 2 then w.quantity else 0 end) as MONDAY, sum(case when w.day = 3 then w.quantity else 0 end) as TUESDAY, sum(case when w.day = 4 then w.quantity else 0 end) as WEDNESDAY, sum(case when w.day = 5 then w.quantity else 0 end) as THURSDAY, sum(case when w.day = 6 then w.quantity else 0 end) as FRIDAY, sum(case when w.day = 7 then w.quantity else 0 end) as SATURDAY, sum(case when w.day = 1 then w.quantity else 0 end) as SUNDAY from weeknum as w RIGHT join items as i on w.item_id = i.item_id Group by i.item_category order by 1
With base as ( select weekday(a.order_date) as week_day , b.item_category as Category , sum(a.quantity) as cnt from Orders a left join Items b on a.item_id = b.item_id group by 1,2) select c.Category , coalesce(Mon.cnt,0) as Monday , coalesce(Tue.cnt,0) as Tuesday , coalesce(Wed.cnt,0) as Wednesday , coalesce(Thu.cnt,0) as Thursday , coalesce(Fri.cnt,0) as Friday , coalesce(Sat.cnt,0) as Saturday , coalesce(Sun.cnt,0) as Sunday from (select distinct item_category as Category from Items) c left join (select * from base where week_day = 0 ) Mon on c.Category = Mon.Category left join (select * from base where week_day = 1 )Tue on c.Category = Tue.Category left join (select * from base where week_day = 2 )Wed on c.Category = Wed.Category left join (select * from base where week_day = 3 )Thu on c.Category = Thu.Category left join (select * from base where week_day = 4 )Fri on c.Category = Fri.Category left join (select * from base where week_day = 5 )Sat on c.Category = Sat.Category left join (select * from base where week_day = 6 )Sun on c.Category = Sun.Category order by Category
distinct b.item_category as CATEGORY, sum(case when weekday(a.order_date)=0 then quantity else 0 end) as MONDAY, sum(case when weekday(a.order_date)=1 then quantity else 0 end) as TUESDAY, sum(case when weekday(a.order_date)=2 then quantity else 0 end) as WEDNESDAY, sum(case when weekday(a.order_date)=3 then quantity else 0 end) as THURSDAY, sum(case when weekday(a.order_date)=4 then quantity else 0 end) as FRIDAY, sum(case when weekday(a.order_date)=5 then quantity else 0 end) as SATURDAY, sum(case when weekday(a.order_date)=6 then quantity else 0 end) as SUNDAY from orders a right join items b on a.item_id=b.item_id group by 1 order by 1
select B.Category as CATEGORY, sum(if( b.day = 'Monday', B.num, 0)) AS MONDAY, sum(if( b.day = 'Tuesday', B.num, 0)) AS TUESDAY, sum(if( b.day = 'Wednesday', B.num, 0)) AS WEDNESDAY, sum(if( b.day = 'Thursday', B.num, 0)) AS THURSDAY, sum(if( b.day = 'Friday', B.num, 0)) AS FRIDAY, sum(if( b.day = 'Saturday', B.num, 0)) AS SATURDAY, sum(if( b.day = 'Sunday', B.num, 0)) AS SUNDAY from (select ifnull(sum(A.quantity),0) as num, A.item_category as Category, A.day from (select Orders.order_id, DAYNAME(Orders.order_date) as day, Orders.quantity, Items.item_category from Orders right join Items on Orders.item_id=Items.item_id) as A group by A.item_category, A.day) as B group by B.Category order by B.Category
select CATEGORY, sum(case when day = 'Monday' then quantity else 0 end) as MONDAY, sum(case when day = 'Tuesday' then quantity else 0 end) as TUESDAY, sum(case when day = 'Wednesday' then quantity else 0 end) as WEDNESDAY, sum(case when day = 'Thursday' then quantity else 0 end) as THURSDAY, sum(case when day = 'Friday' then quantity else 0 end) as FRIDAY, sum(case when day = 'Saturday' then quantity else 0 end) as SATURDAY, sum(case when day = 'Sunday' then quantity else 0 end) as SUNDAY from (select dayname(order_date) as day, i.item_category as category, quantity from orders o right join items i on o.item_id = i.item_id) t group by category order by category
select Category, sum(Monday) as Monday, sum(Tuesday) as Tuesday, sum(Wednesday) as Wednesday, sum(Thursday) as Thursday, sum(Friday) as Friday, sum(Saturday) as Saturday, sum(Sunday) as Sunday from (select t.item_category as Category, case when weekday(order_date) = 0 then quantity else 0 end as 'Monday', case when weekday(order_date) = 1 then quantity else 0 end as 'Tuesday', case when weekday(order_date) = 2 then quantity else 0 end as 'Wednesday', case when weekday(order_date) = 3 then quantity else 0 end as 'Thursday', case when weekday(order_date) = 4 then quantity else 0 end as 'Friday', case when weekday(order_date) = 5 then quantity else 0 end as 'Saturday', case when weekday(order_date) = 6 then quantity else 0 end as 'Sunday' from (select o.order_id, o.customer_id, o.order_date, i.item_id, i.item_category, ifnull(quantity, 0) as quantity from Orders o right join Items i on o.item_id = i.item_id ) t) t1 group by category order by category
select I.item_category as CATEGORY, sum(case when DAYNAME(O.order_date)='Monday' then O.quantity else 0 end) as MONDAY, sum(case when DAYNAME(O.order_date)='Tuesday' then O.quantity else 0 end) as TUESDAY, sum(case when DAYNAME(O.order_date)='Wednesday' then O.quantity else 0 end) as WEDNESDAY, sum(case when DAYNAME(O.order_date)='Thursday' then O.quantity else 0 end) as THURSDAY, sum(case when DAYNAME(O.order_date)='Friday' then O.quantity else 0 end) as FRIDAY, sum(case when DAYNAME(O.order_date)='Saturday' then O.quantity else 0 end) as SATURDAY, sum(case when DAYNAME(O.order_date)='Sunday' then O.quantity else 0 end) as SUNDAY from Orders O right join Items I using(item_id) group by 1 order by 1
select I.item_category as CATEGORY, sum(case when dayofweek(order_date)=2 then quantity else 0 end) as MONDAY, sum(case when dayofweek(order_date)=3 then quantity else 0 end) as TUESDAY, sum(case when dayofweek(order_date)=4 then quantity else 0 end) as WEDNESDAY, sum(case when dayofweek(order_date)=5 then quantity else 0 end) as THURSDAY, sum(case when dayofweek(order_date)=6 then quantity else 0 end) as FRIDAY, sum(case when dayofweek(order_date)=7 then quantity else 0 end) as SATURDAY, sum(case when dayofweek(order_date)=1 then quantity else 0 end) as SUNDAY from Items I left join ( select item_id,order_date,quantity from Orders O ) O on O.item_id=I.item_id group by I.item_category order by I.item_category
select I.item_category as Category, SUM(case WHEN dayname(order_date) = 'Monday' THEN Quantity ELSE 0 END) as Monday, SUM(case WHEN dayname(order_date) = 'Tuesday' THEN Quantity ELSE 0 END) as Tuesday, SUM(case WHEN dayname(order_date) = 'Wednesday' THEN Quantity ELSE 0 END) as Wednesday, SUM(case WHEN dayname(order_date) = 'Thursday' THEN Quantity ELSE 0 END) as Thursday, SUM(case WHEN dayname(order_date) = 'Friday' THEN Quantity ELSE 0 END) as Friday, SUM(case WHEN dayname(order_date) = 'Saturday' THEN Quantity ELSE 0 END) as Saturday, SUM(case WHEN dayname(order_date) = 'Sunday' THEN Quantity ELSE 0 END) as Sunday from Orders O RIGHT JOIN Items I on O.item_id = I.item_id group by I.item_category order by 1
select I.item_category as Category, sum(case when dayofweek(O.order_date) = 2 then O.quantity else 0 end) as Monday, sum(case when dayofweek(O.order_date) = 3 then O.quantity else 0 end) as Tuesday, sum(case when dayofweek(O.order_date) = 4 then O.quantity else 0 end) as Wednesday, sum(case when dayofweek(O.order_date) = 5 then O.quantity else 0 end) as Thursday, sum(case when dayofweek(O.order_date) = 6 then O.quantity else 0 end) as Friday, sum(case when dayofweek(O.order_date) = 7 then O.quantity else 0 end) as Saturday, sum(case when dayofweek(O.order_date) = 1 then O.quantity else 0 end) as Sunday from Items I left join Orders O on O.item_id = I.item_id group by I.item_category order by I.item_category
select I.item_category as Category, sum(case when weekday(order_date) = 0 then quantity else 0 end) as Monday, sum(case when weekday(order_date) = 1 then quantity else 0 end) as Tuesday, sum(case when weekday(order_date) = 2 then quantity else 0 end) as Wednesday, sum(case when weekday(order_date) = 3 then quantity else 0 end) as Thursday, sum(case when weekday(order_date) = 4 then quantity else 0 end) as Friday, sum(case when weekday(order_date) = 5 then quantity else 0 end) as Saturday, sum(case when weekday(order_date) = 6 then quantity else 0 end) as Sunday from Orders O right join items I on O.item_id = I.item_id group by 1 order by 1
select a.Category CATEGORY, sum(case when DOW = 2 then total_quantity else 0 end) MONDAY, sum(case when DOW = 3 then total_quantity else 0 end) TUESDAY, sum(case when DOW = 4 then total_quantity else 0 end) WEDNESDAY, sum(case when DOW = 5 then total_quantity else 0 end) THURSDAY, sum(case when DOW = 6 then total_quantity else 0 end) FRIDAY, sum(case when DOW = 7 then total_quantity else 0 end) SATURDAY, sum(case when DOW = 1 then total_quantity else 0 end) SUNDAY from (select distinct item_category Category from Items) a left join ( select item_category Category, dayofweek(order_date) DOW, sum(quantity) total_quantity from Items a left join Orders b on a.item_id = b.item_id group by Category, DOW ) b on a.Category = b.Category group by Category order by Category
select a.item_category as category, ifnull(sum(case when weekday(order_date)=0 then quantity else 0 end),0) as Monday, ifnull(sum(case when weekday(order_date)=1 then quantity else 0 end),0) as Tuesday, ifnull(sum(case when weekday(order_date)=2 then quantity else 0 end),0) as Wednesday, ifnull(sum(case when weekday(order_date)=3 then quantity else 0 end),0) as Thursday, ifnull(sum(case when weekday(order_date)=4 then quantity else 0 end),0) as Friday, ifnull(sum(case when weekday(order_date)=5 then quantity else 0 end),0) as Saturday, ifnull(sum(case when weekday(order_date)=6 then quantity else 0 end),0) as Sunday from items as a left join orders as b on a.item_id = b.item_id group by 1 order by 1
select a.item_category as category, sum(case when dayofweek(order_date)=2 then quantity else 0 end) as Monday, sum(case when dayofweek(order_date)=3 then quantity else 0 end) as Tuesday, sum(case when dayofweek(order_date)=4 then quantity else 0 end) as Wednesday, sum(case when dayofweek(order_date)=5 then quantity else 0 end) as Thursday, sum(case when dayofweek(order_date)=6 then quantity else 0 end) as Friday, sum(case when dayofweek(order_date)=7 then quantity else 0 end) as Saturday, sum(case when dayofweek(order_date)=1 then quantity else 0 end) as Sunday from items a left join orders b using (item_id) group by 1 order by 1
select a.item_category as category, sum(case when weekday(b.order_date)=0 then quantity else 0 end) as Monday, sum(case when weekday(b.order_date)=1 then quantity else 0 end) as Tuesday, sum(case when weekday(b.order_date)=2 then quantity else 0 end) as Wednesday, sum(case when weekday(b.order_date)=3 then quantity else 0 end) as Thursday, sum(case when weekday(b.order_date)=4 then quantity else 0 end) as Friday, sum(case when weekday(b.order_date)=5 then quantity else 0 end) as Saturday, sum(case when weekday(b.order_date)=6 then quantity else 0 end) as Sunday from items as a left join orders as b on a.item_id = b.item_id group by 1 order by 1
select b.item_category as 'CATEGORY', sum(case when weekday(a.order_date) = 0 then a.quantity else 0 end) as 'MONDAY', sum(case when weekday(a.order_date) = 1 then a.quantity else 0 end) as 'TUESDAY', sum(case when weekday(a.order_date) = 2 then a.quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(a.order_date) = 3 then a.quantity else 0 end) as 'THURSDAY', sum(case when weekday(a.order_date) = 4 then a.quantity else 0 end) as 'FRIDAY', sum(case when weekday(a.order_date) = 5 then a.quantity else 0 end) as 'SATURDAY', sum(case when weekday(a.order_date) = 6 then a.quantity else 0 end) as 'SUNDAY' from orders a right join items b on a.item_id = b.item_id group by b.item_category order by b.item_category
select b.item_category as 'CATEGORY', sum(case when weekday(a.order_date) = 0 then a.quantity else 0 end) as 'MONDAY', sum(case when weekday(a.order_date) = 1 then a.quantity else 0 end) as 'TUESDAY', sum(case when weekday(a.order_date) = 2 then a.quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(a.order_date) = 3 then a.quantity else 0 end) as 'THURSDAY', sum(case when weekday(a.order_date) = 4 then a.quantity else 0 end) as 'FRIDAY', sum(case when weekday(a.order_date) = 5 then a.quantity else 0 end) as 'SATURDAY', sum(case when weekday(a.order_date) = 6 then a.quantity else 0 end) as 'SUNDAY' from orders a right join items b on a.item_id=b.item_id group by b.item_category order by b.item_category
select b.item_category as category, sum(case when weekday(a.order_date) = 0 then quantity else 0 end) as Monday, sum(case when weekday(a.order_date) = 1 then quantity else 0 end) as Tuesday, sum(case when weekday(a.order_date) = 2 then quantity else 0 end) as Wednesday, sum(case when weekday(a.order_date) = 3 then quantity else 0 end) as Thursday, sum(case when weekday(a.order_date) = 4 then quantity else 0 end) as Friday, sum(case when weekday(a.order_date) = 5 then quantity else 0 end) as Saturday, sum(case when weekday(a.order_date) = 6 then quantity else 0 end) as Sunday from items as b left join orders as a using(item_id) group by 1 order by 1
select b.item_category as category, sum(case when weekday(order_date)=0 then quantity else 0 end) as Monday, sum(case when weekday(order_date)=1 then quantity else 0 end) as Tuesday, sum(case when weekday(order_date)=2 then quantity else 0 end) as Wednesday, sum(case when weekday(order_date)=3 then quantity else 0 end) as Thursday, sum(case when weekday(order_date)=4 then quantity else 0 end) as Friday, sum(case when weekday(order_date)=5 then quantity else 0 end) as Saturday, sum(case when weekday(order_date)=6 then quantity else 0 end) as Sunday from Orders a right join Items b on a.item_id=b.item_id group by b.item_category order by category
select distinct category as CATEGORY, SUM(Monday) over (partition by category) as MONDAY, SUM(Tuesday) over (partition by category) as TUESDAY, SUM(Wednesday) over (partition by category) as WEDNESDAY, SUM(Thursday) over (partition by category) as THURSDAY, SUM(Friday) over (partition by category) as FRIDAY, SUM(Saturday) over (partition by category) as SATURDAY, SUM(Sunday) over (partition by category) as SUNDAY FROM (SELECT distinct category, CASE WHEN weekday='Monday' then SUM(quantity) over (partition by category,weekday ) else 0 end as 'MONDAY', CASE WHEN weekday='Tuesday' then SUM(quantity) over (partition by category,weekday ) else 0 end as 'TUESDAY', CASE WHEN weekday='Wednesday' then SUM(quantity) over (partition by category,weekday order by weekday) else 0 end as 'WEDNESDAY', CASE WHEN weekday='Thursday' then SUM(quantity) over (partition by category,weekday order by weekday) else 0 end as 'THURSDAY', CASE WHEN weekday='Friday' then SUM(quantity) over (partition by category,weekday order by weekday) else 0 end as 'FRIDAY', CASE WHEN weekday='Saturday' then SUM(quantity) over (partition by category,weekday order by weekday) else 0 end as 'SATURDAY', CASE WHEN weekday='Sunday' then SUM(quantity) over (partition by category,weekday order by weekday) else 0 end as 'SUNDAY' FROM( SELECT order_id, customer_id, order_date, O.item_id, quantity, DAYNAME(order_date) as weekday, item_category as category FROM Items I LEFT JOIN Orders O on I.item_id=O.item_id order by order_id)A)B order by category
select distinct(i.item_category) as CATEGORY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 2 THEN quantity end), 0) as MONDAY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 3 THEN quantity end), 0) as TUESDAY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 4 THEN quantity end), 0) as WEDNESDAY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 5 THEN quantity end), 0) as THURSDAY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 6 THEN quantity end), 0) as FRIDAY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 7 THEN quantity end), 0) as SATURDAY, ifnull(sum(CASE WHEN DAYOFWEEK(order_date) = 1 THEN quantity end), 0) as SUNDAY from Orders o RIGHT JOIN Items i ON o.item_id = i.item_id group by i.item_category order by i.item_category
select i.category, coalesce(monday, 0) as monday, coalesce(tuesday, 0) as tuesday, coalesce(wednesday, 0) as wednesday, coalesce(thursday, 0) as thursday, coalesce(friday, 0) as friday, coalesce(saturday, 0) as saturday, coalesce(sunday, 0) as sunday from ( select distinct item_category as category from items ) i left join ( select item_category as category, sum(IF(DAYNAME(order_date) = 'Monday', quantity, 0)) as monday, sum(IF(DAYNAME(order_date) = 'Tuesday', quantity, 0)) as Tuesday, sum(IF(DAYNAME(order_date) = 'Wednesday', quantity, 0)) as Wednesday, sum(IF(DAYNAME(order_date) = 'Thursday', quantity, 0)) as Thursday, sum(IF(DAYNAME(order_date) = 'Friday', quantity, 0)) as Friday, sum(IF(DAYNAME(order_date) = 'Saturday', quantity, 0)) as Saturday, sum(IF(DAYNAME(order_date) = 'Sunday', quantity, 0)) as Sunday from orders o join items i on i.item_id = o.item_id group by 1 ) o on o.category = i.category order by 1
select i.item_category as "CATEGORY", sum((if(dayname(o.order_date)="Monday", o.quantity, 0))) as "Monday", sum((if(dayname(o.order_date)="Tuesday", o.quantity, 0))) as "Tuesday", sum((if(dayname(o.order_date)="Wednesday", o.quantity, 0))) as "Wednesday", sum((if(dayname(o.order_date)="Thursday", o.quantity, 0))) as "Thursday", sum((if(dayname(o.order_date)="Friday", o.quantity, 0))) as "Friday", sum((if(dayname(o.order_date)="Saturday", o.quantity, 0))) as "Saturday", sum((if(dayname(o.order_date)="Sunday", o.quantity, 0))) as "Sunday" from orders as o right join items as i on i.item_id=o.item_id group by i.item_category order by i.item_category
select i.item_category as "CATEGORY", sum(case when dayofweek(o.order_date) = 2 then o.quantity else 0 end) as "MONDAY" , sum(case when dayofweek(o.order_date) = 3 then o.quantity else 0 end) as "TUESDAY" , sum(case when dayofweek(o.order_date) = 4 then o.quantity else 0 end) as "WEDNESDAY" , sum(case when dayofweek(o.order_date) = 5 then o.quantity else 0 end) as "THURSDAY" , sum(case when dayofweek(o.order_date) = 6 then o.quantity else 0 end) as "FRIDAY" , sum(case when dayofweek(o.order_date) = 7 then o.quantity else 0 end) as "SATURDAY" , sum(case when dayofweek(o.order_date) = 1 then o.quantity else 0 end) as "SUNDAY" from items as i left join orders as o on i.item_id = o.item_id group by 1 order by 1
select i.item_category as 'CATEGORY', sum(case when dayname(o.order_date) = 'Monday' then o.quantity else 0 end) as 'MONDAY', sum(case when dayname(o.order_date) = 'Tuesday' then o.quantity else 0 end) as 'TUESDAY', sum(case when dayname(o.order_date) = 'Wednesday' then o.quantity else 0 end) as 'WEDNESDAY', sum(case when dayname(o.order_date) = 'Thursday' then o.quantity else 0 end) as 'THURSDAY', sum(case when dayname(o.order_date) = 'Friday' then o.quantity else 0 end) as 'FRIDAY', sum(case when dayname(o.order_date) = 'Saturday' then o.quantity else 0 end) as 'SATURDAY', sum(case when dayname(o.order_date) = 'Sunday' then o.quantity else 0 end) as 'SUNDAY' from orders as o right join items as i on o.item_id = i.item_id group by 1 order by 1
select i.item_category as 'CATEGORY', sum(case when weekday(o.order_date) = 0 then o.quantity else 0 end) as 'MONDAY', sum(case when weekday(o.order_date) = 1 then o.quantity else 0 end) as 'TUESDAY', sum(case when weekday(o.order_date) = 2 then o.quantity else 0 end) as 'WEDNESDAY', sum(case when dayname(o.order_date) = 'Thursday' then o.quantity else 0 end) as 'THURSDAY', sum(case when dayname(o.order_date) = 'Friday' then o.quantity else 0 end) as 'FRIDAY', sum(case when dayname(o.order_date) = 'Saturday' then o.quantity else 0 end) as 'SATURDAY', sum(case when dayname(o.order_date) = 'Sunday' then o.quantity else 0 end) as 'SUNDAY' from orders as o right join items as i on o.item_id = i.item_id group by 1 order by 1
select i.item_category as 'CATEGORY',sum(case when weekday(o.order_date)=0 then o.quantity else 0 end) as 'MONDAY', sum(case when weekday(o.order_date)=1 then o.quantity else 0 end) as 'TUESDAY', sum(case when weekday(o.order_date)=2 then o.quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(o.order_date)=3 then o.quantity else 0 end) as 'THURSDAY', sum(case when weekday(o.order_date)=4 then o.quantity else 0 end) as 'FRIDAY', sum(case when weekday(o.order_date)=5 then o.quantity else 0 end) as 'SATURDAY', sum(case when weekday(o.order_date)=6 then o.quantity else 0 end) as 'SUNDAY' from Orders as o right join Items as i on o.item_id=i.item_id group by i.item_category order by i.item_category
select i.item_category as CATEGORY , sum(case when weekday(o.order_date) = 0 then o.quantity else 0 end) as MONDAY , sum(case when weekday(o.order_date) = 1 then o.quantity else 0 end) as TUESDAY , sum(case when weekday(o.order_date) = 2 then o.quantity else 0 end) as WEDNESDAY , sum(case when weekday(o.order_date) = 3 then o.quantity else 0 end) as THURSDAY , sum(case when weekday(o.order_date) = 4 then o.quantity else 0 end) as FRIDAY , sum(case when weekday(o.order_date) = 5 then o.quantity else 0 end) as SATURDAY , sum(case when weekday(o.order_date) = 6 then o.quantity else 0 end) as SUNDAY from Orders as o right join Items as i on o.item_id = i.item_id group by i.item_category order by Category
select i.item_category as CATEGORY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Monday" then o.quantity END),0) as MONDAY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Tuesday" then o.quantity END),0) as TUESDAY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Wednesday" then o.quantity END),0) as WEDNESDAY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Thursday" then o.quantity END),0) as THURSDAY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Friday" then o.quantity END),0) as FRIDAY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Saturday" then o.quantity END),0) as SATURDAY, IFNULL(SUM(CASE WHEN DAYNAME(o.order_date) = "Sunday" then o.quantity END),0) as SUNDAY from items i LEFT JOIN orders o ON o.item_id = i.item_id group by 1 order by 1
select i.item_category as CATEGORY, SUM(CASE WHEN DAYOFWEEK(o.order_date)=2 then quantity Else 0 End) as 'MONDAY', SUM(CASE WHEN DAYOFWEEK(o.order_date)=3 then quantity Else 0 End) as 'TUESDAY', SUM(CASE WHEN DAYOFWEEK(o.order_date)=4 then quantity Else 0 End) as 'WEDNESDAY', SUM(CASE WHEN DAYOFWEEK(o.order_date)=5 then quantity Else 0 End) as 'THURSDAY', SUM(CASE WHEN DAYOFWEEK(o.order_date)=6 then quantity Else 0 End) as 'FRIDAY', SUM(CASE WHEN DAYOFWEEK(o.order_date)=7 then quantity Else 0 End) as 'SATURDAY', SUM(CASE WHEN DAYOFWEEK(o.order_date)=1 then quantity Else 0 End) as 'SUNDAY' from Items i Left JOIN Orders o ON i.item_id=o.item_id Group by i.item_category order by i.item_category
select i.item_category as CATEGORY, sum((case when weekday(o.order_date)=0 then o.quantity else 0 end)) as MONDAY, sum((case when weekday(o.order_date)=1 then o.quantity else 0 end)) as TUESDAY, sum((case when weekday(o.order_date)=2 then o.quantity else 0 end)) as WEDNESDAY, sum((case when weekday(o.order_date)=3 then o.quantity else 0 end)) as THURSDAY, sum((case when weekday(o.order_date)=4 then o.quantity else 0 end)) as FRIDAY, sum((case when weekday(o.order_date)=5 then o.quantity else 0 end)) as SATURDAY, sum((case when weekday(o.order_date)=6 then o.quantity else 0 end)) as SUNDAY from Items i left join Orders o on i.item_id = o.item_id group by i.item_category order by i.item_category
select i.item_category as CATEGORY, sum(case when WEEKDAY(order_date)=0 then quantity else 0 end) as MONDAY, sum(case when WEEKDAY(order_date)=1 then quantity else 0 end) as TUESDAY, sum(case when WEEKDAY(order_date)=2 then quantity else 0 end) as WEDNESDAY, sum(case when WEEKDAY(order_date)=3 then quantity else 0 end) as THURSDAY ,sum(case when WEEKDAY(order_date)=4 then quantity else 0 end) as FRIDAY ,sum(case when WEEKDAY(order_date)=5 then quantity else 0 end) as SATURDAY ,sum(case when WEEKDAY(order_date)=6 then quantity else 0 end) as SUNDAY from Items i left join Orders o on o.item_id=i.item_id group by i.item_category order by 1
select i.item_category as CATEGORY, sum(case when dayofweek(o.order_date) = 2 then quantity else 0 end) as 'MONDAY', sum(case when dayofweek(o.order_date) = 3 then quantity else 0 end) as 'TUESDAY', sum(case when dayofweek(o.order_date) = 4 then quantity else 0 end) as 'WEDNESDAY', sum(case when dayofweek(o.order_date) = 5 then quantity else 0 end) as 'THURSDAY', sum(case when dayofweek(o.order_date) = 6 then quantity else 0 end) as 'FRIDAY', sum(case when dayofweek(o.order_date) = 7 then quantity else 0 end) as 'SATURDAY', sum(case when dayofweek(o.order_date) = 1 then quantity else 0 end) as 'SUNDAY' from items i left join orders o on o.item_id = i.item_id group by item_category order by item_category
select i.item_category as CATEGORY, sum(case when weekday(o.order_date)=0 then o.quantity else 0 end) as MONDAY, sum(case when weekday(o.order_date)=1 then o.quantity else 0 end) as TUESDAY, sum(case when weekday(o.order_date)=2 then o.quantity else 0 end) as WEDNESDAY, sum(case when weekday(o.order_date)=3 then o.quantity else 0 end) as THURSDAY, sum(case when weekday(o.order_date)=4 then o.quantity else 0 end) as FRIDAY, sum(case when weekday(o.order_date)=5 then o.quantity else 0 end) as SATURDAY, sum(case when weekday(o.order_date)=6 then o.quantity else 0 end) as SUNDAY from orders o RIGHT join items i on o.item_id = i.item_id group by i.item_category order by i.item_category
select i.item_category as CATEGORY, sum(case when weekday(order_date)=0 then quantity else 0 end) as MONDAY, sum(case when weekday(order_date)=1 then quantity else 0 end) as TUESDAY, sum(case when weekday(order_date)=2 then quantity else 0 end) as WEDNESDAY, sum(case when weekday(order_date)=3 then quantity else 0 end) as THURSDAY, sum(case when weekday(order_date)=4 then quantity else 0 end) as FRIDAY, sum(case when weekday(order_date)=5 then quantity else 0 end) as SATURDAY, sum(case when weekday(order_date)=6 then quantity else 0 end) as SUNDAY from Items i left outer join Orders o on o.item_id = i.item_id group by 1 order by 1
select i.item_category as Category, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 2 and item_id in (select item_id from Items where item_category = i.item_category)) as Monday, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 3 and item_id in (select item_id from Items where item_category = i.item_category)) as Tuesday, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 4 and item_id in (select item_id from Items where item_category = i.item_category)) as Wednesday, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 5 and item_id in (select item_id from Items where item_category = i.item_category)) as Thursday, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 6 and item_id in (select item_id from Items where item_category = i.item_category)) as Friday, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 7 and item_id in (select item_id from Items where item_category = i.item_category)) as Saturday, (select coalesce(sum(quantity), 0) from Orders where dayofweek(order_date) = 1 and item_id in (select item_id from Items where item_category = i.item_category)) as Sunday from Items i left join Orders o on i.item_id = o.item_id group by Category order by Category
select i.item_category as Category, ifnull(sum(case when weekday(order_date)=0 then quantity else 0 end),0) as Monday, ifnull(sum(case when weekday(order_date)=1 then quantity else 0 end),0) as Tuesday, ifnull(sum(case when weekday(order_date)=2 then quantity else 0 end),0) as Wednesday, ifnull(sum(case when weekday(order_date)=3 then quantity else 0 end),0) as Thursday, ifnull(sum(case when weekday(order_date)=4 then quantity else 0 end),0) as Friday, ifnull(sum(case when weekday(order_date)=5 then quantity else 0 end),0) as Saturday, ifnull(sum(case when weekday(order_date)=6 then quantity else 0 end),0) as Sunday from Items i left join Orders a on i.item_id=a.item_id group by 1 order by 1
select i.item_category as Category, sum(case when dayname(order_date) = 'Monday' then quantity else 0 end) as 'Monday', sum(case when dayname(order_date) = 'Tuesday'then quantity else 0 end) as 'Tuesday', sum(case when dayname(order_date) = 'Wednesday'then quantity else 0 end) as 'Wednesday', sum(case when dayname(order_date) = 'Thursday'then quantity else 0 end) as 'Thursday', sum(case when dayname(order_date) = 'Friday'then quantity else 0 end) as 'Friday', sum(case when dayname(order_date) = 'Saturday'then quantity else 0 end) as 'Saturday', sum(case when dayname(order_date) = 'Sunday'then quantity else 0 end) as 'Sunday' from orders o right join items i on o.item_id = i.item_id group by item_category order by item_category
select i.item_category as Category, sum(case when dayofweek(o.order_date) = 2 then quantity else 0 end) as Monday, sum(case when dayofweek(o.order_date) = 3 then quantity else 0 end) as Tuesday, sum(case when dayofweek(o.order_date) = 4 then quantity else 0 end) as Wednesday, sum(case when dayofweek(o.order_date) = 5 then quantity else 0 end) as Thursday, sum(case when dayofweek(o.order_date) = 6 then quantity else 0 end) as Friday, sum(case when dayofweek(o.order_date) = 7 then quantity else 0 end) as Saturday, sum(case when dayofweek(o.order_date) = 1 then quantity else 0 end) as Sunday from items i left join orders o using(item_id) group by i.item_category order by i.item_category
select i.item_category as Category, sum(case when weekday(order_date) = 0 then quantity else 0 end) as 'Monday', sum(case when weekday(order_date) = 1 then quantity else 0 end) as 'Tuesday', sum(case when weekday(order_date) = 2 then quantity else 0 end) as 'Wednesday', sum(case when weekday(order_date) = 3 then quantity else 0 end) as 'Thursday', sum(case when weekday(order_date) = 4 then quantity else 0 end) as 'Friday', sum(case when weekday(order_date) = 5 then quantity else 0 end) as 'Saturday', sum(case when weekday(order_date) = 6 then quantity else 0 end) as 'Sunday' from Orders o right join Items i on o.item_id = i.item_id group by i.item_category ORDER BY 1
select i.item_category as Category, sum(case when weekday(order_date)=0 then quantity else 0 end) as 'Monday', sum(case when weekday(order_date)=1 then quantity else 0 end) as 'Tuesday', sum(case when weekday(order_date)=2 then quantity else 0 end) as 'Wednesday', sum(case when weekday(order_date)=3 then quantity else 0 end) as 'Thursday', sum(case when weekday(order_date)=4 then quantity else 0 end) as 'Friday', sum(case when weekday(order_date)=5 then quantity else 0 end) as 'Saturday', sum(case when weekday(order_date)=6 then quantity else 0 end) as 'Sunday' from Orders right join Items i on i.item_id=Orders.item_id group by i.item_category order by i.item_category
select i.item_category as category ,sum(case when dayofweek(o.order_date) = 2 then o.quantity else 0 end) as 'Monday' ,sum(case when dayofweek(o.order_date) = 3 then o.quantity else 0 end) as 'Tuesday' ,sum(case when dayofweek(o.order_date) = 4 then o.quantity else 0 end) as 'Wednesday' ,sum(case when dayofweek(o.order_date) = 5 then o.quantity else 0 end) as 'Thursday' ,sum(case when dayofweek(o.order_date) = 6 then o.quantity else 0 end) as 'Friday' ,sum(case when dayofweek(o.order_date) = 7 then o.quantity else 0 end) as 'Saturday' ,sum(case when dayofweek(o.order_date) = 1 then o.quantity else 0 end) as 'Sunday' from orders o right join items i on o.item_id = i.item_id group by i.item_category order by i.item_category asc
select i.item_category as category, SUM(CASE WHEN DAYNAME(order_date)='Monday' THEN quantity ELSE 0 END ) AS Monday, SUM(CASE WHEN DAYNAME(order_date)='Tuesday' THEN quantity ELSE 0 END ) AS Tuesday, SUM(CASE WHEN DAYNAME(order_date)='Wednesday' THEN quantity ELSE 0 END ) AS Wednesday, SUM(CASE WHEN DAYNAME(order_date)='Thursday' THEN quantity ELSE 0 END ) AS Thursday, SUM(CASE WHEN DAYNAME(order_date)='Friday' THEN quantity ELSE 0 END ) AS Friday, SUM(CASE WHEN DAYNAME(order_date)='Saturday' THEN quantity ELSE 0 END ) AS Saturday, SUM(CASE WHEN DAYNAME(order_date)='Sunday' THEN quantity ELSE 0 END ) AS Sunday from orders o right join items i on o.item_id=i.item_id group by category order by category asc
select i.item_category as category, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=2 then o.quantity else 0 end) as Monday, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=3 then o.quantity else 0 end) as Tuesday, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=4 then o.quantity else 0 end) as Wednesday, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=5 then o.quantity else 0 end) as Thursday, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=6 then o.quantity else 0 end) as Friday, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=7 then o.quantity else 0 end) as Saturday, sum(case when ifnull(DAYOFWEEK(o.order_date),0)=1 then o.quantity else 0 end) as Sunday from Items i left join Orders o on i.item_id = o.item_id group by i.item_category order by i.item_category
select i.item_category as category, sum(case when weekday(o.order_date)=0 then o.quantity else 0 end) as Monday, sum(case when weekday(o.order_date)=1 then o.quantity else 0 end) as Tuesday, sum(case when weekday(o.order_date)=2 then o.quantity else 0 end) as Wednesday, sum(case when weekday(o.order_date)=3 then o.quantity else 0 end) as Thursday, sum(case when weekday(o.order_date)=4 then o.quantity else 0 end) as Friday, sum(case when weekday(o.order_date)=5 then o.quantity else 0 end) as Saturday, sum(case when weekday(o.order_date)=6 then o.quantity else 0 end) as Sunday from orders o right join items i on o.item_id= i.item_id group by i.item_category order by i.item_category
select i.item_category as category, sum(case when weekday(order_date)=0 then quantity else 0 end) as monday, sum(case when weekday(order_date)=1 then quantity else 0 end) as tuesday, sum(case when weekday(order_date)=2 then quantity else 0 end) as Wednesday , sum(case when weekday(order_date)=3 then quantity else 0 end) as Thursday , sum(case when weekday(order_date)=4 then quantity else 0 end) as Friday , sum(case when weekday(order_date)=5 then quantity else 0 end) as Saturday , sum(case when weekday(order_date)=6 then quantity else 0 end) as Sunday from items as i left join orders as o using (item_id) group by i.item_category order by i.item_category
select i.item_category as category, sum(ifnull(case when WEEKDAY(order_date) = 0 then o.quantity end, 0)) as 'Monday', sum(ifnull(case when WEEKDAY(order_date) = 1 then o.quantity end, 0)) as 'Tuesday', sum(ifnull(case when WEEKDAY(order_date) = 2 then o.quantity end, 0)) as 'Wednesday', sum(ifnull(case when WEEKDAY(order_date) = 3 then o.quantity end, 0)) as 'Thursday', sum(ifnull(case when WEEKDAY(order_date) = 4 then o.quantity end, 0)) as 'Friday', sum(ifnull(case when WEEKDAY(order_date) = 5 then o.quantity end, 0)) as 'Saturday', sum(ifnull(case when WEEKDAY(order_date) = 6 then o.quantity end, 0)) as 'Sunday' from Orders o right join Items i on o.item_id = i.item_id group by i.item_category order by i.item_category
select i.item_category category, sum(case when dayname(o.order_date) = 'Monday' then quantity else 0 end) Monday, sum(case when dayname(o.order_date) = 'Tuesday' then quantity else 0 end) Tuesday, sum(case when dayname(o.order_date) = 'Wednesday' then quantity else 0 end) Wednesday, sum(case when dayname(o.order_date) = 'Thursday' then quantity else 0 end) Thursday, sum(case when dayname(o.order_date) = 'Friday' then quantity else 0 end) Friday, sum(case when dayname(o.order_date) = 'Saturday' then quantity else 0 end) Saturday, sum(case when dayname(o.order_date) = 'Sunday' then quantity else 0 end) Sunday from orders o right join items i on o.item_id = i.item_id group by category order by category
select item_category "Category", sum(case when weekday(order_date) = 0 then quantity else 0 end) "Monday", sum(case when weekday(order_date) = 1 then quantity else 0 end) "Tuesday", sum(case when weekday(order_date) = 2 then quantity else 0 end) "Wednesday", sum(case when weekday(order_date) = 3 then quantity else 0 end) "Thursday", sum(case when weekday(order_date) = 4 then quantity else 0 end) "Friday", sum(case when weekday(order_date) = 5 then quantity else 0 end) "Saturday", sum(case when weekday(order_date) = 6 then quantity else 0 end) "Sunday" from orders o right join items i on i.item_id = o.item_id group by 1 order by 1
select item_category 'Category', sum(case when weekday(order_date)=0 then O.quantity else 0 end) as Monday, sum(case when weekday(order_date)=1 then O.quantity else 0 end) as Tuesday, sum(case when weekday(order_date)=2 then O.quantity else 0 end) as Wednesday, sum(case when weekday(order_date)=3 then O.quantity else 0 end) as Thursday, sum(case when weekday(order_date)=4 then O.quantity else 0 end) as Friday, sum(case when weekday(order_date)=5 then O.quantity else 0 end) as Saturday, sum(case when weekday(order_date)=6 then O.quantity else 0 end) as Sunday from Orders O right join Items I on O.item_id=I.item_id group by Category order by Category
select item_category CATEGORY , sum(case when dayofweek(order_date) = 2 then quantity else 0 end) MONDAY , sum(case when dayofweek(order_date) = 3 then quantity else 0 end) TUESDAY , sum(case when dayofweek(order_date) = 4 then quantity else 0 end) WEDNESDAY , sum(case when dayofweek(order_date) = 5 then quantity else 0 end) THURSDAY , sum(case when dayofweek(order_date) = 6 then quantity else 0 end) FRIDAY , sum(case when dayofweek(order_date) = 7 then quantity else 0 end) SATURDAY , sum(case when dayofweek(order_date) = 1 then quantity else 0 end) SUNDAY from orders a right join items b on a.item_id = b.item_id group by item_category order by item_category
select item_category CATEGORY, ifnull(sum(if(dayofweek(order_date)=2, 1, 0) * quantity), 0) MONDAY, ifnull(sum(if(dayofweek(order_date)=3, 1, 0) * quantity), 0) TUESDAY, ifnull(sum(if(dayofweek(order_date)=4, 1, 0) * quantity), 0) WEDNESDAY, ifnull(sum(if(dayofweek(order_date)=5, 1, 0) * quantity), 0) THURSDAY, ifnull(sum(if(dayofweek(order_date)=6, 1, 0) * quantity), 0) FRIDAY, ifnull(sum(if(dayofweek(order_date)=7, 1, 0) * quantity), 0) SATURDAY, ifnull(sum(if(dayofweek(order_date)=1, 1, 0) * quantity), 0) SUNDAY from items left join orders using (item_id) group by item_category order by CATEGORY
select item_category CATEGORY, sum(case when dayName(order_date) = 'Monday' then quantity else 0 end) as MONDAY, sum(case when DAyName(order_date) = 'Tuesday' then quantity else 0 end) as TUESDAY, sum(case when DAyName(order_date) = 'Wednesday' then quantity else 0 end) as WEDNESDAY, sum(case when DAyName(order_date) = 'Thursday' then quantity else 0 end) as THURSDAY, sum(case when DAyName(order_date) = 'Friday' then quantity else 0 end) as FRIDAY, sum(case when DAyName(order_date) = 'Saturday' then quantity else 0 end) as SATURDAY, sum(case when DAyName(order_date) = 'Sunday' then quantity else 0 end) as SUNDAY from items left join orders on orders.item_id = items.item_id group by 1 order by 1
select item_category Category, ifnull(sum(case when dayname(o.order_date)='Monday' then quantity else 0 end), 0) Monday, ifnull(sum(case when dayname(o.order_date)='Tuesday' then quantity else 0 end), 0) Tuesday, ifnull(sum(case when dayname(o.order_date)='Wednesday' then quantity else 0 end), 0) Wednesday, ifnull(sum(case when dayname(o.order_date)='Thursday' then quantity else 0 end), 0) Thursday, ifnull(sum(case when dayname(o.order_date)='Friday' then quantity else 0 end), 0) Friday, ifnull(sum(case when dayname(o.order_date)='Saturday' then quantity else 0 end), 0) Saturday, ifnull(sum(case when dayname(o.order_date)='Sunday' then quantity else 0 end), 0) Sunday from Items i left join Orders o using(item_id) group by item_category order by item_category
select item_category as "CATEGORY", sum(case when weekday(order_date) = 0 then quantity else 0 end) as 'MONDAY', sum(case when weekday(order_date) = 1 then quantity else 0 end) as 'TUESDAY', sum(case when weekday(order_date) = 2 then quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(order_date) = 3 then quantity else 0 end) as 'THURSDAY', sum(case when weekday(order_date) = 4 then quantity else 0 end) as 'FRIDAY', sum(case when weekday(order_date) = 5 then quantity else 0 end) as 'SATURDAY', sum(case when weekday(order_date) = 6 then quantity else 0 end) as 'SUNDAY' from Orders as o right join Items i on o.item_id=i.item_id group by 1 ORDER BY 1
select item_category as "Category", sum(case when weekday(order_date) = 0 then quantity else 0 end) as Monday, sum(case when weekday(order_date) = 1 then quantity else 0 end) as Tuesday, sum(case when weekday(order_date) = 2 then quantity else 0 end) as Wednesday, sum(case when weekday(order_date) = 3 then quantity else 0 end) as Thursday, sum(case when weekday(order_date) = 4 then quantity else 0 end) as Friday, sum(case when weekday(order_date) = 5 then quantity else 0 end) as Saturday, sum(case when weekday(order_date) = 6 then quantity else 0 end) as Sunday from orders o right join items i on o.item_id = i.item_id group by 1 order by 1
select item_category as 'CATEGORY', sum(case when weekday(order_date) = 0 then quantity else 0 end) as 'MONDAY', sum(case when weekday(order_date) = 1 then quantity else 0 end) as 'TUESDAY', sum(case when weekday(order_date) = 2 then quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(order_date) = 3 then quantity else 0 end) as 'THURSDAY', sum(case when weekday(order_date) = 4 then quantity else 0 end) as 'FRIDAY', sum(case when weekday(order_date) = 5 then quantity else 0 end) as 'SATURDAY', sum(case when weekday(order_date) = 6 then quantity else 0 end) as 'SUNDAY' from Orders o right join Items i on o.item_id = i.item_id group by item_category order by item_category
select item_category as 'Category', ifnull(sum(if(dayofweek(order_date) = 2, quantity,0)),0) as 'MONDAY', ifnull(sum(if(dayofweek(order_date) = 3, quantity,0)),0) as 'TUESDAY', ifnull(sum(if(dayofweek(order_date) = 4, quantity,0)),0) as 'WEDNESDAY', ifnull(sum(if(dayofweek(order_date) = 5, quantity,0)),0) as 'THURSDAY', ifnull(sum(if(dayofweek(order_date) = 6, quantity,0)),0) as 'FRIDAY', ifnull(sum(if(dayofweek(order_date) = 7, quantity,0)),0) as 'SATURDAY', ifnull(sum(if(dayofweek(order_date) = 1, quantity,0)),0) as 'SUNDAY' from Items left join Orders using(item_id) group by item_category order by item_category
select item_category as CATEGORY ,sum(case when dayofweek(order_date) = 2 then coalesce(quantity, 0) else 0 end) as MONDAY ,sum(case when dayofweek(order_date) = 3 then coalesce(quantity, 0) else 0 end) as TUESDAY ,sum(case when dayofweek(order_date) = 4 then coalesce(quantity, 0) else 0 end) as WEDNESDAY ,sum(case when dayofweek(order_date) = 5 then coalesce(quantity, 0) else 0 end) as THURSDAY ,sum(case when dayofweek(order_date) = 6 then coalesce(quantity, 0) else 0 end) as FRIDAY ,sum(case when dayofweek(order_date) = 7 then coalesce(quantity, 0) else 0 end) as SATURDAY ,sum(case when dayofweek(order_date) = 1 then coalesce(quantity, 0) else 0 end) as SUNDAY from items a left join orders b on a.item_id = b.item_id group by 1 order by 1
select item_category as CATEGORY ,sum(case when weekday=0 then cat_units else 0 end) as MONDAY ,sum(case when weekday=1 then cat_units else 0 end) as TUESDAY ,sum(case when weekday=2 then cat_units else 0 end) as WEDNESDAY ,sum(case when weekday=3 then cat_units else 0 end) as THURSDAY ,sum(case when weekday=4 then cat_units else 0 end) as FRIDAY ,sum(case when weekday=5 then cat_units else 0 end) as SATURDAY ,sum(case when weekday=6 then cat_units else 0 end) as SUNDAY from ( select a.item_category, b.weekday, coalesce(sum(item_units),0) as cat_units from Items as a left join ( select item_id, weekday(order_date) as weekday, sum(quantity) as item_units from Orders group by 1,2 ) as b on a.item_id=b.item_id group by 1,2 ) as c group by 1 order by 1
select item_category as CATEGORY, ifnull(sum(Monday), 0) as MONDAY, ifnull(sum(Tuesday),0) as TUESDAY, ifnull(sum(Wednesday),0) as WEDNESDAY, ifnull(sum(Thursday),0) as THURSDAY, ifnull(sum(Friday),0) as FRIDAY, ifnull(sum(Saturday),0) as SATURDAY, ifnull(sum(Sunday),0) as SUNDAY from Items i left join ( select item_id, sum(case when weekday(o.order_date) = 0 then quantity else 0 end) as Monday, sum(case when weekday(o.order_date) = 1 then quantity else 0 end) as Tuesday, sum(case when weekday(o.order_date) = 2 then quantity else 0 end) as Wednesday, sum(case when weekday(o.order_date) = 3 then quantity else 0 end) as Thursday, sum(case when weekday(o.order_date) = 4 then quantity else 0 end) as Friday, sum(case when weekday(o.order_date) = 5 then quantity else 0 end) as Saturday, sum(case when weekday(o.order_date) = 6 then quantity else 0 end) as Sunday from Orders o group by item_id ) as tab on i.item_id = tab.item_id group by 1 order by 1
select item_category as CATEGORY, sum(case when date_format(order_date,'%W')='Monday' then quantity else 0 end ) as 'MONDAY', sum(case when date_format(order_date,'%W')='Tuesday' then quantity else 0 end ) as 'TUESDAY', sum(case when date_format(order_date,'%W') ='Wednesday' then quantity else 0 end ) as 'WEDNESDAY', sum(case when date_format(order_date,'%W') ='Thursday' then quantity else 0 end ) as 'THURSDAY', sum(case when date_format(order_date,'%W') ='Friday' then quantity else 0 end ) as 'FRIDAY', sum(case when date_format(order_date,'%W')='Saturday' then quantity else 0 end ) as 'SATURDAY', sum(case when date_format(order_date,'%W')='Sunday' then quantity else 0 end ) as 'SUNDAY' from Items left join Orders using (item_id) group by 1 ORDER BY 1
select item_category as CATEGORY, sum(case when dayname(order_date) = 'Monday' then c.quantity else 0 end) as 'MONDAY', sum(case when dayname(order_date) = 'Tuesday' then c.quantity else 0 end) as 'TUESDAY', sum(case when dayname(order_date) = 'Wednesday' then c.quantity else 0 end) as 'WEDNESDAY', sum(case when dayname(order_date) = 'Thursday' then c.quantity else 0 end) as 'THURSDAY', sum(case when dayname(order_date) = 'Friday' then c.quantity else 0 end) as 'FRIDAY', sum(case when dayname(order_date) = 'Saturday' then c.quantity else 0 end) as 'SATURDAY', sum(case when dayname(order_date) = 'Sunday' then c.quantity else 0 end) as 'SUNDAY' from ( select b.item_category, a.quantity, a.order_date from Items b left join Orders a using (item_id) ) c group by item_category order by item_category
select item_category as CATEGORY, sum(case when dayname(order_date)='Monday' then quantity else 0 end) as 'MONDAY', sum(case when dayname(order_date)='Tuesday' then quantity else 0 end) as 'TUESDAY', sum(case when dayname(order_date)='Wednesday' then quantity else 0 end) as 'WEDNESDAY', sum(case when dayname(order_date)='ThuRsday' then quantity else 0 end) as 'THURSDAY', sum(case when dayname(order_date)='Friday' then quantity else 0 end) as 'FRIDAY', sum(case when dayname(order_date)='Saturday' then quantity else 0 end) as 'SATURDAY', sum(case when dayname(order_date)='Sunday' then quantity else 0 end) as 'SUNDAY' from orders o right join items i on o.item_id=i.item_id group by item_category order by item_category
select item_category as CATEGORY, sum(case when dayofweek(order_date) = 2 then quantity else 0 end) as "MONDAY" , sum(case when dayofweek(order_date) = 3 then quantity else 0 end) as "TUESDAY", sum(case when dayofweek(order_date) = 4 then quantity else 0 end) as "WEDNESDAY", sum(case when dayofweek(order_date) = 5 then quantity else 0 end) as "THURSDAY", sum(case when dayofweek(order_date) = 6 then quantity else 0 end) as "FRIDAY", sum(case when dayofweek(order_date) = 7 then quantity else 0 end) as "SATURDAY", sum(case when dayofweek(order_date) = 1 then quantity else 0 end) as "SUNDAY" from orders o right join items i on o.item_id=i.item_id group by 1 order by 1
select item_category as CATEGORY, sum(case when week_day = 0 then quantity else 0 end) as MONDAY, sum(case when week_day = 1 then quantity else 0 end) as TUESDAY, sum(case when week_day = 2 then quantity else 0 end) as WEDNESDAY, sum(case when week_day = 3 then quantity else 0 end) as THURSDAY, sum(case when week_day = 4 then quantity else 0 end) as FRIDAY, sum(case when week_day = 5 then quantity else 0 end) as SATURDAY, sum(case when week_day = 6 then quantity else 0 end) as SUNDAY from (select *, weekday(order_date) as week_day from Orders right join Items using (item_id) ) t group by 1 order by 1
select item_category as CATEGORY, sum(case when weekday(order_date) = 0 then quantity else 0 end) as MONDAY, sum(case when weekday(order_date) = 1 then quantity else 0 end) as TUESDAY, sum(case when weekday(order_date) = 2 then quantity else 0 end) as WEDNESDAY, sum(case when weekday(order_date) = 3 then quantity else 0 end) as THURSDAY, sum(case when weekday(order_date) = 4 then quantity else 0 end) as FRIDAY, sum(case when weekday(order_date) = 5 then quantity else 0 end) as SATURDAY, sum(case when weekday(order_date) = 6 then quantity else 0 end) as SUNDAY from Items i left join Orders o on i.item_id = o.item_id group by 1 order by 1
select item_category as CATEGORY, sum(if(weekday(order_date)=0,quantity,0)) as MONDAY, sum(if(weekday(order_date)=1,quantity,0)) as TUESDAY, sum(if(weekday(order_date)=2,quantity,0)) as WEDNESDAY, sum(if(weekday(order_date)=3,quantity,0)) as THURSDAY, sum(if(weekday(order_date)=4,quantity,0)) as FRIDAY, sum(if(weekday(order_date)=5,quantity,0)) as SATURDAY, sum(if(weekday(order_date)=6,quantity,0)) as SUNDAY from orders as o right join items as i using (item_id) group by 1 order by 1
select item_category as CATEGORY,sum(case when weekday(order_date) = 0 then quantity else 0 end) as MONDAY, sum(case when weekday(order_date) = 1 then quantity else 0 end) as TUESDAY, sum(case when weekday(order_date) = 2 then quantity else 0 end) as WEDNESDAY, sum(case when weekday(order_date) = 3 then quantity else 0 end) as THURSDAY, sum(case when weekday(order_date) = 4 then quantity else 0 end) as FRIDAY, sum(case when weekday(order_date) = 5 then quantity else 0 end) as SATURDAY, sum(case when weekday(order_date) = 6 then quantity else 0 end) as SUNDAY from Orders right join Items on Orders.item_id = Items.item_id group by 1 order by 1
select item_category as Category , sum(case when dayofweek(order_date) = 2 then quantity else 0 end) as Monday , sum(case when dayofweek(order_date) = 3 then quantity else 0 end) as Tuesday , sum(case when dayofweek(order_date) = 4 then quantity else 0 end) as Wednesday , sum(case when dayofweek(order_date) = 5 then quantity else 0 end) as Thursday , sum(case when dayofweek(order_date) = 6 then quantity else 0 end) as Friday , sum(case when dayofweek(order_date) = 7 then quantity else 0 end) as Saturday , sum(case when dayofweek(order_date) = 1 then quantity else 0 end) as Sunday from orders a right join items b on a.item_id = b.item_id group by 1 order by 1
select item_category as Category , sum(if(weekday(order_date)=0, quantity, 0)) as Monday, sum(if(weekday(order_date)=1, quantity, 0)) as Tuesday, sum(if(weekday(order_date)=2, quantity, 0)) as Wednesday, sum(if(weekday(order_date)=3, quantity, 0)) as Thursday, sum(if(weekday(order_date)=4, quantity, 0)) as Friday, sum(if(weekday(order_date)=5, quantity, 0)) as Saturday, sum(if(weekday(order_date)=6, quantity, 0)) as Sunday from items as i left join orders as o on i.item_id = o.item_id group by item_category order by item_category
select item_category as Category ,sum(case when dayname(order_date) = 'Monday' then quantity else 0 end) as Monday ,sum(case when dayname(order_date) = 'Tuesday' then quantity else 0 end) as Tuesday ,sum(case when dayname(order_date) = 'Wednesday' then quantity else 0 end) as Wednesday ,sum(case when dayname(order_date) = 'Thursday' then quantity else 0 end) as Thursday ,sum(case when dayname(order_date) = 'Friday' then quantity else 0 end) as Friday ,sum(case when dayname(order_date) = 'Saturday' then quantity else 0 end) as Saturday ,sum(case when dayname(order_date) = 'Sunday' then quantity else 0 end) as Sunday from Items items left join Orders orders on items.item_id = orders.item_id group by item_category order by item_category
select item_category as Category, sum(case when DAYOFWEEK(order_date) = 2 then quantity else 0 end) as 'Monday', sum(case when DAYOFWEEK(order_date) = 3 then quantity else 0 end) as 'Tuesday', sum(case when DAYOFWEEK(order_date) = 4 then quantity else 0 end) as 'Wednesday', sum(case when DAYOFWEEK(order_date) = 5 then quantity else 0 end) as 'Thursday', sum(case when DAYOFWEEK(order_date) = 6 then quantity else 0 end) as 'Friday', sum(case when DAYOFWEEK(order_date) = 7 then quantity else 0 end) as 'Saturday', sum(case when DAYOFWEEK(order_date) = 1 then quantity else 0 end) as 'Sunday' FROM Orders right join Items on Orders.item_id = Items.item_id group by item_category order by item_category
select item_category as Category, sum(case when day = 'Monday' then total_quant else 0 end) as Monday, sum(case when day = 'Tuesday' then total_quant else 0 end) as Tuesday, sum(case when day = 'Wednesday' then total_quant else 0 end) as Wednesday, sum(case when day = 'Thursday' then total_quant else 0 end) as Thursday, sum(case when day = 'Friday' then total_quant else 0 end) as Friday, sum(case when day = 'Saturday' then total_quant else 0 end) as Saturday, sum(case when day = 'Sunday' then total_quant else 0 end) as Sunday from( select dayname(o.order_date) as day, i.item_category, sum(o.quantity) as total_quant from Items as i left join Orders as o on o.item_id = i.item_id group by 1, 2) as a group by Category order by Category
select item_category as Category, sum(case when dayname(order_date) = 'Monday' then quantity else 0 end) as Monday, sum(case when dayname(order_date) = 'Tuesday' then quantity else 0 end) as Tuesday, sum(case when dayname(order_date) = 'Wednesday' then quantity else 0 end) as Wednesday, sum(case when dayname(order_date) = 'Thursday' then quantity else 0 end) as Thursday, sum(case when dayname(order_date) = 'Friday' then quantity else 0 end) as Friday, sum(case when dayname(order_date) = 'Saturday' then quantity else 0 end) as Saturday, sum(case when dayname(order_date) = 'Sunday' then quantity else 0 end) as Sunday from orders o right join items i on o.item_id = i.item_id group by item_category order by item_category
select item_category as Category, sum(case when dayname(order_date)='Monday' then quantity else 0 end) as Monday, sum(case when dayname(order_date) ='Tuesday' then quantity else 0 end) as Tuesday, sum(case when dayname(order_date) ='Wednesday' then quantity else 0 end) as Wednesday, sum(case when dayname(order_date) ='Thursday' then quantity else 0 end) as Thursday, sum(case when dayname(order_date) ='Friday' then quantity else 0 end) as Friday, sum(case when dayname(order_date) ='Saturday' then quantity else 0 end) as Saturday, sum(case when dayname(order_date) ='Sunday' then quantity else 0 end) as Sunday from items left join orders using(item_id) group by item_category order by item_category
select item_category as Category, sum(case when dayofweek(order_date)=2 then quantity else 0 end) as 'Monday', sum(case when dayofweek(order_date)=3 then quantity else 0 end) as 'Tuesday', sum(case when dayofweek(order_date)=4 then quantity else 0 end) as 'Wednesday', sum(case when dayofweek(order_date)=5 then quantity else 0 end) as 'Thursday', sum(case when dayofweek(order_date)=6 then quantity else 0 end) as 'Friday', sum(case when dayofweek(order_date)=7 then quantity else 0 end) as 'Saturday', sum(case when dayofweek(order_date)=1 then quantity else 0 end) as 'Sunday' from Items as I left join Orders as O on O.item_id=I.item_id group by item_category order by 1
select item_category as Category, sum(case when dow = 2 then total else 0 end) as Monday, sum(case when dow = 3 then total else 0 end) as Tuesday, sum(case when dow = 4 then total else 0 end) as Wednesday, sum(case when dow = 5 then total else 0 end) as Thursday, sum(case when dow = 6 then total else 0 end) as Friday, sum(case when dow = 7 then total else 0 end) as Saturday, sum(case when dow = 1 then total else 0 end) as Sunday from (select i.item_category, DAYOFWEEK(o.order_date) dow, sum(o.quantity) as total from Items i left join Orders o on o.item_id = i.item_id group by 1, 2 order by 1, 2 ) as temp group by Category
select item_category as Category, sum(case when weekday = 0 then quantity else 0 end) as Monday, sum(case when weekday = 1 then quantity else 0 end) as Tuesday, sum(case when weekday = 2 then quantity else 0 end) as Wednesday, sum(case when weekday = 3 then quantity else 0 end) as Thursday, sum(case when weekday = 4 then quantity else 0 end) as Friday, sum(case when weekday = 5 then quantity else 0 end) as Saturday, sum(case when weekday = 6 then quantity else 0 end) as Sunday from ( select weekday, quantity, item_category from (select weekday(o.order_date) as weekday, o.quantity, i.item_category from Orders o right join Items i on o.item_id = i.item_id) a ) b group by item_category order by item_category
select item_category as Category, sum(if(DAYOFWEEK(order_date) = 2, quantity, 0)) as 'Monday', sum(if(DAYOFWEEK(order_date) = 3, quantity, 0)) as 'Tuesday', sum(if(DAYOFWEEK(order_date) = 4, quantity, 0)) as 'Wednesday', sum(if(DAYOFWEEK(order_date) = 5, quantity, 0)) as 'Thursday', sum(if(DAYOFWEEK(order_date) = 6, quantity, 0)) as 'Friday', sum(if(DAYOFWEEK(order_date) = 7, quantity, 0)) as 'Saturday', sum(if(DAYOFWEEK(order_date) = 1, quantity, 0)) as 'Sunday' from orders right join items using (item_id) group by item_category order by item_category
select item_category as Category, sum(if(dayname(order_date)='Monday', quantity, 0)) as Monday, sum(if(dayname(order_date)='Tuesday', quantity, 0)) as Tuesday, sum(if(dayname(order_date)='Wednesday', quantity, 0)) as Wednesday, sum(if(dayname(order_date)='Thursday', quantity, 0)) as Thursday, sum(if(dayname(order_date)='Friday', quantity, 0)) as Friday, sum(if(dayname(order_date)='Saturday', quantity, 0)) as Saturday, sum(if(dayname(order_date)='Sunday', quantity, 0)) as Sunday from Orders right join Items using(item_id) group by 1 order by 1
select item_category as Category, sum(if(dayofweek(order_date) = 2,quantity, 0)) as Monday, sum(if(dayofweek(order_date) = 3,quantity, 0)) as Tuesday, sum(if(dayofweek(order_date) = 4,quantity, 0)) as Wednesday, sum(if(dayofweek(order_date) = 5,quantity, 0)) as Thursday, sum(if(dayofweek(order_date) = 6,quantity, 0)) as Friday, sum(if(dayofweek(order_date) = 7,quantity, 0)) as Saturday, sum(if(dayofweek(order_date) = 1,quantity, 0)) as Sunday from Orders right join Items on Items.item_id = Orders.item_id group by Category order by Category
select item_category as Category, sum(if(weekday(Orders.order_date)=0, quantity, 0)) as Monday, sum(if(weekday(Orders.order_date)=1, quantity, 0)) as Tuesday, sum(if(weekday(Orders.order_date)=2, quantity, 0)) as Wednesday, sum(if(weekday(Orders.order_date)=3, quantity, 0)) as Thursday, sum(if(weekday(Orders.order_date)=4, quantity, 0)) as Friday, sum(if(weekday(Orders.order_date)=5, quantity, 0)) as Saturday, sum(if(weekday(Orders.order_date)=6, quantity, 0)) as Sunday from Items left join Orders on Orders.item_id = Items.item_id group by Category order by Category
select item_category as Category, sum(if(weekday(order_date)=0, quantity, 0)) as Monday, sum(if(weekday(order_date)=1, quantity, 0)) as Tuesday, sum(if(weekday(order_date)=2, quantity, 0)) as Wednesday, sum(if(weekday(order_date)=3, quantity, 0)) as Thursday, sum(if(weekday(order_date)=4, quantity, 0)) as Friday, sum(if(weekday(order_date)=5, quantity, 0)) as Saturday, sum(if(weekday(order_date)=6, quantity, 0)) as Sunday from items as i left join orders as o on i.item_id = o.item_id group by item_category order by item_category
select item_category as Category, sum(if(weekday(order_date)=0, quantity,0)) as Monday, sum(if(weekday(order_date)=1, quantity,0)) as Tuesday, sum(if(weekday(order_date)=2, quantity,0)) as Wednesday, sum(if(weekday(order_date)=3, quantity,0)) as Thursday, sum(if(weekday(order_date)=4, quantity,0)) as Friday, sum(if(weekday(order_date)=5, quantity,0)) as Saturday, sum(if(weekday(order_date)=6, quantity,0)) as Sunday from (select o.order_date, o.item_id as oid, o.quantity, i.item_id as iid, i.item_category from Orders as o right join Items as i on o.item_id = i.item_id)a group by a.item_category order by a.item_category
select item_category as Category, sum(if(weekday(order_date)=0, quantity,0)) as Monday, sum(if(weekday(order_date)=1, quantity,0)) as Tuesday, sum(if(weekday(order_date)=2, quantity,0)) as Wednesday, sum(if(weekday(order_date)=3, quantity,0)) as Thursday, sum(if(weekday(order_date)=4, quantity,0)) as Friday, sum(if(weekday(order_date)=5, quantity,0)) as Saturday, sum(if(weekday(order_date)=6, quantity,0)) as Sunday from Orders right join Items on Orders.item_id = Items.item_id group by Category order by Category
select item_category as category, SUM( case when weekday(order_date) =0 then quantity else 0 end ) as Monday, SUM( case when weekday(order_date)=1 then quantity else 0 end ) as Tuesday, SUM( case when weekday(order_date)=2 then quantity else 0 end ) as Wednesday , SUM( case when weekday(order_date)=3 then quantity else 0 end ) as Thursday , SUM( case when weekday(order_date)=4 then quantity else 0 end ) as Friday , SUM( case when weekday(order_date)=5 then quantity else 0 end ) as Saturday , SUM( case when weekday(order_date)=6 then quantity else 0 end ) as Sunday from items left join orders using (item_id) group by item_category order by item_category
select item_category as category, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 2 THEN quantity ELSE 0 END) AS Monday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 3 THEN quantity ELSE 0 END) AS Tuesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 4 THEN quantity ELSE 0 END) AS Wednesday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 5 THEN quantity ELSE 0 END) AS Thursday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 6 THEN quantity ELSE 0 END) AS Friday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 7 THEN quantity ELSE 0 END) AS Saturday, SUM(CASE WHEN DAYOFWEEK(o.order_date) = 1 THEN quantity ELSE 0 END) AS Sunday from orders o right join items i on i.item_id = o.item_id group by category order by category
select item_category as category, ifnull(sum(case when dayofweek(order_date) = 2 then quantity else 0 end), 0) as Monday, ifnull(sum(case when dayofweek(order_date) = 3 then quantity else 0 end), 0) as Tuesday, ifnull(sum(case when dayofweek(order_date) = 4 then quantity else 0 end), 0) as Wednesday, ifnull(sum(case when dayofweek(order_date) = 5 then quantity else 0 end), 0) as Thursday, ifnull(sum(case when dayofweek(order_date) = 6 then quantity else 0 end), 0) as Friday, ifnull(sum(case when dayofweek(order_date) = 7 then quantity else 0 end), 0) as Saturday, ifnull(sum(case when dayofweek(order_date) = 1 then quantity else 0 end), 0) as Sunday from items i left join orders o on i.item_id = o.item_id group by item_category order by item_category
select item_category as category, sum(IF(DAYNAME(order_date) = 'Monday', quantity, 0)) as monday, sum(IF(DAYNAME(order_date) = 'Tuesday', quantity, 0)) as Tuesday, sum(IF(DAYNAME(order_date) = 'Wednesday', quantity, 0)) as Wednesday, sum(IF(DAYNAME(order_date) = 'Thursday', quantity, 0)) as Thursday, sum(IF(DAYNAME(order_date) = 'Friday', quantity, 0)) as Friday, sum(IF(DAYNAME(order_date) = 'Saturday', quantity, 0)) as Saturday, sum(IF(DAYNAME(order_date) = 'Sunday', quantity, 0)) as Sunday from items i left join orders o on i.item_id = o.item_id group by 1 order by 1
select item_category as category, sum(case when Dayname(order_date)='Monday' then quantity else 0 end) as Monday, sum(case when Dayname(order_date)='Tuesday' then quantity else 0 end) as Tuesday, sum(case when Dayname(order_date)='Wednesday' then quantity else 0 end) as Wednesday, sum(case when Dayname(order_date)='Thursday' then quantity else 0 end) as Thursday, sum(case when Dayname(order_date)='Friday' then quantity else 0 end) as Friday, sum(case when Dayname(order_date)='Saturday' then quantity else 0 end) as Saturday, sum(case when Dayname(order_date)='Sunday' then quantity else 0 end) as Sunday from Items I left join Orders O on I.item_id = O.item_id group by category order by category
select item_category as category, sum(case when date_format(order_date, "%W") = 'Monday' then quantity else 0 end) as Monday, sum(case when date_format(order_date, "%W") = 'Tuesday' then quantity else 0 end) as Tuesday, sum(case when date_format(order_date, "%W") = 'Wednesday' then quantity else 0 end) as Wednesday, sum(case when date_format(order_date, "%W") = 'Thursday' then quantity else 0 end) as Thursday, sum(case when date_format(order_date, "%W") = 'Friday' then quantity else 0 end) as Friday, sum(case when date_format(order_date, "%W") = 'Saturday' then quantity else 0 end) as Saturday, sum(case when date_format(order_date, "%W") = 'Sunday' then quantity else 0 end) as Sunday from Items left join Orders using(item_id) group by item_category order by 1
select item_category as category, sum(case when dayofweek(order_date) = 2 then ifnull(quantity, 0) else 0 end) as Monday, sum(case when dayofweek(order_date) = 3 then ifnull(quantity, 0) else 0 end) as Tuesday, sum(case when dayofweek(order_date) = 4 then ifnull(quantity, 0) else 0 end) as Wednesday, sum(case when dayofweek(order_date) = 5 then ifnull(quantity, 0) else 0 end) as Thursday, sum(case when dayofweek(order_date) = 6 then ifnull(quantity, 0) else 0 end) as Friday, sum(case when dayofweek(order_date) = 7 then ifnull(quantity, 0) else 0 end) as Saturday, sum(case when dayofweek(order_date) = 1 then ifnull(quantity, 0) else 0 end) as Sunday from Items i left join Orders o on i.item_id = o.item_id group by item_category order by item_category
select item_category as category, sum(case when dayofweek(order_date) = 2 then quantity else 0 end ) as Monday, sum(case when dayofweek(order_date) = 3 then quantity else 0 end ) as Tuesday, sum(case when dayofweek(order_date) = 4 then quantity else 0 end ) as Wednesday, sum(case when dayofweek(order_date) = 5 then quantity else 0 end ) as Thursday, sum(case when dayofweek(order_date) = 6 then quantity else 0 end ) as Friday, sum(case when dayofweek(order_date) = 7 then quantity else 0 end ) as Saturday, sum(case when dayofweek(order_date) = 1 then quantity else 0 end ) as Sunday from orders right join items on orders.item_id = items.item_id group by 1 order by 1
select item_category as category, sum(case when dayofweek(order_date)=2 then ifnull(quantity,0) else 0 end) as Monday, sum(case when dayofweek(order_date)=3 then ifnull(quantity,0) else 0 end) as Tuesday, sum(case when dayofweek(order_date)=4 then ifnull(quantity,0) else 0 end) as Wednesday, sum(case when dayofweek(order_date)=5 then ifnull(quantity,0) else 0 end) as Thursday, sum(case when dayofweek(order_date)=6 then ifnull(quantity,0) else 0 end) as Friday, sum(case when dayofweek(order_date)=7 then ifnull(quantity,0) else 0 end) as Saturday, sum(case when dayofweek(order_date)=1 then ifnull(quantity,0) else 0 end) as Sunday from orders right join items using(item_id) group by item_category order by category
select item_category as category, sum(case when dayofweek(order_date)=2 then quantity else 0 end) Monday, sum(case when dayofweek(order_date)=3 then quantity else 0 end) Tuesday, sum(case when dayofweek(order_date)=4 then quantity else 0 end) Wednesday, sum(case when dayofweek(order_date)=5 then quantity else 0 end) Thursday, sum(case when dayofweek(order_date)=6 then quantity else 0 end) Friday, sum(case when dayofweek(order_date)=7 then quantity else 0 end) Saturday, sum(case when dayofweek(order_date)=1 then quantity else 0 end) Sunday from Items i left join orders o on i.item_id = o.item_id group by category order by category
select item_category as category, sum(case when dayofweek(order_date)=2 then quantity else 0 end) as Monday, sum(case when dayofweek(order_date)=3 then quantity else 0 end) as Tuesday, sum(case when dayofweek(order_date)=4 then quantity else 0 end) as Wednesday, sum(case when dayofweek(order_date)=5 then quantity else 0 end) as Thursday, sum(case when dayofweek(order_date)=6 then quantity else 0 end) as Friday, sum(case when dayofweek(order_date)=7 then quantity else 0 end) as Saturday, sum(case when dayofweek(order_date)=1 then quantity else 0 end) as Sunday from orders o right join items i on i.item_id=o.item_id group by item_category order by item_category
select item_category as category, sum(case when weekday = 0 then total_q else 0 end) as Monday, sum(case when weekday = 1 then total_q else 0 end) as Tuesday, sum(case when weekday = 2 then total_q else 0 end) as Wednesday, sum(case when weekday = 3 then total_q else 0 end) as Thursday, sum(case when weekday = 4 then total_q else 0 end) as Friday, sum(case when weekday = 5 then total_q else 0 end) as Saturday, sum(case when weekday = 6 then total_q else 0 end) as Sunday from (select i.item_category, weekday(o.order_date) as weekday, sum(quantity) as total_q from items i left join orders o on i.item_id = o.item_id group by 1,2 order by 1) a group by 1 order by 1
select item_category as category, sum(case when weekday(order_date) = 0 then quantity else 0 end) as 'Monday', sum(case when weekday(order_date) = 1 then quantity else 0 end) as 'Tuesday', sum(case when weekday(order_date) = 2 then quantity else 0 end) as 'Wednesday', sum(case when weekday(order_date) = 3 then quantity else 0 end) as 'Thursday', sum(case when weekday(order_date) = 4 then quantity else 0 end) as 'Friday', sum(case when weekday(order_date) = 5 then quantity else 0 end) as 'Saturday', sum(case when weekday(order_date) = 6 then quantity else 0 end) as 'Sunday' from items natural left join orders group by item_category order by 1
select item_category as category, sum(case when weekday(order_date)= 0 then quantity else 0 end) as 'Monday', sum(case when weekday(order_date)= 1 then quantity else 0 end) as 'Tuesday', sum(case when weekday(order_date)= 2 then quantity else 0 end) as 'Wednesday', sum(case when weekday(order_date)= 3 then quantity else 0 end) as 'Thursday', sum(case when weekday(order_date)= 4 then quantity else 0 end) as 'Friday', sum(case when weekday(order_date)= 5 then quantity else 0 end) as 'Saturday', sum(case when weekday(order_date)= 6 then quantity else 0 end) as 'Sunday' from Orders O right join Items I on I.item_id=O.item_id group by 1 order by 1
select item_category as category, sum(case when weekday(order_date)=0 then quantity else 0 end) as 'Monday', sum(case when weekday(order_date)=1 then quantity else 0 end) as 'Tuesday', sum(case when weekday(order_date)=2 then quantity else 0 end) as 'Wednesday', sum(case when weekday(order_date)=3 then quantity else 0 end) as 'Thursday', sum(case when weekday(order_date)=4 then quantity else 0 end) as 'Friday', sum(case when weekday(order_date)=5 then quantity else 0 end) as 'Saturday', sum(case when weekday(order_date)=6 then quantity else 0 end) as 'Sunday' from orders o right join items i on o.item_id=i.item_id group by item_category order by category
select item_category as category, sum(if(dayname(order_date) = 'Monday', quantity, 0)) as Monday, sum(if(dayname(order_date) = 'Tuesday', quantity, 0)) as Tuesday, sum(if(dayname(order_date) = 'Wednesday', quantity, 0)) as Wednesday, sum(if(dayname(order_date) = 'Thursday', quantity, 0)) as Thursday, sum(if(dayname(order_date) = 'Friday', quantity, 0)) as Friday, sum(if(dayname(order_date) = 'Saturday', quantity, 0)) as Saturday, sum(if(dayname(order_date) = 'Sunday', quantity, 0)) as Sunday from Orders o right join Items i on o.item_id = i.item_id group by 1 order by 1
select item_category as category, sum(if(dayname(order_date) = 'Monday', quantity, 0)) as monday, sum(if(dayname(order_date) = 'Tuesday', quantity, 0)) as tuesday, sum(if(dayname(order_date) = 'Wednesday', quantity, 0)) as wednesday, sum(if(dayname(order_date) = 'Thursday', quantity, 0)) as thursday, sum(if(dayname(order_date) = 'Friday', quantity, 0)) as friday, sum(if(dayname(order_date) = 'Saturday', quantity, 0)) as saturday, sum(if(dayname(order_date) = 'Sunday', quantity, 0)) as sunday from items o left join orders i on i.item_id = o.item_id group by 1 order by 1
select item_category as category, sum(if(weekday = 2, quantity, 0)) as Monday, sum(if(weekday = 3, quantity, 0)) as Tuesday, sum(if(weekday = 4, quantity, 0)) as Wednesday, sum(if(weekday = 5, quantity, 0)) as Thursday, sum(if(weekday = 6, quantity, 0)) as Friday, sum(if(weekday = 7, quantity, 0)) as Saturday, sum(if(weekday = 1, quantity, 0)) as Sunday from ( select item_category, dayofweek(order_date) as weekday, sum(quantity) as quantity from orders o right join items i on o.item_id = i.item_id group by item_category, dayofweek(order_date) ) a group by item_category order by item_category
select item_category as category, sum(if(weekday(order_date) = 0, quantity,0)) as Monday, sum(if(weekday(order_date) = 1, quantity,0)) as Tuesday, sum(if(weekday(order_date) = 2, quantity,0)) as Wednesday, sum(if(weekday(order_date) = 3, quantity,0)) as Thursday, sum(if(weekday(order_date) = 4, quantity,0)) as Friday, sum(if(weekday(order_date) = 5, quantity,0)) as Saturday, sum(if(weekday(order_date) = 6, quantity,0)) as Sunday from Orders right join Items on Orders.item_id = Items.item_id group by item_category order by 1
select item_category as category, sum(if(weekday(order_date)=0, quantity, 0)) as Monday, sum(if(weekday(order_date)=1, quantity, 0)) as Tuesday, sum(if(weekday(order_date)=2, quantity, 0)) as Wednesday, sum(if(weekday(order_date)=3, quantity, 0)) as Thursday, sum(if(weekday(order_date)=4, quantity, 0)) as Friday, sum(if(weekday(order_date)=5, quantity, 0)) as Saturday, sum(if(weekday(order_date)=6, quantity, 0)) as Sunday from items a left join orders b on a.item_id = b.item_id group by category order by category
select item_category category, sum(case when dayofweek(order_date)=2 then quantity else 0 end) Monday, sum(case when dayofweek(order_date)=3 then quantity else 0 end) Tuesday, sum(case when dayofweek(order_date)=4 then quantity else 0 end) Wednesday, sum(case when dayofweek(order_date)=5 then quantity else 0 end) thursday, sum(case when dayofweek(order_date)=6 then quantity else 0 end) friday, sum(case when dayofweek(order_date)=7 then quantity else 0 end) saturday, sum(case when dayofweek(order_date)=1 then quantity else 0 end) sunday from Items i left outer join Orders o on o.item_id = i.item_id group by item_category order by item_category
select item_category category, sum(case when weekday = 'Monday' then total else 0 end) Monday, sum(case when weekday = 'Tuesday' then total else 0 end) Tuesday, sum(case when weekday = 'Wednesday' then total else 0 end) Wednesday, sum(case when weekday = 'Thursday' then total else 0 end) Thursday, sum(case when weekday = 'Friday' then total else 0 end) Friday, sum(case when weekday = 'Saturday' then total else 0 end) Saturday, sum(case when weekday = 'Sunday' then total else 0 end) Sunday from ( select item_category, weekday, sum(quantity) total from ( select o.quantity, i.item_category, date_format(order_date, "%W") weekday from orders o right join items i on o.item_id = i.item_id ) d group by item_category, weekday ) g group by item_category order by item_category
select item_category category, sum(case when weekday = 'Monday' then total else 0 end) Monday, sum(case when weekday = 'Tuesday' then total else 0 end) Tuesday, sum(case when weekday = 'Wednesday' then total else 0 end) Wednesday, sum(case when weekday = 'Thursday' then total else 0 end) Thursday, sum(case when weekday = 'Friday' then total else 0 end) Friday, sum(case when weekday = 'Saturday' then total else 0 end) Saturday, sum(case when weekday = 'Sunday' then total else 0 end) Sunday from ( select sum(o.quantity) total, i.item_category, date_format(order_date, "%W") weekday from orders o right join items i on o.item_id = i.item_id group by item_category, weekday ) g group by item_category order by item_category
select item_category category, sum(case when weekday(order_date) ='0' then quantity else 0 end) Monday, sum(case when weekday(order_date) ='1' then quantity else 0 end) Tuesday, sum(case when weekday(order_date) ='2' then quantity else 0 end) Wednesday, sum(case when weekday(order_date) ='3' then quantity else 0 end) Thursday, sum(case when weekday(order_date) ='4' then quantity else 0 end) Friday, sum(case when weekday(order_date) ='5' then quantity else 0 end) Saturday, sum(case when weekday(order_date) ='6' then quantity else 0 end) Sunday from orders right join items using (item_id) group by 1 order by 1
select item_category category, sum(if(weekday(order_date)=0,quantity,0)) monday, sum(if(weekday(order_date)=1,quantity,0)) tuesday, sum(if(weekday(order_date)=2,quantity,0)) wednesday, sum(if(weekday(order_date)=3,quantity,0)) thursday, sum(if(weekday(order_date)=4,quantity,0)) friday, sum(if(weekday(order_date)=5,quantity,0)) saturday, sum(if(weekday(order_date)=6,quantity,0)) sunday from orders o right join items i on o.item_id = i.item_id group by item_category order by category
select k.cat as Category ,sum(case when k.day = 2 then q else 0 end) as Monday ,sum(case when k.day = 3 then q else 0 end) as Tuesday ,sum(case when k.day = 4 then q else 0 end) as Wednesday ,sum(case when k.day = 5 then q else 0 end) as Thursday ,sum(case when k.day = 6 then q else 0 end) as Friday ,sum(case when k.day = 7 then q else 0 end) as Saturday ,sum(case when k.day = 1 then q else 0 end) as Sunday from ( select dayofweek(o.order_date) as day, i.item_category as cat, quantity as q from Orders o right join Items i on o.item_id = i.item_id )k group by Category order by Category
select t.item_category as CATEGORY, SUM(IF(weekday(o.order_date) = 0, o.quantity, 0)) as MONDAY, SUM(IF(weekday(o.order_date) = 1, o.quantity, 0)) as TUESDAY, SUM(IF(weekday(o.order_date) = 2, o.quantity, 0)) as WEDNESDAY, SUM(IF(weekday(o.order_date) = 3, o.quantity, 0)) as THURSDAY, SUM(IF(weekday(o.order_date) = 4, o.quantity, 0)) as FRIDAY, SUM(IF(weekday(o.order_date) = 5, o.quantity, 0)) as SATURDAY, SUM(IF(weekday(o.order_date) = 6, o.quantity, 0)) as SUNDAY from Items t left join Orders o on t.item_id = o.item_id group by t.item_category order by Category
select t.item_category as Category, sum(case when weekday(order_date)=0 then a.quantity else 0 end) as Monday, sum(case when weekday(order_date)=1 then a.quantity else 0 end) as Tuesday , sum(case when weekday(order_date)=2 then a.quantity else 0 end) as Wednesday , sum(case when weekday(order_date)=3 then a.quantity else 0 end) as Thursday , sum(case when weekday(order_date)=4 then a.quantity else 0 end) as Friday , sum(case when weekday(order_date)=5 then a.quantity else 0 end) as Saturday , sum(case when weekday(order_date)=6 then a.quantity else 0 end) as Sunday from items t left join orders a on t.item_id=a.item_id group by t.item_category order by 1
select t1.item_category as CATEGORY, sum(if(dayofweek(order_date)=2,quantity,0)) as MONDAY, sum(if(dayofweek(order_date)=3,quantity,0)) as TUESDAY, sum(if(dayofweek(order_date)=4,quantity,0)) as WEDNESDAY, sum(if(dayofweek(order_date)=5,quantity,0)) as THURSDAY, sum(if(dayofweek(order_date)=6,quantity,0)) as FRIDAY, sum(if(dayofweek(order_date)=7,quantity,0)) as SATURDAY, sum(if(dayofweek(order_date)=1,quantity,0)) as SUNDAY from items t1 left join orders t2 on t2.item_id = t1.item_id group by t1.item_category order by t1.item_category asc
select t1.item_category as Category, sum(case when day = 'Monday' then t2.total_quantity else 0 end) as Monday, sum(case when day = 'Tuesday' then t2.total_quantity else 0 end) as Tuesday, sum(case when day = 'Wednesday' then t2.total_quantity else 0 end) as Wednesday, sum(case when day = 'Thursday' then t2.total_quantity else 0 end) as Thursday, sum(case when day = 'Friday' then t2.total_quantity else 0 end) as Friday, sum(case when day = 'Saturday' then t2.total_quantity else 0 end) as Saturday, sum(case when day = 'Sunday' then t2.total_quantity else 0 end) as Sunday from ( select distinct item_category from items ) t1 left join ( select t2.item_category, dayname(t1.order_date) as day, sum(t1.quantity) as total_quantity from orders t1 join items t2 on t2.item_id = t1.item_id group by t2.item_category, day ) t2 on t2.item_category = t1.item_category group by t1.item_category order by t1.item_category asc
with a as ( select i.item_category as category , t.day_name , sum(t.total_q) as total_q from items as i left join ( select item_id , order_date , sum(quantity) as total_q , dayname(order_date) as day_name from orders group by item_id, order_date) as t on i.item_id=t.item_id group by i.item_category, t.day_name ) select category as CATEGORY , sum(case when day_name='Monday' then total_q else 0 end) as MONDAY , sum(case when day_name='Tuesday' then total_q else 0 end) as TUESDAY , sum(case when day_name='Wednesday' then total_q else 0 end) as WEDNESDAY , sum(case when day_name='Thursday' then total_q else 0 end) as THURSDAY , sum(case when day_name='Friday' then total_q else 0 end) as FRIDAY , sum(case when day_name='Saturday' then total_q else 0 end) as SATURDAY , sum(case when day_name='Sunday' then total_q else 0 end) as SUNDAY from a group by category order by category asc
with a as (select item_category,coalesce(sum(quantity),0) as units_sold,dayofweek(order_date) as day_of_week from orders right join items on orders.item_id = items.item_id group by item_category, dayofweek(order_date) order by item_category ,dayofweek(order_date)) select item_category as category, sum(case when day_of_week = 2 then units_sold else 0 end ) as Monday, sum(case when day_of_week = 3 then units_sold else 0 end ) as Tuesday, sum(case when day_of_week = 4 then units_sold else 0 end ) as Wednesday, sum(case when day_of_week = 5 then units_sold else 0 end ) as Thursday, sum(case when day_of_week = 6 then units_sold else 0 end ) as Friday, sum(case when day_of_week = 7 then units_sold else 0 end ) as Saturday, sum(case when day_of_week = 1 then units_sold else 0 end ) as Sunday from a group by 1 order by 1
with all_orders as ( select t1.*, dayofweek(t1.order_date) as day, t2.item_name, t2.item_category from orders t1 left join items t2 on t2.item_id = t1.item_id union select t1.*, dayofweek(t1.order_date) as day, t2.item_name, t2.item_category from orders t1 right join items t2 on t2.item_id = t1.item_id ) select item_category as CATEGORY, sum(if(day = 2, quantity, 0)) as MONDAY, sum(if(day = 3, quantity, 0)) as TUESDAY, sum(if(day = 4, quantity, 0)) as WEDNESDAY, sum(if(day = 5, quantity, 0)) as THURSDAY, sum(if(day = 6, quantity, 0)) as FRIDAY, sum(if(day = 7, quantity, 0)) as SATURDAY, sum(if(day = 1, quantity, 0)) as SUNDAY from all_orders group by item_category order by item_category
with base as( select dayname(order_date) as dow, i.item_category, sum(quantity) as qty from orders o join items i on o.item_id = i.item_id group by 2,1 ) select i.category, ifnull(monday,0) monday, ifnull(tuesday,0) tuesday, ifnull(wednesday,0) wednesday, ifnull(thursday, 0) thursday, ifnull(friday, 0) friday, ifnull(saturday,0) saturday, ifnull(sunday,0) sunday from( select category, max(monday) monday, max(tuesday) tuesday, max(wednesday) wednesday, max(thursday) thursday, max(friday) friday, max(saturday) saturday, max(sunday) sunday from( select item_category as category, case when dow = "Monday" then qty else 0 end Monday, case when dow = "Tuesday" then qty else 0 end Tuesday, case when dow = "Wednesday" then qty else 0 end Wednesday, case when dow = "Thursday" then qty else 0 end Thursday, case when dow = "Friday" then qty else 0 end Friday, case when dow = "Saturday" then qty else 0 end Saturday, case when dow = "Sunday" then qty else 0 end Sunday from base ) sub group by 1 ) l right join (select distinct item_category as category from items) i on l.category = i.category order by category
with cte as ( Select *, DayName(order_date) as Day from orders ) Select item_category as category, SUM(CASE WHEN Day='Monday' THEN quantity else 0 END) AS 'Monday', SUM(CASE WHEN Day='Tuesday' THEN quantity else 0 END) AS 'Tuesday', SUM(CASE WHEN Day='Wednesday' THEN quantity else 0 END) AS 'Wednesday', SUM(CASE WHEN Day='Thursday' THEN quantity else 0 END) AS 'Thursday', SUM(CASE WHEN Day='Friday' THEN quantity else 0 END) AS 'Friday', SUM(CASE WHEN Day='Saturday' THEN quantity else 0 END) AS 'Saturday', SUM(CASE WHEN Day='Sunday' THEN quantity else 0 END) AS 'Sunday' from cte c right join items i on c.item_id=i.item_id group by item_category order by 1
with cte as ( select DAYOFWEEK(order_date) as dayofwk, item_category as CATEGORY, sum(quantity) as quant from Orders right outer join Items on Orders.item_id = Items.item_id group by DAYOFWEEK(order_date), item_category ) select CATEGORY, sum(case when dayofwk = 2 then quant else 0 end) as MONDAY, sum(case when dayofwk = 3 then quant else 0 end) as TUESDAY, sum(case when dayofwk = 4 then quant else 0 end) as WEDNESDAY, sum(case when dayofwk = 5 then quant else 0 end) as THURSDAY, sum(case when dayofwk = 6 then quant else 0 end) as FRIDAY, sum(case when dayofwk = 7 then quant else 0 end) as SATURDAY, sum(case when dayofwk = 1 then quant else 0 end) as SUNDAY from cte group by CATEGORY order by CATEGORY
with cte as ( select dayofweek(order_date) as day,item_category,sum(quantity) as quan from Orders join items on Orders.item_id = Items.item_id group by dayofweek(order_date),item_category ), cte1 as ( select item_category,quan as monday from cte where day = 2 union select distinct item_category,0 as monday from items where item_category not in (select item_category from cte where day = 2) ),cte2 as ( select cte1.item_category,monday,ifnull(quan,0) as tuesday from cte1 left join cte on cte.item_category = cte1.item_category and day = 3 ),cte3 as ( select cte2.item_category,monday,tuesday,ifnull(quan,0) as wednesday from cte2 left join cte on cte.item_category = cte2.item_category and day = 4 ), cte4 as ( select cte3.item_category,monday,tuesday,wednesday,ifnull(quan,0) as thursday from cte3 left join cte on cte.item_category = cte3.item_category and day = 5 ),cte5 as ( select cte4.item_category,monday,tuesday,wednesday,thursday,ifnull(quan,0) as friday from cte4 left join cte on cte.item_category = cte4.item_category and day = 6 ),cte6 as ( select cte5.item_category,monday,tuesday,wednesday,thursday,friday,ifnull(quan,0) as saturday from cte5 left join cte on cte.item_category = cte5.item_category and day = 7 ), cte7 as ( select cte6.item_category as category,monday,tuesday,wednesday,thursday,friday,saturday,ifnull(quan,0) as sunday from cte6 left join cte on cte.item_category = cte6.item_category and day = 1 ) select * from cte7 order by category
with cte as ( select dayofweek(order_date) as dy, item_category, coalesce(sum(quantity),0) as quantity from orders a right join items b on a.item_id = b.item_id group by 1,2 ), cte1 as ( select case when dy=1 then 'Sunday' when dy=2 then 'Monday' when dy=3 then 'Tuesday' when dy=4 then 'Wednesday' when dy=5 then 'Thursday' when dy=6 then 'Friday' when dy=7 then 'Saturday' end as weekday, item_category as Category, coalesce(quantity,0) as quantity from cte ) select category, Coalesce(Sum(case when weekday ='Monday' then quantity end),0) as 'Monday', coalesce(sum(case when weekday ='Tuesday' then quantity end ),0)as 'Tuesday', coalesce(sum(case when weekday ='Wednesday' then quantity end),0) as 'Wednesday', coalesce(sum(case when weekday ='Thursday' then quantity end),0) as 'Thursday', coalesce(sum(case when weekday ='Friday' then quantity end),0) as 'Friday', coalesce(sum(case when weekday ='Saturday' then quantity end),0) as 'Saturday', coalesce(sum(case when weekday ='Sunday' then quantity end),0) as 'Sunday' from cte1 group by 1 order by category
with cte as ( select item_category Category, dayname(order_date) day, ifnull(sum(quantity),0) total from items i left join orders o on i.item_id=o.item_id group by Category, day ) select Category, sum(case when day='Monday' then total else 0 end) Monday, sum(case when day='Tuesday' then total else 0 end) Tuesday, sum(case when day='Wednesday' then total else 0 end) Wednesday, sum(case when day='Thursday' then total else 0 end) Thursday, sum(case when day='Friday' then total else 0 end) Friday, sum(case when day='Saturday' then total else 0 end) Saturday, sum(case when day='Sunday' then total else 0 end) Sunday from cte group by Category order by 1
with cte as ( select item_category as Category, weekday(order_date) as `weekday`, sum(quantity) as total_quantity from Items i left join Orders o on i.item_id = o.item_id group by item_category, weekday(order_date) ) select CATEGORY, ifnull(sum(case when `weekday`= 0 then total_quantity end), 0) as MONDAY, ifnull(sum(case when `weekday`= 1 then total_quantity end), 0) as TUESDAY, ifnull(sum(case when `weekday`= 2 then total_quantity end), 0) as WEDNESDAY, ifnull(sum(case when `weekday`= 3 then total_quantity end), 0) as THURSDAY, ifnull(sum(case when `weekday`= 4 then total_quantity end), 0) as FRIDAY, ifnull(sum(case when `weekday`= 5 then total_quantity end), 0) as SATURDAY, ifnull(sum(case when `weekday`= 6 then total_quantity end), 0) as SUNDAY from cte group by Category order by Category
with cte as (select date_format(order_date,'%W') AS weekday,quantity,item_category from orders a right join items b on a.item_id=b.item_id) select item_category as category, sum(case when weekday='Monday' then quantity else 0 end) as Monday, sum(case when weekday='Tuesday' then quantity else 0 end) as Tuesday, sum(case when weekday='Wednesday' then quantity else 0 end) as Wednesday, sum(case when weekday='Thursday' then quantity else 0 end) as Thursday, sum(case when weekday='Friday' then quantity else 0 end) as Friday, sum(case when weekday='Saturday' then quantity else 0 end) as Saturday, sum(case when weekday='Sunday' then quantity else 0 end) as Sunday from cte group by 1 order by 1
with cte as (select dayofweek(order_date) as day, quantity, item_category as category from Orders o right join Items i on o.item_id = i.item_id) select category as CATEGORY, sum(case when day = 2 then quantity else 0 end) as "MONDAY", sum(case when day = 3 then quantity else 0 end) as "TUESDAY", sum(case when day = 4 then quantity else 0 end) as "WEDNESDAY", sum(case when day = 5 then quantity else 0 end) as "THURSDAY", sum(case when day = 6 then quantity else 0 end) as "FRIDAY", sum(case when day = 7 then quantity else 0 end) as "SATURDAY", sum(case when day = 1 then quantity else 0 end) as "SUNDAY" from cte group by 1 order by 1
with cte as (select e.item_category, DAYNAME(o.order_date) as day_of_week, sum(o.quantity) as tot_unit from Orders o right join Items e on e.item_id = o.item_id group by e.item_category, DAYNAME(o.order_date) ), cte2 as (select item_category, case when day_of_week = 'Monday' then tot_unit else 0 end as Monday, case when day_of_week = 'Tuesday' then tot_unit else 0 end as Tuesday, case when day_of_week = 'Wednesday' then tot_unit else 0 end as Wednesday, case when day_of_week = 'Thursday' then tot_unit else 0 end as Thursday, case when day_of_week = 'Friday' then tot_unit else 0 end as Friday, case when day_of_week = 'Saturday' then tot_unit else 0 end as Saturday, case when day_of_week = 'Sunday' then tot_unit else 0 end as Sunday from cte ) select item_category as CATEGORY, sum(Monday) as MONDAY, sum(Tuesday) as TUESDAY, sum(Wednesday) as WEDNESDAY, sum(Thursday) as THURSDAY, sum(Friday) as FRIDAY, sum(Saturday) as SATURDAY, sum(Sunday) as SUNDAY from cte2 group by item_category order by 1
with cte as (select item_category, DAYOFWEEK(order_date) as 'day_of_week', IFNULL(sum(quantity), 0) as 'category_quantity' from Orders right outer join Items on (Orders.item_id = Items.item_id) group by day_of_week, item_category) select item_category as 'CATEGORY', sum(CASE WHEN day_of_week = '2' THEN category_quantity ELSE 0 END) as 'MONDAY', sum(CASE WHEN day_of_week = '3' THEN category_quantity ELSE 0 END) as 'TUESDAY', sum(CASE WHEN day_of_week = '4' THEN category_quantity ELSE 0 END) as 'WEDNESDAY', sum(CASE WHEN day_of_week = '5' THEN category_quantity ELSE 0 END) as 'THURSDAY', sum(CASE WHEN day_of_week = '6' THEN category_quantity ELSE 0 END) as 'FRIDAY', sum(CASE WHEN day_of_week = '7' THEN category_quantity ELSE 0 END) as 'SATURDAY', sum(CASE WHEN day_of_week = '1' THEN category_quantity ELSE 0 END) as 'SUNDAY' from cte group by CATEGORY order by CATEGORY
with cte as (select o.order_date, o.item_id, i.item_category, o.quantity, DAYNAME(o.order_date) as weekday from orders o right join items i on o.item_id = i.item_id ) select item_category as CATEGORY, coalesce(sum(case when weekday ='Monday' then quantity end),0) as 'MONDAY', coalesce(sum(case when weekday ='Tuesday' then quantity end),0) as 'TUESDAY', coalesce(sum(case when weekday ='Wednesday' then quantity end),0) as 'WEDNESDAY', coalesce(sum(case when weekday ='Thursday' then quantity end),0) as 'THURSDAY', coalesce(sum(case when weekday ='Friday' then quantity end),0) as 'FRIDAY', coalesce(sum(case when weekday ='Saturday' then quantity end),0)as 'SATURDAY', coalesce(sum(case when weekday ='Sunday' then quantity end),0) as 'SUNDAY' from cte group by item_category order by item_category
with cte as (select o.order_date, o.item_id, i.item_category, o.quantity, DAYNAME(o.order_date) as weekday from orders o right join items i on o.item_id = i.item_id group by i.item_category,o.order_date,o.item_id,o.quantity ) select item_category as CATEGORY, coalesce(sum(case when weekday ='Monday' then quantity end),0) as 'MONDAY', coalesce(sum(case when weekday ='Tuesday' then quantity end),0) as 'TUESDAY', coalesce(sum(case when weekday ='Wednesday' then quantity end),0) as 'WEDNESDAY', coalesce(sum(case when weekday ='Thursday' then quantity end),0) as 'THURSDAY', coalesce(sum(case when weekday ='Friday' then quantity end),0) as 'FRIDAY', coalesce(sum(case when weekday ='Saturday' then quantity end),0)as 'SATURDAY', coalesce(sum(case when weekday ='Sunday' then quantity end),0) as 'SUNDAY' from cte group by item_category order by item_category
with cte as (select weekday(order_date) as wk, item_category, quantity from orders right join items on orders.item_id=items.item_id ) select item_category as category, sum(case when wk=0 then quantity else 0 end) as Monday, sum(case when wk=1 then quantity else 0 end) as Tuesday, sum(case when wk=2 then quantity else 0 end) as Wednesday, sum(case when wk=3 then quantity else 0 end) as Thursday, sum(case when wk=4 then quantity else 0 end) as Friday, sum(case when wk=5 then quantity else 0 end) as Saturday, sum(case when wk=6 then quantity else 0 end) as Sunday from cte group by item_category order by category
with cte as( select i.item_category, o.order_date, o.quantity from items i left join orders o on o.item_id = i.item_id ) select item_category category , sum(case when weekday(order_date) = 0 then quantity else 0 end) as 'MONDAY', sum(case when weekday(order_date) = 1 then quantity else 0 end) as 'TUESDAY', sum(case when weekday(order_date) = 2 then quantity else 0 end) as 'WEDNESDAY', sum(case when weekday(order_date) = 3 then quantity else 0 end) as 'THURSDAY', sum(case when weekday(order_date) = 4 then quantity else 0 end) as 'FRIDAY', sum(case when weekday(order_date) = 5 then quantity else 0 end) as 'SATURDAY', sum(case when weekday(order_date) = 6 then quantity else 0 end) as 'SUNDAY' from cte group by item_category order by 1
with cte as( select i.item_category, weekday(o.order_date) as "day", sum(o.quantity) as qnt from items i left join orders o on o.item_id = i.item_id group by 1,2) select item_category as category, ifnull(max(case when day = 0 then qnt end),0) as "Monday", ifnull(max(case when day = 1 then qnt end),0) as "Tuesday", ifnull(max(case when day = 2 then qnt end),0) as "Wednesday", ifnull(max(case when day = 3 then qnt end),0) as "Thursday", ifnull(max(case when day = 4 then qnt end),0) as "Friday", ifnull(max(case when day = 5 then qnt end),0) as "Saturday", ifnull(max(case when day = 6 then qnt end),0) as "Sunday" from cte group by 1 order by 1
with daily_category_sales as ( select weekday(o.order_date) as day_of_week, i.item_category, sum(quantity) as total_quantity from items i left join orders o on o.item_id = i.item_id group by 1, 2 ) select item_category as Category, sum(if(day_of_week = 0, total_quantity, 0)) as Monday, sum(if(day_of_week = 1, total_quantity, 0)) as Tuesday, sum(if(day_of_week = 2, total_quantity, 0)) as Wednesday, sum(if(day_of_week = 3, total_quantity, 0)) as Thursday, sum(if(day_of_week = 4, total_quantity, 0)) as Friday, sum(if(day_of_week = 5, total_quantity, 0)) as Saturday, sum(if(day_of_week = 6, total_quantity, 0)) as Sunday from daily_category_sales group by 1 order by 1
with grouped as ( select item_category, dayofweek(order_date) as day, order_date , quantity from Orders right join Items on Orders.item_id = Items.item_id ) , summed as( select item_category, day, sum(quantity) as sales from grouped group by item_category, day ) select item_category as Category, sum(if(day = 2,sales, 0)) as Monday, sum(if(day = 3,sales, 0)) as Tuesday, sum(if(day = 4,sales, 0)) as Wednesday, sum(if(day = 5,sales, 0)) as Thursday, sum(if(day = 6,sales, 0)) as Friday, sum(if(day = 7,sales, 0)) as Saturday, sum(if(day = 1,sales, 0)) as Sunday from summed group by Category order by Category
with grouped_category as( select item_id, DAYOFWEEK(order_date) as DayofWeek, sum(quantity) as num_sold from orders group by item_id,dayofweek), pivoted_categorys as( select item_id, max(case when DayofWeek = 2 then num_sold else 0 end) as Monday, max(case when DayofWeek = 3 then num_sold else 0 end) as Tuesday, max(case when DayofWeek = 4 then num_sold else 0 end) as Wednesday, max(case when DayofWeek = 5 then num_sold else 0 end) as Thursday, max(case when DayofWeek = 6 then num_sold else 0 end) as Friday, max(case when DayofWeek = 7 then num_sold else 0 end) as Saturday, max(case when DayofWeek = 1 then num_sold else 0 end) as Sunday from grouped_category gc group by item_id) select item_category as CATEGORY, ifnull(sum(Monday),0) as MONDAY, ifnull(sum(Tuesday),0) as TUESDAY, ifnull(sum(Wednesday),0) as WEDNESDAY, ifnull(sum(Thursday),0) as THURSDAY, ifnull(sum(Friday),0) as FRIDAY, ifnull(sum(Saturday),0) as SATURDAY, ifnull(sum(sunday),0) as SUNDAY from pivoted_categorys pc right join Items i on i.item_id = pc.item_id group by category order by category
with joined as (select distinct Items.item_id, order_date, dayofweek(order_date) as day, sum(quantity) over (partition by item_id, order_date) as sum_quantity_by_day, item_category from Orders left join Items on Items.item_id = Orders.item_id) , grouped as ( select item_category, day, sum(sum_quantity_by_day) as sales from joined group by item_category, day ) select cate.item_category as Category, sum(if(day = 2,sales, 0)) as Monday, sum(if(day = 3,sales, 0)) as Tuesday, sum(if(day = 4,sales, 0)) as Wednesday, sum(if(day = 5,sales, 0)) as Thursday, sum(if(day = 6,sales, 0)) as Friday, sum(if(day = 7,sales, 0)) as Saturday, sum(if(day = 1,sales, 0)) as Sunday from grouped right join (select distinct item_category from Items) as cate on cate.item_category = grouped.item_category group by cate.item_category order by Category
with orderitem as ( select dayname(o.order_date) weekday, i.item_category, sum(quantity) quan from orders o right outer join items i on i.item_id=o.item_id group by dayname(o.order_date), i.item_category ) select item_category as CATEGORY, sum(case when weekday='Monday' then quan else 0 end) MONDAY, sum(case when weekday='Tuesday' then quan else 0 end) TUESDAY, sum(case when weekday='Wednesday' then quan else 0 end) WEDNESDAY, sum(case when weekday='Thursday' then quan else 0 end) THURSDAY, sum(case when weekday='Friday' then quan else 0 end) FRIDAY, sum(case when weekday='Saturday' then quan else 0 end ) SATURDAY, sum( case when weekday='Sunday' then quan else 0 end) SUNDAY from orderitem group by item_category order by 1
with orders2 as(select i1.item_category as Category,dayofweek(o1.order_date) as dOW,o1.quantity from Items as i1 left join Orders o1 on i1.item_id=o1.item_id) select Category, SUM(case when dOW=2 then quantity else 0 end) as Monday, SUM(case when dOW=3 then quantity else 0 end) as Tuesday, SUM(case when dOW=4 then quantity else 0 end) as Wednesday, SUM(case when dOW=5 then quantity else 0 end) as Thursday, SUM(case when dOW=6 then quantity else 0 end) as Friday, SUM(case when dOW=7 then quantity else 0 end) as Saturday, SUM(case when dOW=1 then quantity else 0 end) as Sunday from orders2 group by 1 order by 1
with orders_day as(select dayofweek(order_date) as day_w,item_category as category,quantity from orders right join items on orders.item_id=items.item_id ) select category,sum(if(day_w=2,quantity,0)) as 'Monday', sum(if(day_w=3,quantity,0)) as 'Tuesday', sum(if(day_w=4,quantity,0)) as 'Wednesday', sum(if(day_w=5,quantity,0)) as 'Thursday', sum(if(day_w=6,quantity,0)) as 'Friday', sum(if(day_w=7,quantity,0)) as 'Saturday', sum(if(day_w=1,quantity,0)) as 'Sunday' from orders_day group by category order by category
with recursive wk(n) as ( select 0 union all select n+1 from wk where n<6 ) , wkorder as ( select item_id, weekday(order_date) as day, sum(quantity) as qty from Orders group by 1,2 order by 1,2 ) select i.item_category as Category, ifnull(sum(case when t.day=0 then t.qty else null end),0) as Monday, ifnull(sum(case when t.day=1 then t.qty else null end),0) as Tuesday, ifnull(sum(case when t.day=2 then t.qty else null end),0) as Wednesday, ifnull(sum(case when t.day=3 then t.qty else null end),0) as Thursday, ifnull(sum(case when t.day=4 then t.qty else null end),0) as Friday, ifnull(sum(case when t.day=5 then t.qty else null end),0) as Saturday, ifnull(sum(case when t.day=6 then t.qty else null end),0) as Sunday from Items i left join ( select wk.n as day, wo.item_id, sum(wo.qty) as qty from wk left join wkorder wo on wk.n = wo.day group by 1,2 ) t on i.item_id = t.item_id group by 1 order by 1
with rpt_order_quantity as ( select i.item_category as Category , dayname(o.order_date) as day_of_week , sum(o.quantity) as quantity from Items i left join Orders o on i.item_id = o.item_id group by 1, 2 ) select Category as CATEGORY , coalesce(sum(case when day_of_week = "Monday" then quantity end), 0) as MONDAY , coalesce(sum(case when day_of_week = "Tuesday" then quantity end), 0) as TUESDAY , coalesce(sum(case when day_of_week = "Wednesday" then quantity end), 0) as WEDNESDAY , coalesce(sum(case when day_of_week = "Thursday" then quantity end), 0) as THURSDAY , coalesce(sum(case when day_of_week = "Friday" then quantity end), 0) as FRIDAY , coalesce(sum(case when day_of_week = "Saturday" then quantity end), 0) as SATURDAY , coalesce(sum(case when day_of_week = "Sunday" then quantity end), 0) as SUNDAY from rpt_order_quantity group by 1 order by 1
with sales as( select item_category as category, weekday(order_date) as weekday, order_date, sum(quantity) as quantity from items left join orders using (item_id) group by item_category, weekday(order_date) order by item_category ) select category, sum(case when dayofweek(order_date)=2 then (quantity) else 0 end) as Monday, sum(case when dayofweek(order_date)=3 then (quantity) else 0 end) as Tuesday, sum(case when dayofweek(order_date)=4 then (quantity) else 0 end) as Wednesday , sum(case when dayofweek(order_date)=5 then (quantity) else 0 end) as Thursday , sum(case when dayofweek(order_date)=6 then (quantity) else 0 end) as Friday , sum(case when dayofweek(order_date)=7 then (quantity) else 0 end) as Saturday , sum(case when dayofweek(order_date)=1 then (quantity) else 0 end) as Sunday from sales group by category order by category
with summary as (select DAYOFWEEK(order_date) as dow, item_category, sum(quantity) as s from orders o join items i on o.item_id=i.item_id group by item_category,DAYOFWEEK(order_date)) select ii.item_category as category, sum(case when dow=2 then s else 0 end) as Monday, sum(case when dow=3 then s else 0 end) as Tuesday, sum(case when dow=4 then s else 0 end) as Wednesday, sum(case when dow=5 then s else 0 end) as Thursday, sum(case when dow=6 then s else 0 end) as Friday, sum(case when dow=7 then s else 0 end) as Saturday, sum(case when dow=1 then s else 0 end) as Sunday from summary a right join (select distinct item_category from Items) ii on a.item_category = ii.item_category group by category order by category
with t as ( select dayname(order_date) days,item_category, sum(quantity) total from orders, items where orders.item_id = items.item_id group by dayname(order_date), item_category ), idx as ( select distinct(item_category) CATEGORY from items ) select idx.*, sum(case when days = 'Monday' then total else 0 end) MONDAY, sum(case when days = 'Tuesday' then total else 0 end) TUESDAY, sum(case when days = 'Wednesday' then total else 0 end) WEDNESDAY, sum(case when days = 'Thursday' then total else 0 end) THURSDAY, sum(case when days = 'Friday' then total else 0 end) FRIDAY, sum(case when days = 'Saturday' then total else 0 end) SATURDAY, sum(case when days = 'Sunday' then total else 0 end) SUNDAY from idx left join t on idx.category = t.item_category group by idx.category order by category
with t as ( select i.item_category, dayofweek(o.order_date) as day, sum(o.quantity) as quantity from orders as o right join items as i on o.item_id=i.item_id group by day, item_category order by day) select item_category as 'Category', ifnull(sum(case when day=2 then quantity end),0) as 'Monday', ifnull(sum(case when day=3 then quantity end),0) as 'Tuesday', ifnull(sum(case when day=4 then quantity end),0) as 'Wednesday', ifnull(sum(case when day=5 then quantity end),0) as 'Thursday', ifnull(sum(case when day=6 then quantity end),0) as 'Friday', ifnull(sum(case when day=7 then quantity end),0) as 'Saturday', ifnull(sum(case when day=1 then quantity end),0) as 'Sunday' from t group by category order by category
with t1 as ( select Orders.*, Items.item_category, date_format(order_date, '%W') as day from Orders right join Items on Orders.item_id = Items.item_id ) select item_category as CATEGORY, sum(case when day = 'Monday' then quantity else 0 end) as MONDAY, sum(case when day = 'Tuesday' then quantity else 0 end) as TUESDAY, sum(case when day = 'Wednesday' then quantity else 0 end) as WEDNESDAY, sum(case when day = 'Thursday' then quantity else 0 end) as THURSDAY, sum(case when day = 'Friday' then quantity else 0 end) as FRIDAY, sum(case when day = 'Saturday' then quantity else 0 end) as SATURDAY, sum(case when day = 'Sunday' then quantity else 0 end) as SUNDAY from t1 group by item_category order by item_category
with t1 as (select item_category, dayname(order_date) as 'day', sum(quantity) as 'sums' from orders o right outer join items i on (o.item_id = i.item_id) group by dayname(order_date), item_category) select item_category as CATEGORY, sum(case when day = 'Monday' then sums else 0 end) as 'MONDAY', sum(case when day = 'Tuesday' then sums else 0 end) as 'TUESDAY', sum(case when day = 'WEDNESDAY' then sums else 0 end) as 'WEDNESDAY', sum(case when day = 'THURSDAY' then sums else 0 end) as 'THURSDAY', sum(case when day = 'FRIDAY' then sums else 0 end) as 'FRIDAY', sum(case when day = 'SATURDAY' then sums else 0 end) as 'SATURDAY', sum(case when day = 'SUNDAY' then sums else 0 end) as 'SUNDAY' from t1 group by item_category order by item_category
with tablea as (select item_category as Category, dayname(order_date ) as weekname, sum(quantity) as quantity from Items o left join Orders i on o.item_id=i.item_id group by item_category, dayname(order_date )) select Category, sum(case when lower(weekname)='monday' then quantity else 0 end) as Monday, sum(case when lower(weekname)='tuesday' then quantity else 0 end) as Tuesday, sum(case when lower(weekname)='wednesday' then quantity else 0 end) as Wednesday, sum(case when lower(weekname)='thursday' then quantity else 0 end) as Thursday, sum(case when lower(weekname)='friday' then quantity else 0 end) as Friday, sum(case when lower(weekname)='saturday' then quantity else 0 end) as Saturday, sum(case when lower(weekname)='sunday' then quantity else 0 end) as Sunday from tablea group by Category order by category
with tb as ( select i.item_category, (case dayofweek(order_date) when 1 then 'Sunday' when 2 then 'Monday' when 3 then 'Tuesday' when 4 then 'Wednesday' when 5 then 'Thursday' when 6 then 'Friday' when 7 then 'Saturday' end) as weekDay, o.quantity from orders as o right join items as i on o.item_id = i.item_id ), tb_ as ( select item_category as Category, sum(case weekDay when 'Monday' then quantity else 0 end) as 'Monday', sum(case weekDay when 'Tuesday' then quantity else 0 end) as 'Tuesday', sum(case weekDay when 'Wednesday' then quantity else 0 end) as 'Wednesday', sum(case weekDay when 'Thursday' then quantity else 0 end) as 'Thursday', sum(case weekDay when 'Friday' then quantity else 0 end) as 'Friday', sum(case weekDay when 'Saturday' then quantity else 0 end) as 'Saturday', sum(case weekDay when 'Sunday' then quantity else 0 end) as 'Sunday' from tb group by item_category ) select * from tb_ order by Category
with tb as ( select i.item_category, (case dayofweek(order_date) when 1 then 'Sunday' when 2 then 'Monday' when 3 then 'Tuesday' when 4 then 'Wednesday' when 5 then 'Thursday' when 6 then 'Friday' when 7 then 'Saturday' end) as weekDay, sum(o.quantity) as sum_quantity from orders as o right join items as i on o.item_id = i.item_id group by (case dayofweek(o.order_date) when 1 then 'Sunday' when 2 then 'Monday' when 3 then 'Tuesday' when 4 then 'Wednesday' when 5 then 'Thursday' when 6 then 'Friday' when 7 then 'Saturday' end), i.item_category ), tb_ as ( select item_category as Category, sum(case weekDay when 'Monday' then sum_quantity else 0 end) as 'Monday', sum(case weekDay when 'Tuesday' then sum_quantity else 0 end) as 'Tuesday', sum(case weekDay when 'Wednesday' then sum_quantity else 0 end) as 'Wednesday', sum(case weekDay when 'Thursday' then sum_quantity else 0 end) as 'Thursday', sum(case weekDay when 'Friday' then sum_quantity else 0 end) as 'Friday', sum(case weekDay when 'Saturday' then sum_quantity else 0 end) as 'Saturday', sum(case weekDay when 'Sunday' then sum_quantity else 0 end) as 'Sunday' from tb group by item_category ) select * from tb_ order by Category
with temp as ( select case when sum(quantity) is null then 0 else sum(quantity) end as qty, item_category, case when weekday(order_date) = 0 then "Monday" when weekday(order_date) = 1 then "Tuesday" when weekday(order_date) = 2 then "Wednesday" when weekday(order_date) = 3 then "Thursday" when weekday(order_date) = 4 then "Friday" when weekday(order_date) = 5 then "Saturday" else "Sunday" end as weekday from Orders as o right join Items as i on i.item_id = o.item_id group by 2, 3 order by 2 asc, 3 asc) select item_category as CATEGORY, sum(case when weekday = "Monday" then qty else 0 end) as "MONDAY", sum(case when weekday = "Tuesday" then qty else 0 end) as "TUESDAY", sum(case when weekday = "Wednesday" then qty else 0 end) as "WEDNESDAY", sum(case when weekday = "Thursday" then qty else 0 end) as "THURSDAY", sum(case when weekday = "Friday" then qty else 0 end) as "FRIDAY", sum(case when weekday = "Saturday" then qty else 0 end) as "SATURDAY", sum(case when weekday = "Sunday" then qty else 0 end) as "SUNDAY" from temp group by 1 order by 1 asc
with temp as ( select case when sum(quantity) is null then 0 else sum(quantity) end as qty, item_category, weekday(order_date) as weekday from Orders as o right join Items as i on i.item_id = o.item_id group by 2, 3 order by 2 asc, 3 asc) select item_category as CATEGORY, sum(case when weekday = 0 then qty else 0 end) as "MONDAY", sum(case when weekday = 1 then qty else 0 end) as "TUESDAY", sum(case when weekday = 2 then qty else 0 end) as "WEDNESDAY", sum(case when weekday = 3 then qty else 0 end) as "THURSDAY", sum(case when weekday = 4 then qty else 0 end) as "FRIDAY", sum(case when weekday = 5 then qty else 0 end) as "SATURDAY", sum(case when weekday = 6 then qty else 0 end) as "SUNDAY" from temp group by 1 order by 1 asc
with temp as ( select i.item_category as Category, date_format(o.order_date, "%W") as day_of_week, quantity from Orders o right join Items i on o.item_id = i.item_id ) select Category, sum(case when day_of_week = 'Monday' then quantity else 0 end) as Monday, sum(case when day_of_week = 'Tuesday' then quantity else 0 end) as Tuesday, sum(case when day_of_week = 'Wednesday' then quantity else 0 end) as Wednesday, sum(case when day_of_week = 'Thursday' then quantity else 0 end) as Thursday, sum(case when day_of_week = 'Friday' then quantity else 0 end) as Friday, sum(case when day_of_week = 'Saturday' then quantity else 0 end) as Saturday, sum(case when day_of_week = 'Sunday' then quantity else 0 end) as Sunday from temp group by Category order by Category
with temp as ( select i.item_category, order_id, o.item_id, case when quantity is NULL then 0 else quantity end as quantity, DAYOFWEEK(order_date) as day from Orders as o right join Items as i on o.item_id = i.item_id ), temp1 as ( select item_category, case when day = 2 then quantity else 0 end as 'Monday', case when day = 3 then quantity else 0 end as 'Tuesday', case when day = 4 then quantity else 0 end as 'Wednesday', case when day = 5 then quantity else 0 end as 'Thursday', case when day = 6 then quantity else 0 end as 'Friday', case when day = 7 then quantity else 0 end as 'Saturday', case when day = 1 then quantity else 0 end as 'Sunday' from temp ) select item_category as Category, sum(Monday) as Monday, sum(Tuesday) as Tuesday, sum(Wednesday) as Wednesday, sum(Thursday) as Thursday, sum(Friday) as Friday, sum(Saturday) as Saturday, sum(Sunday) as Sunday from temp1 group by Category order by category
with temp as ( select item_id, SUM(CASE WHEN dayofweek(order_date) = 2 then quantity else 0 END) as MONDAY, SUM(CASE WHEN dayofweek(order_date) = 3 then quantity else 0 END) as TUESDAY, SUM(CASE WHEN dayofweek(order_date) = 4 then quantity else 0 END) as WEDNESDAY, SUM(CASE WHEN dayofweek(order_date) = 5 then quantity else 0 END) as THURSDAY, SUM(CASE WHEN dayofweek(order_date) = 6 then quantity else 0 END) as FRIDAY, SUM(CASE WHEN dayofweek(order_date) = 7 then quantity else 0 END) as SATURDAY, SUM(CASE WHEN dayofweek(order_date) = 1 then quantity else 0 END) as SUNDAY from orders group by item_id ), records as (select items.item_category as CATEGORY, SUM(MONDAY) AS MONDAY , SUM(TUESDAY) AS TUESDAY, SUM(WEDNESDAY) AS WEDNESDAY, SUM(THURSDAY) AS THURSDAY, SUM(FRIDAY) AS FRIDAY, SUM(SATURDAY) AS SATURDAY, SUM(SUNDAY) AS SUNDAY from temp LEFT JOIN items ON temp.item_id = items.item_id GROUP BY items.item_category ORDER BY 1 ) SELECT DISTINCT item_category AS CATEGORY, COALESCE(MONDAY,0) AS MONDAY, COALESCE(TUESDAY,0) AS TUESDAY, COALESCE(WEDNESDAY,0) AS WEDNESDAY, COALESCE(THURSDAY,0) AS THURSDAY, COALESCE(FRIDAY,0) AS FRIDAY, COALESCE(SATURDAY,0) AS SATURDAY, COALESCE(SUNDAY,0) AS SUNDAY FROM Items LEFT JOIN records ON Items.item_category = records.CATEGORY ORDER BY item_category ASC
with temp as (select DAYNAME(order_date) as day, O.quantity, I.item_category as Category from Orders O right JOIN Items I ON O.item_id = I.item_id) select Category, sum(case when day = 'Monday' then quantity else 0 end) as Monday, sum(case when day = 'Tuesday' then quantity else 0 end) as Tuesday, sum(case when day = 'Wednesday' then quantity else 0 end) as Wednesday, sum(case when day = 'Thursday' then quantity else 0 end) as Thursday, sum(case when day = 'Friday' then quantity else 0 end) as Friday, sum(case when day = 'Saturday' then quantity else 0 end) as Saturday, sum(case when day = 'Sunday' then quantity else 0 end) as Sunday from temp group by 1 order by 1
with temp as (select o.order_id, o.customer_id, o.order_date, o.item_id, o.quantity, i.item_category, weekday(o.order_date) as wd from orders o right join items i on o.item_id = i.item_id) , t2 as (select wd, item_category, ifnull(sum(quantity),0) quantity from temp group by wd, item_category) select t2.item_category CATEGORY, max(case when t2.wd = 0 then quantity else 0 end) as 'MONDAY', max(case when t2.wd = 1 then quantity else 0 end) as 'TUESDAY', max(case when t2.wd = 2 then quantity else 0 end) as 'WEDNESDAY', max(case when t2.wd= 3 then quantity else 0 end) as 'THURSDAY', max(case when t2.wd= 4 then quantity else 0 end) as 'FRIDAY', max(case when t2.wd=5 then quantity else 0 end) as 'SATURDAY', max(case when t2.wd=6 then quantity else 0 end) as 'SUNDAY' from t2 group by t2.item_category ORDER BY CATEGORY
with temp as( select o.item_id, i.item_category, quantity, DAYOFWEEK(order_date) as day from Orders as o join items as i on o.item_id = i.item_id ) select t.item_category as Category, sum(case when day = 2 then quantity else 0 end) as Monday, sum(case when day = 3 then quantity else 0 end) as Tuesday, sum(case when day = 4 then quantity else 0 end) as Wednesday, sum(case when day = 5 then quantity else 0 end) as Thursday, sum(case when day = 6 then quantity else 0 end) as Friday, sum(case when day = 7 then quantity else 0 end) as Saturday, sum(case when day = 1 then quantity else 0 end) as Sunday from (select distinct item_category from Items) as t left join temp on t.item_category = temp.item_category group by t.item_category order by Category
with temp as( select o.order_date, o.item_id, o.quantity, i.item_category from orders as o right join items as i on o.item_id = i.item_id ) select item_category as "Category", sum(if(weekday(temp.order_date) = 0, quantity, 0)) as "Monday", sum(if(weekday(temp.order_date) = 1, quantity, 0)) as "Tuesday", sum(if(weekday(temp.order_date) = 2, quantity, 0)) as "Wednesday", sum(if(weekday(temp.order_date) = 3, quantity, 0)) as "Thursday", sum(if(weekday(temp.order_date) = 4, quantity, 0)) as "Friday", sum(if(weekday(temp.order_date) = 5, quantity, 0)) as "Saturday", sum(if(weekday(temp.order_date) = 6, quantity, 0)) as "Sunday" from temp group by item_category order by item_category
with tmp as ( select item_category as category, dayofweek(order_date) as dow, sum(quantity) as units from orders a inner join items b using (item_id) group by 1,2) select a.category, sum(case when dow=2 then units else 0 end) as monday, sum(case when dow=3 then units else 0 end) as tuesday, sum(case when dow=4 then units else 0 end) as wednesday, sum(case when dow=5 then units else 0 end) as thursday, sum(case when dow=6 then units else 0 end) as friday, sum(case when dow=7 then units else 0 end) as saturday, sum(case when dow=1 then units else 0 end) as sunday from (select distinct item_category as category from items) a left join tmp b on a.category=b.category group by 1 order by 1
with tmp as (select item_category as category, dayofweek(order_date) as dow, sum(quantity) as qty from orders a inner join items b on a.item_id=b.item_id group by 1,2 ) select item_category as category, max(case when dow=2 then qty else 0 end) as Monday, max(case when dow=3 then qty else 0 end) as Tuesday, max(case when dow=4 then qty else 0 end) as Wednesday, max(case when dow=5 then qty else 0 end) as Thursday, max(case when dow=6 then qty else 0 end) as Friday, max(case when dow=7 then qty else 0 end) as Saturday, max(case when dow=1 then qty else 0 end) as Sunday from (select distinct item_category from items) a left join tmp b on a.item_category=b.category group by 1 order by 1
with tmp1 as ( select item_id, dayname(order_date) as dayofweek, sum(quantity) as quantity from Orders group by 1,2 ) select t2.item_category as CATEGORY, sum(case when dayofweek = 'Monday' then quantity else 0 end) as MONDAY, sum(case when dayofweek = 'Tuesday' then quantity else 0 end) as TUESDAY, sum(case when dayofweek = 'Wednesday' then quantity else 0 end) as WEDNESDAY, sum(case when dayofweek = 'Thursday' then quantity else 0 end) as THURSDAY, sum(case when dayofweek = 'Friday' then quantity else 0 end) as FRIDAY, sum(case when dayofweek = 'Saturday' then quantity else 0 end) as SATURDAY, sum(case when dayofweek = 'Sunday' then quantity else 0 end) as SUNDAY from Items t2 left join tmp1 t1 on t1.item_id = t2.item_id group by 1 order by 1
with x as(select item_id, ifnull((case when dayname(order_date) = 'Monday' then quantity end),0) as Monday, ifnull((case when dayname(order_date) = 'Tuesday' then quantity end),0) as Tuesday, ifnull((case when dayname(order_date) = 'Wednesday' then quantity end),0) as Wednesday, ifnull((case when dayname(order_date) = 'Thursday' then quantity end),0) as Thursday, ifnull((case when dayname(order_date) = 'Friday' then quantity end),0) as Friday, ifnull((case when dayname(order_date) = 'Saturday' then quantity end),0) as Saturday, ifnull((case when dayname(order_date) = 'Sunday' then quantity end),0) as Sunday from orders) select item_category as Category, ifnull(sum(Monday),0) Monday, ifnull(sum(Tuesday),0) Tuesday, ifnull(sum(Wednesday),0) Wednesday, ifnull(sum(Thursday),0) Thursday, ifnull(sum(Friday),0) Friday, ifnull(sum(Saturday),0) Saturday, ifnull(sum(Sunday),0) Sunday from x right join items b on x.item_id=b.item_id group by 1 order by 1,2,3,4,5,6,7,8 desc
