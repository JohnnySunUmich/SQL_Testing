CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls c GROUP BY 1, 2
SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, COUNT(duration) as call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, count(*) as call_count, sum(duration) as total_duration FROM Calls GROUP BY person1, person2
SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) as person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) as person2, count(duration) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1, person2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2 ORDER BY person1, person2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls group by 1, 2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1,person2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN to_id > from_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM calls GROUP BY CASE WHEN from_id < to_id THEN from_id ELSE to_id END, CASE WHEN to_id > from_id THEN to_id ELSE from_id END
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY 1,2
SELECT CASE WHEN from_id < to_id then from_id ELSE to_id end as person1, CASE WHEN from_id < to_id then to_id ELSE from_id end as person2, count(*) as call_count, sum(duration) as total_duration FROM calls group by 1,2
SELECT CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1, person2
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1,person2
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1, 2
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1,person2
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration from calls group by person2, person1
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, count(duration) as call_count, sum(duration) as total_duration FROM Calls GROUP BY person1, person2
SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id >to_id THEN from_id ELSE to_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT CASE WHEN from_id<to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id<to_id THEN to_id ELSE from_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT CASE WHEN from_id<to_id THEN to_id ELSE from_id END "person1", CASE WHEN from_id>to_id THEN to_id ELSE from_id END "person2", COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1,person2
SELECT CASE WHEN to_id > from_id THEN from_id ELSE to_id END AS person1, CASE WHEN to_id > from_id THEN to_id ELSE from_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM calls GROUP BY person1 , person2
SELECT DISTINCT Least(from_id,to_id) as person1, Greatest(from_id,to_id) as person2, Count(*) as call_count, Sum(duration) as total_duration FROM Calls Group by person1,person2
SELECT DISTINCT PERSON1, PERSON2, COUNT(C.DURATION) AS CALL_COUNT, SUM(C.DURATION) AS TOTAL_DURATION FROM (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS) C GROUP BY PERSON1, PERSON2 ORDER BY PERSON1
SELECT DISTINCT Person1, person2, SUM(call_count) AS call_count,SUM( total_duration) total_duration FROM( SELECT DISTINCT from_id AS person1 , to_id AS person2 ,COUNT(*) call_count ,SUM(duration) total_duration FROM Calls WHERE from_id< to_id GROUP BY from_id, to_id UNION ALL SELECT DISTINCT to_id AS person1 , from_id AS person2 ,COUNT(*) call_count ,SUM(duration) total_duration FROM Calls WHERE from_id> to_id GROUP BY from_id, to_id) AS f GROUP BY person1, person2
SELECT IF(from_id < to_id, from_id, to_id) AS person1, IF(from_id < to_id, to_id, from_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT IF(from_id<to_id,from_id,to_id) person1, IF(from_id>to_id,from_id,to_id) person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY IF(from_id<to_id,from_id,to_id), IF(from_id>to_id,from_id,to_id)
SELECT IF(from_id<to_id,from_id,to_id) person1, IF(from_id>to_id,from_id,to_id) person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1, person2
SELECT LEAST(from_id, to_id) AS person1 ,GREATEST(from_id, to_id) AS person2 ,count(*) AS call_count ,sum(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1, 2
SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY LEAST(from_id, to_id), GREATEST(from_id, to_id)
SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2 ORDER BY person1
SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY LEAST(from_id, to_id), GREATEST(from_id, to_id)
SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(c.duration) as total_duration FROM calls c GROUP BY 1,2
SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY LEAST(from_id, to_id), GREATEST(from_id, to_id)
SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1, person2
SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM calls GROUP BY person1, person2
SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls GROUP BY person1,person2
SELECT LEAST(from_id, to_id) person1, GREATEST(from_id, to_id) person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1, person2
SELECT LEAST(from_id,to_id) AS person1, GREATEST (from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM calls GROUP BY person1,person2
SELECT LEAST(from_id,to_id) AS person1, GREATEST(from_id,to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT LEAST(from_id,to_id) AS person1, GREATEST(from_id,to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2
SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2
SELECT LEAST(from_id,to_id) person1, GREATEST(from_id,to_id) person2, COUNT(duration) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1, person2
SELECT MIN(from_id) AS person1, MAX(to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM ( SELECT CONCAT(LEAST(from_id, to_id), '-', GREATEST(from_id, to_id)) AS persons, from_id, to_id, duration FROM Calls ) a GROUP BY persons
SELECT a AS person1, b as person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM ( (SELECT from_id AS a, to_id AS b, duration FROM Calls WHERE from_id < to_id) UNION ALL (SELECT to_id AS a, from_id AS b, duration FROM Calls WHERE from_id > to_id ) ) AS t1 GROUP BY a, b
SELECT a.from_id AS person1, a.to_id AS person2, COUNT(*) AS call_count, SUM(a.duration) AS total_duration FROM (SELECT (CASE WHEN c.from_id<c.to_id THEN c.from_id ELSE c.to_id END) as from_id, (CASE WHEN c.from_id<c.to_id THEN c.to_id ELSE c.from_id END) AS to_id, c.duration FROM calls c) AS a GROUP BY a.from_id, a.to_id
SELECT c.from_id as person1, c.to_id as person2, SUM(c.call_count) as call_count, SUM(c.duration) as total_duration FROM (SELECT from_id, to_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls c1 WHERE c1.from_id < c1.to_id GROUP BY from_id, to_id UNION SELECT to_id as from_id, from_id as to_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls c2 WHERE c2.from_id > c2.to_id GROUP BY from_id, to_id) c GROUP BY person1, person2
SELECT c3.to_id as person1, c3.from_id as person2, COUNT(c3.duration) as call_count, SUM(c3.duration) as total_duration FROM (SELECT c1.to_id, c1.from_id, c1.duration FROM Calls as c1 UNION ALL SELECT c2.from_id as "to_id", c2.to_id as "from_id", c2.duration FROM Calls as c2) as c3 WHERE to_id < from_id GROUP BY to_id,from_id
SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM ( SELECT * FROM calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM calls WHERE to_id < from_id ) a group by from_id, to_id
SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM ( SELECT from_id, to_id, duration FROM calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM calls WHERE from_id > to_id ) a GROUP BY from_id, to_id
SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM (SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id > to_id)t GROUP BY 1, 2
SELECT from_id AS person1, to_id AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM ( SELECT * FROM Calls UNION ALL SELECT to_id, from_id, duration FROM Calls ) as T1 WHERE from_id<to_id GROUP BY from_id, to_id ORDER BY 1
SELECT from_id AS person1, to_id AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM (SELECT from_id, to_id, duration FROM Calls WHERE from_id<to_id UNION ALL SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id>to_id)t1 GROUP BY person1,person2
SELECT from_id AS person1,to_id AS person2,COUNT(*) AS call_count,SUM(duration) AS total_duration FROM Calls GROUP BY from_id+to_id, from_id*to_id ORDER BY 1,2
SELECT from_id as person1, to_id as person2, count(*) as call_count, SUM(duration) as total_duration FROM (SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) as from_id, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) as to_id, duration FROM Calls) t GROUP BY from_id, to_id
SELECT least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration FROM Calls GROUP BY 1,2
SELECT least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by person1, person2
SELECT least(from_id,to_id) AS person1, greatest(from_id,to_id) AS person2, count(*) AS call_count, sum(duration) AS total_duration FROM Calls GROUP BY 1,2
SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM( SELECT CASE WHEN from_id<to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id>to_id THEN from_id ELSE to_id END AS person2, duration FROM Calls) c GROUP BY person1, person2
SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM( SELECT IF(from_id < to_id, from_id, to_id) AS person1, IF(from_id > to_id, from_id, to_id) AS person2, duration FROM Calls ) tmp GROUP BY 1, 2
SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM( SELECT duration, CASE WHEN from_id<to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id>to_id THEN from_id ELSE to_id END AS person2 FROM Calls) AS sub1 GROUP BY person1, person2
SELECT person1, person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM ( SELECT from_id as person1, to_id as person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id as person1, from_id as person2, duration FROM Calls WHERE to_id < from_id) t GROUP BY person1, person2
SELECT person1, person2, COUNT(*) call_count, SUM(duration) total_duration FROM (SELECT from_id person1, to_id person2, duration FROM calls UNION ALL SELECT to_id person1, from_id person2, duration FROM calls) a WHERE 1=1 AND person1 <person2 GROUP BY person1, person2
SELECT person1, person2, COUNT(1) AS call_count, SUM(duration) AS total_duration FROM ( SELECT CASE WHEN (from_id < to_id) THEN from_id ELSE to_id END AS person1, CASE WHEN (from_id < to_id) THEN to_id ELSE from_id END AS person2, duration FROM Calls ) AS CallsProcessed GROUP BY person1, person2
SELECT person1, person2, COUNT(c.duration) AS call_count, SUM(c.duration) AS total_duration FROM (SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, duration FROM Calls) c GROUP BY person1, person2
SELECT person1, person2, count(*) as call_count, sum(duration) as total_duration FROM (SELECT from_id as person1, to_id as person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id as person1, from_id as person2, duration FROM Calls WHERE from_id > to_id) A GROUP BY person1, person2
SELECT person1,person2, COUNT(*) call_count,SUM(duration) total_duration FROM (SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) person2, duration FROM Calls c ) temp GROUP BY person1,person2
SELECT sub.person1, sub.person2, COUNT(*) AS call_count, SUM(sub.duration) AS total_duration FROM (SELECT from_id AS person1, to_id AS person2, duration FROM Calls UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls) sub GROUP BY sub.person1, sub.person2 HAVING sub.person1 < sub.person2
SELECT t.from_id AS person1, t.to_id as person2, SUM(t.call_count) as call_count, SUM(t.duration) as total_duration FROM ((SELECT from_id, to_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls GROUP BY from_id, to_id) UNION ALL (SELECT to_id, from_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls GROUP BY from_id, to_id)) as t WHERE t.from_id < t.to_id GROUP BY t.from_id, t.to_id
Select Case when from_id < to_id then from_id Else to_id End as Person1, Case When from_id < to_id then to_id Else from_id End as Person2, Count(*) AS call_count, Sum(duration) AS total_duration from calls group by person1, person2 order by person1, person2
Select Least(from_id, to_id) as person1, Greatest(from_id, to_id) as person2, Count(*) as call_count, Sum(duration) as total_duration From Calls Group By person1, person2
Select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, Count(*) as call_count, SUM(duration) as total_duration From calls Group By person1, person2
Select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from Calls Group by person1, person2
Select case when from_id < to_id then from_id else to_id end person1, case when from_id > to_id then from_id else to_id end person2, count(*) call_count, sum(duration) total_duration From Calls Group BY person1, person2
Select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from (Select * from calls union all Select to_id as from_id, from_id as to_id, duration from calls) a where from_id < to_id group by from_id,to_id
Select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from (Select case when from_id > to_id then to_id else from_id end from_id, case when to_id < from_id then from_id else to_id end to_id, duration from Calls )t1 group by from_id, to_id
WITH CET AS (SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE from_id > to_id) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM CET GROUP BY 1,2
WITH CTE AS ( SELECT FROM_ID AS PERSON1,TO_ID AS PERSON2, DURATION FROM CALLS WHERE FROM_ID<TO_ID UNION ALL SELECT TO_ID AS PERSON1,FROM_ID AS PERSON2,DURATION FROM CALLS WHERE FROM_ID>TO_ID) SELECT PERSON1,PERSON2, COUNT(*) AS CALL_COUNT, SUM(DURATION) AS total_duration FROM CTE GROUP BY PERSON1,PERSON2
WITH CTE AS ( Select * FROM calls UNION ALL select to_id,from_id, duration from calls ) SELECT from_id as person1, to_id as person2, count(*) as call_count,sum(duration) as total_duration from cte where from_id < to_id group by from_id,to_id
WITH CTE AS( SELECT from_id as person1, to_id as person2, duration FROM Calls UNION ALL SELECT to_id as person1, from_id as person2, duration FROM Calls ) SELECT person1, person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM CTE WHERE person1<person2 GROUP BY person1, person2
WITH CTE AS( SELECT*, CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2 FROM Calls ) SELECT person1,person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM CTE GROUP BY person1,person2
WITH CTE1 AS ( SELECT (CASE WHEN from_id<to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id<to_id THEN to_id ELSE from_id END) AS person2, duration FROM Calls) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM CTE1 GROUP BY person1, person2
WITH CTE1 AS ( SELECT FROM_ID AS PERSON1, TO_ID AS PERSON2, DURATION FROM CALLS WHERE FROM_ID < TO_ID UNION ALL SELECT TO_ID AS PERSON1, FROM_ID AS PERSON2, DURATION FROM CALLS WHERE TO_ID < FROM_ID ) SELECT PERSON1, PERSON2, COUNT(*) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM CTE1 GROUP BY PERSON1, PERSON2
WITH CTE1 AS ( SELECT from_id, to_id, duration FROM calls UNION ALL SELECT to_id, from_id, duration FROM calls ) SELECT from_id as person1, to_id as person2, COUNT(*) as call_count, SUM(duration) total_duration FROM CTE1 WHERE from_id<to_id GROUP BY from_id, to_id
WITH TEMP AS (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS C) SELECT DISTINCT PERSON1, PERSON2, COUNT(*) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM TEMP GROUP BY PERSON1, PERSON2
WITH TEMP AS (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS C) SELECT DISTINCT PERSON1, PERSON2, COUNT(DURATION) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM TEMP GROUP BY PERSON1, PERSON2
WITH TEMP AS( SELECT * FROM Calls UNION ALL SELECT to_id as from_id, from_id as to_id, duration FROM Calls) SELECT from_id as person1, to_id as person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM TEMP GROUP BY 1,2 HAVING from_id < to_id
WITH X AS ( SELECT DISTINCT * FROM Calls ), CTE1 AS ( SELECT (CASE WHEN from_id<to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id<to_id THEN to_id ELSE from_id END) AS person2, duration FROM Calls) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM CTE1 GROUP BY person1, person2
WITH all_calls AS ( SELECT DISTINCT from_id, to_id, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls WHERE from_id < to_id GROUP BY from_id, to_id UNION ALL SELECT DISTINCT to_id AS from_id, from_id AS to_id, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls WHERE from_id > to_id GROUP BY from_id, to_id ) SELECT from_id AS person1, to_id AS person2, SUM(call_count) AS call_count, SUM(total_duration) AS total_duration FROM all_calls GROUP BY person1, person2
WITH all_calls AS (SELECT * FROM Calls UNION ALL SELECT to_id, from_id, duration FROM Calls) SELECT from_id AS person1, to_id as person2, COUNT(duration) AS call_count,SUM(duration) AS total_duration FROM all_calls WHERE from_id < to_id GROUP BY from_id, to_id
WITH allrows AS ( SELECT IF (from_id <= to_id, from_id, to_id) AS person1, IF (from_id <= to_id, to_id, from_id) AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM allrows GROUP BY person1, person2 ORDER BY person1, person2
WITH c AS ( SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS from_id, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS to_id, duration FROM Calls ) SELECT from_id AS person1, to_id AS person2, COUNT(from_id) AS call_count, SUM(duration) AS total_duration FROM c GROUP BY from_id, to_id
WITH c1 AS (SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id > to_id) SELECT from_id AS person1, to_id AS person2 , count(1) AS call_count, SUM(duration) AS total_duration FROM c1 GROUP BY from_id, to_id
WITH calls_cte AS ( SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS from_id, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS to_id, duration FROM Calls ) SELECT from_id AS person1, to_id AS person2, COUNT(1) AS call_count, SUM(duration) AS total_duration FROM calls_cte GROUP BY from_id, to_id
WITH clean_calls AS ( SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) as person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) as person2, duration FROM Calls) SELECT person1, person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM clean_calls GROUP BY person1, person2
WITH combo as ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id, from_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from combo group by from_id, to_id order by from_id, to_id
WITH cte AS ( Select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) Select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2
WITH cte AS (SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE from_id > to_id) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM cte GROUP BY person1, person2
WITH cte AS (SELECT from_id, to_id, COUNT(*) AS cnt, SUM(duration) AS dur FROM Calls GROUP BY from_id, to_id) SELECT IF(from_id<to_id, from_id, to_id) AS person1, IF(from_id<to_id, to_id, from_id) AS person2, SUM(cnt) AS call_count, SUM(dur) AS total_duration FROM cte GROUP BY person1, person2
WITH cte_summary AS ( SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE to_id < from_id ) SELECT person1, person2, COUNT(1) AS call_count, SUM(duration) AS total_duration FROM cte_summary GROUP BY person1, person2
WITH getCalls AS( SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id > to_id UNION ALL SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id ) SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM getCalls GROUP BY 1,2 ORDER BY 1,2
WITH main(person1, person2, duration) AS ( SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM Calls WHERE from_id > to_id ) SELECT person1, person2, COUNT(duration) AS call_Count, SUM(duration) AS total_duration FROM main GROUP BY person1, person2
WITH reorder_tb AS ( SELECT IF(from_id < to_id, from_id, to_id) AS person1, IF(from_id < to_id, to_id, from_id) AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM reorder_tb GROUP BY person1, person2
WITH same_calls AS ( SELECT from_id, to_id, COUNT(*) as call_count, SUM(duration) as total_duration from Calls GROUP BY from_id, to_id ), temp_data AS ( SELECT C1.from_id, C1.to_id, C2.from_id as c2_from_id, (COALESCE(C1.call_count,0)+COALESCE(C2.call_count,0)) as call_count, (COALESCE(C1.total_duration,0) + COALESCE(C2.total_duration,0)) as total_duration from same_calls C1 LEFT JOIN same_calls C2 ON C1.from_id = C2.to_id AND C1.to_id = C2.from_id ORDER BY C1.from_id, C1.to_id ) SELECT from_id as person1, to_id as person2, call_count , total_duration from temp_data where (from_id < c2_from_id OR c2_from_id is NULL)
WITH t AS (SELECT * FROM Calls UNION ALL SELECT to_id AS from_id,from_id AS to_id,duration FROM Calls) SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM t WHERE from_id < to_id GROUP BY 1,2
WITH t AS (SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END as person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END as person2, duration FROM calls) SELECT person1, person2, count(*) as call_count, sum(duration) as total_duration FROM t GROUP BY 1,2
WITH table1 AS( SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) As total_duration FROM table1 GROUP BY person1, person2
WITH tb1 AS( SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(*) call_count, SUM(duration) total_duration FROM tb1 GROUP BY person1, person2
WITH temp AS ( SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE to_id < from_id ) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM temp GROUP BY person1, person2
With cte as ( Select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) Select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2
select ( case when from_id < to_id then from_id when from_id > to_id then to_id end ) person1, (case when from_id < to_id then to_id when from_id > to_id then from_id end ) person2, count(*) as call_count,sum(duration) as total_duration from Calls group by person1, person2
select (case when from_id < to_id then from_id else to_id end) as person1, (case when from_id > to_id then from_id else to_id end) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select (case when from_id < to_id then from_id else to_id end) person1, (case when from_id > to_id then from_id else to_id end) person2, count(duration)call_count, sum(duration) total_duration from calls group by 1, 2 order by 1, 2
select (case when from_id < to_id then from_id else to_id end) person1, (case when from_id > to_id then from_id else to_id end) person2, count(from_id) call_count, sum(duration) total_duration from Calls group by person1, person2
select (case when from_id < to_id then from_id else to_id end) person1, (case when to_id > from_id then to_id else from_id end) person2, count(1) call_count, sum(duration) total_duration from Calls group by 1,2
select A.person1, A.person2, count(duration) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1,from_id as person2, duration from Calls) as A where A.person1<A.person2 group by 1,2
select CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, count(1) as call_count, sum(duration) as total_duration from calls group by 1,2
select DISTINCT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select IF(from_id<to_id, from_id, to_id) as person1, IF(from_id<to_id, to_id, from_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls GROUP BY 1,2
select IF(from_id>to_id, to_id, from_id) as person1, IF(from_id>to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1,2
select LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by LEAST(from_id, to_id), GREATEST(from_id, to_id)
select LEAST(from_id, to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2
select LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) total_duration from Calls group by person1, person2
select a.person1, a.person2, count(*) as call_count, sum(a.duration) as total_duration from ( select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, duration from calls ) a group by a.person1, a.person2
select base.person1,base.person2, count(*) call_count, sum(base.duration) total_duration from (select from_id person1, to_id person2, duration from Calls union all select to_id person1, from_id person2, duration from Calls ) as base where base.person1< base.person2 group by base.person1, base.person2
select c.person1, c.person2, sum(call_count) call_count, sum(total_duration) total_duration from (select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id<to_id group by 1,2 union select to_id person1, from_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id>to_id group by 1,2) c group by 1,2
select case when c.from_id < c.to_id then c.from_id else c.to_id end as person1, case when c.from_id > c.to_id then c.from_id else c.to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls c group by person1, person2
select case when from_id < to_id then from_id else to_id end "person1", case when from_id > to_id then from_id else to_id end "person2", count(*) "call_count", sum(duration) "total_duration" from calls group by 1, 2
select case when from_id < to_id then from_id else to_id end "person1", case when from_id > to_id then from_id else to_id end "person2", count(duration) "call_count", sum(duration) "total_duration" from calls group by 1, 2
select case when from_id < to_id then from_id else to_id end as 'person1', case when from_id < to_id then to_id else from_id end as 'person2', count(*) as call_count, sum(duration)as total_duration from Calls group by 1,2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1,2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1,2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1, 2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1,2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(1) as call_count, sum(duration) as total_duration from Calls group by 1,2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(1) as call_count, sum(duration) as total_duration from calls group by 1,2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by person1, person2
select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, sum(duration) as total_duration, count(duration) as call_count from Calls group by person1,person2 order by person1,person2
select case when from_id < to_id then from_id else to_id end person1, case when from_id > to_id then from_id else to_id end person2, count(duration) call_count, sum(duration) total_duration from calls group by person1, person2
select case when from_id < to_id then from_id when from_id > to_id then to_id end as person1, case when from_id < to_id then to_id when from_id > to_id then from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select case when from_id > to_id then to_id else from_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select case when from_id > to_id then to_id else from_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) call_count, sum(duration) total_duration from calls group by 1,2
select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2
select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count,sum(duration) as total_duration from calls group by case when from_id > to_id then to_id else from_id end, case when from_id > to_id then from_id else to_id end
select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by 1,2
select case when from_id > to_id then to_id else from_id end as person1, case when to_id > from_id then to_id else from_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person2, person1
select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2
select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person1, person2
select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, count(to_id) as call_count, sum(duration) as total_duration from Calls group by 1,2 order by 1,2
select case when from_id<to_id then from_id else to_id end as person1, case when from_id>to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2
select case when from_id<to_id then from_id else to_id end as person1, case when to_id>from_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select case when from_id>to_id then from_id else to_id end as person1, case when from_id>to_id then to_id else from_id end as person2, count(duration) call_count, sum(duration) total_duration from Calls group by person1, person2
select case when from_id>to_id then to_id else from_id end as person1, case when from_id>to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person1, person2
select case when from_id>to_id then to_id else from_id end as person1, case when from_id>to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person2, person1
select case when to_id < from_id then to_id else from_id end as person1, case when to_id > from_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2
select case when(from_id > to_id) then to_id else from_id end as person1 , case when(from_id > to_id) then from_id else to_id end as person2 , count(*) as call_count , sum(duration) as total_duration from calls group by 1,2
select distinct person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls ) c where person1 < person2 group by person1, person2
select distinct person1, person2, count(duration) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from calls) t group by 1,2
select distinct person1, person2, count(duration) as call_count, sum(duration)as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls )a where person1<person2 group by person1, person2
select from_ as person1, to_ as person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as from_, case when from_id > to_id then from_id else to_id end as to_, duration from Calls) t1 group by from_, to_
select from_id as 'person1', to_id as 'person2', count(*) as 'call_count', sum(duration) as 'total_duration' from ( select * from Calls Union all select to_id as 'from_id', from_id as 'to_id', duration from Calls) as A where from_id < to_id group by from_id, to_id
select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) as tmp group by from_id, to_id
select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from (select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id union all select from_id, to_id, duration from calls where from_id < to_id) a group by from_id, to_id
select from_id as person1, to_id as person2, count(*) as call_count, sum(duration)as total_duration from (select to_id as from_id,from_id as to_id,duration from calls where from_id >to_id union all select from_id,to_id ,duration from calls where from_id < to_id)t group by 1,2 order by person1
select from_id as person1, to_id as person2, count(1) as call_count,sum(duration) as total_duration from (select from_id as from_id, to_id as to_id, duration from calls where from_id<to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id>to_id ) as t group by from_id,to_id
select from_id as person1, to_id as person2, count(case when from_id < to_id then concat(from_id, to_id) else 0 end) as call_count, sum(duration) as total_duration from Calls where case when from_id < to_id then concat(from_id, to_id) when to_id < from_id then concat(to_id, from_id) end group by case when from_id < to_id then concat(from_id, to_id) when to_id < from_id then concat(to_id, from_id) end
select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id, from_id, duration from Calls) as t where from_id < to_id group by person1, person2
select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id, from_id, duration from Calls) t1 where from_id < to_id group by person1, person2
select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id,from_id,duration from Calls) as temp where from_id<to_id group by person1,person2
select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from( select from_id, to_id, duration from calls where from_id < to_id union all select to_id, from_id, duration from calls where to_id < from_id) t group by 1,2 order by 1,2
select from_id as person1, to_id as person2, count(from_id) as call_count ,sum(duration) as total_duration from (select case when to_id<from_id then to_id else from_id end as from_id ,case when to_id<from_id then from_id else to_id end as to_id ,duration from Calls)a group by from_id,to_id
select from_id as person1, to_id as person2, sum(ct) as call_count, sum(duration) as total_duration from ( select from_id, to_id, count(*) as ct, sum(duration) as duration from Calls group by from_id, to_id having from_id < to_id union select to_id, from_id, count(*) as ct, sum(duration) as duration from Calls group by to_id, from_id having to_id < from_id ) sub group by from_id, to_id
select from_id as person1, to_id as person2,count(*) as call_count,sum(duration) as total_duration from ( select case when from_id > to_id then to_id else from_id end as from_id, case when from_id > to_id then from_id else to_id end as to_id, duration from Calls ) temp group by from_id,to_id
select from_id as person1,to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id, from_id, duration from Calls) t1 where from_id < to_id group by person1, person2
select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from (select to_id as from_id, from_id as to_id, duration from Calls where from_id > to_id union all select from_id, to_id, duration from Calls where from_id < to_id) t group by 1,2
select from_id_ as person1, to_id_ as person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id > to_id then to_id else from_id end as from_id_, case when from_id > to_id then from_id else to_id end as to_id_, duration from Calls)a group by from_id_, to_id_
select id1 as person1, id2 as person2, count(duration) as call_count, sum(duration) as total_duration from ( select from_id as id1, to_id as id2, duration from calls union all select to_id as id1, from_id as id2, duration from calls) as temp where id1<id2 group by id1, id2
select id1 person1, id2 person2, count(*) call_count, sum(duration) total_duration from (select LEAST(from_id, to_id) as id1, GREATEST(from_id, to_id) as id2, duration from Calls) as t1 group by id1, id2
select id1 person1, id2 person2, count(*) call_count, sum(duration) total_duration from (select if(from_id < to_id, from_id, to_id) as id1, if(from_id > to_id, from_id, to_id) as id2, duration from Calls) as t1 group by id1, id2
select if (from_id < to_id, from_id, to_id) as person1, if(from_id < to_id, to_id, from_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select if(calls.from_id<calls.to_id,calls.from_id,calls.to_id) person1, if(calls.from_id<calls.to_id,calls.to_id,calls.from_id) person2, count(*) call_count,sum(duration) total_duration from calls group by 1,2
select if(from_id < to_id, from_id, to_id) as person1 , if(from_id > to_id, from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by 1, 2
select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1,person2
select if(from_id >to_id,to_id , from_id )person1, if(from_id > to_id, from_id,to_id )person2,count(*) call_count ,sum(duration) total_duration from Calls group by person1,person2
select if(from_id<to_id, from_id, to_id) person1, if(from_id>to_id, from_id, to_id) person2, count(*) call_count, sum(duration) total_duration from calls group by person1, person2
select if(from_id<to_id, from_id, to_id) person1, if(from_id>to_id,from_id, to_id) person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2
select if(from_id<to_id,from_id,to_id)as person1, if(from_id>to_id,from_id,to_id)as person2, count(*)as call_count, sum(duration)as total_duration from calls group by person1, person2
select if(from_id>to_id, from_id, to_id) as person1, if (from_id<to_id, from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select least(from_id , to_id) person1, greatest (from_id , to_id) person2 , count(duration) as call_count , sum(duration) as total_duration from Calls group by 1,2 order by 1,2
select least(from_id, to_id) as 'person1', greatest(from_id, to_id) as 'person2', count(duration) as 'call_count', sum(duration) as 'total_duration' from calls group by person1, person2
select least(from_id, to_id) as person1 , greatest(from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by 1, 2
select least(from_id, to_id) as person1 , greatest(from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by person1, person2
select least(from_id, to_id) as person1 , greatest(from_id,to_id) as person2,count(*) as call_count,sum(duration) as total_duration from calls group by person1,person2
select least(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2
select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2
select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1, 2
select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select least(from_id, to_id) person1, greatest(from_id, to_id) person2, count(*) call_count, sum(duration) total_duration from calls group by 1,2
select least(from_id, to_id) person1, greatest(to_id, from_id) person2,count(*) call_count, sum(duration) total_duration from Calls group by 1, 2
select least(from_id,to_id) 'person1', greatest(from_id,to_id) 'person2', count(*) 'call_count', sum(duration) 'total_duration' from calls group by person1, person2
select least(from_id,to_id) as person1 , greatest(from_id,to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from calls a group by person1,person2
select least(from_id,to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select least(from_id,to_id) as person1, greatest(from_id, to_id) as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by 1, 2
select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1,2
select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2
select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(1) as call_count, sum(duration) as total_duration from calls group by person1, person2
select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by person1, person2
select least(from_id,to_id) as person1,greatest(from_id,to_id) as person2,count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2
select least(from_id,to_id)person1, greatest(from_id,to_id)person2, COUNT(*) AS call_count, sum(duration) total_duration from Calls group by 1,2 order by 1,2
select person1 ,person2 ,count(duration) as call_count ,sum(duration) as total_duration from( select if(from_id<to_id, from_id,to_id) as person1 ,if(from_id<to_id, to_id, from_id) as person2 ,duration from Calls ) callA group by person1,person2
select person1, person2, call_count, total_duration from (select person1, person2, sum(c1) as call_count, sum(d1) as total_duration from (select from_id as person1, to_id as person2, count(*) as c1, sum(duration) as d1 from Calls group by 1, 2 union select to_id as person1, from_id as person2, count(*) as c1, sum(duration) as d1 from Calls group by 1, 2) as a group by 1, 2) as b where person1 < person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select IF(from_id > to_id, from_id, to_id) as person1, IF(from_id < to_id, from_id, to_id) as person2, duration from calls ) as t group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select case when from_id > to_id then to_id else from_id end as person1, case when from_id < to_id then to_id else from_id end as person2, duration from calls )temp group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1, to_id as person2, duration from Calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from Calls where from_id>to_id ) t1 group by 1,2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) as a group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1,to_id as person2, duration from Calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from Calls where to_id<from_id )tmp group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select if(from_id < to_id, from_id, to_id) as person1, if(from_id < to_id, to_id, from_id) as person2, duration from Calls ) temp group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from ((select from_id as person1, to_id as person2, duration from Calls where from_id < to_id) union all (select to_id as person1, from_id as person2, duration from Calls where from_id > to_id)) as tb group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) all_records group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, duration from calls) x group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select duration, case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2 from Calls) Table1 group by Table1.person1, Table1.person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id < to_id union all select to_id as person1, from_id as person1, duration from Calls where from_id > to_id) as all_ordered group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from Calls where from_id > to_id)t group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from Calls where to_id < from_id) a group by 1,2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from Calls where from_id>to_id) temp group by person1, person2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) t group by 1,2
select person1, person2, count(*) as call_count, sum(duration) as total_duration from( select from_id as person1,to_id as person2,duration from calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from calls where to_id<from_id )a group by person1 , person2
select person1, person2, count(duration) as call_count, sum(duration) as total_duration from (select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) tmp group by 1,2
select person1, person2, count(duration) as call_count, sum(duration) as total_duration from (select person1, person2, duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls) t1 where person1<person2) t2 group by 1,2
select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from (select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2 union select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2) sub group by 1, 2 having person1 < person2
select person1, person2, sum(call_count) call_count, sum(total_duration) total_duration from( select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from calls where from_id<to_id group by from_id, to_id union select to_id person1, from_id person2, count(*) call_count, sum(duration) total_duration from calls where from_id>to_id group by to_id, from_id) t group by t.person1, t.person2
select person1,person2, SUM(call_count) as call_count, SUM(total_duration) as total_duration from (select from_id as person1,to_id as person2,count(1) as call_count,SUM(duration) as total_duration from calls where from_id < to_id group by from_id,to_id UNION select to_id as person1,from_id as person2,count(1) as call_count,SUM(duration) as total_duration from calls where from_id > to_id group by from_id,to_id ) t group by person1,person2 order by person1
select person1,person2,sum(call_count) call_count,sum(duration) total_duration from (select from_id as person1,to_id as person2, count(*) as call_count, sum(duration) duration from Calls where from_id<to_id group by from_id,to_id union select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) duration from Calls where to_id<from_id group by to_id,from_id) A group by person1,person2
select t.from_id as person1 , t.to_id as person2 , count(*) as call_count , sum(t.duration) as total_duration from (select from_id, to_id, duration from Calls UNION ALL select to_id, from_id, duration from Calls) t where t.from_id < t.to_id group by person1, person2
select t.from_id as person1, t.to_id as person2, count(*) as call_count, sum(t.duration) as total_duration from ( (select from_id, to_id, duration from calls where from_id < to_id ) union all ( select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) ) t group by 1,2
select t.from_id as person1, t.to_id as person2, count(duration) as call_count, sum(duration) as total_duration from ( select from_id, to_id, duration from Calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from Calls where from_id > to_id ) t group by 1, 2
select t.person1, t.person2, count(duration) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls) t where t.person1 < t.person2 group by 1,2
select t.person1, t.person2, count(t.duration) as call_count, sum(t.duration) as total_duration from ( select case when c.from_id > c.to_id then c.to_id else c.from_id end as person1, case when c.from_id > c.to_id then c.from_id else c.to_id end as person2, c.duration from Calls c ) t group by t.person1, t.person2
select t2.person1 as Person1, t2.person2 as Person2, count(*) as call_count, sum(t2.duration) as total_duration from (SELECT IF(from_id < to_id, from_id, to_id) as person1 , IF(from_id > to_id, from_id, to_id) as person2 , duration from Calls) as t2 group by t2.person1, t2.person2
select temp.from_id as person1, temp.to_id as person2, count(temp.from_id) as call_count, sum(temp.duration) as total_duration from (select from_id , to_id,duration from calls union all select to_id as from_id,from_id as to_id, duration from calls) as temp where temp.from_id<temp.to_id group by temp.from_id,temp.to_id
with CTE as ( select case when from_id<to_id then from_id else to_id end as from_id, case when from_id>to_id then from_id else to_id end as to_id,duration from calls ) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from CTE group by from_id,to_id
with a as ( select case when from_id < to_id then from_id else to_id end as id1 , case when from_id < to_id then to_id else from_id end as id2 , duration from (select * from calls where from_id!=to_id) as t) select id1 as person1 , id2 as person2 , count(*) as call_count , sum(duration) as total_duration from a group by id1, id2
with a as( SELECT * FROM Calls UNION ALL SELECT to_id from_id, from_id to_id, duration FROM Calls) SELECT from_id person1, to_id person2, COUNT(*) call_count, SUM(duration) total_duration FROM a GROUP BY person1, person2 HAVING person1 < person2
with all_users as (select distinct from_id as id from calls union select distinct to_id as id from calls) select a.id as person1, b.id as person2, count(duration) as call_count, sum(duration) as total_duration from all_users a join all_users b on a.id<b.id join calls c on (a.id = c.from_id and b.id = c.to_id ) or (a.id = c.to_id and b.id = c.from_id ) group by 1,2
with base as ( select * from ( select * from calls where from_id < to_id )t union all( select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) ) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from base group by 1,2
with base as ( select from_id as id1, to_id as id2, duration from Calls union all select to_id as id1, from_id as id2, duration from Calls ) select id1 as person1, id2 as person2, count(1) as call_count, sum(duration) as total_duration from base where id1 < id2 group by 1,2
with ct as (select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from calls where from_id < to_id group by from_id, to_id union all select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) total_duration from calls where from_id > to_id group by to_id,from_id) select person1,person2,sum(call_count) as call_count,sum(total_duration) as total_duration from ct group by person1,person2
with cte as ( select * from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(1) call_count, sum(duration) total_duration from cte group by 1, 2
with cte as ( select case when from_id > to_id then to_id else from_id end as from_id, case when from_id < to_id then to_id else from_id end as to_id, duration from Calls ) select from_id person1 , to_id person2 , count(from_id) call_count , sum(duration) total_duration from cte group by from_id, to_id
with cte as ( select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from calls where from_id<to_id group by 1,2 union all select to_id as person1, from_id as person2, count(duration) as call_count, sum(duration) as total_duration from calls where from_id>to_id group by 1,2 ) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from cte group by 1,2
with cte as ( select from_id as person1, to_id as person2, duration from calls union all select to_id as person1, from_id as person2, duration from calls ) SELECT PERSON1 AS person1,PERSON2 AS person2,COUNT(PERSON1) as call_count,SUM(DURATION) as total_duration FROM CTE WHERE PERSON1 < PERSON2 GROUP BY PERSON1,PERSON2
with cte as ( select from_id as person1, to_id as person2, duration from calls union all select to_id as person1, from_id as person2, duration from calls ) select person1,person2, count(*) as call_count, sum(duration) as total_duration from cte where person1 < person2 group by person1,person2
with cte as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2
with cte as ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id, from_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from cte group by from_id, to_id
with cte as ( select from_id, to_id, sum(duration) as dur, count(from_id) as cnt from calls group by 1,2 order by 1,2 ) select c1.from_id as person1, c1.to_id as person2, sum(ifnull(c1.cnt,0)+ifnull(c2.cnt,0)) as call_count, sum(ifnull(c1.dur,0) + ifnull(c2.dur,0)) as total_duration from cte c1 left join cte c2 on c1.to_id = c2.from_id and c2.to_id = c1.from_id where c1.from_id < c2.from_id or c2.to_id is null group by 1,2
with cte as ( select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, duration from calls) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2
with cte as ((select from_id as person1, to_id as person2, duration from calls where from_id<to_id) union all (select to_id as person1, from_id as person2, duration from calls where from_id>to_id)) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2
with cte as (Select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, duration from calls), cte_1 as (Select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2) Select * from cte_1
with cte as (select (case when from_id < to_id then from_id else to_id end) as from_id, (case when to_id > from_id then to_id else from_id end) as to_id, duration from calls) select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from cte group by from_id, to_id
with cte as (select c1.from_id, c1.to_id, c1.duration from calls c1 union all select c2.to_id as from_id, c2.from_id as to_id, c2.duration from calls c2) select from_id as person1, to_id as person2, count(from_id) as call_count, sum(duration) as total_duration from cte where from_id<to_id group by 1,2
with cte as (select case when from_id<to_id then from_id else to_id end as from_id, case when from_id<to_id then to_id else from_id end as to_id, duration from calls) select from_id as person1, to_id as person2,count(duration) call_count, sum(duration) total_duration from cte group by 1,2
with cte as (select distinct from_id as person1, to_id as person2, count(*) over(partition by from_id,to_id ) as call_count, sum(duration) over(partition by from_id,to_id ) as total_duration from calls where from_id<to_id union distinct select distinct to_id as person1, from_id as person2, count(*) over(partition by to_id,from_id ) as call_count,sum(duration) over(partition by to_id,from_id) as total_duration from calls where to_id<from_id) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from cte group by person1, person2
with cte as (select from_id,to_id,duration from calls where from_id<to_id union all select to_id,from_id,duration from calls where from_id>to_id) select from_id person1,to_id person2,count(*) call_count, sum(duration) total_duration from cte group by 1,2
with cte as (select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, duration from calls) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2
with cte as( select (case when from_id < to_id then from_id else to_id end) as person1, (case when from_id > to_id then from_id else to_id end) as person2, duration from calls ) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by 1,2
with cte as( select case when from_id < to_id then from_id else to_id end as from_id, case when from_id > to_id then from_id else to_id end as to_id, duration from calls) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2
with cte as( select case when from_id < to_id then from_id else to_id end from_id1, case when from_id < to_id then to_id else from_id end to_id1, duration from calls ) select from_id1 person1, to_id1 person2,count(*) call_count, sum(duration) total_duration from cte group by 1,2
with cte as( select case when from_id<to_id then from_id else to_id end as person1, case when to_id<from_id then from_id else to_id end as person2, duration from calls) select person1,person2,count(*) as call_count,sum(duration) as total_duration from cte group by 1,2
with cte1 as ( select * from Calls where from_id < to_id ), cte2 as ( select to_id as from_id, from_id as to_id, duration from Calls where from_id > to_id ), cte3 as ( select * from cte1 union all select * from cte2 ) select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from cte3 group by person1, person2
with cte1 as ( select *, if(from_id>to_id,cast(to_id + from_id*power(2,32) as unsigned),cast(from_id + to_id*power(2,32) as unsigned)) as combo from Calls ) select if(from_id<to_id, from_id, to_id) as person1, if(from_id>to_id, from_id, to_id) as person2, count(combo) as call_count, sum(duration) as total_duration from cte1 group by combo order by person1, person2
with cte1 as ( select case when from_id<to_id then from_id else to_id end as person1, case when from_id>to_id then from_id else to_id end as person2,duration from calls ) select person1,person2,count(1) as call_count,sum(duration) as total_duration from cte1 group by 1,2
with cte1 as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id ) ,cte2 as ( select to_id as person1, from_id as person2, duration from calls where from_id > to_id ) ,cte3 as( select person1, person2, duration from cte1 union all select person1, person2, duration from cte2 ) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte3 group by 1,2
with cte1 as ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from cte1 group by from_id,to_id
with final as ( with other1 as ( with other as ( with cte as ( Select * ,count(*) over(partition by from_id,to_id) as 'calls_between' from Calls ) Select *,sum(duration) as 'initial_sum' from cte group by from_id,to_id ) Select o1.from_id as 'first_from',o1.to_id as 'first_to',o2.from_id as 'second_from',o2.to_id as 'second_to',o1.calls_between,o1.initial_sum as 'first_sum',o2.initial_sum as 'second_sum' from other o1 left join other o2 on o1.to_id = o2.from_id and o1.from_id = o2.to_id where (o2.from_id is null and o2.to_id is null) or (o1.from_id < o2.from_id and o1.to_id > o2.to_id) ) Select *, case when (first_from = second_to and first_to = second_from) then calls_between + 1 when second_from is null and second_to is null then calls_between end as updated_call_count, case when (first_from = second_to and first_to = second_from) then first_sum + second_sum when second_from is null and second_to is null then first_sum end as updated_sum from other1 ) Select first_from as person1,first_to as person2,updated_call_count as call_count, updated_sum as total_duration from final
with main as ( select from_id,to_id,duration from calls union all select to_id,from_id,duration from calls ) select from_id as person1, to_id as person2, count(1) as call_count, sum(duration) as total_duration from main where from_id<to_id group by from_id,to_id
with new as( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person1, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from new group by person1, person2
with new as(select if(from_id<to_id,from_id,to_id) as person1, if(from_id<to_id,to_id,from_id) as person2, duration from calls) select person1, person2, count(*) as call_count, sum(duration) as total_duration from new group by 1,2
with pairs as ( select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by from_id, to_id union select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by from_id, to_id ) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from pairs where person1 < person2 group by person1, person2
with person_single as (select * from (select distinct from_id as person from Calls union select distinct to_id as person from Calls) sub ), duration_sub as (select * from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls) sub2), combo_pair as (select p1.person as person1, p2.person as person2 from person_single p1 join person_single p2 on p1.person < p2.person ) select d.person1, d.person2, count(d.duration) as call_count, sum(d.duration) as total_duration from combo_pair p join duration_sub d on p.person1 = d.person1 and p.person2 = d.person2 group by 1,2
with summaryTable as ( select Case when from_id < to_id then from_id else to_id end as person1, Case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls as c1 group by from_id, to_id ) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from summaryTable as st group by person1, person2
with t as ( select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, duration from Calls) select distinct person1, person2, count(*) as call_count, sum(duration) as total_duration from t group by person1, person2
with t as ( select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from calls ) select person1,person2,count(duration) as call_count, sum(duration) as total_duration from t group by 1,2
with t as ( select case when from_id > to_id then to_id else from_id end person1, case when from_id > to_id then from_id else to_id end person2, duration from calls ) select t.person1, t.person2, count(*) call_count, sum(duration) total_duration from t group by person1, person2
with t as ( select from_id as p1, to_id as p2, duration from calls where to_id > from_id union all select to_id as p1, from_id as p2, duration from calls where to_id < from_id ) select p1 as person1, p2 as person2, count(*) as call_count, sum(t.duration) as total_duration from t group by person1, person2
with t as (SELECT CASE WHEN from_id<to_id then from_id else to_id end as person1, CASE WHEN from_id<to_id then to_id else from_id end as person2, duration from calls) select person1,person2, count(duration) as call_count, sum(duration) as total_duration from t group by person1,person2
with t as (select from_id, to_id, count(duration) as call_count, sum(duration) as duration from calls group by from_id, to_id) select from_id as person1, to_id as person2, call_count, duration as total_duration from t where (from_id,to_id) not in (select t1.from_id,t1.to_id from t t1, t t2 where t1.from_id = t2.to_id and t1.to_id = t2.from_id) union all select t1.from_id,t1.to_id, (t1.call_count + t2.call_count) as call_count, (t1.duration + t2.duration) as total_duration from t t1, t t2 where t1.from_id = t2.to_id and t1.to_id = t2.from_id and t1.from_id <t1.to_id
with t as (select from_id, to_id, count(duration) as call_count, sum(duration) as total_duration from calls group by from_id, to_id) select distinct if(t1.from_id < t1.to_id, t1.from_id, t1.to_id) person1, if(t1.from_id < t1.to_id, t1.to_id, t1.from_id) person2, if(t2.from_id is null, t1.call_count, t1.call_count + t2.call_count) as call_count, if(t2.from_id is null, t1.total_duration, t1.total_duration + t2.total_duration) as total_duration from t t1 left join t t2 on t1.from_id = t2.to_id and t1.to_id = t2.from_id
with t as (select t1.from_id,t1.to_id,t1.duration from (select from_id,to_id,duration from calls union all select to_id as from_id,from_id as to_id,duration from calls) t1 where t1.to_id > t1.from_id) select from_id as person1 ,to_id as person2 ,count(*) as call_count ,sum(duration) as total_duration from t GROUP BY from_id ,to_id
with t1 as( select * from calls where from_id<to_id union all select to_id as 'from_id', from_id as 'to_id', duration from calls where from_id>to_id ) select from_id as 'person1', to_id as 'person2', count(from_id) as 'call_count', sum(duration) as 'total_duration' from t1 group by 1,2
with t1 as(select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from calls) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from t1 group by person1, person2
with tab as ( select * from calls union all select to_id as from_id,from_id as to_id, duration from calls ) select from_id as person1, to_id as person2, count(from_id) as call_count, sum(duration) as total_duration from tab where from_id < to_id group by 1,2 order by 1,2
with tab as (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls ) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from tab group by person1, person2
with temp as ( select case when from_id<to_id then from_id else to_id end as person1, case when to_id>from_id then to_id else from_id end as person2, duration from calls ) select person1, person2, count(*) as call_count, sum(duration)as total_duration from temp group by 1, 2
with temp as (select from_id, to_id, count(*) as ct, sum(duration) as du from Calls group by from_id, to_id) select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, sum(ct) call_count, sum(du) total_duration from temp group by case when from_id > to_id then to_id else from_id end, case when from_id > to_id then from_id else to_id end
with temp as (select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from temp group by from_id, to_id
with temp as( select a.from_id person1, a.to_id person2, count(*) cnt, sum(duration) duration from calls a group by a.from_id, a.to_id), temp2 as( select t1.person1, t1.person2, ifnull(sum(t1.cnt),0)+ ifnull(sum(t2.cnt),0) call_count, coalesce(sum(t1.duration),0)+ ifnull(sum(t2.duration),0) total_duration from temp t1 left join temp t2 on t1.person1 = t2.person2 and t1.person2 = t2.person1 where t1.person1 < t1.person2 group by 1,2) select * from temp2 union select person2,person1,cnt,duration from temp where person2< person1 and (person2,person1) not in (select person1,person2 from temp2)
with temp1 as ( select case when from_id < to_id then from_id else to_id end as person1, case when from_id> to_id then from_id else to_id end as person2, duration from calls) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from temp1 group by person1, person2
with tmp as ( select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, duration from Calls ) select person1,person2, count(*) as call_count, sum(duration) total_duration from tmp group by 1,2
with tmp as ((select from_id as person1, to_id as person2, duration from calls where from_id < to_id) union all (select to_id as person1, from_id as person2, duration from calls where from_id > to_id)) select person1, person2, count(person1) as call_count, sum(duration) as total_duration from tmp group by person1, person2
with tot as (select c1.from_id as person1, c1.to_id as person2,count(c1.duration) as ct, sum(c1.duration) as dur from calls c1 where c1.from_id<c1.to_id group by c1.from_id,c1.to_id union select c2.to_id as person1, c2.from_id as person1,count(c2.duration) as ct, sum(c2.duration) as dur from calls c2 where c2.to_id<c2.from_id group by c2.to_id,c2.from_id) select person1,person2,sum(ct) as call_count,sum(dur) as total_duration from tot group by person1,person2
with union_pair as ( select from_id as person1, to_id as person2, count(*) as num_calls, sum(duration) as total_duration from Calls where from_id < to_id group by 1, 2 union all select to_id as person1, from_id as person2, count(*) as num_calls, sum(duration) as total_duration from Calls where to_id < from_id group by 1, 2 ) select person1, person2, sum(num_calls) as call_count, sum(total_duration) as total_duration from union_pair group by 1, 2
