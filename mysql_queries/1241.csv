SELECT A.SUB_ID AS post_id, COUNT(DISTINCT B.SUB_ID) AS number_of_comments FROM ( SELECT DISTINCT SUB_ID FROM SUBMISSIONS WHERE PARENT_ID IS NULL ) AS A LEFT JOIN SUBMISSIONS AS B ON A.SUB_ID = B.PARENT_ID GROUP BY A.SUB_ID
SELECT DISTINCT S.sub_id AS post_id, IFNULL(TP.n_comments,0) AS number_of_comments FROM Submissions AS S LEFT JOIN (SELECT parent_id AS post_id, COUNT(DISTINCT sub_id) AS n_comments FROM Submissions WHERE parent_id IS NOT Null GROUP BY parent_id) AS TP ON S.sub_id = TP.post_id WHERE S.parent_id IS Null ORDER BY S.sub_id
SELECT DISTINCT SUB_ID AS POST_ID, (SELECT COUNT(DISTINCT(SUB_ID)) FROM SUBMISSIONS S2 WHERE S1.SUB_ID = S2.PARENT_ID) AS number_of_comments FROM SUBMISSIONS AS S1 WHERE PARENT_ID IS NULL ORDER BY SUB_ID
SELECT DISTINCT a.sub_id AS post_id, (SELECT COUNT(DISTINCT b.sub_id) FROM Submissions b WHERE a.sub_id = b.parent_id) AS number_of_comments FROM Submissions a WHERE a.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT a.sub_id AS post_id, COUNT(DISTINCT b.sub_id) AS number_of_comments FROM (SELECT * FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN (SELECT * FROM Submissions WHERE parent_id IS NOT NULL) b ON a.sub_id =b.parent_id GROUP BY 1 ORDER BY 1
SELECT DISTINCT a.sub_id AS post_id, COUNT(DISTINCT b.sub_id) AS number_of_comments FROM Submissions AS a LEFT JOIN Submissions AS b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL GROUP BY a.sub_id
SELECT DISTINCT a.sub_id as 'post_id',COUNT(DISTINCT b.sub_id) as 'number_of_comments' FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id is null GROUP BY a.sub_id
SELECT DISTINCT a.sub_id as post_id, COUNT(DISTINCT(b.sub_id)) as 'number_of_comments' FROM Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by post_id
SELECT DISTINCT a.sub_id as post_id, Count(distinct b.sub_id) AS number_of_comments from Submissions a LEFT JOIN Submissions b on a.sub_id=b.parent_id WHERE a.parent_id IS NULL GROUP BY a.sub_id
SELECT DISTINCT p.sub_id AS post_id, COUNT(DISTINCT c.sub_id) AS number_of_comments FROM Submissions as p LEFT JOIN Submissions AS c ON p.sub_id = c.parent_id WHERE p.parent_id IS NULL GROUP BY post_id ORDER BY post_id
SELECT DISTINCT p.sub_id as post_id, COUNT(DISTINCT c.sub_id) as number_of_comments FROM Submissions as p LEFT JOIN Submissions as c ON (c.parent_id = p.sub_id) WHERE p.parent_id is null GROUP BY p.sub_id
SELECT DISTINCT posts.sub_id AS post_id, COUNT(DISTINCT comments.sub_id, comments.parent_id) AS number_of_comments FROM Submissions posts LEFT JOIN Submissions comments ON posts.sub_id = comments.parent_id WHERE posts.parent_id IS NULL GROUP BY posts.sub_id
SELECT DISTINCT s.sub_id as post_id, (SELECT COUNT(DISTINCT a.sub_id) FROM Submissions a WHERE s.sub_id=a.parent_id) as number_of_comments FROM Submissions s WHERE s.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT s.sub_id as post_id, coalesce(c.number_of_comments, 0) as number_of_comments FROM submissions s LEFT JOIN ( SELECT parent_id, count(distinct sub_id) as number_of_comments FROM submissions WHERE parent_id is not null GROUP BY parent_id ) c ON c.parent_id = s.sub_id WHERE s.parent_id is null ORDER BY 1
SELECT DISTINCT s1.sub_id AS 'post_id', (SELECT COUNT(DISTINCT s2.sub_id) FROM Submissions AS s2 WHERE s2.parent_id = s1.sub_id) AS 'number_of_comments' FROM Submissions AS s1 WHERE s1.parent_id IS NULL ORDER BY s1.sub_id ASC
SELECT DISTINCT s1.sub_id AS 'post_id', COUNT(DISTINCT s2.sub_id) AS 'number_of_comments' FROM Submissions s1 LEFT JOIN Submissions s2 ON s2.parent_id = s1.sub_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id ORDER BY post_id
SELECT DISTINCT s1.sub_id AS post_id, (SELECT COUNT(DISTINCT s2.sub_id) FROM Submissions s2 WHERE s1.sub_id = s2.parent_id ) AS number_of_comments FROM Submissions s1 WHERE s1.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT s1.sub_id AS post_id, COALESCE(s2.number_of_comments, 0) AS number_of_comments FROM Submissions s1 LEFT JOIN ( SELECT parent_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions GROUP BY parent_id )s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL ORDER BY s1.sub_id
SELECT DISTINCT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions AS s1 LEFT JOIN Submissions AS s2 ON s1.sub_id=s2.parent_id WHERE s1.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT DISTINCT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id
SELECT DISTINCT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM submissions s1 LEFT JOIN submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT DISTINCT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM submissions s1 LEFT JOIN submissions s2 ON s1.sub_id=s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id ORDER BY post_id
SELECT DISTINCT s1.sub_id AS post_id, IFNULL(s3.post,0) AS number_of_comments FROM Submissions s1 LEFT JOIN (SELECT DISTINCT parent_id, COUNT(DISTINCT sub_id) AS post FROM Submissions s2 GROUP BY parent_id) s3 ON s1.sub_id = s3.parent_id WHERE s1.parent_id is null ORDER BY s1.sub_id ASC
SELECT DISTINCT s1.sub_id as post_id, (SELECT COUNT(DISTINCT s2.sub_id) FROM Submissions s2 WHERE s1.sub_id = s2.parent_id) as number_of_comments FROM Submissions s1 WHERE parent_id IS NULL ORDER BY post_id
SELECT DISTINCT s2.sub_id AS 'post_id', (SELECT COUNT(DISTINCT s1.sub_id) FROM Submissions s1 WHERE s1.parent_id = s2.sub_id) AS 'number_of_comments' FROM Submissions s2 WHERE s2.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT s2.sub_id AS post_id, COUNT(DISTINCT(s1.sub_id))AS number_of_comments FROM Submissions S1 RIGHT JOIN Submissions S2 ON s1.parent_id = s2.sub_id WHERE s2.parent_id is NULL GROUP BY s2.sub_id
SELECT DISTINCT sub_id AS post_id , (SELECT COUNT(DISTINCT sub_id) FROM Submissions s2 WHERE s1.sub_id = s2.parent_id) AS number_of_comments FROM Submissions s1 WHERE parent_id IS NULL ORDER BY post_id
SELECT DISTINCT sub_id AS post_id, (SELECT COUNT(DISTINCT sub_id) FROM Submissions AS s2 WHERE s1.sub_id = s2.parent_id ) AS number_of_comments FROM Submissions AS s1 WHERE parent_id IS NULL ORDER BY post_id
SELECT DISTINCT sub_id AS post_id, (SELECT COUNT(DISTINCT sub_id) FROM Submissions S2 WHERE S1.sub_id = S2.parent_id) AS number_of_comments FROM Submissions AS S1 WHERE parent_id IS NULL ORDER BY 1
SELECT DISTINCT sub_id AS post_id, (SELECT COUNT(DISTINCT sub_id) FROM Submissions S2 WHERE S1.sub_id = S2.parent_id) AS number_of_comments FROM Submissions AS S1 WHERE parent_id IS NULL ORDER BY sub_id
SELECT DISTINCT sub_id AS post_id, (SELECT COUNT(DISTINCT sub_id) FROM Submissions s2 WHERE s1.sub_id = s2.parent_id) AS number_of_comments FROM Submissions AS s1 WHERE parent_id IS NULL ORDER BY sub_id
SELECT DISTINCT sub_id AS post_id, (SELECT IFNULL(COUNT(DISTINCT sub_id),0) FROM Submissions s2 WHERE s1.sub_id = s2.parent_id)AS number_of_comments FROM Submissions s1 WHERE s1.parent_id IS NULL ORDER BY sub_id
SELECT DISTINCT sub_id AS post_id, COALESCE(number_of_comments,0) AS number_of_comments FROM Submissions s LEFT JOIN (SELECT parent_id,COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions GROUP BY parent_id) t ON s.sub_id=t.parent_id WHERE s.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT sub_id AS post_id,COALESCE(number_of_comments,0) AS number_of_comments FROM Submissions S LEFT JOIN ( SELECT parent_id,COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions GROUP BY parent_id) AS sub ON S.sub_id = sub.parent_id WHERE S.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT sub_id as 'post_id', (SELECT COUNT(DISTINCT sub_id) FROM Submissions as s2 WHERE s1.sub_id=s2.parent_id) as 'number_of_comments' FROM Submissions as s1 WHERE parent_id IS NULL ORDER BY post_id
SELECT DISTINCT sub_id as post_id, IFNULL(x, 0) as number_of_comments FROM Submissions as ZZ LEFT JOIN (SELECT parent_id, COUNT(DISTINCT sub_id) as x FROM Submissions WHERE parent_id is not Null GROUP BY parent_id) as yy ON ZZ.sub_id = yy.parent_id WHERE ZZ.parent_id is null ORDER BY post_id ASC
SELECT DISTINCT sub_id post_id, IFNULL(number_of_comments,0) number_of_comments FROM Submissions LEFT JOIN (SELECT parent_id, COUNT(DISTINCT Submissions.sub_id) AS number_of_comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id ) t ON Submissions.sub_id = t.parent_id WHERE Submissions.parent_id IS NULL ORDER BY post_id
SELECT DISTINCT t1.sub_id as post_id, COUNT(DISTINCT t2.sub_id) as number_of_comments FROM submissions t1 LEFT JOIN submissions t2 ON t1.sub_id = t2.parent_id WHERE t1.parent_id IS NULL GROUP BY post_id ORDER BY post_id
SELECT DISTINCT(b.sub_id) AS post_id ,COUNT(DISTINCT(a.sub_id)) AS number_of_comments FROM Submissions a RIGHT JOIN (SELECT sub_id FROM Submissions WHERE parent_id IS NULL) b ON a.parent_id = b.sub_id GROUP BY b.sub_id
SELECT DISTINCT(s2.sub_id) AS 'post_id', COUNT(DISTINCT s1.sub_id) AS number_of_comments FROM Submissions s1 RIGHT JOIN Submissions s2 ON s1.parent_id = s2.sub_id WHERE s2.parent_id IS NULL GROUP BY s2.sub_id ORDER BY post_id
SELECT DISTINCT(s2.sub_id) as post_id, COUNT(DISTINCT(s1.sub_id)) as number_of_comments FROM Submissions s1 RIGHT JOIN Submissions s2 ON s1.parent_id = s2.sub_id WHERE s2.parent_id IS NULL GROUP BY s2.sub_id
SELECT P.sub_id AS post_id, COUNT(DISTINCT S.sub_id) AS number_of_comments FROM Submissions P LEFT JOIN Submissions S ON P.sub_id = S.parent_id WHERE p.parent_id IS NULL GROUP BY p.sub_id
SELECT Posts.sub_id AS post_id, COUNT(DISTINCT Comments.sub_id) AS number_of_comments FROM Submissions AS Posts LEFT JOIN Submissions AS Comments ON Comments.parent_id = Posts.sub_id WHERE Posts.parent_id IS NULL GROUP BY Posts.sub_id
SELECT Posts.sub_id AS post_id, IFNULL(COUNT(parent_id), 0) AS number_of_comments FROM (SELECT sub_id FROM Submissions WHERE parent_id IS NULL GROUP BY sub_id) AS Posts LEFT JOIN (SELECT DISTINCT sub_id, parent_id FROM Submissions WHERE parent_id IS NOT NULL) AS Submissions ON Posts.sub_id = Submissions.parent_id GROUP BY Posts.sub_id ORDER BY post_id
SELECT RECORD.sub_id AS post_id, COUNT(DISTINCT Submissions.sub_id) AS number_of_comments FROM ( SELECT DISTINCT Submissions.sub_id AS sub_id FROM Submissions WHERE Submissions.parent_id IS NULL ) AS RECORD LEFT OUTER JOIN Submissions ON RECORD.sub_id = Submissions.parent_id GROUP BY RECORD.sub_id ORDER BY post_id
SELECT S.sub_id as post_id, COUNT(DISTINCT P.sub_id) AS number_of_comments FROM Submissions S LEFT OUTER JOIN Submissions P ON S.sub_id = P.parent_id WHERE S.parent_id is null GROUP BY S.sub_id
SELECT S1.SUB_ID AS POST_ID, IFNULL( COUNT( DISTINCT S2.SUB_ID), 0) AS NUMBER_OF_COMMENTS FROM SUBMISSIONS S1 LEFT JOIN SUBMISSIONS S2 ON S1.SUB_ID = S2.PARENT_ID WHERE S1.PARENT_ID IS NULL GROUP BY S1.SUB_ID ORDER BY S1.SUB_ID
SELECT S1.SUB_ID AS POST_ID, IFNULL(COUNT(DISTINCT S2.SUB_ID), 0) AS NUMBER_OF_COMMENTS FROM SUBMISSIONS S1 LEFT JOIN SUBMISSIONS S2 ON S1.SUB_ID = S2.PARENT_ID WHERE S1.PARENT_ID IS NULL GROUP BY S1.SUB_ID ORDER BY S1.SUB_ID
SELECT S1.sub_id AS post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM (SELECT * FROM Submissions WHERE parent_id IS NULL) S1 LEFT JOIN Submissions S2 ON S1.sub_id = S2.parent_id GROUP BY 1
SELECT S1.sub_id AS post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM (SELECT sub_id FROM Submissions WHERE parent_id IS NULL) AS S1 LEFT OUTER JOIN Submissions S2 ON S1.sub_id = S2.parent_id GROUP BY S1.sub_id
SELECT S1.sub_id AS post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM Submissions S1 LEFT JOIN Submissions S2 ON S1.sub_id = S2.parent_id WHERE S1.parent_id IS NULL GROUP BY S1.sub_id
SELECT S1.sub_id AS post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM Submissions S1 LEFT JOIN Submissions S2 ON S1.sub_id = S2.parent_id WHERE S1.parent_id IS NULL GROUP BY S1.sub_id ORDER BY S1.sub_id ASC
SELECT S1.sub_id AS post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM Submissions S1 LEFT JOIN Submissions S2 ON S1.sub_id = S2.parent_id WHERE S1.parent_id is NULL GROUP BY S1.sub_id
SELECT S1.sub_id AS post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM Submissions S1 LEFT JOIN Submissions S2 ON S1.sub_id=S2.parent_id WHERE S1.parent_id IS NULL GROUP BY S1.sub_id ORDER BY S1.sub_id
SELECT S1.sub_id as post_id, IFNULL(COUNT(distinct S2.sub_id),0) as number_of_comments FROM Submissions S1 LEFT JOIN Submissions S2 ON S1.sub_id = S2.parent_id WHERE S1.parent_id is NULL GROUP BY S1.sub_id
SELECT S1.sub_id post_id, COUNT(DISTINCT S2.sub_id) number_of_comments FROM submissions S1 LEFT JOIN submissions S2 ON S2.parent_id = S1.sub_id WHERE S1.parent_id IS NULL GROUP BY 1
SELECT T1.sub_id AS post_id, COUNT(DISTINCT T2.sub_id) AS number_of_comments FROM Submissions AS T1 LEFT JOIN Submissions AS T2 ON T1.sub_id = T2.parent_id WHERE T1.parent_id IS NULL GROUP BY T1.sub_id ORDER BY T1.sub_id
SELECT T2.post_id AS post_id, COUNT(DISTINCT T1.sub_id) AS number_of_comments FROM (SELECT * FROM Submissions WHERE parent_id IS NOT NULL) T1 RIGHT JOIN (SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) T2 ON T1.parent_id=T2.post_id GROUP BY T2.post_id ORDER BY T2.post_id
SELECT a.post_id,count(distinct sub_id) as number_of_comments FROM (select distinct sub_id as post_id from Submissions where parent_id is Null) as a LEFT JOIN Submissions as s on s.parent_id = a.post_id GROUP BY post_id ORDER BY post_id
SELECT a.sub_id AS post_id ,COUNT(DISTINCT b.sub_id) AS number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT a.sub_id AS post_id, COALESCE(COUNT(DISTINCT b.sub_id), 0) AS number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL GROUP BY 1
SELECT a.sub_id AS post_id, COUNT(DISTINCT b.sub_id) AS number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL GROUP BY post_id
SELECT a.sub_id AS post_id, COUNT(DISTINCT b.sub_id) as number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL GROUP BY a.sub_id ORDER BY post_id
SELECT a.sub_id AS post_id, IFNULL(COUNT(DISTINCT b.sub_id),0) AS number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id=b.parent_id WHERE a.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT a.sub_id AS post_id, IFNULL(b.num, 0) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN (SELECT parent_id, COUNT(DISTINCT sub_id) AS num FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id) b ON a.sub_id = b.parent_id ORDER BY post_id
SELECT a.sub_id AS post_id, IFNULL(b.number_of_comments,0) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN (SELECT parent_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM submissions GROUP BY parent_id) b ON a.sub_id = b.parent_id ORDER BY 1 ASC
SELECT a.sub_id as post_id ,COUNT(distinct b.sub_id) as number_of_comments FROM submissions a LEFT JOIN submissions b on a.sub_id = b.parent_id WHERE 1=1 AND a.parent_id IS NULL GROUP BY 1
SELECT a.sub_id as post_id, COALESCE(b.number_of_comments, 0) as number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN (SELECT parent_id, COUNT(DISTINCT parent_id,sub_id) as number_of_comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id)b ON a.sub_id = b.parent_id ORDER BY a.sub_id
SELECT a.sub_id as post_id, COUNT(DISTINCT b.sub_id) as number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id is NULL GROUP BY a.sub_id
SELECT a.sub_id as post_id, COUNT(DISTINCT s.sub_id) as number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN Submissions s on a.sub_id = s.parent_id GROUP BY a.sub_id
SELECT a.sub_id post_id, COALESCE(COUNT(DISTINCT b.sub_id),0) AS number_of_comments FROM ( SELECT sub_id, parent_id FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN Submissions b ON a.sub_id=b.parent_id GROUP BY 1 ORDER BY 1
SELECT a.sub_id post_id, COUNT(DISTINCT a.sub_id,b.sub_id) number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL)a LEFT JOIN Submissions b ON a.sub_id=b.parent_id GROUP BY 1
SELECT a.sub_id post_id, COUNT(DISTINCT b.sub_id) number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL GROUP BY 1
SELECT a.sub_id post_id, COUNT(DISTINCT b.sub_id) number_of_comments FROM Submissions a LEFT JOIN Submissions b ON a.sub_id=b.parent_id WHERE a.parent_id IS NULL GROUP BY 1
SELECT b.sub_id AS post_id , COUNT(DISTINCT(a.sub_id)) AS number_of_comments FROM submissions a RIGHT JOIN ( SELECT DISTINCT(sub_id) FROM submissions WHERE parent_id is NULL) b ON a.parent_id = b.sub_id GROUP BY post_id ORDER BY post_id
SELECT b.sub_id AS post_id, COUNT(DISTINCT a.sub_id) AS number_of_comments FROM Submissions a RIGHT JOIN Submissions b ON a.parent_id=b.sub_id WHERE b.parent_id IS NULL GROUP BY b.sub_id
SELECT distinct a.sub_id as post_id , IFNULL(count(distinct b.sub_id),0) as number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is NULL group by 1
SELECT distinct a.sub_id as post_id, ifnull(c.comment_count,0) as number_of_comments FROM Submissions a LEFT JOIN (SELECT parent_id, count(DISTINCT sub_id, parent_id) as comment_count FROM Submissions GROUP BY parent_id) as c ON a.sub_id= c.parent_id where a.parent_id is null ORDER BY a.sub_id
SELECT distinct post_id, COUNT(sub_id) over (partition by post_id) as number_of_comments FROM (SELECT distinct sub_id as post_id FROM Submissions WHERE parent_id IS NULL ) P LEFT JOIN (SELECT DISTINCT sub_id, parent_id FROM Submissions) C ON P.post_id=C.parent_id
SELECT distinct s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments FROM submissions s1 LEFT JOIN submissions s2 ON s2.parent_id = s1.sub_id WHERE s1.parent_id is Null GROUP BY 1 ORDER BY 1
SELECT manager_id post_id, COUNT(sub_id) number_of_comments FROM (SELECT DISTINCT s1.sub_id manager_id, s2.sub_id FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL) sub GROUP BY manager_id ORDER by post_id
SELECT p.post_id, COALESCE(number_of_comments, 0) AS number_of_comments FROM ( SELECT DISTINCT sub_id AS post_id FROM submissions WHERE parent_id IS NULL ) p LEFT JOIN ( SELECT parent_id AS post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM submissions GROUP BY post_id ) c ON p.post_id = c.post_id ORDER BY post_id ASC
SELECT p.post_id, IFNULL(COUNT(DISTINCT sub_id), 0) AS number_of_comments FROM ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) AS p LEFT JOIN Submissions AS s ON s.parent_id = p.post_id GROUP BY p.post_id
SELECT p.sub_id AS post_id, COUNT(DISTINCT s.sub_id) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM submissions WHERE parent_id IS NULL) p LEFT JOIN submissions s ON p.sub_id = s.parent_id GROUP BY p.sub_id
SELECT p.sub_id AS post_id, COUNT(DISTINCT s.sub_id) AS number_of_comments FROM submissions p LEFT JOIN submissions s ON p.sub_id = s.parent_id WHERE p.parent_id IS NULL GROUP BY p.sub_id ORDER BY 1
SELECT p.sub_id AS post_id, count(DISTINCT a.sub_id) AS number_of_comments FROM Submissions p LEFT JOIN Submissions a ON p.sub_id = a.parent_id WHERE p.parent_id IS NULL GROUP BY p.sub_id
SELECT p.sub_id as post_id, COUNT(DISTINCT s.sub_id) as number_of_comments FROM Submissions as p LEFT JOIN Submissions as s ON p.sub_id=s.parent_id WHERE p.parent_id IS NULL GROUP BY p.sub_id ORDER BY p.sub_id
SELECT p.sub_id as post_id, COUNT(DISTINCT s.sub_id) as number_of_comments FROM Submissions s RIGHT JOIN Submissions p ON s.parent_id = p.sub_id WHERE p.parent_id IS NULL GROUP BY p.sub_id
SELECT p.sub_id as post_id, count(distinct c.sub_id) as number_of_comments FROM Submissions p LEFT JOIN Submissions c ON P.sub_id = c.parent_id WHERE p.parent_id IS NULL GROUP BY p.sub_id ORDER BY p.sub_id
SELECT p.sub_id post_id , count(distinct c.sub_id) number_of_comments FROM (SELECT * from Submissions where parent_id IS NULL) p LEFT JOIN (SELECT * from Submissions where parent_id IS NOT NULL) c ON p.sub_id = c.parent_id GROUP BY 1
SELECT parent_id as post_id, ifnull(count(distinct sub_id), 0) as number_of_comments FROM (SELECT sub_id, a.parent_id FROM (SELECT distinct sub_id as parent_id FROM submissions WHERE parent_id IS NULL) a LEFT JOIN submissions b ON a.parent_id = b.parent_id) as t0 GROUP BY parent_id
SELECT post.post_id, IFNULL(comments.number_of_comments, 0) AS number_of_comments FROM( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) AS post LEFT JOIN ( SELECT parent_id AS post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id) AS comments ON post.post_id=comments.post_id ORDER BY post_id
SELECT post.sub_id AS post_id, COUNT(DISTINCT sub.sub_id) AS number_of_comments FROM ( SELECT sub_id FROM submissions WHERE parent_id IS NULL ) post LEFT JOIN ( SELECT sub_id, parent_id FROM submissions WHERE parent_id IS NOT NULL ) sub ON post.sub_id = sub.parent_id GROUP BY post.sub_id ORDER BY 1 ASC
SELECT post.sub_id AS post_id, Count(DISTINCT com.sub_id) AS number_of_comments FROM submissions post LEFT JOIN submissions com ON post.sub_id = com.parent_id WHERE post.parent_id IS NULL GROUP BY post.sub_id ORDER BY 1
SELECT post.sub_id AS post_id, count(DISTINCT comments.sub_id) AS number_of_comments FROM (SELECT * FROM submissions where parent_id is NULL) post LEFT JOIN submissions comments ON post.sub_id = comments.parent_id GROUP BY post_id
SELECT post_id, COALESCE(COUNT(DISTINCT sub_id),0) number_of_comments FROM ( SELECT DISTINCT sub_id post_id FROM Submissions WHERE parent_id IS NULL ) t LEFT JOIN Submissions s ON t.post_id = s.parent_id GROUP BY post_id ORDER BY post_id ASC
SELECT post_id, COUNT(DISTINCT S2.sub_id) AS 'number_of_comments' FROM ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) AS S1 LEFT JOIN Submissions AS S2 ON S1.post_id = S2.parent_id GROUP BY S1.post_id
SELECT post_id, COUNT(DISTINCT S2.sub_id) AS number_of_comments FROM (SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS Null) S1 LEFT JOIN Submissions S2 ON S1.post_id=S2.parent_id GROUP BY S1.post_id
SELECT post_id, IFNULL(COUNT(DISTINCT sub_id),0) AS number_of_comments FROM (SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL GROUP BY 1 ) AS post LEFT JOIN Submissions ON post_id = parent_id GROUP BY 1 ORDER BY post_id
SELECT post_id, IFNULL(comments, 0) AS number_of_comments FROM (SELECT sub_id AS post_id FROM submissions WHERE parent_id IS Null GROUP BY 1) p LEFT JOIN (SELECT parent_id, COUNT(DISTINCT sub_id) AS comments FROM submissions GROUP BY 1) s ON p.post_id = s.parent_id GROUP BY 1 ORDER BY 1
SELECT post_id, IFNULL(number_of_comments,0) AS number_of_comments FROM (SELECT distinct sub_ID AS post_id FROm Submissions Post WHERE parent_ID is null) P LEFT JOIN (SELECT parent_id , count(DISTINCT sub_id) AS number_of_comments from submissions where parent_id is not null group by parent_id) C ON (P.post_id= c.parent_id) ORDER by post_id asc
SELECT post_id,COUNT(DISTINCT sub_id) AS number_of_comments FROM (SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE ISNULL(parent_id)) AS new LEFT JOIN Submissions AS S ON new.post_id=S.parent_id GROUP bY post_id
SELECT post_table.sub_id AS post_id ,COUNT(comments_table.parent_id) AS number_of_comments FROM (SELECT sub_id ,parent_id FROM Submissions WHERE parent_id IS NULL GROUP BY 1,2) AS post_table LEFT JOIN (SELECT sub_id ,parent_id FROM Submissions WHERE parent_id IS NOT NULL GROUP BY 1,2) AS comments_table ON comments_table.parent_id = post_table.sub_id GROUP BY 1 ORDER BY 1
SELECT posts.post_id, COALESCE(num_comments.number_of_comments, 0) AS number_of_comments FROM (SELECT DISTINCT(sub_id) AS post_id FROM Submissions WHERE parent_id IS NULL) posts LEFT JOIN (SELECT parent_id AS post_id, COUNT(DISTINCT(sub_id)) AS number_of_comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY post_id) num_comments ON posts.post_id = num_comments.post_id ORDER BY 1
SELECT posts.post_id, COUNT(DISTINCT(comments.sub_id)) AS number_of_comments FROM (SELECT * FROM Submissions WHERE parent_id IS NOT NULL) COMMENTS RIGHT JOIN (SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) posts ON comments.parent_id = posts.post_id GROUP BY post_id
SELECT posts.sub_id AS post_id, COUNT(DISTINCT comments.sub_id) AS number_of_comments FROM Submissions posts LEFT JOIN Submissions comments ON posts.sub_id = comments.parent_id WHERE posts.parent_id IS NULL GROUP BY posts.sub_id
SELECT posts.sub_id AS post_id, IFNULL(COUNT(comments.sub_id), 0) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) posts LEFT JOIN (SELECT DISTINCT sub_id, parent_id FROM Submissions WHERE parent_id IS NOT NULL) comments ON posts.sub_id = comments.parent_id GROUP BY posts.sub_id ORDER BY posts.sub_id
SELECT posts.sub_id as post_id, count(distinct com.sub_id) number_of_comments FROM ( SELECT sub_id from Submissions where parent_id IS NULL ) posts LEFT JOIN ( SELECT distinct sub_id, parent_id from Submissions WHERE parent_id IS NOT NULL ) com ON posts.sub_id = com.parent_id group by posts.sub_id
SELECT s.sub_id AS 'post_id', (SELECT COUNT(DISTINCT s1.sub_id) FROM Submissions s1 WHERE s.sub_id = s1.parent_id) AS 'number_of_comments' FROM Submissions s WHERE s.parent_id IS NULL GROUP BY s.sub_id ORDER BY s.sub_id
SELECT s.sub_id AS post_id, (SELECT COUNT(DISTINCT(s1.sub_id)) FROM Submissions s1 WHERE s1.parent_id = s.sub_id) AS number_of_comments FROM Submissions s WHERE s.parent_id IS null GROUP BY s.sub_id order by post_id
SELECT s.sub_id AS post_id, (SELECT COUNT(DISTINCT(s1.sub_id)) FROM Submissions s1 WHERE s1.parent_id = s.sub_id) AS number_of_comments FROM Submissions s WHERE s.parent_id IS null GROUP BY s.sub_id order by s.sub_id asc
SELECT s.sub_id post_id, COUNT(DISTINCT(s2.sub_id)) as number_of_comments FROM Submissions s LEFT JOIN Submissions s2 ON s.sub_id=s2.parent_id where s.parent_id is null GROUP BY s.sub_id ORDER BY s.sub_id
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE IFNULL(s1.parent_id, -1) = -1 GROUP BY s1.sub_id
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id ORDER BY s1.sub_id ASC
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s2.parent_id = s1.sub_id WHERE s1.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s1 LEFT JOIN submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id ORDER BY post_id
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM submissions s1 LEFT JOIN submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT s1.sub_id AS post_id, COUNT(DISTINCT s2.sub_id) AS number_of_comments FROM submissions s1 LEFT JOIN submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.sub_id IN (SELECT sub_id FROM submissions WHERE parent_id IS NULL) GROUP BY post_id
SELECT s1.sub_id AS post_id, COUNT(DISTINCT(s2.sub_id)) AS number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id
SELECT s1.sub_id AS post_id, COUNT(DISTINCT(s2.sub_id)) as number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id ORDER BY s1.sub_id
SELECT s1.sub_id AS post_id, IFNULL(count(distinct s2.sub_id), 0) AS number_of_comments FROM Submissions as s1 LEFT JOIN Submissions AS s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id
SELECT s1.sub_id as post_id, (SELECT count(DISTINCT s2.sub_id) FROM Submissions s2 WHERE s1.sub_id = s2.parent_id) as number_of_comments FROM Submissions s1 WHERE s1.parent_id is NULL GROUP BY s1.sub_id ORDER BY s1.sub_id
SELECT s1.sub_id as post_id, COUNT(distinct s2.sub_id ) as number_of_comments FROM Submissions as s1 LEFT JOIN Submissions as s2 ON s1.sub_id = s2.parent_id WHere s1.parent_id IS NULL GROUP BY s1.sub_id
SELECT s1.sub_id as post_id, IFNULL(COUNT(DISTINCT s2.sub_id),0) as number_of_comments FROM Submissions as s1 LEFT JOIN Submissions as s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY 1
SELECT s1.sub_id as post_id, IFNULL(s2.number_of_comments,0) AS number_of_comments FROM ( SELECT DISTINCT sub_id FROM submissions WHERE parent_id IS NULL ) s1 LEFT JOIN ( SELECT DISTINCT parent_id AS post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM ( SELECT DISTINCT parent_id, sub_id FROM submissions WHERE parent_id IS NOT NULL ) sub GROUP BY parent_id ) s2 ON s1.sub_id = s2.post_id ORDER BY 1
SELECT s1.sub_id as post_id, count(DISTINCT s2.sub_id) as number_of_comments from Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id where s1.parent_id is NULL group by s1.sub_id
SELECT s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments FROM Submissions as s1 LEFT JOIN Submissions as s2 on s2.parent_id=s1.sub_id where s1.parent_id is Null GROUP BY s1.sub_id
SELECT s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments FROM Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id=s2.parent_id WHERE s1.parent_id is null GROUP BY 1
SELECT s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments FROM submissions s1 LEFT JOIN submissions s2 ON s1.sub_id = s2.parent_id WHERE s1.parent_id IS NULL GROUP BY s1.sub_id
SELECT s2.sub_id AS post_id, COUNT(DISTINCT s1.sub_id) AS number_of_comments FROM Submissions s1 RIGHT JOIN Submissions s2 ON s1.parent_id = s2.sub_id WHERE s2.parent_id IS NULL GROUP BY 1 ORDER BY 1
SELECT s2.sub_id AS post_id, COUNT(distinct S1.SUB_ID) as NUMBER_OF_COMMENTS from Submissions S2 left JOIN Submissions S1 ON S1. parent_id = S2.sub_id WHERE S2.parent_id IS NULL group by 1
SELECT sub1.parent_id AS post_id, COALESCE(sub.number_of_comments, 0) AS number_of_comments FROM (SELECT DISTINCT(sub_id) AS parent_id FROM Submissions WHERE parent_id IS NULL) sub1 LEFT JOIN (SELECT parent_id, COUNT(DISTINCT(sub_id)) AS number_of_comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id) sub ON sub1.parent_id = sub.parent_id ORDER BY post_id
SELECT sub_id AS 'post_id', (SELECT COUNT(DISTINCT sub_id) FROM Submissions S2 WHERE S1.sub_id = S2.parent_id) AS 'number_of_comments' FROM Submissions S1 WHERE parent_id IS NULL GROUP BY sub_id ORDER BY sub_id ASC
SELECT sub_id AS post_id, COALESCE(number_of_comments, 0) AS number_of_comments FROM ( SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL ) a LEFT JOIN ( SELECT parent_id, COUNT(DISTINCT sub_id) as number_of_comments FROM Submissions GROUP BY parent_id ) b ON a.sub_id = b.parent_id ORDER BY post_id ASC
SELECT sub_id AS post_id, IFNULL(num, 0) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) as post LEFT JOIN (SELECT parent_id, COUNT(sub_id) AS num FROM (SELECT DISTINCT sub_id, parent_id FROM Submissions WHERE parent_id is NOT NULL) AS comm GROUP BY parent_id) AS num_comm ON post.sub_id = num_comm.parent_id ORDER BY post_id
SELECT sub_id AS post_id, IFNULL(nums, 0) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) a LEFT JOIN (SELECT parent_id, COUNT(DISTINCT sub_id) AS nums FROM Submissions GROUP BY parent_id) b ON sub_id = parent_id ORDER BY post_id
SELECT sub_id as post_id, COUNT(distinct parent_id) AS number_of_comments FROM (SELECT * FROM Submissions UNION SELECT parent_id, sub_id FROM Submissions) sub WHERE sub_id IN (SELECT sub_id FROM Submissions WHERE parent_id is null) GROUP BY 1
SELECT t1.sub_id AS post_id, Count(DISTINCT t2.sub_id) AS number_of_comments FROM submissions AS t1 LEFT JOIN submissions AS t2 ON t1.sub_id = t2.parent_id WHERE t1.parent_id IS NULL GROUP BY t1.sub_id ORDER BY post_id
SELECT t1.sub_id AS post_id, SUM(IF(t2.parent_id IS NULL,0,1)) AS number_of_comments FROM (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) t1 LEFT JOIN (SELECT * FROM Submissions UNION SELECT * FROM Submissions) t2 ON t1.sub_id = t2.parent_id GROUP BY t1.sub_id ORDER BY 1
Select Posts.sub_id as post_id, count(distinct Submissions.sub_id) as number_of_comments From Submissions right join (Select distinct sub_id From Submissions where parent_id is Null) as Posts On Submissions.parent_id = Posts.sub_id Group by Posts.sub_id
Select a.sub_id as post_id , Count(Distinct s.sub_id ) as number_of_comments From ( Select distinct sub_id from Submissions where parent_id is Null) as a Left Join Submissions s on a.sub_id=s.parent_id group by 1
Select a.sub_id as post_id, COALESCE(b.count_me,0) as number_of_comments From (Select Distinct sub_id from submissions where parent_id IS NULL) a LEFT JOIN (Select Distinct parent_id, sub_id, count(distinct sub_id) as count_me from submissions GROUP BY parent_id having parent_id IS NOT NULL ) b ON a.sub_id=b.parent_id order by post_id
Select a.sub_id as post_id, Count(distinct b.sub_id) as number_of_comments From Submissions as a Left Join Submissions as b On a.sub_id = b.parent_id Where a.parent_id IS NULL Group BY a.sub_id Order By post_id ASC
Select a.sub_id as post_id, coalesce(b.number_of_comments,0) as number_of_comments from( select distinct sub_id from submissions where parent_id is null) a left join( select parent_id, count(distinct(sub_id)) as number_of_comments from submissions group by parent_id having parent_id = any(select sub_id from submissions where parent_id is null)) b on a.sub_id = b.parent_id order by post_id
Select b.sub_id as post_id, Count(Distinct a.sub_id) as number_of_comments From Submissions a Right Join Submissions b On a.parent_id = b.sub_id Where b.parent_id is Null Group By b.sub_id Order By post_id ASC
Select distinct a.sub_id as post_id,count(distinct b.sub_id) as number_of_comments from (Select distinct sub_id from Submissions where parent_id is null) as a LEFT JOIN Submissions b on a.sub_id = b.parent_id group by a.sub_id,b.parent_id
Select distinct s1.sub_id post_id, count(distinct s2.sub_id) number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
Select p.sub_id as post_id, ifnull(count(distinct c.sub_id),0) as number_of_comments from Submissions p left join Submissions c on p.sub_id = c.parent_id where p.parent_id is null group by p.sub_id order by p.sub_id
Select post_id, Ifnull(number_of_comments, 0) number_of_comments From ( Select distinct sub_id As post_id From Submissions Where parent_id is NULL) As A left Join (Select parent_id, count(distinct sub_id) As number_of_comments From Submissions Where parent_id is not NULL Group by parent_id) As B On A.post_id = B.parent_id Order by post_id
Select posts.sub_id as post_id, count(comments.parent_id) as number_of_comments FROM (Select DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL) posts LEFT JOIN (Select DISTINCT * FROM Submissions ) comments ON posts.sub_id = comments.parent_id group by posts.sub_id order by 1
Select s1.sub_id AS post_id, IFNULL(count(distinct s2.sub_id),0) AS number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id IS NULL group by s1.sub_id
Select s1.sub_id as post_id ,count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s2.parent_id = s1.sub_id where s1.parent_id is null group by s1.sub_id
WITH CTE AS( SELECT sub_id FROM Submissions WHERE parent_id IS NULL ), CTE1 AS( SELECT sub_id, parent_id FROM Submissions WHERE parent_id IS NOT NULL ) SELECT a.sub_id AS post_id, COUNT(DISTINCT b.sub_id) AS number_of_comments FROM CTE a LEFT JOIN CTE1 b ON a.sub_id = b.parent_id GROUP BY 1 ORDER BY 1
WITH CTE1 AS ( SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL ), CTE2 AS ( SELECT parent_id FROM Submissions WHERE parent_id IS NOT NULL GROUP BY sub_id, parent_id ) SELECT CTE1.sub_id AS post_id, IFNULL(COUNT(CTE2.parent_id), 0) as number_of_comments FROM CTE1 LEFT JOIN CTE2 ON CTE1.sub_id = CTE2.parent_id GROUP BY CTE1.sub_id ORDER BY post_id
WITH Parents AS ( SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT p.post_id AS post_id, COUNT(DISTINCT(c.sub_id)) AS number_of_comments FROM Parents p LEFT JOIN Submissions c ON p.post_id = c.parent_id GROUP BY p.post_id ORDER BY p.post_id
WITH Posts AS ( SELECT DISTINCT sub_id AS 'post_id' FROM Submissions WHERE parent_id IS NULL ) SELECT post_id, COUNT(DISTINCT sub_id) AS 'number_of_comments' FROM Posts AS p LEFT JOIN Submissions AS s ON p.post_id = s.parent_id GROUP BY post_id
WITH Posts AS (SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) SELECT P.post_id, COALESCE(COUNT(DISTINCT sub_id),0) AS number_of_comments FROM Posts P LEFT JOIN Submissions S ON P.post_id = S.parent_id GROUP BY 1
WITH Posts AS (SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) SELECT P.post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM Posts P LEFT JOIN Submissions S ON P.post_id = S.parent_id GROUP BY 1
WITH T1 AS ( SELECT distinct sub_id AS "parent_id" FROM Submissions WHERE parent_id is null ) , T2 AS ( SELECT parent_id, count(distinct sub_id) as num_comments From Submissions WHERE parent_id is not null GROUP BY parent_id ) SELECT T1.parent_id as "post_id", CASE WHEN T2.parent_id is null then 0 ELSE num_comments END AS "number_of_comments" FROM T1 LEFT JOIN T2 on T1.parent_id = T2.parent_id ORDER BY post_id ASC
WITH T1 AS (SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL), T2 AS (SELECT parent_id, COUNT(DISTINCT sub_id) as CNT FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id ORDER BY parent_id) SELECT T1.sub_id AS post_id, IFNULL(T2.CNT,0) AS number_of_comments FROM T1 LEFT JOIN T2 on T1.sub_id = T2.parent_id ORDER BY T1.sub_id
WITH T1 AS( SELECT DISTINCT SUB_ID AS POST_ID FROM Submissions WHERE PARENT_ID IS NULL ), T2 AS( SELECT PARENT_ID, COUNT(DISTINCT SUB_ID) AS number_of_comments FROM Submissions WHERE PARENT_ID IS NOT NULL GROUP BY 1 ) SELECT T1.POST_ID, (CASE WHEN T2.number_of_comments IS NULL THEN 0 ELSE T2.number_of_comments END) AS number_of_comments FROM T1 LEFT JOIN T2 ON T1.POST_ID = T2.PARENT_ID ORDER BY 1
WITH TEMP AS (SELECT DISTINCT SUB_ID AS PARENT_ID FROM SUBMISSIONS WHERE PARENT_ID IS NULL) SELECT T.PARENT_ID AS POST_ID, COUNT(DISTINCT S.SUB_ID) AS NUMBER_OF_COMMENTS FROM TEMP T LEFT OUTER JOIN SUBMISSIONS S ON S.PARENT_ID = T.PARENT_ID GROUP BY T.PARENT_ID ORDER BY 1
WITH cte AS (SELECT DISTINCT sub_id as post_id from Submissions where parent_id is null) Select cte.post_id, COUNT(distinct sub_id) as number_of_comments from cte left join Submissions on cte.post_id = Submissions.parent_id group by post_id
WITH cte AS( SELECT parent_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id ) SELECT DISTINCT sub_id AS post_id, COALESCE(b.number_of_comments,0) AS number_of_comments FROM Submissions a LEFT JOIN cte b ON a.sub_id = b.parent_id WHERE a.parent_id IS NULL ORDER BY 1
WITH cte AS( SELECT parent_id, COUNT(DISTINCT sub_id, parent_id) AS comments FROM Submissions WHERE parent_id IS NOT NULL GROUP BY parent_id ) SELECT DISTINCT s.sub_id as post_id, IFNULL(cte.comments,0) AS number_of_comments FROM Submissions s LEFT JOIN cte ON s.sub_id = cte.parent_id WHERE s.parent_id IS NULL ORDER BY post_id ASC
WITH cte1 AS ( select distinct sub_id as post_id FROM submissions WHERE parent_id IS NULL ), cte2 AS ( SELECT distinct sub_id, parent_id FROM submissions WHERE PARENT_ID IS NOT NULL ), cte3 AS ( SELECT parent_id, count(sub_id) as cnt FROM cte2 GROUP BY parent_id ) SELECT cte1.post_id, IFNULL(cte3.cnt,0) AS number_of_comments FROM cte1 LEFT JOIN cte3 ON cte1.post_id = cte3.parent_id ORDER BY post_id
WITH cte_a AS ( SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL ), cte_b AS ( SELECT sub_id, parent_id FROM Submissions GROUP BY sub_id, parent_id HAVING parent_id IS NOT NULL ) SELECT a.sub_id AS post_id, COUNT(b.parent_id) AS number_of_comments FROM cte_a AS a LEFT JOIN cte_b AS b ON a.sub_id = b.parent_id GROUP BY a.sub_id ORDER BY a.sub_id
WITH cte_post AS ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM cte_post c LEFT JOIN Submissions S ON c.post_id = S.parent_id GROUP BY post_id
WITH cte_post As ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM cte_post c LEFT JOIN Submissions s ON c.post_id = s.parent_id GROUP BY post_id
WITH cte_post As ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT post_id,COUNT(DISTINCT sub_id) AS number_of_comments FROM cte_post c LEFT JOIN Submissions s ON c.post_id = s.parent_id GROUP BY post_id
WITH num_comments AS ( SELECT parent_id AS post_id, COUNT(*) AS number_of_comments FROM (SELECT DISTINCT sub_id, parent_id FROM Submissions WHERE parent_id IN ( SELECT DISTINCT sub_id FROM submissions WHERE parent_id IS NULL )) AS post_details GROUP BY parent_id ), post_ids AS ( SELECT sub_id FROM submissions WHERE parent_id IS NULL ) SELECT DISTINCT sub_id AS post_id, COALESCE(number_of_comments, 0) As number_of_comments FROM post_ids LEFT JOIN Num_comments ON post_ids.sub_id = num_comments.post_id ORDER BY 1
WITH p AS ( SELECT DISTINCT sub_id as post_id FROM Submissions WHERE parent_id IS NULL), c AS ( SELECT parent_id as post_id, COUNT(*) as number_of_comments FROM (SELECT DISTINCT * FROM Submissions) AS b WHERE parent_id in (SELECT * FROM p) GROUP BY parent_id) SELECT p.post_id, IFNULL(number_of_comments, 0) AS number_of_comments FROM p LEFT JOIN c ON p.post_id = c.post_id ORDER BY post_id
WITH parent as ( select distinct p.sub_id from submissions as p where p.parent_id is null ), sub as ( select parent_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by parent_id ) select p.sub_Id as post_Id, ifnull(s.number_of_comments, 0) as number_of_comments from parent as p left join sub as s on p.sub_id = s.parent_id order by p.sub_Id
WITH parent_tb AS ( SELECT sub_id FROM Submissions WHERE parent_id IS NULL ), comment_tb AS ( SELECT sub_id, parent_id FROM Submissions WHERE parent_id IS NOT NULL ) SELECT parent_tb.sub_id AS post_id, COUNT(DISTINCT comment_tb.sub_id) AS number_of_comments FROM parent_tb LEFT JOIN comment_tb ON parent_tb.sub_id = comment_tb.parent_id GROUP BY parent_tb.sub_id
WITH post AS ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT p.post_id, COUNT(DISTINCT s.sub_id) AS number_of_comments FROM post p LEFT JOIN Submissions s ON p.post_id = s.parent_id GROUP BY post_id ORDER BY post_id
WITH post AS ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) SELECT post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM post LEFT JOIN Submissions s ON s.parent_id = post.post_id GROUP BY post_id
WITH post AS( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT DISTINCT post.post_id, COUNT(DISTINCT(sub_id)) AS number_of_comments FROM Submissions s RIGHT JOIN post ON s.parent_id = post.post_id GROUP BY post_id
WITH post AS( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) SELECT post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM post LEFT JOIN Submissions s ON post.post_id = s.parent_id GROUP BY post_id
WITH post as ( SELECT DISTINCT parent_id, sub_id FROM SUBMISSIONS WHERE parent_id IS NULL ) ,comments as ( SELECT DISTINCT parent_id, COUNT(DISTINCT sub_id) as number_of_comments FROM SUBMISSIONS GROUP BY parent_id ) SELECT DISTINCT p.sub_id as post_id, IFNULL(c.number_of_comments,0) AS number_of_comments FROM post p LEFT JOIN comments c on p.sub_id = c.parent_id ORDER BY p.sub_id
WITH post as (SELECT distinct sub_id FROM Submissions WHERE ISNULL(parent_id)), comment as (SELECT sub_id, parent_id FROM Submissions WHERE !ISNULL(parent_id) AND parent_id IN (SELECT * FROM post)) SELECT P.sub_id as post_id, IFNULL(COUNT(distinct C.sub_id),0) AS number_of_comments FROM post P LEFT JOIN comment C ON P.sub_id = C.parent_id GROUP BY P.sub_id
WITH post_ids AS ( SELECT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL GROUP BY sub_id ) SELECT P.post_id, CASE WHEN S.sub_id IS NULL THEN 0 ELSE COUNT(DISTINCT S.sub_id) END AS number_of_comments FROM Submissions S RIGHT JOIN post_ids P ON S.parent_id = P.post_id GROUP BY P.post_id
WITH posts AS ( SELECT DISTINCT sub_id AS post_id FROM submissions WHERE parent_id IS NULL ), comments AS ( SELECT parent_id AS post_id, COUNT(DISTINCT sub_id) AS num_comments FROM submissions WHERE parent_id IS NOT NULL GROUP BY parent_id ) SELECT po.post_id, COALESCE(co.num_comments,0) as number_of_comments FROM posts po LEFT JOIN comments co ON po.post_id = co.post_id ORDER BY post_id
WITH posts AS ( SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL ), counts1 AS ( SELECT parent_id AS post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions WHERE parent_id IN (SELECT sub_id FROM posts) GROUP BY parent_id ), counts2 AS ( SELECT DISTINCT sub_id AS post_id, 0 AS number_of_comments FROM Submissions WHERE sub_id IN (SELECT sub_id FROM posts) AND sub_id NOT IN (SELECT post_id FROM counts1) ) SELECT * FROM counts1 UNION SELECT * FROM counts2 ORDER BY post_id
WITH posts AS ( SELECT DISTINCT sub_id, parent_id FROM Submissions WHERE parent_id IS NULL ), comments AS ( SELECT DISTINCT sub_id, parent_id FROM Submissions WHERE parent_id IS NOT NULL ) SELECT a.sub_id AS post_id, count(b.b.parent_id) AS number_of_comments FROM posts a LEFT JOIN comments b ON a.sub_id = b.parent_id GROUP BY a.sub_id ORDER BY post_id ASC
WITH posts AS ( SELECT sub_id AS post_id FROM submissions WHERE parent_id IS Null ), comments AS ( SELECT parent_id, count(distinct sub_id) AS number_of_comments FROM submissions WHERE parent_id IS NOT Null GROUP BY parent_id ) SELECT posts.post_id, CASE WHEN comments.number_of_comments IS Null THEN 0 ELSE comments.number_of_comments END AS number_of_comments FROM posts LEFT JOIN comments ON posts.post_id = comments.parent_id GROUP BY posts.post_id ORDER BY posts.post_id asc
WITH raw_data AS ( SELECT T1.sub_id AS post_id, T2.sub_id AS comment_id FROM Submissions T1 LEFT JOIN Submissions T2 ON T2.parent_id = T1.sub_id WHERE T1.parent_id IS NULL ) SELECT post_id, COUNT(DISTINCT comment_id) AS number_of_comments FROM raw_Data GROUP BY post_id
WITH sub_cte AS (SELECT DISTINCT sub_id,parent_id FROM submissions) ,parent_id_group AS (SELECT parent_id, count(*) ct FROM sub_cte GROUP BY parent_id) SELECT sub_id post_id, coalesce(ct,0) number_of_comments FROM sub_cte sc LEFT JOIN parent_id_group pg ON 1=1 AND sc.sub_id=pg.parent_id WHERE 1=1 AND sc.parent_id IS NULL ORDER BY 1
WITH t AS ( SELECT DISTINCT sub_id FROM Submissions WHERE parent_id IS NULL ) SELECT sub_id AS post_id, COALESCE(tt.number_of_comments, 0) AS number_of_comments FROM t LEFT JOIN ( SELECT parent_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM Submissions GROUP BY parent_id ) tt ON t.sub_id = tt.parent_id ORDER BY post_id
WITH t AS( SELECT parent_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM submissions GROUP BY parent_id ) SELECT DISTINCT s.sub_id AS post_id, IFNULL(t.number_of_comments,0) AS number_of_comments FROM Submissions s LEFT JOIN t ON s.sub_id = t.parent_id WHERE s.parent_id IS NULL ORDER BY s.sub_id
WITH t1 AS ( SELECT DISTINCT * FROM Submissions WHERE parent_id IS NULL ) SELECT t1.sub_id AS post_id, (SELECT COUNT(DISTINCT t2.sub_id) FROM Submissions t2 WHERE t2.parent_id = t1.sub_id) AS number_of_comments FROM t1 ORDER BY 1
WITH t1 AS ( SELECT DISTINCT s1.sub_id AS post_id FROM Submissions s1 WHERE s1.parent_id IS NULL ), t2 AS ( SELECT t1.post_id, IFNULL((SELECT COUNT(DISTINCT s2.sub_id) FROM Submissions s2 WHERE s2.parent_id = t1.post_id),0) AS number_of_comments FROM t1 t1 ) SELECT * FROM t2 ORDER BY 1
WITH t1 AS( SELECT DISTINCT sub_id AS post_id FROM submissions WHERE parent_id is NULL ) SELECT post_id, COUNT(DISTINCT sub_id) AS number_of_comments FROM t1 LEFT JOIN submissions s on t1.post_id = s.parent_id GROUP BY post_id ORDER BY post_id
WITH tem as( SELECT parent_id as post_id, count(distinct sub_id) as number_of_comments FROM Submissions s GROUP BY parent_id ) SELECT distinct sub_id as post_id, coalesce(tem.number_of_comments,0) as number_of_comments FROM submissions s LEFT JOIN tem ON s.sub_id= tem.post_id WHERE parent_id is null ORDER BY sub_id ASC
WITH temp AS( SELECT DISTINCT t1.sub_id as post_id, t2.sub_id as comment_id FROM submissions t1 LEFT JOIN submissions t2 ON t1.sub_id = t2.parent_id WHERE t1.parent_id IS NULL ) SELECT post_id, IFNULL(COUNT(comment_id),0) as number_of_comments FROM temp GROUP BY post_id ORDER BY post_id
WITH u_post AS ( SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL ) SELECT UP.post_id, COUNT(DISTINCT S.sub_id) AS number_of_comments FROM u_post AS UP LEFT JOIN Submissions AS S ON UP.post_id = S.parent_id GROUP BY UP.post_id
With post as (Select distinct sub_id as sub_id From Submissions Where parent_id is Null) Select sub_id as post_id, ifnull(count_comment,0) as number_of_comments From post p Left join (Select parent_id, count(distinct sub_id) as count_comment From Submissions Where parent_id is not Null Group by parent_id) c On p.sub_id = c.parent_id Order by post_id
from submissions a left join submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
from submissions l left join submissions r on l.sub_id = r.parent_id where l.parent_id is null group by l.sub_id order by post_id
select S.sub_id 'post_id',count(distinct A.sub_id) 'number_of_comments' from Submissions S left join ( select sub_id,parent_id from Submissions where parent_id is not null ) A on A.parent_id = S.sub_id where S.parent_id is null group by S.sub_id
select S1.sub_id as post_id, count(distinct S2.sub_id) as number_of_comments FROM Submissions S1 LEFT JOIN Submissions S2 on S1.sub_id = S2.parent_id where S1.parent_id is null group by S1.sub_id
select T1.sub_id post_id, count(distinct T2.sub_id) number_of_comments from Submissions T1 left join Submissions T2 on T1.sub_id = T2.parent_id where T1.parent_id is null group by T1.sub_id
select a.parent_id as post_id, coalesce(b.cnt,0) as number_of_comments from (select distinct(sub_id) as parent_id from submissions where parent_id is null) a left join (select parent_id, count(distinct(sub_id)) as cnt from submissions where parent_id is not null group by parent_id) b on a.parent_id = b.parent_id order by 1
select a.post_id ,coalesce (number_of_comments,0) as number_of_comments from ( select distinct sub_id as post_id from submissions where parent_id is null ) a left join ( select parent_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by 1 ) b on a.post_id=b.parent_id order by 1
select a.post_id, count(distinct Submissions.sub_id) as number_of_comments from (select distinct sub_id as post_id from Submissions where parent_id is Null) a left join Submissions on Submissions.parent_id = a.post_id group by a.post_id
select a.post_id, ifnull(b.number_of_comments, 0) as number_of_comments from (select distinct sub_id as post_id from Submissions where parent_id is null) a left join (select parent_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by 1) b on a.post_id = b.parent_id order by post_id asc
select a.post_id, ifnull(b.number_of_comments,0) as number_of_comments from (select distinct (case when parent_id is null then sub_id end) as post_id from submissions) as a left join (select parent_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by parent_id) as b on a.post_id = b.parent_id where a.post_id is not null order by 1
select a.sub as post_id,count(distinct a.sub_id) as number_of_comments from (select a.sub_id as sub,b.sub_id from (select distinct sub_id from submissions where parent_id is null)a left join submissions b on a.sub_id=b.parent_id)a group by 1
select a.sub_id as 'post_id', count(distinct s.sub_id) as 'number_of_comments' from (select a.sub_id from Submissions a where a.parent_id is null) a left join Submissions s on a.sub_id = s.parent_id group by a.sub_id
select a.sub_id as post_id ,count(b.sub_id) as number_of_comments from (select distinct sub_id, parent_id from submissions where parent_id is null )a left join (select distinct sub_id, parent_id from submissions where parent_id is not null )b on a.sub_id = b.parent_id group by 1 order by a.sub_id
select a.sub_id as post_id ,count(distinct b.sub_id) as number_of_comments from (select distinct sub_id from submissions where parent_id is null) a left join Submissions b on a.sub_id = b.parent_id group by a.sub_id
select a.sub_id as post_id, IFNULL(count(distinct b.sub_id),0) as number_of_comments from Submissions as a LEFT JOIN Submissions as b on a.sub_id = b.parent_id WHERE A.parent_id is null group by a.sub_id ORDER BY a.sub_id asc
select a.sub_id as post_id, coalesce(count(distinct b.sub_id), 0) as number_of_comments from submissions as a left outer join submissions as b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
select a.sub_id as post_id, coalesce(count(distinct b.sub_id),0) as number_of_comments from ( select sub_id from Submissions where parent_id is null )a left join Submissions b on a.sub_id=b.parent_id group by 1
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from (select * from Submissions where parent_id is null) a left join (select * from Submissions where parent_id is not null) b on a.sub_id=b.parent_id group by 1
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) a left join Submissions b on a.sub_id=b.parent_id group by a.sub_id order by a.sub_id
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on (a.sub_id = b.parent_id) where a.parent_id is null group by a.sub_id
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id order by a.sub_id
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id= b.parent_id where a.parent_id is null group by a.sub_id
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id=b.parent_id where a.parent_id is null group by a.sub_id
select a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions as a left join Submissions as b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id order by a.sub_id
select a.sub_id as post_id, count(distinct(b.sub_id )) as number_of_comments from submissions as a left join submissions as b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
select a.sub_id as post_id, count(distinct(s.sub_id)) as number_of_comments from (select distinct(sub_id) from Submissions where parent_id is Null) as a left join Submissions as s on a.sub_id=s.parent_id group by 1
select a.sub_id as post_id, ifnull(b.number_of_comments,0) as number_of_comments from (select distinct sub_id from Submissions where parent_id is Null) a left join (select parent_id, count(distinct sub_id) as number_of_comments from Submissions group by parent_id) b on a.sub_id = b.parent_id order by post_id ASC
select a.sub_id as post_id, ifnull(count(distinct b.sub_id), 0) as number_of_comments from submissions a left join submissions b on a.sub_id = b.parent_id where a.parent_id is null group by 1 order by 1
select a.sub_id as post_id, ifnull(count(distinct b.sub_id), 0) number_of_comments from submissions a left join submissions b on a.sub_id = b.parent_id where a.parent_id is null group by 1 order by 1
select a.sub_id as post_id, ifnull(count(distinct b.sub_id),0) as number_of_comments from (select distinct sub_id from submissions where parent_id is null) a left join submissions b on a.sub_id=b.parent_id group by 1 order by 1
select a.sub_id as post_id, ifnull(count(distinct(b.sub_id)), 0) as number_of_comments from submissions a left join submissions b on a.sub_id = b.parent_id where a.parent_id is null group by 1 order by 1
select a.sub_id as post_id,ifnull(number_of_comments,0) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) as a left join (select parent_id,count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by parent_id) as b on a.sub_id=b.parent_id order by post_id
select a.sub_id post_id, count(distinct b.sub_id) number_of_comments from (select sub_id from submissions where parent_id is null ) a left join submissions b on a.sub_id = b.parent_id group by 1
select a.sub_id post_id, count(distinct b.sub_id) number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
select b.parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions a right join ( select distinct sub_id as parent_id from Submissions where parent_id is null)b on b.parent_id = a.parent_id group by 1
select b.sub_id as post_id,coalesce(count(distinct a.sub_id),0) as number_of_comments from Submissions a right join Submissions b on a.parent_id=b.sub_id where b.parent_id is null group by 1 order by 1
select c.post_id, count(distinct c.sub_id, c.comment_id) as number_of_comments from ( select distinct a.sub_id as post_id, a.parent_id, b.sub_id, b.parent_id as comment_id from submissions a left join submissions b on a.sub_id = b.parent_id where a.parent_id is Null ) c group by 1 order by 1
select distinct S1.sub_id as post_id, ifnull(number_of_comments,0) as number_of_comments from Submissions S1 left join ( select parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not Null group by parent_id) P on S1.sub_id=P.post_id where S1.parent_id is Null order by S1.sub_id
select distinct S2.sub_id as 'post_id', (select count(distinct S.sub_id) from Submissions S where S.parent_id = S2.sub_id ) as 'number_of_comments' from Submissions S2 where S2.parent_id is null order by S2.sub_id asc
select distinct a.sub_id as post_id ,count(distinct b.sub_id,b.parent_id) as number_of_comments from (select distinct sub_id from submissions where parent_id is null) a left join Submissions b on a.sub_id = b.parent_id group by a.sub_id
select distinct a.sub_id as post_id, ( select count(distinct sub_id)as comments FROM SUBMISSIONs S2 WHERE S2.PARENT_ID = a.sub_id ) as number_of_comments from submissions a where a.parent_id is null order by 1
select distinct a.sub_id as post_id, (select count(distinct b.sub_id) from Submissions b where a.sub_id=b.parent_id) as number_of_comments from Submissions a where a.parent_id is null order by 1
select distinct a.sub_id as post_id, (select count(distinct b.sub_id) from Submissions b where a.sub_id=b.parent_id) as number_of_comments from Submissions a where a.parent_id is null order by post_id
select distinct a.sub_id as post_id, (select count(distinct b.sub_id) from submissions as b where b.parent_id=a.sub_id) as number_of_comments from submissions as a where a.parent_id is Null order by post_id
select distinct a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
select distinct a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id ORDER BY (a.sub_id)
select distinct a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join Submissions b on a.sub_id=b.parent_id where a.parent_id is null group by a.sub_id
select distinct a.sub_id as post_id, count(distinct b.sub_id) as number_of_comments from submissions a left join submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id order by a.sub_id
select distinct a.sub_id as post_id, count(distinct b.sub_id) number_of_comments from Submissions a left join Submissions b on b.parent_id = a.sub_id where a.parent_id is null group by a.sub_id
select distinct a.sub_id as post_id, count(distinct b.sub_id)as number_of_comments from Submissions a left join Submissions b on a.sub_id = b.parent_id where a.parent_id is null group by a.sub_id
select distinct a.sub_id as post_id, ifnull(b.ct,0) as number_of_comments from Submissions a left join (select a.parent_id, count(*) ct from (select Distinct * from Submissions) a group by a.parent_id having a.parent_id is not NULL) b on a.sub_id=b.parent_id where a.parent_id is NULL order by post_id asc
select distinct a.sub_id as post_id, ifnull(b.number_of_comments, 0) as number_of_comments from submissions a left join (select parent_id as post_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by parent_id) b on a.sub_id = b.post_id where a.parent_id is null order by a.sub_id
select distinct a.sub_id as post_id, ifnull(temp.comments,0) as number_of_comments from submissions a left join ( select parent_id, count(distinct sub_id) as comments from submissions group by parent_id ) temp on a.sub_id = temp.parent_id where a.parent_id is null order by 1
select distinct a.sub_id post_id, ( select count(distinct b.sub_id) from Submissions b where b.parent_id=a.sub_id ) number_of_comments from Submissions a where a.parent_id is NULL order by a.sub_id asc
select distinct b.sub_id as post_id, coalesce(c.number_of_comments, 0) as number_of_comments from submissions b left outer join (select a.parent_id, count(distinct a.sub_id) as number_of_comments from submissions a group by a.parent_id) c on b.sub_id = c.parent_id where b.parent_id is null order by b.sub_id
select distinct post.sub_id as post_id, count(distinct cmt.sub_id) as number_of_comments from submissions as post left join submissions as cmt on post.sub_id = cmt.parent_id where post.parent_id is null group by 1 order by 1
select distinct post_id ,count(distinct comments.sub_id )as number_of_comments from ( select distinct sub_id as post_id from Submissions where parent_id is null )as posts left join ( select distinct * from Submissions where parent_id is not null )as comments on posts.post_id = comments.parent_id group by post_id order by post_id
select distinct post_id,coalesce(count(distinct sub_id),0) as number_of_comments from (select distinct sub_id as post_id from submissions where parent_id is NULL) as e left join submissions on post_id=parent_id group by post_id
select distinct s.sub_id as post_id, (select count(distinct s1.sub_id) from submissions s1 where s1.parent_id = s.sub_id) as number_of_comments from submissions s where parent_id is null order by post_id asc
select distinct s.sub_id as post_id, coalesce(num, 0) as number_of_comments from Submissions s left join (select parent_id, count(distinct sub_id) as num from Submissions group by parent_id) sub on s.sub_id = sub.parent_id where s.parent_id is Null order by post_id asc
select distinct s.sub_id as post_id, count(distinct y.sub_id) as number_of_comments from submissions s left join submissions y on s.sub_id = y.parent_id where s.parent_id is null group by s.sub_id order by s.sub_id asc
select distinct s.sub_id as post_id,ifnull(number_of_comments,0) as number_of_comments from Submissions s left join ( select parent_id, count(distinct sub_id) as number_of_comments from Submissions group by parent_id) a on s.sub_id = a.parent_id where s.sub_id in (select distinct sub_id from Submissions where parent_id is null) order by s.sub_id
select distinct s1.sub_id as post_id, (select count(distinct s2.sub_id) from Submissions s2 where s2.parent_id = s1.sub_id) as number_of_comments from Submissions as s1 where parent_id is null order by s1.sub_id
select distinct s1.sub_id as post_id, (select count(distinct s2.sub_id) from Submissions s2 where s2.parent_id=s1.sub_id ) as number_of_comments from submissions as s1 where s1.parent_id is Null group by s1.sub_id order by s1.sub_id
select distinct s1.sub_id as post_id, (select count(distinct sub_id) from submissions s2 where s2.parent_id = s1.sub_id) as number_of_comments from submissions s1 where parent_id is null order by sub_id
select distinct s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select distinct s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id=s2.parent_id where s1.parent_id is null group by s1.sub_id
select distinct s1.sub_id as post_id, ifnull(count(distinct s2.sub_id), 0) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by 1 order by 1
select distinct s1.sub_id as post_id, ifnull(count(distinct s2.sub_id),0) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is Null group by post_id order by post_id
select distinct s1.sub_id post_id, count(distinct s2.sub_id) number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select distinct sub_id as post_id, ( select count(distinct sub_id) from submissions b where a.sub_id = b.parent_id ) as number_of_comments from Submissions as a where parent_id is null group by 1,2 order by 1,2 asc
select distinct sub_id as post_id, (SELECT COUNT(DISTINCT sub_id) FROM Submissions S2 WHERE S1.sub_id = S2.parent_id) AS number_of_comments from Submissions S1 where S1.parent_id is null order by S1.sub_id
select distinct sub_id as post_id, (select count(distinct sub_id) from Submissions a where a.parent_id = b.sub_id) as number_of_comments from Submissions b where parent_id is null order by post_id
select distinct sub_id as post_id, (select count(distinct sub_id) from Submissions s2 where s1.sub_id=s2.parent_id) as number_of_comments from Submissions s1 where parent_id is null group by sub_id order by sub_id
select distinct sub_id as post_id, (select count(distinct sub_id) from submissions s2 where s1.sub_id=s2.parent_id) as number_of_comments from submissions s1 where s1.parent_id is NULL order by sub_id asc
select distinct sub_id as post_id, coalesce(number_of_comments, 0) as number_of_comments from submissions s left join ( select parent_id, count(distinct sub_id) as number_of_comments from submissions group by 1 ) c on c.parent_id = s.sub_id where s.parent_id is null order by 1
select distinct sub_id as post_id, coalesce(number_of_comments,0) as number_of_comments from Submissions as p left join (select parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions group by parent_id ) as t on (t.post_id=p.sub_id) where p.parent_id is null order by post_id
select distinct sub_id as post_id,(select count(distinct sub_id) from submissions s2 where s2.parent_id = s1.sub_id) AS number_of_comments from submissions s1 where parent_id is null order by sub_id
select distinct sub_id as post_id,coalesce (number_of_comments,0) as number_of_comments from submissions left join (select parent_id,count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by parent_id) as X on submissions.sub_id = x.parent_id where submissions.parent_id is null order by post_id asc
select distinct t1.sub_id as post_id, (select count(distinct t2.sub_id) from submissions t2 where t2.parent_id = t1.sub_id) as number_of_comments from submissions t1 where t1.parent_id is null order by 1
select distinct(a.sub_id) as post_id, count(distinct b.sub_id) as number_of_comments from Submissions a left join submissions b on a. sub_id=b.parent_id group by a.sub_id having sum(case when a.parent_id is null then 1 else 0 end)>0
select distinct(a.sub_id) as post_id, count(distinct(b.sub_id)) as number_of_comments from submissions a left join submissions b on a.sub_id=b.parent_id where a.parent_id is null group by a.sub_id order by post_id
select distinct(a.sub_id) as post_id, count(distinct(b.sub_id)) as number_of_comments from submissions a left join submissions b on a.sub_id=b.parent_id where a.parent_id is null group by a.sub_id order by post_id asc
select distinct(s1.sub_id) as 'post_id', count(distinct(s2.sub_id)) as 'number_of_comments' from submissions as s1 left join submissions as s2 on s2.parent_id = s1.sub_id where s1.parent_id is Null group by s1.sub_id
select distinct(s1.sub_id) as post_id, count(distinct(s2.sub_id)) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where S1.parent_id is null group by S1.sub_id
select distinct(s2.sub_id) as 'post_id', count(distinct(s1.sub_id)) as 'number_of_comments' from submissions as s1 right join submissions as s2 on s1.parent_id = s2.sub_id where s2.parent_id is Null group by s2.sub_id
select distinct(s2.sub_id) as post_id,count(distinct(s1.sub_id)) as number_of_comments from submissions as s1 right join submissions as s2 on s1.parent_id = s2.sub_id where s2.parent_id is Null group by s2.sub_id
select f1.sub_id as post_id, count(f2.parent_id) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) f1 left join (select distinct * from Submissions) f2 on f1.sub_id = f2.parent_id group by 1 order by 1
select f1.sub_id post_id, count(f2.parent_id) number_of_comments from ( select distinct sub_id from submissions where parent_id is null) f1 left join ( select distinct * from submissions) f2 on f1.sub_id = f2.parent_id group by f1.sub_id order by post_id
select l.post_id as post_id, IFNULL(number_of_comments, 0) as number_of_comments from (select distinct(sub_id) as post_id from Submissions where parent_id is Null) l left join (select parent_id as post_id, count(distinct(sub_id)) as number_of_comments from Submissions where parent_id is not null group by parent_id) r on l.post_id = r.post_id order by post_id asc
select p.post as post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from (select distinct sub_id as post from submissions where parent_id is null) as p left join submissions as s on p.post = s.parent_id group by post order by post_id
select p.sub_id as post_id , coalesce(count(distinct c.sub_id),0) as number_of_comments from Submissions p left join Submissions c on p.sub_id=c.parent_id where p.parent_id is null group by 1 order by 1
select p.sub_id as post_id ,count(distinct s.sub_id) as number_of_comments from submissions p left join submissions s on p.sub_id = s.parent_id where p.parent_id is null group by p.sub_id
select p.sub_id as post_id, IFNULL(count(distinct c.sub_id), 0) as number_of_comments from Submissions p left join Submissions c on p.sub_id = c.parent_id where p.parent_id is null group by p.sub_id order by p.sub_id asc
select p.sub_id as post_id, count(distinct c.sub_id) as number_of_comments from (select sub_id from submissions where parent_id is NULL) as p left join submissions as c on p.sub_id = c.parent_id group by p.sub_id
select p.sub_id as post_id, count(distinct c.sub_id) as number_of_comments from Submissions p left join Submissions c on p.sub_id = c.parent_id where p.parent_id is null group by p.sub_id
select p.sub_id as post_id, count(distinct q.sub_id) as number_of_comments from submissions p left join submissions q on p.sub_id = q.parent_id where p.parent_id is null group by 1 order by 1
select p.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from submissions as p left join submissions as s on p.sub_id = s.parent_id where p.parent_id is null group by p.sub_id
select p.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from submissions p left join submissions s on p.sub_id = s.parent_id where p.parent_id is null group by p.sub_id
select p.sub_id as post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from (select distinct sub_id from submissions where parent_id is null) as p left join submissions as s on p.sub_id = s.parent_id group by p.sub_id order by post_id
select p.sub_id post_id , count(distinct(c.sub_id)) number_of_comments from submissions p left join submissions c on p.sub_id=c.parent_id where p.parent_id is null group by p.sub_id order by p.sub_id asc
select p.sub_id post_id, count(distinct s.sub_id) number_of_comments from submissions p left join submissions s on p.sub_id = s.parent_id where p.parent_id is null group by p.sub_id
select p.sub_id post_id,count(distinct s.sub_id) number_of_comments from submissions p left join submissions s on p.sub_id = s.parent_id where p.parent_id is null group by p.sub_id
select p1.sub_id as post_id, count(p2.sub_id) as number_of_comments from (select sub_id from Submissions where parent_id is null group by 1 ) p1 left join ( select sub_id, parent_id from Submissions where parent_id is not null group by 1,2 ) p2 on p1.sub_id = p2.parent_id group by 1 order by 1
select parent.sub_id as post_id, IFNULL(child.counts,0) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) parent left join (select parent_id, count(distinct sub_id) counts from Submissions where parent_id is not null group by parent_id) child on parent.sub_id = child. parent_id order by parent.sub_id
select parent.sub_id post_id ,count(distinct child.sub_id) number_of_comments from Submissions parent left join Submissions child on parent.sub_id = child.parent_id where parent.parent_id is null group by parent.sub_id order by parent.sub_id asc
select post.sub_id as post_id, count(distinct comment.sub_id) as number_of_comments from submissions post left join submissions comment on post.sub_id = comment.parent_id where post.parent_id is null group by 1 order by 1
select post.sub_id as post_id, ifnull(count(distinct s1.sub_id,s1.parent_id),0) as number_of_comments from Submissions s1 right join (select sub_id from Submissions where parent_id is null) post on s1.parent_id=post.sub_id group by post.sub_id
select post_id, case when number_of_comments is null then 0 else number_of_comments end as number_of_comments from (select distinct sub_id post_id from submissions where parent_id is null) s left join (select parent_id, count(distinct sub_id) number_of_comments from submissions where parent_id is not null group by parent_id ) p on s.post_id = p.parent_id order by post_id
select post_id, coalesce(number_of_comments,0) as number_of_comments from ( (select distinct(sub_id) as post_id from submissions where parent_id is null order by post_id) A left join (select parent_id as post_id1, count(distinct sub_id) as number_of_comments from submissions group by parent_id) B on A.post_id=B.post_id1)
select post_id, count(distinct comment) as number_of_comments from ( select s1.sub_id as post_id, s2.parent_id,s2.sub_id as comment from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id)d group by post_id having post_id in (Select sub_id from Submissions where parent_id is null )
select post_id, count(distinct s.sub_id) as number_of_comments from Submissions s right join ( select distinct sub_id as post_id from Submissions where parent_id is null ) as ss on ss.post_id = s.parent_id group by ss.post_id order by ss.post_id
select post_id, count(distinct s2.sub_id) as number_of_comments from (select distinct sub_id as post_id from submissions where parent_id is null)s1 left join submissions s2 on s1.post_id = s2.parent_id group by post_id
select post_id, count(distinct sub_id) as number_of_comments from (select distinct sub_id as post_id from Submissions where parent_id is null) as t1 left join Submissions s on t1.post_id = s.parent_id group by post_id order by post_id
select post_id, count(distinct sub_id)as number_of_comments from (select sub_id as post_id from submissions where parent_id is null) as t1 left join submissions s on t1.post_id = s.parent_id group by post_id order by post_id
select post_id, count(sub_id) as number_of_comments from (select distinct sub_id as post_id from Submissions where parent_id is NULL ) as post left join (select distinct sub_id, parent_id from Submissions where parent_id is not null ) as comments on post.post_id = comments.parent_id group by post_id order by post_id
select post_id, ifnull(count(distinct sub_id),0) as number_of_comments from (select sub_id as post_id from Submissions where parent_id is null) Posts left join Submissions on Submissions.parent_id = Posts.post_id group by Posts.post_id
select post_id, ifnull(number_of_comments, 0) as number_of_comments from(select distinct s.sub_id as post_id from submissions s where s.parent_id is null) as t left join (select ss.parent_id, count(distinct ss.sub_id) as number_of_comments from submissions ss group by ss.parent_id ) as s on t.post_id = s.parent_id order by post_id
select post_id, sum(case when S2.sub_id is not null then 1 else 0 end) as number_of_comments from (select distinct S1.sub_id as post_id from Submissions S1 where S1.parent_id is null) S1 left join (select distinct S2.parent_id, S2.sub_id from Submissions S2 where S2.parent_id is not null) S2 on post_id=S2.parent_id group by post_id order by post_id asc
select post_id, sum(number_of_comments) as number_of_comments from ((select parent_id as post_id, count(distinct sub_id) as number_of_comments from submissions where parent_id in (select distinct sub_id from submissions where parent_id is null) group by parent_id) union (select sub_id as post_id, nullif(count(parent_id), null) as number_of_comments from submissions where parent_id is null group by sub_id)) tmp group by post_id order by post_id
select post_id,coalesce(count(distinct sub_id),0) as number_of_comments from (select distinct sub_id as post_id from submissions where parent_id is NULL) as e left join submissions on post_id=parent_id group by post_id
select posts.post_id, count(distinct sub_id) 'number_of_comments' from (select distinct sub_id 'post_id' from Submissions where parent_id is null) posts left join Submissions on posts.post_id = Submissions.parent_id group by posts.post_id
select posts.sub_id as post_id, coalesce(comments.total_comments, 0) as number_of_comments from ( select distinct sub_id from submissions where parent_id is null ) posts left join ( select parent_id, count(distinct sub_id) as total_comments from submissions group by parent_id ) comments on posts.sub_id = comments.parent_id order by posts.sub_id
select posts.sub_id as post_id, count(distinct comments.sub_id) as number_of_comments from submissions as posts left join submissions as comments on posts.sub_id = comments.parent_id where posts.parent_id is null group by posts.sub_id
select posts.sub_id as post_id, count(sb.parent_id) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) as posts left join (select sub_id, parent_id from Submissions group by sub_id, parent_id) sb on sb.parent_id = posts.sub_id group by posts.sub_id order by post_id
select posts.sub_id as post_id, sum(if(parent_id is not Null, 1, 0)) as number_of_comments from (select distinct sub_id from Submissions where parent_id is Null ) as posts left join ( select distinct sub_id, parent_id from Submissions where parent_id is not Null ) as comments on posts.sub_id = comments.parent_id group by 1 order by post_id asc
select s.sub_id as post_id, count(distinct c.sub_id) as number_of_comments from submissions as s left join submissions as c on s.sub_id=c.parent_id where s.parent_id is null group by s.sub_id order by s.sub_id
select s.sub_id as post_id, count(distinct s1.sub_id) as number_of_comments from Submissions s left join Submissions s1 on s.sub_id = s1.parent_id where s.parent_id is null group by s.sub_id
select s.sub_id as post_id, count(distinct ss.sub_id) as number_of_comments from submissions s left join submissions ss on s.sub_id = ss.parent_id where s.parent_id is null group by 1
select s.sub_id as post_id, ifnull(count(distinct(s1.sub_id)),0) as number_of_comments from submissions s left join submissions s1 on(s.sub_id=s1.parent_id) where s.parent_id is null group by s.sub_id
select s1 as post_id, count(s22) as number_of_comments from ( select distinct s1.sub_id as s1, s1.parent_id s12, s2.sub_id as s2, s2.parent_id as s22 from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null ) x group by 1 order by 1
select s1.post_id, count(DISTINCT s2.sub_id) as number_of_comments from (SELECT DISTINCT sub_id AS post_id FROM Submissions WHERE parent_id IS NULL) s1 left join Submissions s2 on s1.post_id = s2.parent_id group by s1.post_id
select s1.post_id, ifnull(number_of_comments,0) as number_of_comments from (select distinct sub_id as post_id from Submissions where parent_id is null) s1 left join (select post_id, count(com_id) number_of_comments from (select distinct sub_id as com_id, parent_id as post_id from Submissions where parent_id is not null) s group by post_id) s2 on s1.post_id = s2.post_id order by s1.post_id
select s1.sub_id as 'post_id', count(distinct s2.sub_id) as 'number_of_comments' from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by 1
select s1.sub_id as post_id , count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by 1 order by 1
select s1.sub_id as post_id, COUNT(distinct s2.sub_id) as number_of_comments from Submissions s1 LEFT JOIN Submissions s2 ON s1.sub_id = s2.parent_id where s1.parent_id is NULL group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from ((select distinct sub_id from Submissions where parent_id is null) s1 left join (select distinct * from Submissions) s2 on s1.sub_id = s2.parent_id) group by 1
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from (select distinct sub_id, parent_id from submissions where parent_id is null) s1 left join (select distinct sub_id, parent_id from submissions where parent_id is not null) s2 on s1.sub_id = s2.parent_id group by 1 order by 1
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from (select sub_id from Submissions where parent_id is null) s1 left join Submissions s2 on s1.sub_id = s2.parent_id group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from (select sub_id from submissions where parent_id is null) as s1 left join submissions as s2 on s1.sub_id = s2.parent_id group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is NULL group by 1 order by 1
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is Null group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by 1
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id=s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s2.parent_id = s1.sub_id where s1.parent_id is null group by 1
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from Submissions s1 left join Submissions s2 on s2.parent_id = s1.sub_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is NULL group by s1.sub_id order by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by 1 order by 1
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s1.sub_id=s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, count(distinct(s2.sub_id)) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, count(s2.parent_id) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) s1 left join (select distinct * from Submissions) s2 on s1.sub_id = s2.parent_id group by s1.sub_id order by post_id asc
select s1.sub_id as post_id, count(s2.parent_id) as number_of_comments from (select distinct sub_id from submissions where parent_id is null) s1 left join (select distinct sub_id, parent_id from submissions) s2 on s1.sub_id = s2.parent_id group by s1.sub_id order by s1.sub_id
select s1.sub_id as post_id, ifnull(count(distinct s2.sub_id),0) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id, sum(case when s2.parent_id is not null then 1 else 0 end) as number_of_comments from (select sub_id, parent_id from submissions where parent_id is not null group by sub_id, parent_id) s2 right join (select sub_id from submissions where parent_id is null group by sub_id) s1 on (s1.sub_id=s2.parent_id) group by s1.sub_id order by s1.sub_id
select s1.sub_id as post_id,count(distinct s2.sub_id) as number_of_comments from submissions s1 left join submissions s2 on s2.parent_id = s1.sub_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id,count(distinct s2.sub_id) number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id as post_id,ifnull(count(distinct s2.sub_id),0) as number_of_comments from submissions s1 left join submissions s2 on s2.parent_id=s1.sub_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id post_id , count(distinct s2.sub_id) number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id =s2.parent_id where s1.Parent_id is NULL group by s1.sub_id
select s1.sub_id post_id, count(distinct s2.sub_id) number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id post_id, count(distinct s2.sub_id) number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id=s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id post_id, count(distinct s2.sub_id) number_of_comments from submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by s1.sub_id
select s1.sub_id post_id, ifnull(count(distinct s2.sub_id),0) as number_of_comments from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null group by 1 order by 1
select s2.sub_id as 'post_id', count(distinct(s1.sub_id)) as 'number_of_comments' from submissions as s1 right join submissions as s2 on s1.parent_id = s2.sub_id where s2.parent_id is Null group by s2.sub_id
select s2.sub_id as post_id, ifnull(count(distinct s1.sub_id ),0) as number_of_comments from submissions s1 right join submissions s2 on s1.parent_id = s2.sub_id where s2.parent_id is null group by 1 order by s2.sub_id
select s3.a post_id , ifnull(count(distinct s3.b),0) number_of_comments from (select s1.sub_id a,s2.sub_id b from Submissions s1 left join Submissions s2 on s1.sub_id =s2.parent_id where s1.Parent_id is NULL)s3 group by s3.a
select sub.sub_id as post_id, count(distinct temp.sub_id) as number_of_comments from Submissions sub left join Submissions temp on sub.sub_id = temp.parent_id where sub.parent_id is NULL group by sub.sub_id order by sub.sub_id
select sub.sub_id as post_id, ifnull(count(distinct s.sub_id), 0) as number_of_comments from submissions sub left join submissions s on sub.sub_id = s.parent_id where sub.parent_id is null group by sub.sub_id
select sub_id as post_id, case when cnt is NULL then 0 else cnt end as number_of_comments from (select distinct sub_id from Submissions where parent_id is NULL) as t left join (select parent_id, count(distinct sub_id) as cnt from Submissions group by parent_id) as u on t.sub_id = u.parent_id order by post_id
select sub_id as post_id, count(distinct(comment_id)) as number_of_comments from ( select * from ( select t1.sub_id, t1.parent_id, t2.sub_id as comment_id from Submissions t1 left join Submissions t2 on t1.sub_id = t2.parent_id ) comments where comments.parent_id is null ) posts group by post_id order by post_id
select sub_id as post_id, ifnull(num_of_comments,0) as number_of_comments from (select Distinct sub_id from Submissions where parent_id is null) as temp left join (select parent_id, count(Distinct sub_id) as num_of_comments from Submissions group by parent_id) as temp_2 on temp.sub_id = temp_2.parent_id order by post_id
select sub_id as post_id, sum( case when comment_id is NULL then 0 else 1 end ) as number_of_comments from (select distinct s.sub_id, t.sub_id as comment_id from submissions as s left join submissions as t on s.sub_id = t.parent_id where s.parent_id is NULL) as u group by sub_id order by post_id
select t.post_id, count(distinct sub_id) as number_of_comments from Submissions as s right join (select distinct sub_id as post_id from Submissions where parent_id is null) as t on t.post_id = s.parent_id group by t.post_id
select t.post_id, ifnull(a.nc,0) as number_of_comments from (select distinct sub_id as post_id from submissions where parent_id is null) t left join (select parent_id as post_id, count(distinct sub_id) as nc from submissions group by 1) a on t.post_id=a.post_id group by 1 order by 1
select t.post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from (select distinct(sub_id) as post_id from submissions where parent_id is Null)t left join submissions s on t.post_id=s.parent_id group by 1
select t.sub_id post_id, count(distinct s.sub_id) number_of_comments from ( select distinct sub_id from submissions where parent_id is null ) t left join submissions s on t.sub_id = s.parent_id group by t.sub_id
select t.sub_id post_id, count(distinct s.sub_id) number_of_comments from (select distinct sub_id from submissions where parent_id is null) t left join submissions s on s.parent_id = t.sub_id group by t.sub_id order by 1
select t1.post_id, coalesce(t2.number_of_comments,0) as number_of_comments from (select distinct sub_id as post_id from submissions where parent_id is null) t1 left join (select parent_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by parent_id) t2 on t1.post_id=t2.parent_id order by post_id
select t1.post_id, count(distinct s.sub_id) as number_of_comments from submissions s right join ( select sub_id as post_id from submissions where parent_id is null ) as t1 on t1.post_id = s.parent_id group by t1.post_id order by t1.post_id asc
select t1.sub_id as post_id , ifnull(count(s.parent_id),0) as number_of_comments from ( select distinct sub_id from Submissions where parent_id is null ) t1 left join ( select distinct * from Submissions)s on t1.sub_id = s.parent_id group by 1 order by 1
select t1.sub_id as post_id, count(distinct commenter_id) as number_of_comments from (select sub_id from Submissions where parent_id is null) as t1 left join (select parent_id as sub_id, sub_id as commenter_id from Submissions where parent_id is not null) as t2 on (t1.sub_id = t2.sub_id) group by t1.sub_id
select t1.sub_id as post_id, count(distinct t2.sub_id) as number_of_comments from ( select distinct sub_id from submissions where parent_id is null ) t1 left join ( select * from submissions ) t2 on t2.parent_id = t1.sub_id group by t1.sub_id order by t1.sub_id asc
select t1.sub_id as post_id, count(distinct t2.sub_id) as number_of_comments from ( select distinct sub_id from submissions where parent_id is null ) t1 left join ( select * from submissions where parent_id is not null ) t2 on t2.parent_id = t1.sub_id group by t1.sub_id order by t1.sub_id asc
select t1.sub_id as post_id, count(distinct t2.sub_id) as number_of_comments from ( select distinct sub_id from submissions where parent_id is null ) t1 left join submissions t2 on t2.parent_id = t1.sub_id group by t1.sub_id order by t1.sub_id asc
select t1.sub_id as post_id, count(distinct t2.sub_id) as number_of_comments from (select distinct sub_id from Submissions where parent_id is null ) t1 left join Submissions t2 on t1.sub_id= t2.parent_id group by post_id
select t1.sub_id as post_id, count(distinct t2.sub_id) as number_of_comments from Submissions t1 left join Submissions t2 on t1.sub_id=t2.parent_id where t1.parent_id is null group by t1.sub_id
select t1.sub_id as post_id,count(t2.parent_id) as number_of_comments from ( select distinct sub_id from Submissions s1 where parent_id is null) t1 left join ( select distinct sub_id,parent_id from Submissions s2) t2 on t1.sub_id=t2.parent_id group by post_id order by post_id
select t1.t1.sub_id as post_id, count(distinct t2.sub_id) as number_of_comments from (select distinct t1.sub_id from Submissions t1 where parent_id is null ) t1 left join Submissions t2 on t1.sub_id= t2.parent_id group by post_id
select tb.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from ( select distinct sub_id from submissions where parent_id is null ) tb left join submissions s on tb.sub_id = s.parent_id group by post_id order by post_id
select tem.post_id, tem.number_of_comments from (select a.sub_id as post_id,ifnull(count(distinct b.parent_id,b.sub_id),0) as number_of_comments,a.parent_id as pp from submissions a left join submissions b on a.parent_id is null and a.sub_id = b.parent_id group by a.sub_id) tem where tem.pp is null
select tem1.sub_id as post_id, ifnull(tem2.ct,0)as number_of_comments from (select distinct sub_id from Submissions su where su.parent_id is null) tem1 left join (select parent_id, count(distinct sub_id) as ct from Submissions su where su.parent_id is not null group by su.parent_id )tem2 on tem1.sub_id = tem2.parent_id order by post_id
select tp.post_id, count(tc.sub_id) number_of_comments from (select distinct sub_id as post_id from submissions where parent_id is null) tp left join (select distinct sub_id, parent_id from submissions where parent_id is not null) tc on tp.post_id = tc.parent_id group by tp.post_id order by tp.post_id
select x.sub_id as post_id, ifnull(count(distinct y.sub_id), 0) as number_of_comments from (select sub_id from submissions where parent_id is null) x left join submissions y on x.sub_id=y.parent_id group by 1
with CTE as (SELECT DISTINCT sub_id as post_id FROM Submissions WHERE parent_id IS NULL) SELECT post_id, COUNT(DISTINCT sub_id) as number_of_comments FROM CTE LEFT JOIN Submissions on CTE.post_id = Submissions.parent_id GROUP BY post_id ORDER BY post_id ASC
with T as ( select sub_id from Submissions where parent_id is null ), T1 as ( select parent_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by parent_id ) select distinct T.sub_id as post_id, ifnull(t1.number_of_comments, 0) as number_of_comments from T left join T1 on T.sub_id = T1.parent_id order by T.sub_id
with T as(select s1.sub_id as comments, s2.sub_id as post_id from Submissions s1 right join Submissions s2 on s1.parent_id = s2.sub_id where s2.parent_id is null) select distinct post_id, count(distinct comments) as number_of_comments from t group by post_id
with a as (select distinct sub_id aa from Submissions where parent_id is null), b as (select sub_id ,parent_id from Submissions where parent_id is not null) select distinct aa post_id, count(distinct sub_id) number_of_comments from a left join b on b.parent_id=a.aa group by 1
with active_posts as ( Select distinct sub_id from Submissions where parent_id is Null ) Select A.sub_id as post_id , count(distinct S.sub_id) as number_of_comments from Submissions S right join active_posts A on S.parent_id = A.sub_id group by post_id
with b as (select sub_id from submissions where parent_id is null) select distinct b.sub_id post_id, coalesce(count(distinct a.sub_id),0) number_of_comments from submissions a right join b on a.parent_id = b.sub_id group by b.sub_id
with b as( select distinct sub_id from submissions where parent_id is null), a as( select distinct * from submissions), c as( select parent_id, count(*) as number_of_comments from a group by 1) select b.sub_id as post_id, ifnull(c.number_of_comments,0) as number_of_comments from b left join c on b.sub_id=c.parent_id order by 1
with base as (select distinct sub_id from submissions where parent_id is null) select b.sub_id as post_id, ifnull(count(parent_id),0) as number_of_comments from (select distinct sub_id, parent_id from submissions where parent_id in (select sub_id from base))a right join base b on a.parent_id = b.sub_id group by b.sub_id order by b.sub_id
with comments_per_post as ( Select parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by 1 ) Select distinct sub_id as post_id , coalesce(number_of_comments,0) as number_of_comments from Submissions s left join comments_per_post cp on cp.post_id = s.sub_id where s.parent_id is null order by 1
with cte as ( select distinct post_id,s.sub_id as comments_id from submissions s right join (select distinct sub_id as post_id from submissions where parent_id is null) t on t.post_id = s.parent_id ) select post_id,count(comments_id) as number_of_comments from cte group by post_id order by post_id
with cte as ( select distinct sub_id as mainpostid from Submissions where parent_id is Null ) select cte.mainpostid as post_id, count(distinct s.sub_id) as number_of_comments from cte left join Submissions s on cte.mainpostid = s. parent_id group by cte.mainpostid
with cte as ( select distinct sub_id as post from submissions where parent_id is null ) select c.post as post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from cte c left join submissions s on c.post = s.parent_id group by 1
with cte as ( select distinct sub_id as post_id from Submissions where parent_id is NULL ) SELECT post_id, COUNT(distinct sub_id) as number_of_comments FROM CTE a LEFT JOIN Submissions b on post_id = parent_id group by post_id
with cte as ( select distinct sub_id as post_id from Submissions where parent_id is Null), cte2 as ( select parent_id, COUNT(distinct sub_id) as cnt from Submissions where parent_id is not Null group by parent_id ) select cte.post_id, IFNULL(cte2.cnt,0) as number_of_comments from cte left join cte2 on cte.post_id = cte2.parent_id order by 1
with cte as ( select distinct sub_id as post_id from Submissions where parent_id is null ) select post_id, count(distinct sub_id) as number_of_comments from cte a left join Submissions b on a.post_id = b.parent_id group by post_id
with cte as ( select distinct sub_id as post_id from Submissions where parent_id is null ) select post_id, count(distinct sub_id) as number_of_comments from cte c left join Submissions s on c.post_id = s.parent_id group by post_id
with cte as ( select distinct sub_id as post_id from submissions where parent_id is null ) select c.post_id, count(distinct s.sub_id) as number_of_comments from cte c left join submissions s on c.post_id=s.parent_id group by c.post_id
with cte as ( select distinct sub_id as post_id from submissions where parent_id is null ), cte2 as ( select parent_id as post_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by 1 ) select cte.post_id, ifnull(number_of_comments, 0) as number_of_comments from cte left join cte2 on cte.post_id = cte2.post_id order by 1
with cte as ( select distinct sub_id, parent_id from submissions) select distinct sub_id as post_id, (case when count is null then 0 else count end) as number_of_comments from submissions s left join ( select parent_id as post_id, count(parent_id) as count from cte group by parent_id) as d on d.post_id = s.sub_id where s.parent_id is NULL order by sub_id
with cte as ( select parent_id as post_id,count(distinct sub_id) as number_of_comments from submissions group by parent_id ), demo as ( select distinct sub_id as post_id from submissions where parent_id is null ) select d.post_id,coalesce(cte.number_of_comments,0) as number_of_comments from demo as d left join cte on d.post_id=cte.post_id order by post_id
with cte as ( select parent_id, count(distinct sub_id) as number_of_comments from submissions where parent_id is not null group by parent_id ) select distinct s1.sub_id as post_id, ifnull(cte.number_of_comments, 0) as number_of_comments from submissions as s1 left join cte on s1.sub_id = cte.parent_id where s1.parent_id is null order by post_id
with cte as ( select parent_id, count(distinct sub_id) num_cms from ( select sub_id, parent_id from submissions where parent_id is not null ) f group by 1 ) select s1.sub_id post_id, ifnull(cte.num_cms, 0) number_of_comments from cte right join ( select distinct sub_id from submissions where parent_id is null ) s1 on cte.parent_id = s1.sub_id order by 1
with cte as ( select s.sub_id, s.parent_id from Submissions s group by 1,2 ), comments as ( select parent_id, count(*) as 'comcount' from cte group by 1 ) select cte.sub_id as 'post_id', ifnull(c.comcount,0) as 'number_of_comments' from cte left join comments c on c.parent_id = cte.sub_id where cte.parent_id IS NULL order by 1 ASC
with cte as ( select sub_id as post_id from Submissions where parent_id is null), cte1 as ( select parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by 1) select distinct x.post_id, ifnull(y.number_of_comments,0) as number_of_comments from cte x left join cte1 y on x.post_id = y.post_id order by 1
with cte as (select * from submissions group by sub_id, parent_id) select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from ( select sub_id from cte where parent_id is null ) s1 left join submissions s2 on s1.sub_id = s2.parent_id group by s1.sub_id
with cte as (select distinct sub_id as post_id from Submissions where parent_id is null) select b.post_id, count(distinct a.sub_id) as number_of_comments from cte b left join Submissions a on a.parent_id = b.post_id group by b.post_id
with cte as (select distinct sub_id as post_id from Submissions where parent_id is null) select post_id, ifnull((count(distinct sub_id)),0) as number_of_comments from CTE a left join Submissions b on a.post_id = b.parent_id group by post_id
with cte as (select distinct sub_id as sd from submissions where parent_id is Null) , c1 as (select * from submissions where parent_id is not null) select cte.sd as post_id, ifnull(count(distinct c1.sub_id),0) as number_of_comments from cte left join c1 on cte.sd = c1.parent_id group by 1 order by 1
with cte as (select distinct sub_id as ss from Submissions where parent_id is null) select cte.ss as post_id, count(distinct sub_id) as number_of_comments from cte left join Submissions on cte.ss = Submissions.parent_id group by 1 order by 1
with cte as (select distinct sub_id from submissions s where parent_id is null) select cte.sub_id as post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from cte left join submissions s on cte.sub_id=s.parent_id group by cte.sub_id
with cte as (select distinct(sub_id) from Submissions where parent_id is null), cte2 as ( select parent_id, count(distinct(sub_id)) as number_of_comments from submissions group by 1) select cte.sub_id as post_id, ifnull(number_of_comments,0) as number_of_comments from cte left join cte2 on cte.sub_id = cte2.parent_id order by 1
with cte as (select parent_id, count(parent_id) as num from (select distinct sub_id,parent_id from Submissions where parent_id is not null)as b group by 1) select a.sub_id as post_id,ifnull(cte.num,0)as number_of_comments from (select distinct sub_id from Submissions where parent_id is null) as a left join cte on a.sub_id = cte.parent_id order by 1
with cte as (select sub_id as post_id from Submissions where parent_id is Null ) select cte.post_id, count(distinct s.sub_id) number_of_comments from cte left join Submissions s on cte.post_id = s.parent_id group by 1
with cte as (select sub_id from submissions where parent_id is null) select c.sub_id post_id, count(distinct s.sub_id) number_of_comments from cte c left join submissions s on c.sub_id = s.parent_id group by c.sub_id
with cte as (select sub_id from submissions where parent_id is null) select cte.sub_id as post_id,count(distinct s.sub_id) as number_of_comments from cte left join submissions s on cte.sub_id=s.parent_id group by 1
with cte as( select distinct sub_id from submissions where parent_id is null) select cte.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from cte left join submissions s on cte.sub_id = s.parent_id group by 1 order by 1 asc
with cte as( select parent_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not Null group by parent_id) select distinct s.sub_id as post_id, ifnull(number_of_comments,0) as number_of_comments from Submissions s LEFT JOIN cte ON s.sub_id = cte.parent_id where s.parent_id is Null order by post_id
with cte as(select sub_id as post_id from Submissions where parent_id is null) select a.post_id, count(distinct b.sub_id) as number_of_comments from cte a left join Submissions b on a.post_id = b.parent_id group by a.post_id
with cte as(select sub_id from submissions where parent_id is null group by 1) select c.sub_id as post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from cte c left join submissions s on c.sub_id = s.parent_id group by 1
with cte1 as ( select distinct sub_id as post_id from Submissions where parent_id is null ), cte2 as ( select parent_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by parent_id ) select post_id, ifnull(number_of_comments, 0) as number_of_comments from cte1 left join cte2 on cte1.post_id=cte2.parent_id order by post_id
with cte1 as ( select distinct sub_id as post_id from submissions where parent_id is null), cte2 as ( select * from submissions where parent_id is not null group by 1,2) select c1.post_id, ifnull(count(c2.parent_id),0) as number_of_comments from cte1 c1 left join cte2 c2 on c1.post_id=c2.parent_id group by 1 order by 1 asc
with cte1 as (select distinct * from submissions where parent_id is Null), cte2 as (select distinct * from submissions where parent_id is not Null) select post_id,count(id) as number_of_comments from( select cte1.sub_id as post_id,cte2.sub_id as id from cte1 left join cte2 on cte1.sub_id = cte2.parent_id) t group by post_id order by 1
with cte1 as (select parent_id, sub_id as sub from Submissions group by sub_id having parent_id IS NULL) select sub as post_id, count(distinct sub_id) as number_of_comments from cte1 c left join submissions s on c.sub = s.parent_id group by sub
with cte1 as( Select distinct sub_id from Submissions where parent_id is null ), cte2 as( Select parent_id, count(distinct sub_id) as number_of_comments from submissions group by 1 ) select cte1.sub_id as post_id, ifnull(number_of_comments,0) as number_of_comments from cte1 left join cte2 on cte1.sub_id = cte2.parent_id order by 1
with cte_dedupe as ( select distinct * from Submissions ), cte_posts as ( select sub_id as post_id from cte_dedupe where parent_id is null ), cte_self_join as ( select s1.sub_id, count(*) as number_of_comments from cte_dedupe as s1 join cte_dedupe as s2 on s1.sub_id = s2.parent_id group by 1 ), cte_final as ( select post_id, coalesce(number_of_comments, 0) as number_of_comments from cte_posts as p left join cte_self_join as sj on p.post_id = sj.sub_id order by 1 ) select * from cte_final
with cte_parent as ( select distinct sub_id as parent from submissions where parent_id is null ), cte_parent_child as ( select parent, sub_id as child from cte_parent left join submissions on (cte_parent.parent=submissions.parent_id) ) select parent as post_id, count(distinct child) as number_of_comments from cte_parent_child group by parent
with cte_parent as( select distinct sub_id from Submissions where parent_id is Null ), cte_child as( select parent_id, count(distinct sub_id) as cnt from Submissions where parent_id is not null group by parent_id) select sub_id as post_id, ifnull(cnt,0) as number_of_comments from cte_parent cp left join cte_child cc on cp.sub_id = cc.parent_id order by sub_id
with cte_post as ( select sub_id as posts from submissions where parent_id is NULL ) select posts as post_id, coalesce(count(distinct(sub_id)),0) as number_of_comments from cte_post p left join submissions s on p.posts = s.parent_id group by posts order by post_id
with cte_posts as ( select distinct sub_id as posts from Submissions where parent_id is null ) select posts as post_id, coalesce(count(distinct sub_id), 0) as number_of_comments from cte_posts left join Submissions on cte_posts.posts = Submissions.parent_id group by 1
with ids as (select distinct sub_id from submissions where parent_id is Null) select i.sub_id as post_id, ifnull(count(distinct s.sub_id),0) as number_of_comments from ids i left join submissions s on s.parent_id = i.sub_id group by i.sub_id order by 1
with idx as ( select distinct(sub_id) sub_id from submissions where parent_id is null ) select idx.sub_id post_id, count(distinct(t.sub_id)) number_of_comments from idx left join (select * from submissions where parent_id is not null) t on idx.sub_id = t.parent_id group by idx.sub_id
with p as (select distinct sub_id as post_id from submissions where parent_id is null) select p.post_id, count(distinct s.sub_id) as number_of_comments from p left join submissions s on p.post_id = s.parent_id group by p.post_id
with parents as ( SELECT sub_id FROM Submissions where parent_id IS NULL ) select p.sub_id as post_id , coalesce(count(distinct po.sub_id),0) as number_of_comments FROM Submissions po RIGHT JOIN parents p on p.sub_id = po.parent_id GROUP BY p.sub_id order by p.sub_id
with post as ( SELECT DISTINCT sub_id from Submissions where parent_id IS NULL) select post.sub_id post_id, count(DISTINCT s.sub_id) number_of_comments from post left join Submissions s on s.parent_id = post.sub_id group by post.sub_id
with post as ( select distinct sub_id from Submissions where parent_id is null), comment as ( select distinct sub_id, parent_id from Submissions where parent_id is not null) select p.sub_id as post_id, ifnull(count(c.sub_id),0) as number_of_comments from post p left join comment c on p.sub_id = c.parent_id group by p.sub_id order by p.sub_id
with post as ( select sub_id as post_id from submissions where parent_id is null group by 1 ) select post_id ,coalesce(count(distinct c.sub_id),0) as number_of_comments from post p left join Submissions c on p.post_id = c.parent_id group by 1 order by 1
with post as (select distinct sub_id as post_id from submissions where parent_id is null), tb as (select distinct sub_id,parent_id from submissions) select p.post_id,ifnull(count(tb.sub_id),0) as number_of_comments from post p left join tb on p.post_id=tb.parent_id group by 1 order by 1
with post as( select distinct sub_id post_id from Submissions where parent_id is null ) select p.post_id,count(distinct s.sub_id) number_of_comments from post p left join Submissions s on p.post_id = s.parent_id group by 1 order by 1
with post_id as ( select sub_id as post_id from submissions where parent_id is null) , post_comment as ( select a.post_id, b.sub_id as comment_id from post_id a left join (select * from submissions where parent_id is not null) b on a.post_id=b.parent_id) select post_id, count(distinct comment_id) as number_of_comments from post_comment group by post_id
with posts as ( select distinct sub_id as post_id from Submissions where parent_id is null) , comments as ( select parent_id as post_id, sub_id as comment_id from Submissions where parent_id is not null) select posts.post_id, count(distinct comments.comment_id) as number_of_comments from posts left join comments on posts.post_id = comments.post_id group by posts.post_id
with posts as ( select distinct sub_id as post_id from submissions where parent_ID IS Null ) select post_id, count(distinct s.sub_id) as number_of_comments from posts left join submissions s on posts.post_id = s.parent_id group by post_id
with posts as ( select distinct sub_id from Submissions where parent_id is null ), n_comments as ( select parent_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by parent_id ) select a.sub_id as post_id, coalesce(b.number_of_comments, 0) as number_of_comments from posts as a left join n_comments as b on a.sub_id = b.parent_id order by a.sub_id
with posts as ( select distinct sub_id from submissions where parent_id is null ) select p.sub_id post_id, count(distinct c.sub_id) number_of_comments from posts p left join Submissions c on p.sub_id = c.parent_id group by 1
with posts as ( select distinct sub_id from submissions where parent_id is null ), comments as ( select distinct sub_id, parent_id from submissions where parent_id is not null ) select a.sub_id as post_id, count(distinct(b.sub_id)) as number_of_comments from posts a left join comments b on a.sub_id=b.parent_id group by a.sub_id
with posts as (select distinct sub_id as post_id from Submissions where parent_id is null) select post_id, ifnull(count(distinct(sub_id)), 0) as number_of_comments from (select * from posts p left join Submissions s on p.post_id = s.parent_id) a group by post_id order by post_id
with posts as (select distinct sub_id as post_id from Submissions where parent_id is null), B as (select distinct parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions group by parent_id) select posts.post_id, case when number_of_comments is null then 0 else number_of_comments END as number_of_comments from posts left join B on posts.post_id = B.post_id order by posts.post_id
with posts as (select distinct sub_id as post_id from Submissions where parent_id is null), comments as (select distinct parent_id as post_id, count(distinct sub_id) as number_of_comments from Submissions group by post_id) select posts.post_id, ifnull (comments.number_of_comments, 0) as number_of_comments from posts left join comments on posts.post_id= comments.post_id order by post_id
with posts as (select distinct sub_id from submissions where parent_id IS NULL) select posts.sub_id as post_id, count(distinct S.sub_id) as number_of_comments from posts left join (select distinct sub_id, parent_id from submissions where parent_id IS NOT NULL) s on S.parent_id = posts.sub_id group by post_id order by post_id
with posts as (select distinct sub_id from submissions where parent_id is null) select p.sub_id post_id, count(distinct s.sub_id) number_of_comments from posts p left join submissions s on p.sub_id = s.parent_id group by 1 order by 1
with s1 as (select sub_id from submissions where parent_id is null) select s1.sub_id as post_id, count(distinct s2.sub_id) as number_of_comments from s1 left join submissions as s2 on s1.sub_id = s2.parent_id group by s1.sub_id
with scte as ( select distinct sub_id from submissions where parent_id is null ) select t.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from scte t left join submissions s on t.sub_id = s.parent_id group by t.sub_id order by t.sub_id
with step1 as( select * from Submissions where parent_id IS Null), step3 as( select a.sub_id as post_id, b.sub_id as comments from step1 a LEFT join Submissions b on a.sub_id = b.parent_id) select DISTINCT post_id, count(DISTINCT comments) as number_of_comments from step3 group by post_id ORDER BY post_id
with submis as (select distinct sub_id, parent_id from submissions) select a.sub_id as post_id, count(b.sub_id) as number_of_comments from (select distinct sub_id from submis where parent_id is null) a left join submis b on a.sub_id = b.parent_id group by 1 order by 1
with t as ( SELECT DISTINCT combined, sub_id, parent_id FROM ( SELECT CONCAT(sub_id, parent_id) As 'combined', sub_id, parent_id FROM Submissions ) As t0 ) SELECT DISTINCT s.sub_id As post_id, IFNULL(t1.number_of_comments, 0) As number_of_comments FROM Submissions s LEFT JOIN (SELECT parent_id As post_id, COUNT(parent_id) As number_of_comments FROM t WHERE parent_id IN (SELECT sub_id FROM Submissions WHERE parent_id IS NULL) GROUP BY parent_id ) As t1 ON s.sub_id = t1.post_id WHERE s.parent_id IS NULL ORDER BY post_id
with t as ( SELECT s2.parent_id AS post_id, count(DISTINCT s2.sub_id) AS number_of_comments FROM Submissions s2 WHERE s2.parent_id IS NOT NULL GROUP BY post_id), uniq_ids as ( SELECT DISTINCT s1.sub_id as post_id FROM Submissions s1 WHERE s1.parent_id IS NULL) SELECT u.post_id, COALESCE(t.number_of_comments,0) as number_of_comments FROM uniq_ids u LEFT JOIN t ON u.post_id=t.post_id ORDER BY post_id ASC
with t1 as (select distinct sub_id as post_id from submissions where parent_id is null) select post_id, ifnull(count(distinct sub_id),0) as number_of_comments from submissions a right join t1 on a.parent_id=t1.post_id group by 1
with t1 as (select distinct sub_id, parent_id from submissions where parent_id is not null), t2 as (select distinct sub_id as post_id from submissions where parent_id is null), t3 as (select parent_id as post_id, count(*) as number_of_comments from t1 group by parent_id) select t2.post_id, ifnull(number_of_comments,0) as number_of_comments from t2 left join t3 using(post_id) order by t2.post_id
with t_post as ( SELECT distinct * FROM Submissions WHERE parent_id is null ), t_com as ( SELECT * FROM Submissions WHERE parent_id is not null ) select p.sub_id as post_id, count(distinct c.sub_id) as number_of_comments from t_post p left join t_com c on p.sub_id = c.parent_id group by p.sub_id
with tb1 as( select distinct sub_id from Submissions where parent_id is null) select tb1.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from tb1 left join submissions s on tb1.sub_id= s.parent_id group by 1
with temp as ( select * from (select distinct(sub_id) as post_id from submissions where parent_id is null) t1 left join (select parent_id, ifnull(count(distinct(sub_id)),0) as comments from submissions group by parent_id)t2 on t1.post_id = t2.parent_id ) select post_id, ifnull(comments,0) as number_of_comments from temp order by post_id asc
with temp as ( select distinct * from submissions) select s.sub_id as 'post_id', sum(case when s1.parent_id is not null then 1 else 0 end) as 'number_of_comments' from temp s left join temp s1 on s.sub_id = s1.parent_id where s.parent_id is null group by s.sub_id order by s.sub_id
with temp as ( select distinct sub_id as t from submissions where parent_id is null ) select t as post_id, ifnull(count(distinct sub_id),0) as number_of_comments from temp left join submissions on temp.t=submissions.parent_id group by t
with temp as (select distinct sub_id, parent_id from submissions ) select a.sub_id as post_id , coalesce(count(distinct b.sub_id),0) as number_of_comments from (select * from temp where parent_id is null) as a left join (select * from temp) as b on a.sub_id = b.parent_id group by 1 order by 1
with temp as (select t.post_id,count(t.post_id) as number_of_comments from (select parent_id as post_id, sub_id from Submissions where parent_id is not null group by 1,2) t group by 1), temp2 as (select distinct sub_id as post_id from Submissions where parent_id is null) select temp2.post_id, ifnull(temp.number_of_comments,0) as number_of_comments from temp2 left join temp using (post_id) order by 1
with temp as( select distinct s1.sub_id as post_id, s2.sub_id as comment_id from Submissions s1 left join Submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is NULL) select post_id, count(comment_id) as number_of_comments from temp group by post_id order by post_id
with temp as(SELECT s1.sub_id id1, s2.sub_id id2 from Submissions s1 left join submissions s2 on s1.sub_id = s2.parent_id where s1.parent_id is null) select id1 post_id, count(distinct(id2)) number_of_comments from temp group by 1
with temp1 as ( select parent_id, count(distinct sub_id) as number_of_comments from Submissions where parent_id is not null group by parent_id), temp2 as (select distinct sub_id as post_id from Submissions where parent_id is Null group by post_id) select temp2.post_id, ifnull(temp1.number_of_comments,0) as number_of_comments from temp2 left outer join temp1 on temp2.post_id = temp1.parent_id order by temp2.post_id
with tmp as ( select distinct sub_id from submissions where parent_id is null ) select tmp.sub_id as post_id, count(distinct s.sub_id) as number_of_comments from tmp left join submissions s on tmp.sub_id = s.parent_id group by tmp.sub_id
with tmp as (select distinct sub_id from Submissions where parent_id is null) select tmp.sub_id as post_id, count(distinct(s.sub_id)) as number_of_comments from tmp left join Submissions s on tmp.sub_id = s.parent_id group by tmp.sub_id
with tmp as (select sub_id from Submissions where parent_id is null) select tmp.sub_id as post_id, count(distinct(s.sub_id)) as number_of_comments from tmp left join Submissions s on tmp.sub_id = s.parent_id group by tmp.sub_id
with top_posts as (select sub_id as post_id from Submissions where parent_id is null) select post_id, count(distinct s.sub_id) number_of_comments from top_posts as tp left join Submissions as s on tp.post_id = s.parent_id group by post_id
with valid_id as ( select distinct(sub_id) as id from Submissions where parent_id is null ), number_of_comments as( select parent_id as post_id,count(distinct sub_id) as number_cmt from Submissions group by 1) select v.id as post_id,coalesce(number_cmt,0) as number_of_comments from valid_id v left join number_of_comments n on v.id=n.post_id order by 1
with x as ( select parent_id,count(sub_id) as c from (select distinct sub_id,parent_id from submissions) a where parent_id is not null and parent_id in (select distinct sub_id from submissions where parent_id is null) group by 1 ) select distinct(sub_id) as post_id, case when x.c is null then 0 else x.c end as number_of_comments from submissions left join x on submissions.sub_id = x.parent_id where submissions.parent_id is null order by 1
