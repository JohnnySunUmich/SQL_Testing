SELECT * FROM ((SELECT Teams.team_id, Teams.team_name, t2.num_points FROM Teams, (SELECT t1.team_id, SUM(t1.pts) AS 'num_points' FROM (SELECT host_team AS 'team_id', IF(host_goals > guest_goals, 3, IF(host_goals = guest_goals, 1, 0)) AS 'pts' FROM Matches UNION ALL SELECT guest_team AS 'team_id', IF(guest_goals > host_goals, 3, IF(host_goals = guest_goals, 1, 0)) AS 'pts' FROM Matches) t1 GROUP BY t1.team_id) t2 WHERE Teams.team_id = t2.team_id) UNION (SELECT team_id, team_name, 0 AS 'num_points' FROM Teams WHERE team_id NOT IN ( SELECT host_team AS 'team_id' FROM matches UNION SELECT guest_team AS 'team_id' FROM matches))) tlast ORDER BY num_points DESC, team_id ASC
SELECT Agg_guest.team_id, Agg_guest.team_name, (Agg_guest.agg_guest_points + Agg_host.agg_host_points) AS num_points FROM (SELECT Guest.team_id, Guest.team_name, SUM(Guest.guest_points) AS agg_guest_points FROM (SELECT Teams.team_id, Teams.team_name, CASE WHEN Matches.host_goals < Matches.guest_goals THEN 3 WHEN Matches.host_goals = Matches.guest_goals THEN 1 ELSE 0 END AS guest_points FROM Teams LEFT JOIN Matches ON Matches.guest_team = Teams.team_id) AS Guest GROUP BY Guest.team_id) AS Agg_guest JOIN (SELECT Host.team_id, Host.team_name, SUM(Host.host_points) AS agg_host_points FROM (SELECT Teams.team_id, Teams.team_name, CASE WHEN Matches.host_goals > Matches.guest_goals THEN 3 WHEN Matches.host_goals = Matches.guest_goals THEN 1 ELSE 0 END AS host_points FROM Teams LEFT JOIN Matches ON Matches.host_team = Teams.team_id) AS Host GROUP BY Host.team_id) AS Agg_host ON Agg_guest.team_id = Agg_host.team_id ORDER BY num_points DESC, Agg_guest.team_id ASC
SELECT DISTINCT t2.team_id AS team_id, t2.team_name, IFNULL(SUM(scores),0) AS num_points FROM TEAMS t2 LEFT JOIN ((SELECT host_team AS team, guest_team AS comp, (CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 WHEN host_goals<guest_goals THEN 0 END) AS scores FROM Matches) UNION ALL (SELECT guest_team AS team, host_team AS comp, (CASE WHEN host_goals<guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 WHEN host_goals>guest_goals THEN 0 END) AS scores FROM Matches) ) t ON t.team = t2.team_id GROUP BY t2.team_id ORDER BY num_points DESC, t2.team_id ASC
SELECT DISTINCT team_id,team_name, SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=host_team AND host_goals=guest_goals THEN 1 ELSE 0 END)+ SUM(CASE WHEN team_id=guest_team AND host_goals<guest_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=guest_team AND host_goals=guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams LEFT JOIN Matches ON team_id = host_team OR team_id = guest_team GROUP BY team_id,team_name ORDER BY num_points DESC, team_id
SELECT TMP.TEAM_ID, TMP.TEAM_NAME, SUM(TMP.POINTS) AS NUM_POINTS FROM ( SELECT T.TEAM_ID AS TEAM_ID, T.TEAM_NAME AS TEAM_NAME, CASE WHEN (M.HOST_GOALS>M.GUEST_GOALS AND T.TEAM_ID=M.HOST_TEAM) OR (M.HOST_GOALS<M.GUEST_GOALS AND T.TEAM_ID=M.GUEST_TEAM) THEN 3 WHEN (M.HOST_GOALS=M.GUEST_GOALS AND T.TEAM_ID = M.HOST_TEAM) OR (M.HOST_GOALS=M.GUEST_GOALS AND T.TEAM_ID = M.GUEST_TEAM) THEN 1 ELSE 0 END AS POINTS FROM TEAMS T, MATCHES M ) AS TMP GROUP BY TMP.TEAM_ID, TMP.TEAM_NAME ORDER BY 3 DESC,1
SELECT Teams.team_id,team_name,IFNULL(SUM(score),0) AS num_points FROM Teams LEFT JOIN (SELECT host_team AS team_id, CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END AS score FROM Matches UNION ALL SELECT guest_team AS team_id, CASE WHEN host_goals<guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END AS score FROM Matches) T ON T.team_id = Teams.team_id GROUP BY team_id ORDER BY num_points desc, team_id asc
SELECT a.team_id, a.team_name, COALESCE( SUM(CASE WHEN a.team_id=m.host_team AND host_goals > guest_goals THEN 3 WHEN a.team_id=m.guest_team AND guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END), 0 ) AS num_points FROM Teams a LEFT JOIN Matches m ON a.team_id=m.host_team OR a.team_id=m.guest_team GROUP BY a.team_id, a.team_name ORDER BY num_points DESC, a.team_id ASC
SELECT a.team_id, a.team_name, COALESCE(SUM(t.num_points),0) AS num_points FROM Teams a LEFT JOIN ( SELECT host_team AS team_id, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Matches GROUP BY host_team UNION ALL SELECT guest_team AS team_id, SUM(CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END) AS num_points FROM Matches GROUP BY guest_team ) t ON t.team_id=a.team_id GROUP BY t.team_id, a.team_name ORDER BY num_points DESC, a.team_id ASC
SELECT a.team_id, a.team_name, sum(a.score) AS num_points FROM ( select t.team_id, t.team_name, m.match_id, m.host_team, m.guest_team, m.host_goals , m.guest_goals, case WHEN m.match_id IS NOT NULL AND t.team_id = m.host_team AND m.host_goals > m.guest_goals then 3 WHEN m.match_id IS NOT NULL AND t.team_id = m.guest_team AND m.guest_goals > m.host_goals THEN 3 when m.match_id IS NOT NULL AND (t.team_id = m.host_team OR T.team_id = m.guest_team) AND m.host_goals = m.guest_goals THEN 1 ELSE 0 END AS score from Teams t left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team order by t.team_id) a GROUP BY a.team_id, a.team_name ORDER BY num_points DESC, a.team_id asc
SELECT b.team_id ,b.team_name ,SUM(IF(b.team_id = a.host_team AND a.host_goals > a.guest_goals,3,0)) + SUM(IF(b.team_id = a.guest_team AND a.host_goals < a.guest_goals,3,0)) + SUM(IF(b.team_id = a.host_team AND a.host_goals = a.guest_goals,1,0)) + SUM(IF(b.team_id = a.guest_team AND a.host_goals = a.guest_goals,1,0)) AS num_points FROM Matches a RIGHT JOIN Teams b ON a.host_team = b.team_id OR a.guest_team = b.team_id GROUP BY b.team_id ORDER BY num_points DESC ,b.team_id
SELECT distinct T.team_id, team_name, CASE WHEN score is not null THEN SUM(score) over (partition by team_id) ELSE 0 END as num_points FROM Teams T LEFT JOIN ( SELECT match_id, host_team as team_id, (CASE WHEN host_goals>guest_goals then 3 WHEN host_goals=guest_goals then 1 WHEN host_goals<guest_goals then 0 else 0 end ) as score FROM Matches UNION SELECT match_id, guest_team as team_id, (CASE WHEN guest_goals>host_goals then 3 WHEN host_goals=guest_goals then 1 WHEN guest_goals<host_goals then 0 else 0 end ) as score FROM Matches) A on A.team_id=T.team_id ORDER BY num_points desc, t.team_id asc
SELECT t.team_id ,t.team_name ,SUM( CASE WHEN t.team_id = m.host_team AND host_goals > guest_goals THEN 3 WHEN t.team_id = m.guest_team AND host_goals < guest_goals THEN 3 WHEN t.team_id IN (m.guest_team,m.host_team) AND host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY 1 ORDER BY 3 DESC, 1
SELECT t.team_id ,t.team_name ,SUM(CASE WHEN (t.team_id = m.host_team AND m.host_goals > m.guest_goals) OR (t.team_id = m.guest_team AND m.guest_goals > m.host_goals) THEN 3 WHEN m.host_goals = m.guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id ORDER BY num_points DESC, team_id
SELECT t.team_id ,t.team_name ,SUM(CASE WHEN t.team_id = m.host_team AND m.host_goals > m.guest_goals THEN 3 WHEN t.team_id = m.host_team AND m.host_goals < m.guest_goals THEN 0 WHEN t.team_id = m.host_team AND m.host_goals = m.guest_goals THEN 1 WHEN t.team_id = m.guest_team AND m.host_goals < m.guest_goals THEN 3 WHEN t.team_id = m.guest_team AND m.host_goals > m.guest_goals THEN 0 WHEN t.team_id = m.guest_team AND m.host_goals = m.guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY 1 ORDER BY 3 DESC,1
SELECT t.team_id, t.team_name, ( SUM(IF(t.team_id = m.host_team AND m.host_goals > m.guest_goals, 3, 0)) + SUM(IF(t.team_id = m.guest_team AND m.guest_goals > m.host_goals, 3, 0)) + SUM(IF(m.guest_goals = m.host_goals, 1, 0)) ) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id ORDER BY num_points DESC, team_id ASC
SELECT t.team_id, t.team_name, (SUM(IF(t.team_id=m.host_team AND m.host_goals>m.guest_goals, 3, 0)) + SUM(IF(t.team_id=m.guest_team AND m.guest_goals>m.host_goals, 3, 0)) + SUM(IF(m.guest_goals=m.host_goals, 1, 0)) ) AS num_points FROM Teams t LEFT JOIN Matches m ON m.host_team = t.team_id OR m.guest_team = t.team_id GROUP BY t.team_id ORDER BY num_points DESC, team_id ASC
SELECT t.team_id, t.team_name, COALESCE(SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 END ), 0) AS num_points FROM teams t LEFT JOIN matches m ON t.team_id IN (host_team, guest_team) GROUP BY t.team_id, t.team_name ORDER BY 3 DESC, 1 ASC
SELECT t.team_id, t.team_name, IFNULL(SUM(CASE WHEN team_id=host_team and host_goals>guest_goals THEN 3 WHEN team_id=guest_team and host_goals<guest_goals THEN 3 WHEN team_id=host_team and host_goals<guest_goals THEN 0 WHEN team_id=guest_team and host_goals>guest_goals THEN 0 WHEN team_id=host_team and host_goals=guest_goals THEN 1 WHEN team_id=guest_team and host_goals=guest_goals THEN 1 END), 0) AS num_points FROM Teams as t LEFT JOIN Matches as m ON t.team_id=m.host_team or t.team_id=m.guest_team GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, t.team_id
SELECT t.team_id, t.team_name, IFNULL(SUM(num_points), 0) as num_points FROM Teams t LEFT JOIN (( SELECT team_id, SUM(CASE WHEN Matches.host_goals > Matches.guest_goals THEN 3 WHEN Matches.host_goals = Matches.guest_goals THEN 1 ELSE 0 END) as num_points FROM Teams, Matches WHERE Teams.team_id = Matches.host_team GROUP BY Teams.team_id, Teams.team_name ) UNION ALL ( SELECT team_id, SUM(CASE WHEN Matches.guest_goals > Matches.host_goals THEN 3 WHEN Matches.guest_goals = Matches.host_goals THEN 1 ELSE 0 END) as num_points FROM Teams, Matches WHERE Teams.team_id = Matches.guest_team GROUP BY Teams.team_id, Teams.team_name )) goals ON t.team_id = goals.team_id GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, t.team_id
SELECT t.team_id, t.team_name, IFNULL(SUM(num_points),0) AS num_points FROM (SELECT host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches UNION ALL SELECT guest_team AS team_id, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches) AS l RIGHT JOIN Teams t ON l.team_id = t.team_id GROUP BY t.team_id ORDER BY 3 DESC, 1
SELECT t.team_id, t.team_name, IFNULL(SUM(tmp.num_points), 0) num_points FROM Teams t LEFT JOIN ( SELECT host_team team_id, sum(case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end) num_points FROM Matches GROUP BY team_id UNION ALL SELECT guest_team team_id, sum(case when guest_goals > host_goals then 3 when guest_goals < host_goals then 0 else 1 end) num_points FROM Matches GROUP BY team_id ) tmp ON t.team_id = tmp.team_id GROUP BY t.team_id ORDER BY num_points DESC, t.team_id
SELECT t.team_id, t.team_name, SUM( CASE WHEN t.team_id = m.host_team AND m.host_goals > m.guest_goals THEN 3 WHEN t.team_id = m.host_team AND m.host_goals = m.guest_goals THEN 1 WHEN t.team_id = m.guest_team AND m.guest_goals > m.host_goals THEN 3 WHEN t.team_id = m.guest_team AND m.guest_goals = m.host_goals THEN 1 ELSE 0 END ) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id ORDER BY num_points DESC, t.team_id ASC
SELECT t.team_id, t.team_name, SUM( CASE WHEN t.team_id=m.host_team AND m.host_goals>m.guest_goals THEN 3 WHEN t.team_id=m.guest_team AND m.host_goals<m.guest_goals THEN 3 WHEN m.host_goals=m.guest_goals THEN 1 ELSE 0 END ) num_points FROM Teams t LEFT JOIN Matches m on t.team_id=m.host_team OR t.team_id=m.guest_team GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, team_id ASC
SELECT t.team_id, t.team_name, SUM(CASE WHEN (t.team_id = host_team and host_goals > guest_goals) OR (t.team_id = guest_team and host_goals < guest_goals) THEN 3 ELSE 0 END) + SUM(CASE WHEN (t.team_id = host_team and host_goals = guest_goals) OR (t.team_id = guest_team and host_goals = guest_goals) THEN 1 ELSE 0 END) as num_points FROM Teams t, Matches m GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, t.team_id
SELECT t.team_id, t.team_name, SUM(CASE WHEN host_goals > guest_goals AND t.team_id = host_team THEN 3 WHEN host_goals < guest_goals AND t.team_id = guest_team THEN 3 WHEN host_goals = guest_goals AND (t.team_id = host_team OR t.team_id = guest_team) THEN 1 ELSE 0 END) AS num_points FROM teams t LEFT JOIN matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id , t.team_name ORDER BY num_points DESC , team_id ASC
SELECT t.team_id, t.team_name, SUM(CASE WHEN m.host_team = t.team_id AND m.host_goals > m.guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN m.host_team = t.team_id AND m.host_goals = m.guest_goals THEN 1 ELSE 0 END) + SUM(CASE WHEN m.guest_team = t.team_id AND m.host_goals < m.guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN m.guest_team = t.team_id AND m.host_goals = m.guest_goals THEN 1 ELSE 0 END) AS num_points FROM teams t LEFT JOIN matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id ORDER BY num_points DESC, team_id ASC
SELECT t.team_id, t.team_name, SUM(CASE WHEN pts IS NULL THEN 0 ELSE pts END) AS num_points FROM Teams AS t LEFT JOIN (SELECT host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 WHEN host_goals < guest_goals THEN 0 END AS pts FROM Matches UNION ALL SELECT guest_team AS team_id, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 WHEN guest_goals < host_goals THEN 0 END AS pts FROM Matches) AS all_matches ON t.team_id = all_matches.team_id GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, t.team_id
SELECT t.team_id, t.team_name, SUM(CASE WHEN t.team_id = m.host_team AND m.host_goals > m.guest_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN t.team_id = m.guest_team AND m.guest_goals > m.host_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN t.team_id = m.host_team AND m.host_goals = m.guest_goals THEN 1 ELSE 0 END)+ SUM(CASE WHEN t.team_id = m.guest_team AND m.guest_goals = m.host_goals THEN 1 ELSE 0 END) AS num_points FROM Teams AS t LEFT JOIN Matches AS m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id ORDER BY num_points DESC, t.team_id ASC
SELECT t.team_id, t.team_name, SUM(CASE WHEN t.team_id = m.host_team AND m.host_goals > m.guest_goals then 3 WHEN t.team_id = m.guest_team AND m.host_goals < m.guest_goals then 3 WHEN m.host_goals = m.guest_goals then 1 ELSE 0 END ) as "num_points" FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team or t.team_id = m.guest_team GROUP BY t.team_id, t.team_name Order BY num_points DESC, team_id ASC
SELECT t.team_id, t.team_name, SUM(CASE WHEN t.team_id=m.host_team and m.host_goals>m.guest_goals THEN 3 WHEN t.team_id=m.guest_team and m.guest_goals>m.host_goals THEN 3 WHEN (t.team_id=m.host_team or t.team_id=m.guest_team) and m.host_goals=m.guest_goals THEN 1 ELSE 0 END ) AS num_points FROM teams t JOIN matches m GROUP BY t.team_id ORDER BY num_points DESC, t.team_id
SELECT t.team_id, t.team_name, SUM(IF(team_id = host_team AND host_goals > guest_goals, 3, 0))+ SUM(IF(team_id = guest_team AND host_goals < guest_goals, 3, 0))+ SUM(IF(team_id = host_team AND host_goals = guest_goals, 1, 0))+ SUM(IF(team_id = guest_team AND host_goals = guest_goals, 1, 0)) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY t.team_id ORDER BY num_points DESC, team_id
SELECT t.team_id, t.team_name, sum(case when t.team_id=host_team and host_goals>guest_goals then 3 when t.team_id=host_team and host_goals=guest_goals then 1 when t.team_id=guest_team and host_goals<guest_goals then 3 when t.team_id=guest_team and host_goals=guest_goals then 1 else 0 end) as num_points from matches m right join teams t on t.team_id =host_team or t.team_id=guest_team group by 1,2 order by num_points desc,team_id asc
SELECT t.team_id, team_name, COALESCE(num_points, 0) as num_points FROM Teams t LEFT JOIN ( SELECT team_id, SUM(num_points) as num_points FROM ( SELECT host_team as team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END as num_points FROM Matches m1 UNION ALL SELECT guest_team as team_id, CASE WHEN host_goals = guest_goals THEN 1 WHEN host_goals < guest_goals THEN 3 ELSE 0 END as num_points FROM Matches m2 ) test GROUP BY team_id ) test1 ON test1.team_id = t.team_id ORDER BY num_points DESC, t.team_id ASC
SELECT t.team_id,t.team_name, SUM( CASE WHEN (t.team_id = m.host_team AND host_goals > guest_goals ) OR (t.team_id = m.guest_team AND guest_goals > host_goals) THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END ) AS num_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY team_id,team_id ORDER BY num_points desc,team_id
SELECT t1.team_id, t1.team_name, SUM(CASE WHEN t1.team_id = t2.host_team AND t2.host_goals > t2.guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN t1.team_id = t2.guest_team AND t2.host_goals < t2.guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN t1.team_id = t2.host_team AND t2.host_goals = t2.guest_goals THEN 1 ELSE 0 END) + SUM(CASE WHEN t1.team_id = t2.guest_team AND t2.host_goals = t2.guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams t1 LEFT JOIN Matches t2 ON t1.team_id = t2.host_team OR t1.team_id = t2.guest_team GROUP BY t1.team_id ORDER BY num_points DESC, team_id
SELECT team_id ,team_name ,SUM(points) AS num_points FROM ( ( SELECT t1.team_id ,t1.team_name ,SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS points FROM Teams t1 LEFT JOIN Matches m1 ON t1.team_id = m1.host_team GROUP BY t1.team_id ) UNION ALL ( SELECT t2.team_id ,t2.team_name ,SUM(CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END) AS points FROM Teams t2 LEFT JOIN Matches m2 ON t2.team_id = m2.guest_team GROUP BY t2.team_id ) ) n GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
SELECT team_id, team_name, COALESCE(SUM(CASE WHEN T.team_id = M.HOST_TEAM AND host_goals > guest_goals THEN 3 WHEN T.team_id = M.guest_team AND guest_goals > host_goals THEN 3 WHEN T.team_id = M.guest_team AND guest_goals = host_goals THEN 1 WHEN T.team_id = M.HOST_TEAM AND host_goals = guest_goals THEN 1 ELSE 0 END),0) AS NUM_POINTS FROM TEAMS T LEFT JOIN MATCHES M ON T.team_id = M.HOST_TEAM OR T.team_id = M.guest_team GROUP BY 1 ORDER BY 3 DESC, 1 ASC
SELECT team_id, team_name, SUM( CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END ) AS "num_points" FROM Teams AS t LEFT JOIN Matches m ON t.team_id = m.host_team or t.team_id = m.guest_team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM( CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END ) AS "num_points" FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY team_id ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM( CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END ) AS "num_points" FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM( CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 WHEN team_id = host_team AND host_goals = guest_goals THEN 1 WHEN team_id = guest_team AND guest_goals = host_goals THEN 1 ELSE 0 END ) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM( CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = host_team AND host_goals = guest_goals THEN 1 WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 WHEN team_id = guest_team AND host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams AS t LEFT JOIN Matches AS m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY team_id, team_name ORDER BY num_points DESC,team_id
SELECT team_id, team_name, SUM(CASE WHEN m.host_goals > m.guest_goals AND t.team_id=m.host_team THEN 3 WHEN m.guest_goals > m.host_goals AND t.team_id=m.guest_team THEN 3 WHEN m.host_goals = m.guest_goals AND (t.team_id = m.guest_team OR t.team_id = m.host_team) THEN 1 ELSE 0 END ) AS num_points FROM Teams t INNER JOIN Matches m GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM(CASE WHEN t.team_id=m.host_team AND host_goals>guest_goals THEN 3 WHEN t.team_id=m.guest_team AND host_goals<guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 else 0 END) AS num_points FROM Teams as t LEFT JOIN Matches as m ON t.team_id=m.host_team or t.team_id=m.guest_team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = host_team AND host_goals = guest_goals THEN 1 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND guest_goals = host_goals THEN 1 ELSE 0 END) AS num_points FROM Teams LEFT JOIN Matches ON team_id = host_team OR team_id = guest_team GROUP BY team_id ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = host_team AND host_goals = guest_goals THEN 1 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams LEFT JOIN Matches ON team_id = host_team OR team_id = guest_team GROUP BY team_id ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = host_team AND host_goals = guest_goals THEN 1 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams LEFT JOIN Matches ON team_id = host_team or team_id = guest_team GROUP BY team_id ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 ELSE 0 END) + SUM(CASE WHEN team_id = host_team AND host_goals = guest_goals THEN 1 ELSE 0 END)+ SUM(CASE WHEN team_id = guest_team AND host_goals = guest_goals THEN 1 ELSE 0 END) as num_points FROM Teams as t LEFT JOIN Matches as m ON t.team_id = m.host_team OR t.team_id = m.guest_team GROUP BY team_id ORDER BY num_points DESC, team_id
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) num_points FROM Teams T1 LEFT JOIN Matches M1 ON T1.team_id = M1.host_team OR T1.team_id = M1.guest_team GROUP BY team_id ORDER BY num_points DESC,team_id
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND host_goals < guest_goals THEN 3 WHEN team_id = host_team AND host_goals = guest_goals THEN 1 WHEN team_id = guest_team AND host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Teams JOIN Matches GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM(CASE WHEN team_id = host_team AND host_goals>guest_goals THEN 3 ELSE 0 END)+SUM(CASE WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 ELSE 0 END )+SUM(CASE WHEN team_id = host_team AND host_goals = guest_goals THEN 1 ELSE 0 END) + SUM(CASE WHEN team_id = guest_team AND host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM teams LEFT JOIN matches ON team_id = host_team OR team_id = guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM(CASE WHEN temp.point IS NULL THEN 0 ELSE temp.point END) as num_points FROM Teams as t LEFT JOIN ((SELECT host_team as team, CASE WHEN host_goals>guest_goals then 3 WHEN host_goals=guest_goals then 1 ELSE 0 END as point FROM Matches ) UNION ALL (SELECT guest_team as team, CASE WHEN host_goals<guest_goals then 3 WHEN host_goals=guest_goals then 1 ELSE 0 END as point FROM Matches )) as temp ON t.team_id = temp.team GROUP BY team_id ORDER BY num_points DESC,team_id
SELECT team_id, team_name, SUM(IF(team_id = host_team AND host_goals > guest_goals, 3, 0)) + SUM(IF(team_id = guest_team AND guest_goals > host_goals, 3, 0)) + SUM(IF(team_id = host_team AND host_goals = guest_goals, 1, 0)) + SUM(IF(team_id = guest_team AND guest_goals = host_goals, 1, 0)) AS num_points FROM Teams LEFT JOIN Matches ON Teams.team_id = Matches.host_team OR Teams.team_id = Matches.guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM(if(scores is null,0,scores)) as num_points FROM Teams t LEFT JOIN ((SELECT host_team AS team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals < guest_goals THEN 0 ELSE 1 END AS scores FROM Matches m) UNION ALL (SELECT guest_team AS team, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals < guest_goals THEN 3 ELSE 1 END AS scores FROM Matches m)) totalscore ON t.team_id = totalscore.team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, SUM(num_points) AS num_points FROM ( SELECT t.team_id AS team_id, t.team_name AS team_name, CASE WHEN m.host_goals > m.guest_goals THEN 3 WHEN m.host_goals = m.guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches m RIGHT JOIN Teams t ON m.host_team = t.team_id UNION ALL SELECT t.team_id AS team_id, t.team_name AS team_name, CASE WHEN m.guest_goals > m.host_goals THEN 3 WHEN m.guest_goals = m.host_goals THEN 1 ELSE 0 END AS num_points FROM Matches m RIGHT JOIN Teams t ON m.guest_team = t.team_id ) sub GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id, team_name, sum(CASE WHEN team_id=host_team AND host_goals> guest_goals THEN 3 ELSE 0 END)+ sum(CASE WHEN team_id=host_team AND host_goals= guest_goals THEN 1 ELSE 0 END)+ sum(CASE WHEN team_id=guest_team AND guest_goals> host_goals THEN 3 ELSE 0 END)+ sum(CASE WHEN team_id=guest_team AND guest_goals= host_goals THEN 1 ELSE 0 END) as num_points FROM Teams t LEFT JOIN Matches m ON m.host_team=t.team_id or m.guest_team=t.team_id GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id,team_name, CASE WHEN SUM(num_points) >0 THEN SUM(num_points) ELSE 0 END as num_points from ( SELECT host_team as team, SUM(CASE WHEN (host_goals-guest_goals)>=1 THEN 3 WHEN (host_goals=guest_goals) THEN 1 ELSE 0 END) as num_points FROM Matches GROUP BY host_team UNION ALL SELECT guest_team as team, SUM(CASE WHEN (guest_goals-host_goals)>=1 THEN 3 WHEN (host_goals=guest_goals) THEN 1 ELSE 0 END) as num_points FROM Matches GROUP BY guest_team )a RIGHT JOIN Teams on Teams.team_id = a.team group by team_id order by num_points desc, team_id
SELECT team_id,team_name, COALESCE(SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 WHEN team_id=host_team AND host_goals=guest_goals THEN 1 WHEN team_id=guest_team AND guest_goals=host_goals THEN 1 ELSE 0 END), 0) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id,team_name, IFNULL(SUM( CASE WHEN T.team_id=M.host_team AND host_goals>guest_goals THEN 3 WHEN T.team_id=M.host_team AND host_goals<guest_goals THEN 0 WHEN T.team_id=M.guest_team AND host_goals>guest_goals THEN 0 WHEN T.team_id=M.guest_team AND host_goals<guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 END ),0) AS num_points FROM Teams AS T LEFT JOIN Matches AS M ON T.team_id = M.host_team OR T.team_id=m.guest_team GROUP BY team_id,team_name ORDER By num_points DESC,team_id
SELECT team_id,team_name, IFNULL(SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 WHEN team_id=host_team AND host_goals<guest_goals THEN 0 WHEN team_id=guest_team AND guest_goals<host_goals THEN 0 WHEN guest_goals=host_goals THEN 1 END),0) AS num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
SELECT team_id,team_name, IFNULL(SUM(score),0) AS num_points FROM Teams LEFT JOIN ( SELECT host_team team, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS score FROM Matches GROUP BY host_team UNION ALL SELECT guest_team team, SUM(CASE WHEN guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS score FROM Matches GROUP BY guest_team ) t ON Teams.team_id = t.team GROUP BY team_id,team_name ORDER BY num_points DESC, team_id
SELECT team_id,team_name, SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id in (host_team, guest_team) AND host_goals=guest_goals THEN 1 ELSE 0 END) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id,team_name, SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 ELSE 0 END)+ SUM(CASE WHEN team_id=host_team AND host_goals=guest_goals THEN 1 ELSE 0 END)+ SUM(CASE WHEN team_id=guest_team AND guest_goals=host_goals THEN 1 ELSE 0 END) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id,team_name, SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 WHEN team_id=host_team AND host_goals=guest_goals THEN 1 WHEN team_id=guest_team AND guest_goals=host_goals THEN 1 ELSE 0 END) AS num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id,team_name, SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 WHEN team_id=host_team AND host_goals=guest_goals THEN 1 WHEN team_id=guest_team AND guest_goals=host_goals THEN 1 ELSE 0 END) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
SELECT team_id,team_name, ifnull(SUM(CASE WHEN team_id=host_team AND host_goals>guest_goals THEN 3 WHEN team_id=guest_team AND guest_goals>host_goals THEN 3 WHEN team_id=host_team AND host_goals<guest_goals THEN 0 WHEN team_id=guest_team AND guest_goals<host_goals THEN 0 WHEN guest_goals=host_goals THEN 1 END),0) AS num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
SELECT team_id,team_name, sum(CASE WHEN host_goals > guest_goals AND o.host_team = t.team_id THEN 3 WHEN host_goals < guest_goals AND o.guest_team = t.team_id THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM matches o RIGHT JOIN Teams t ON o.host_team = t.team_id OR o.guest_team = t.team_id GROUP BY team_id ORDER BY num_points DESC, team_id
SELECT team_id,team_name, sum(case when team_id=host_team and host_goals>guest_goals then 3 else 0 end) + sum(case when team_id=guest_team and guest_goals>host_goals then 3 else 0 end) + sum(case when team_id=host_team and host_goals=guest_goals then 1 else 0 end) + sum(case when team_id=guest_team and host_goals=guest_goals then 1 else 0 end) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team group by team_id order by num_points desc, team_id asc
SELECT team_id,team_name,(IFNULL(host_points,0)+IFNULL(guest_points,0)) AS num_points FROM Teams t LEFT JOIN (SELECT host_team, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS host_points FROM Matches GROUP BY host_team) h ON t.team_id=h.host_team LEFT JOIN (SELECT guest_team, SUM(CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS guest_points FROM Matches GROUP BY guest_team) g ON t.team_id=g.guest_team ORDER BY num_points DESC, team_id
SELECT teams.team_id, teams.team_name, SUM(CASE WHEN sub.guest_host = 'tie' THEN 1 WHEN sub.host_team = teams.team_id AND guest_host = 'host' THEN 3 WHEN sub.guest_team = teams.team_id AND guest_host = 'guest' THEN 3 ELSE 0 END) as num_points FROM teams LEFT JOIN (SELECT *,CASE WHEN matches.host_goals > matches.guest_goals THEN 'host' WHEN matches.host_goals = matches.guest_goals THEN 'tie' ELSE 'guest' END as guest_host FROM matches) sub ON sub.host_team = teams.team_id OR sub.guest_team = teams.team_id GROUP BY 1,2 ORDER BY 3 desc,1 asc
SELECT teams.team_id, teams.team_name, ifnull(sum(score),0) as num_points FROM ( SELECT host_team as team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS score FROM matches UNION ALL SELECT guest_team as team_id, CASE WHEN guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS score FROM matches) temp RIGHT JOIN teams on temp.team_id = teams.team_id GROUP BY team_id, team_name ORDER BY num_points desc, team_id asc
Select M1.team_id, M1.team_name, sum(M1.Num_points) as num_points From (select t.team_id, t.team_name, (case when t.team_id = M.host_team and M.host_goals > M.guest_goals then 3 else 0 end) + (Case when t.team_id = M.host_team and M.host_goals = M.guest_goals then 1 else 0 end) + (case when t.team_id = M.guest_team and M.host_goals < M.guest_goals then 3 else 0 end) + (Case when t.team_id = M.guest_team and M.host_goals = M.guest_goals then 1 else 0 end) as Num_points from Teams t left join Matches M on (t.team_id = M.host_team) or (t.team_id = M.guest_team)) M1 group by M1.team_id,M1.team_name order by Num_points desc, team_id
Select Teams.team_id as team_id, Teams.team_name, Ifnull(Sum(score), 0) as num_points From Teams Left Join ( (Select host_team as team, Case When host_goals>guest_goals Then 3 When host_goals=guest_goals Then 1 Else 0 End as score From Matches) Union All (Select guest_team as team, Case When host_goals>guest_goals Then 0 When host_goals=guest_goals Then 1 Else 3 End as score From Matches)) as Team_Score On Teams.team_id = Team_Score.team Group By Teams.team_id Order By num_points Desc, team_id
Select b.team_id as team_id, b.team_name, sum(ifnull(temp.score,0)) as num_points From ((Select host_team as team, (Case When host_goals > guest_goals Then 3 When guest_goals > host_goals Then 0 Else 1 End) as score From Matches) Union All (Select guest_team as team, (Case When host_goals > guest_goals Then 0 When guest_goals > host_goals Then 3 Else 1 End) as score From Matches)) as temp Right Join Teams as b On temp.team = b.team_id Group By temp.team, b.team_name Order By num_points DESC, team_id ASC
Select t.team_id, t.team_name, ifnull(sum(points),0) num_points from Teams t left join ( Select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as points from Matches union all Select guest_team as team_id, case when host_goals > guest_goals then 0 when host_goals < guest_goals then 3 else 1 end as points from Matches ) temp on t.team_id = temp.team_id group by 1 order by 3 desc,1
Select team_id, team_name, ifnull(Sum(Case When host_goals > guest_goals And team_id=host_team Then 3 When host_goals > guest_goals And team_id=guest_team Then 0 When host_goals < guest_goals And team_id=host_team Then 0 When host_goals < guest_goals And team_id=guest_team Then 3 When host_goals = guest_goals And team_id=guest_team Then 1 When host_goals = guest_goals And team_id=host_team Then 1 End),0) num_points From Teams t Left join Matches m on t.team_id = m.host_team OR t.team_id = m.guest_team Group by team_id Order by num_points DESC, team_id ASC
Select team_id, team_name, sum(case when team_id = host_team And host_goals> guest_goals then 3 else 0 end) + sum(case when team_id = host_team And host_goals = guest_goals then 1 else 0 end) + sum(case when team_id = guest_team And guest_goals > host_goals then 3 else 0 end) + sum(case when team_id = guest_team And guest_goals = host_goals then 1 else 0 end) as num_points from Teams left join Matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id asc
Select team_id, team_name, sum(case when team_id = host_team And host_goals> guest_goals then 3 else 0 end) + sum(case when team_id = host_team And host_goals = guest_goals then 1 else 0 end) + sum(case when team_id = guest_team And guest_goals > host_goals then 3 else 0 end) + sum(case when team_id = guest_team And guest_goals = host_goals then 1 else 0 end) as num_points from Teams t left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by team_id order by num_points desc, team_id asc
WITH CET AS (SELECT host_team AS team_id, (CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS num_points FROM Matches UNION ALL SELECT guest_team, (CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END) AS num_points FROM Matches) SELECT T.team_id, team_name, IFNULL(SUM(num_points), 0) AS num_points FROM CET C RIGHT JOIN Teams T ON C.team_id = T.team_id GROUP BY T.team_id ORDER BY 3 DESC, 1
WITH CTE AS ( SELECT host_team AS team_id, (CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS points FROM matches UNION ALL SELECT guest_team AS team_id, (CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END) AS points FROM matches ), CTE2 AS ( SELECT team_id, SUM(points) AS win_lose_score FROM CTE GROUP BY team_id ) SELECT t.team_id, t.team_name, COALESCE(c.win_lose_score, 0) AS num_points FROM Teams t LEFT JOIN CTE2 c ON t.team_id = c.team_id ORDER BY num_points DESC, team_id ASC
WITH CTE AS ( SELECT host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches UNION ALL SELECT guest_team AS team_id, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches ), CTE1 AS ( SELECT team_id, SUM(num_points) AS num_points FROM CTE GROUP BY team_id ) SELECT T.team_id, T.team_name, IFNULL(C.num_points,0) AS num_points FROM Teams T LEFT JOIN CTE1 C ON T.team_id = C.team_id ORDER BY num_points DESC, team_id ASC
WITH CTE AS( SELECT TM,SUM(SCORE) AS SC FROM( SELECT HOST_TEAM AS TM, CASE WHEN HOST_GOALS>GUEST_GOALS THEN 3 WHEN HOST_GOALS=GUEST_GOALS THEN 1 ELSE 0 END AS SCORE FROM MATCHES UNION ALL SELECT GUEST_TEAM AS TM, CASE WHEN HOST_GOALS<GUEST_GOALS THEN 3 WHEN HOST_GOALS=GUEST_GOALS THEN 1 ELSE 0 END AS SCORE FROM MATCHES ) X GROUP BY TM ) SELECT TEAM_ID,TEAM_NAME,COALESCE(SC,0) AS NUM_POINTS FROM TEAMS LEFT JOIN CTE ON TEAMS.TEAM_ID=CTE.TM ORDER BY NUM_POINTS DESC,TEAM_ID
WITH CTE1 AS ( SELECT match_id, host_team, guest_team, (CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END) AS host_pts, (CASE WHEN host_goals>guest_goals THEN 0 WHEN host_goals=guest_goals THEN 1 ELSE 3 END) AS guest_pts FROM Matches), CTE2 AS ( SELECT host_team AS team, host_pts AS pts FROM CTE1 UNION ALL SELECT guest_team, guest_pts FROM CTE1), CTE3 AS ( SELECT team, SUM(pts) AS num_points FROM CTE2 GROUP BY team) SELECT Teams.team_id, team_name, IFNULL(num_points, 0) AS num_points FROM Teams LEFT JOIN CTE3 ON Teams.team_id = CTE3.team ORDER BY num_points DESC, team_id
WITH CTE1 AS (SELECT match_id, host_team, guest_team, host_goals, guest_goals FROM matches UNION SELECT match_id+5 as match_id, guest_team, host_team, guest_goals, host_goals FROM matches), CTE2 AS (SELECT match_id, host_team, guest_team, host_goals, guest_goals, CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END as points FROM CTE1) SELECT team_id, team_name, COALESCE(sum(Points),0) as num_points FROM TEAMS a LEFT JOIN CTE2 b ON host_team=team_id GROUP BY team_id ORDER BY num_points desc, team_id
WITH CTE_1 AS ( SELECT HOST_TEAM, SUM( CASE WHEN HOST_GOALS > GUEST_GOALS THEN 3 WHEN HOST_GOALS = GUEST_GOALS THEN 1 ELSE 0 END ) AS HOST_POINTS FROM MATCHES GROUP BY HOST_TEAM ) ,CTE_2 AS ( SELECT GUEST_TEAM, SUM( CASE WHEN GUEST_GOALS > HOST_GOALS THEN 3 WHEN GUEST_GOALS = HOST_GOALS THEN 1 ELSE 0 END ) AS GUEST_POINTS FROM MATCHES GROUP BY GUEST_TEAM ) ,CTE_3 AS ( SELECT C1.HOST_TEAM, COALESCE(HOST_POINTS, 0) + COALESCE(GUEST_POINTS, 0) NUM_POINTS FROM CTE_1 C1 LEFT OUTER JOIN CTE_2 C2 ON C1.HOST_TEAM = C2.GUEST_TEAM UNION SELECT C2.GUEST_TEAM, COALESCE(HOST_POINTS, 0) + COALESCE(GUEST_POINTS, 0) NUM_POINTS FROM CTE_1 C1 RIGHT OUTER JOIN CTE_2 C2 ON C1.HOST_TEAM = C2.GUEST_TEAM ) SELECT T.TEAM_ID, T.TEAM_NAME, COALESCE(NUM_POINTS, 0) NUM_POINTS FROM TEAMS T LEFT OUTER JOIN CTE_3 C ON T.TEAM_ID = C.HOST_TEAM ORDER BY NUM_POINTS DESC, T.TEAM_ID ASC
WITH CTE_POINTS AS( Select host_team as team_id, CASE WHEN host_goals>guest_goals then 3 WHEN host_goals= guest_goals then 1 else 0 end as score from Matches UNION ALL Select guest_team as team_id,CASE WHEN guest_goals>host_goals then 3 WHEN guest_goals=host_goals then 1 else 0 end as score from Matches ), CTE_SUMSCORE AS ( Select team_id,sum(score) as score from CTE_POINTS group by team_id ) Select t.team_id,t.team_name,IFNULL(s.score,0) num_points from teams t left join CTE_SUMSCORE s on t.team_id = s.team_id order by num_points desc,team_id
WITH Match_Score as ( select host_team, guest_team, host_goals, guest_goals, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END as host_score, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END as guest_score from Matches ), Team_Score as ( select host_team as team_id, host_score as team_score from Match_Score UNION ALL select guest_team as team_id, guest_score as team_score from Match_Score ) Select t.team_id, t.team_name, ifnull(sum(ts.team_score),0) as num_points from Teams as t LEFT JOIN team_score as ts on t.team_id = ts.team_id group by t.team_id, t.team_name order by 3 desc, t.team_id
WITH Points AS( SELECT host_team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 WHEN host_goals < guest_goals THEN 0 END host_point, guest_team, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 WHEN host_goals < guest_goals THEN 3 END guest_point FROM Matches m ) SELECT team_id, team_name, COALESCE(SUM(host_point), 0) num_points FROM( SELECT t1.team_id, t1.team_name, p1.host_point FROM Teams t1 LEFT JOIN Points p1 ON t1.team_id = p1.host_team UNION ALL SELECT t2.team_id, t2.team_name, p2.guest_point FROM Teams t2 LEFT JOIN Points p2 ON t2.team_id = p2.guest_team ) subt GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH T AS ( SELECT * FROM Matches UNION SELECT match_id, guest_team AS host_team, host_team AS guest_team, guest_goals AS host_goals, host_goals AS guest_goals FROM Matches ) SELECT team_id, team_name, SUM( CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END ) AS num_points FROM T RIGHT JOIN Teams ON host_team=team_id GROUP BY team_id ORDER BY num_points DESC, team_id
WITH T AS( (SELECT host_team team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END points FROM Matches ) UNION ALL (SELECT guest_team team_id, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END points FROM Matches ) ) SELECT Teams.team_id, team_name , IFNULL(SUM(points),0) num_points FROM T RIGHT JOIN Teams ON Teams.team_id = T.team_id GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH TEMP AS ( SELECT *, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 WHEN host_goals < guest_goals THEN 0 END AS host_points, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 WHEN guest_goals < host_goals THEN 0 END AS guest_points FROM Matches ), TEMP2 AS( SELECT DISTINCT host_team AS team_id, SUM(host_points) AS points FROM TEMP GROUP BY 1 UNION ALL SELECT DISTINCT guest_team AS team_id, SUM(guest_points) AS points FROM TEMP GROUP BY 1 ) SELECT DISTINCT a.team_id, a.team_name, IFNULL(SUM(TEMP2.points),0) AS num_points FROM Teams a LEFT JOIN TEMP2 ON a.team_id = TEMP2.team_id GROUP BY 1,2 ORDER BY 3 DESC, 1 ASC
WITH TeamPoints AS ( SELECT t.team_id, t.team_name, SUM(CASE WHEN team_id = h.host_team and h.host_goals > h.guest_goals THEN 3 WHEN team_id = h.host_team and h.host_goals = h.guest_goals THEN 1 WHEN team_id = h.host_team and h.host_goals < h.guest_goals THEN 0 ELSE 0 END) as num_points FROM Teams as t LEFT JOIN Matches as h on t.team_id = h.host_team GROUP BY t.team_id, t.team_name UNION ALL SELECT t.team_id, t.team_name, SUM(CASE WHEN team_id = g.guest_team and g.guest_goals > g.host_goals THEN 3 WHEN team_id = g.guest_team and g.guest_goals = g.host_goals THEN 1 WHEN team_id = g.guest_team and g.guest_goals < g.host_goals THEN 0 ELSE 0 END) as num_points FROM Teams as t LEFT JOIN Matches as g on t.team_id = g.guest_team GROUP BY t.team_id, t.team_name ) SELECT team_id, team_name, SUM(num_points) as num_points FROM TeamPoints GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
WITH cte AS ( SELECT host_team, guest_team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals < guest_goals THEN 0 ELSE 1 END AS host_label, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals < guest_goals THEN 3 ELSE 1 END AS guest_label FROM Matches ), cte2 AS ( SELECT host_team team_id, host_label score FROM cte UNION ALL SELECT guest_team team_id, guest_label score FROM cte ) SELECT a.team_id, a.team_name, COALESCE(SUM(score),0) num_points FROM Teams a LEFT JOIN cte2 b ON a.team_id=b.team_id GROUP BY 1,2 ORDER BY 3 DESC,1
WITH cte AS (SELECT (CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals < guest_goals THEN 0 ELSE 1 END) AS host_score, (CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals < guest_goals THEN 3 ELSE 1 END) AS guest_score, match_id, host_team, guest_team FROM Matches) SELECT t.team_id, t.team_name, IFNULL(SUM(c.num_points), 0) AS num_points FROM Teams t LEFT JOIN (SELECT host_team AS team_id, host_score AS num_points FROM cte UNION ALL SELECT guest_team AS team_id, guest_score AS num_points FROM cte) AS c ON c.team_id = t.team_id GROUP BY t.team_id ORDER BY num_points DESC, t.team_id ASC
WITH cte AS (SELECT host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT guest_team AS team_id, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches) SELECT a.*, IFNULL(SUM(points), 0) AS num_points FROM Teams a LEFT JOIN cte b ON a.team_id = b.team_id GROUP BY team_id ORDER BY 3 DESC, 1
WITH cte AS (SELECT host_team AS team_id, IF(host_goals>guest_goals, 3, IF(host_goals=guest_goals, 1, 0)) AS num FROM Matches UNION ALL SELECT guest_team AS team_id, IF(host_goals<guest_goals, 3, IF(host_goals=guest_goals, 1, 0)) AS num FROM Matches) SELECT t.team_id, t.team_name, COALESCE(SUM(cte.num),0) AS num_points FROM Teams t LEFT JOIN cte ON t.team_id = cte.team_id GROUP BY team_id, team_name ORDER BY num_points DESC, team_id ASC
WITH cte AS (SELECT host_team, SUM(IF(host_goals > guest_goals, 3, IF(host_goals = guest_goals, 1, 0))) AS host_points FROM Matches GROUP BY host_team UNION ALL SELECT guest_team, SUM(IF(host_goals < guest_goals, 3, IF(host_goals = guest_goals, 1, 0))) AS guest_points FROM Matches GROUP BY guest_team), cte2 AS (SELECT host_team, SUM(host_points) AS total_points FROM cte GROUP BY host_team) SELECT t.team_id, t.team_name, IFNULL(total_points, 0) AS num_points FROM Teams AS t LEFT JOIN cte2 ON t.team_id = cte2.host_team ORDER BY num_points DESC, t.team_id
WITH cte AS( SELECT host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM matches UNION ALL SELECT guest_team AS team_id, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END AS num_points FROM matches) SELECT t.team_id, team_name, IFNULL(SUM(num_points),0) AS num_points FROM teams t LEFT JOIN cte c ON t.team_id = c.team_id GROUP BY t.team_id, team_name ORDER BY 3 DESC, 1
WITH cte AS( SELECT match_id, host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT match_id, guest_team AS team_id, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END AS points FROM Matches ) SELECT t.team_id, t.team_name, COALESCE(SUM(c.points),0) AS num_points FROM cte c RIGHT JOIN Teams t ON c.team_id = t.team_id GROUP BY t.team_id ORDER BY num_points DESC, team_id
WITH cte as (Select*, case when host_status = 'win' then 3 when host_status = 'lose' then 0 else 1 end as host_score, case when host_status = 'win' then 0 when host_status = 'lose' then 3 else 1 end as guest_score FROM ( Select*, case when host_goals > guest_goals then 'win' when host_goals = guest_goals then 'tie' else 'lose' end as host_status FROM Matches) t) SELECT T.team_id, T.team_name, COALESCE(SUM(num_points),0) as num_points FROM Teams T LEFT JOIN (SELECT host_team as team_id, host_score as num_points From cte UNION ALL SELECT guest_team as team_id, guest_score as num_points From cte) S on T.team_id = S.Team_id GROUP BY 1 ORDER BY num_points DESC, 1
WITH cte_flat AS ( SELECT match_id, host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS scores FROM Matches UNION SELECT match_id, guest_team AS team_id, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END AS scores FROM Matches ) SELECT t.team_id, t.team_name, COALESCE(s.num_points, 0) AS num_points FROM Teams t LEFT JOIN ( SELECT team_id, SUM(scores) AS num_points FROM cte_flat GROUP BY team_id ) s ON s.team_id = t.team_id ORDER BY COALESCE(s.num_points, 0) DESC, t.team_id
WITH home_scores AS ( SELECT team_id, team_name, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS home_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.host_team GROUP BY 1,2 ), away_scores AS ( SELECT team_id, team_name, SUM(CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS away_points FROM Teams t LEFT JOIN Matches m ON t.team_id = m.guest_team GROUP BY 1,2 ) SELECT h.team_id, h.team_name, home_points + away_points AS num_points FROM home_scores h JOIN away_scores USING (team_id) ORDER BY 3 DESC, 1 ASC
WITH host AS (SELECT host_team as team, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals < guest_goals THEN 0 ELSE 1 END) AS points FROM Matches GROUP BY 1), guest AS (SELECT guest_team as team, SUM(CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals > guest_goals THEN 0 ELSE 1 END) AS points FROM Matches GROUP BY 1), id_points AS (SELECT team as team_id, SUM(points) as num_points FROM (SELECT team, points FROM host UNION ALL SELECT team, points FROM guest) as id_points GROUP BY 1) SELECT team_id, team_name, CASE WHEN num_points IS NULL THEN 0 ELSE num_points END AS num_points FROM (SELECT t.team_id, t.team_name, i.num_points FROM Teams AS t LEFT JOIN id_points AS i ON t.team_id = i.team_id) as final ORDER BY num_points DESC, team_id
WITH host AS (SELECT m.match_id, t.team_id, t.team_name, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM matches m JOIN teams t ON t.team_id = m.host_team), guest AS (SELECT m.match_id, t.team_id, t.team_name, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END AS points FROM matches m JOIN teams t ON t.team_id = m.guest_team), total_points AS (SELECT team_id, points FROM host UNION ALL SELECT team_id, points FROM guest) SELECT DISTINCT t.team_id, t.team_name, COALESCE(SUM(points) OVER(PARTITION BY team_id), 0) AS num_points FROM teams t LEFT JOIN total_points tp ON t.team_id = tp.team_id ORDER BY num_points DESC, team_id
WITH host_points AS ( SELECT match_id, host_team AS team, CASE WHEN (host_goals > guest_goals) THEN 3 WHEN (host_goals < guest_goals) THEN 0 ELSE 1 END AS points FROM matches ), guest_points AS ( SELECT match_id, guest_team AS team, CASE WHEN (host_goals > guest_goals) THEN 0 WHEN (host_goals < guest_goals) THEN 3 ELSE 1 END AS points FROM matches ), combined AS ( SELECT team AS team_id, sum(points) AS num_points FROM ( SELECT * FROM host_points UNION ALL SELECT * FROM guest_points ) AS joint GROUP BY team ) SELECT teams.team_id, teams.team_name, COALESCE(combined.num_points, 0) AS num_points FROM combined RIGHT JOIN teams ON combined.team_id = teams.team_id ORDER BY num_points DESC, teams.team_id
WITH host_team_points AS ( SELECT host_team as team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals < guest_goals THEN 0 ELSE 1 END AS points FROM Matches ), guest_team_points AS( SELECT guest_team AS team_id, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals < host_goals THEN 0 ELSE 1 END as points FROM Matches ), all_matches_points AS( SELECT team_id, points FROM host_team_points UNION ALL SELECT team_id, points FROM guest_team_points ) SELECT temp.team_id AS team_id, temp.team_name AS team_name, SUM(temp.points) AS num_points FROM( SELECT t.team_id AS team_id, CASE WHEN ap.points IS NULL THEN 0 ELSE ap.points END AS points, t.team_name AS team_name FROM Teams t LEFT JOIN all_matches_points ap ON t.team_id = ap.team_id )temp GROUP BY 1 ORDER BY 3 DESC, 1
WITH host_team_score AS ( SELECT Teams.team_id,Teams.team_name, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals < guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 END AS num_points FROM Matches RIGHT JOIN Teams ON Matches.host_team = Teams.team_id ), guest_team_score AS ( SELECT Teams.team_id,Teams.team_name, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals < host_goals THEN 0 WHEN guest_goals = host_goals THEN 1 END AS num_points FROM Matches RIGHT JOIN Teams ON Matches.guest_team = Teams.team_id ), combined AS( SELECT * FROM host_team_score UNION ALL SELECT * FROM guest_team_score ) SELECT team_id, team_name, COALESCE(SUM(num_points),0) AS num_points FROM combined GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
WITH hosted AS ( SELECT m.host_team as team_id, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) as points FROM matches as m GROUP BY m.host_team), guest AS ( SELECT m.guest_team as team_id, SUM(CASE WHEN guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) as points FROM matches as m GROUP BY m.guest_team), combined AS ( SELECT h.team_id, h.points FROM hosted as h UNION ALL SELECT g.team_id, g.points FROM guest as g) SELECT t.team_id, t.team_name, COALESCE(SUM(points), 0) as num_points FROM teams as t LEFT JOIN combined as c ON t.team_id = c.team_id GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, t.team_id ASC
WITH hp AS (SELECT h.match_id,h.host_team, CASE WHEN h.host_goals > h.guest_goals THEN 3 WHEN h.host_goals = h.guest_goals THEN 1 WHEN h.host_goals < h.guest_goals THEN 0 END AS host_points FROM matches h), gp AS (SELECT g.match_id, g.guest_team, CASE WHEN g.host_goals > g.guest_goals THEN 0 WHEN g.host_goals = g.guest_goals THEN 1 WHEN g.host_goals < g.guest_goals THEN 3 END AS guest_points FROM matches g), hgp AS (SELECT hp.match_id, hp.host_team as team_id, host_points as num_points FROM hp UNION SELECT gp.match_id, gp.guest_team as team_id, guest_points as num_points FROM gp) SELECT t.team_id, t.team_name, IFNULL(SUM(hgp.num_points), 0) AS num_points FROM Teams t LEFT JOIN hgp on hgp.team_id = t.team_id GROUP BY t.team_id ORDER BY num_points DESC, t.team_id
WITH match_data AS(SELECT *, CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END host_points, CASE WHEN host_goals>guest_goals THEN 0 WHEN host_goals=guest_goals THEN 1 ELSE 3 END guest_points FROM Matches) SELECT t.team_id, t.team_name, COALESCE(SUM(sub1.points),0) num_points FROM (SELECT host_team team_id, host_points points FROM match_data UNION ALL SELECT guest_team team_id, guest_points points FROM match_data) sub1 RIGHT JOIN Teams t ON sub1.team_id=t.team_id GROUP BY 1,2 ORDER BY num_points DESC, t.team_id
WITH match_points AS ( SELECT match_id, host_team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS host_points, guest_team, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END AS guest_points FROM Matches ), team_points AS ( SELECT host_team AS team_id, SUM(host_points) AS num_points FROM match_points GROUP BY host_team UNION ALL SELECT guest_team, SUM(guest_points) FROM match_points GROUP BY guest_team ) SELECT Teams.team_id, team_name, COALESCE(SUM(num_points),0) AS num_points FROM team_points RIGHT JOIN Teams ON team_points.team_id = Teams.team_id GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
WITH match_points as ( SELECT host_team, guest_team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END as host_points, (CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END) as guest_points FROM Matches), POINTS_TABLE AS ( SELECT host_team, SUM(host_points) as host_points FROM MATCH_POINTS GROUP BY 1 UNION ALL SELECT guest_team, SUM(guest_points) as guest_points FROM MATCH_POINTS GROUP BY 1) SELECT t.team_id, t.team_name, IFNULL(pt.host_points,0) as num_points FROM Teams as t LEFT JOIN (SELECT host_team, SUM(host_points) as host_points FROM POINTS_TABLE GROUP BY 1) as pt ON pt.host_team = t.team_id GROUP BY 1 ORDER BY num_points DESC, team_id ASC
WITH points AS ( SELECT host_team AS team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS Points FROM Matches UNION ALL SELECT guest_team AS team, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END as points FROM Matches ) SELECT team_id, team_name, IFNULL(SUM(points), 0) as num_points FROM Teams LEFT JOIN Points ON Teams.team_id = Points.team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
WITH points_matches AS (SELECT *, CASE WHEN guest_goals < host_goals THEN 0 WHEN guest_goals = host_goals THEN 1 WHEN guest_goals > host_goals THEN 3 END AS guest_points, CASE WHEN guest_goals < host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 WHEN guest_goals > host_goals THEN 0 END AS host_points FROM Matches), host AS(SELECT team_id, team_name AS team_name,IFNULL(host_points,0) AS points FROM points_matches RIGHT JOIN Teams ON points_matches.host_team = Teams.team_id), guest AS(SELECT team_id, team_name,IFNULL(guest_points,0) AS points FROM points_matches RIGHT JOIN Teams ON points_matches.guest_team = Teams.team_id), unioned AS(SELECT * from host UNION ALL SELECT * FROM guest) SELECT team_id, team_name, SUM(points) AS num_points FROM unioned GROUP BY team_id, team_name ORDER BY SUM(points) DESC, team_id ASC
WITH res AS ( SELECT CASE WHEN host_goals > guest_goals THEN host_team WHEN host_goals < guest_goals THEN guest_team END AS team_id, SUM( CASE WHEN host_goals > guest_goals OR host_goals < guest_goals THEN 3 END ) AS num_points FROM matches WHERE host_goals != guest_goals GROUP BY 1 UNION ALL SELECT host_team AS team_id, 1 AS num_points FROM matches WHERE host_goals = guest_goals UNION ALL SELECT guest_team AS team_id, 1 AS num_points FROM matches WHERE host_goals = guest_goals ), res_new AS ( SELECT team_id, SUM(num_points) AS num_points FROM res GROUP BY 1 ) SELECT t.team_id, t.team_name, COALESCE(r.num_points,0) AS num_points FROM teams t LEFT JOIN res_new r ON r.team_id = t.team_id ORDER BY 3 DESC,1
WITH s AS (SELECT host_team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END host_score, guest_team, CASE WHEN host_goals > guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END guest_score FROM matches) SELECT t.team_id, t.team_name, COALESCE(SUM(num_points),0) num_points FROM teams t LEFT JOIN (SELECT host_team team_id, host_score num_points FROM s UNION ALL SELECT guest_team team_id, guest_score num_points FROM s) m ON m.team_id = t.team_id GROUP BY t.team_id, t.team_name ORDER BY num_points DESC, team_id
WITH s AS (SELECT host_team, guest_team, CASE WHEN host_goals < guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END AS host_score, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS guest_score FROM Matches) SELECT team_id,team_name,COALESCE(SUM(score),0) AS num_points FROM (SELECT host_team AS team_id, host_score AS score FROM s UNION ALL SELECT guest_team, guest_score FROM s) sub RIGHT JOIN Teams USING (team_id) GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH score_tb AS ( SELECT host_team, guest_team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS host_score, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS guest_score FROM Matches ), union_tb AS ( SELECT host_team AS team_id, host_score AS num_points FROM score_tb UNION ALL SELECT guest_team AS team_id, guest_score AS num_points FROM score_tb ) SELECT Teams.team_id, Teams.team_name, IFNULL(SUM(num_points), 0) AS num_points FROM union_tb RIGHT JOIN Teams ON union_tb.team_id = Teams.team_id GROUP BY Teams.team_id ORDER BY num_points DESC, team_id ASC
WITH scores AS ( SELECT *, (CASE WHEN host_goals < guest_goals THEN 0 WHEN host_goals = guest_goals THEN 1 ELSE 3 END) AS host_score, (CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS guest_score FROM Matches ), team_wise AS ( SELECT host_team AS team_id, SUM(host_score) AS agg FROM scores GROUP BY host_team UNION ALL SELECT guest_team AS team_id, SUM(guest_score) AS agg FROM scores GROUP BY guest_team ), tot_score AS ( SELECT team_id, SUM(agg) as total_score FROM team_wise GROUP BY team_id ) SELECT team_id, team_name, IFNULL(total_score,0) AS num_points FROM Teams LEFT JOIN tot_score USING(team_id) ORDER BY num_points DESC, team_id
WITH scores AS( SELECT host_team AS Team, CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END AS Score FROM matches UNION ALL SELECT guest_team AS Team, CASE WHEN host_goals<guest_goals THEN 3 WHEN host_goals=guest_goals THEN 1 ELSE 0 END AS Score FROM matches ) SELECT t.team_id, team_name, COALESCE(SUM(Score),0) AS num_points FROM scores s RIGHT JOIN teams t ON s.Team = t.team_id GROUP BY s.Team,team_name ORDER BY num_points DESC,team_id
WITH t AS (SELECT team_id, team_name, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) score FROM teams JOIN matches ON team_id = host_team GROUP BY 1,2 UNION ALL SELECT team_id, team_name, SUM(CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) score FROM teams JOIN matches ON team_id = guest_team GROUP BY 1,2) SELECT teams.team_id, teams.team_name, SUM(IFNULL(score, 0)) num_points FROM teams LEFT JOIN t ON teams.team_id = t.team_id GROUP BY 1,2 ORDER BY num_points DESC, team_id
WITH t1 AS ( SELECT *, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS host_points, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS guest_points FROM Matches ), t2 AS ( SELECT t.*, ( SELECT SUM(t1.host_points) FROM t1 AS t1 WHERE t1.host_team = t.team_id ) AS points_as_host, ( SELECT SUM(t1.guest_points) FROM t1 AS t1 WHERE t1.guest_team = t.team_id ) AS points_as_guest FROM Teams t ), t3 AS ( SELECT team_id, team_name, IFNULL((points_as_host + points_as_guest),0) AS num_points FROM t2 ORDER BY num_points DESC, team_id ), t4 AS ( SELECT host_team AS team_id, host_points AS num_points FROM t1 UNION ALL SELECT guest_team AS team_id, guest_points AS num_points FROM t1 ), t5 AS ( SELECT team_id, SUM(num_points) AS num_points FROM t4 GROUP BY 1 ), t6 AS ( SELECT team_id, team_name, IFNULL(( SELECT num_points FROM t5 t5 where t5.team_id = t.team_id ),0) AS num_points FROM Teams t ORDER BY num_points DESC, team_id ) SELECT * FROM t6
WITH t1 as ( SELECT host_team as team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END as points FROM Matches UNION ALL SELECT guest_team as team_id, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END as points FROM Matches ) SELECT Teams.team_id, team_name, SUM(IFNULL(points, 0)) as num_points FROM Teams LEFT JOIN t1 ON Teams.team_id = t1.team_id GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH table1 AS( SELECT *, (CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS host_points, (CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END) AS guest_points FROM MATCHES ), table2 AS( SELECT host_team AS team_id, host_points AS num_points FROM table1 UNION ALL SELECT guest_team AS team_id, guest_points AS num_points FROM table1 ) SELECT t.team_id, t.team_name, COALESCE(SUM(num_points),0) AS num_points FROM Teams t LEFT JOIN table2 USING(team_id) GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH table1 AS( SELECT match_id, host_team, guest_team, host_goals, guest_goals, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS host_points, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END AS guest_points FROM Matches ), table2 AS( SELECT host_team, host_points FROM table1 UNION ALL SELECT guest_team, guest_points FROM table1 ) SELECT t.team_id, t.team_name, SUM(IFNULL(host_points,0)) AS num_points FROM Teams t LEFT JOIN table2 ON t.team_id=table2.host_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH team_points AS ( SELECT host_team AS team_id, SUM(CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END ) AS points FROM Matches GROUP BY 1 UNION ALL SELECT guest_team AS team_id, SUM(CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END) AS points FROM Matches GROUP BY 1 ) SELECT Teams.team_id, Teams.team_name, SUM(COALESCE(points, 0)) AS num_points FROM Teams LEFT JOIN team_points p ON Teams.team_id = p.team_id GROUP BY 1, 2 ORDER BY num_points DESC, team_id
WITH team_points as ((SELECT host_team as team_id,CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals<guest_goals THEN 0 ELSE 1 END AS points FROM Matches) UNION ALL (SELECT guest_team as team_id,CASE WHEN host_goals<guest_goals THEN 3 WHEN host_goals>guest_goals THEN 0 ELSE 1 END AS points FROM Matches) ) SELECT t.team_id as team_id,t.team_name as team_name,COALESCE(SUM(points),0) as num_points FROM Teams t LEFT JOIN team_points ON t.team_id=team_points.team_id GROUP BY 1,2 ORDER BY 3 DESC,1
WITH team_points as ((SELECT host_team as team_id,CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals<guest_goals THEN 0 ELSE 1 END AS points FROM Matches) UNION ALL (SELECT guest_team as team_id,CASE WHEN host_goals<guest_goals THEN 3 WHEN host_goals>guest_goals THEN 0 ELSE 1 END AS points FROM Matches) ) SELECT t.team_id as team_id,t.team_name as team_name,COALESCE(sub1.points,0) as num_points FROM Teams t LEFT JOIN (SELECT team_id,SUM(points) as points FROM team_points GROUP BY 1) sub1 ON t.team_id=sub1.team_id ORDER BY 3 DESC,1
WITH temp1 AS ( SELECT *, (CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS host_point, (CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END) AS guest_point FROM Matches ), temp2 AS ( SELECT host_team AS team, host_point AS point FROM temp1 UNION ALL SELECT guest_team AS team, guest_point AS point FROM temp1 ) SELECT team_id, team_name, IFNULL(SUM(point), 0) AS num_points FROM Teams LEFT JOIN temp2 ON Teams.team_id = temp2.team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
WITH tmp AS ( SELECT host_team AS team_id, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches UNION ALL SELECT guest_team AS team_id, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS num_points FROM Matches ) SELECT ina.team_id, ina.team_name, IFNULL(SUM(inb.num_points), 0) AS num_points FROM Teams AS ina LEFT JOIN tmp AS inb ON ina.team_id = inb.team_id GROUP BY ina.team_id, ina.team_name ORDER BY num_points DESC, ina.team_id
With comb_data as (Select host_team as team_id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as score From Matches Union all Select guest_team as team_id, (case when guest_goals>host_goals then 3 when guest_goals=host_goals then 1 else 0 end) as score From Matches) Select t.team_id, team_name, ifnull(s.score,0) as num_points From Teams t Left join (Select team_id, sum(score) as score From comb_data Group by team_id) s On t.team_id = s.team_id Order by num_points desc, team_id asc
With score_table as ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from Matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as num_points from Matches ), team_scores as( select team_id, sum(num_points) as num_points from score_table group by team_id ) select results.team_id, team_name, num_points from ( select team_id, 0 as num_points from Teams where team_id not in ( select distinct team_id from team_scores ) union select * from team_scores ) results join Teams on results.team_id = Teams.team_id order by num_points desc, team_id asc
select T.team_id, T.Team_name, ifnull(Sum(case when T.team_id = M.host_team and M.host_goals > M.guest_goals then 3 when T.team_id = M.host_team and M.host_goals = M.guest_goals then 1 when T.team_id = M.Guest_team and M.host_goals < M.guest_goals then 3 when T.team_id = M.Guest_team and M.host_goals = M.guest_goals then 1 END ),0) as num_points from Teams T left join Matches M on T.team_id = M.host_team or T.team_id = M.guest_team group by T.team_id Order by num_points desc, team_id asc
select T.team_id, T.team_name, sum(case when host_team=team_id and host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when guest_team = team_id and host_goals < guest_goals then 3 else 0 end) as num_points from Teams T left join Matches M on T.team_id = M.host_team or T.team_id = M.guest_team group by 1,2 order by 3 desc, 1 asc
select T1.team_id,T1.team_name,ifnull(sum(T2.goals),0) as num_points from Teams as T1 left join (select host_team as team, (case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as goals from Matches union all select guest_team as team, (case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end) as goals from Matches) as T2 on T1.team_id = T2.team group by team_id order by num_points desc ,T1.team_id
select Teams.team_id, Teams.team_name, sum(case when Teams.team_id = Matches.host_team and Matches.host_goals > Matches.guest_goals then 3 else 0 end) + sum(case when Teams.team_id = Matches.guest_team and Matches.host_goals < Matches.guest_goals then 3 else 0 end) + sum(case when Teams.team_id = Matches.host_team and Matches.host_goals = Matches.guest_goals then 1 else 0 end) + sum(case when Teams.team_id = Matches.guest_team and Matches.host_goals = Matches.guest_goals then 1 else 0 end) as num_points from Teams left join Matches on Teams.team_id = Matches.host_team or Teams.team_id = Matches.guest_team group by Teams.team_id order by num_points desc, team_id
select Teams.team_id, Teams.team_name, sum(case when team_id=host_team and host_goals>guest_goals then 3 else 0 end) + sum(case when team_id=host_team and host_goals=guest_goals then 1 else 0 end) + sum(case when team_id=guest_team and host_goals<guest_goals then 3 else 0 end) + sum(case when team_id=guest_team and host_goals=guest_goals then 1 else 0 end) as num_points from Teams left join Matches on Teams.team_id = Matches.host_team or Teams.team_id = Matches.guest_team group by Teams.team_id order by num_points desc, Teams.team_id asc
select Teams.team_id, team_name, ifnull(num_points, 0) as num_points from Teams left join ( select team_id, sum(points) as num_points from (select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from Matches union all select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from Matches) t3 group by team_id) t4 on t4.team_id = Teams.team_id order by num_points desc, team_id
select a.team_id, a.team_name, coalesce(num_points, 0) as num_points from Teams a left join ( select team_id, sum(num_points) as num_points from ( select host_team as team_id, sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end ) as num_points from Matches group by host_team union all select guest_team as team_id, sum(case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end ) as num_points from Matches group by guest_team ) b group by team_id ) c on a.team_id = c.team_id group by a.team_id, a.team_name order by num_points desc, team_id
select a.team_id, a.team_name, sum(case when a.team_id = b.host_team and b.host_goals > b.guest_goals then 3 when a.team_id = b.guest_team and b.guest_goals > b.host_goals then 3 when ((a.team_id = b.host_team or a.team_id = b.guest_team) and (b.guest_goals = b.host_goals)) then 1 else 0 end) as num_points from Teams a join Matches b group by a.team_id order by num_points desc, a.team_id asc
select a.team_id, a.team_name, sum(case when host_goals>guest_goals and a.team_id=b.host_team then 3 when guest_goals>host_goals and a.team_id=b.guest_team then 3 when guest_goals=host_goals then 1 else 0 end) as num_points from teams a left join matches b on a.team_id=b.host_team or a.team_id=b.guest_team group by 1,2 order by 3 desc, 1
select a.team_id, team_name, ifnull(sum(tot_scores),0) as num_points from teams as a left join ( select host_team as team_id, sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 when host_goals < guest_goals then 0 end) as tot_scores from matches group by 1 union all select guest_team as team_id, sum(case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 when host_goals > guest_goals then 0 end) as tot_scores from matches group by 1 ) as b on a.team_id = b.team_id group by 1,2 order by 3 desc, 1
select a.team_id,a.team_name, ifnull(gueat_score,0)+ifnull(host_score,0) as num_points from Teams a left join (select host_team, sum(case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) host_score from Matches group by host_team) b on a.team_id=b.host_team left join (select guest_team, sum(case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) gueat_score from Matches group by guest_team) c on a.team_id=c.guest_team order by num_points desc,a.team_id
select b.team_id , b.team_name , sum(case when a.team_name_id is null then 0 else a.pt end) as num_points from teams b left join ( with tmpPt as ( select host_team , guest_team , case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_pt , case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as guest_pt from Matches ) select host_team as team_name_id, host_pt as pt from tmpPt union all select guest_team as team_name_id, guest_pt as pt from tmpPt) a on a.team_name_id = b.team_id group by 1,2 order by num_points desc, b.team_id
select b.team_id, b.team_name, sum(ifnull(a.score,0)) as num_points from ((select host_team as team_id, sum(case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end) as score from Matches group by 1 ) union all (select guest_team as team_id, sum(case when guest_goals > host_goals then 3 when guest_goals < host_goals then 0 else 1 end) as score from Matches group by 1 )) a right join Teams b on a.team_id = b.team_id group by 1, 2 order by num_points desc, b.team_id asc
select b.team_id,b.team_name,coalesce(sum(a.points),0) as num_points from ( select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals<guest_goals then 0 else 1 end as points from Matches union all select guest_team as team_id, case when host_goals<guest_goals then 3 when host_goals>guest_goals then 0 else 1 end as points from Matches)a right join Teams b on a.team_id=b.team_id group by b.team_id order by num_points desc, b.team_id
select d.team_id as team_id, d.team_name, coalesce(sum(point),0) as num_points from teams d left join (select guest_team as team, guest_point as point from (select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_point, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as guest_point from matches group by 1,2)a union all select host_team as team, host_point as point from (select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_point, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as guest_point from matches group by 1,2)b )c on c.team = d.team_id group by 1,2 order by 3 desc, 1
select distinct a.team_id, a.team_name, sum(case when a.team_id = b.host_team and b.host_goals > b.guest_goals then 3 else 0 end) + sum(case when a.team_id = b.guest_team and b.guest_goals > b.host_goals then 3 else 0 end) + sum(case when a.team_id = b.host_team and b.host_goals = b.guest_goals then 1 else 0 end) + sum(case when a.team_id = b.guest_team and b.guest_goals = b.host_goals then 1 else 0 end) as num_points from teams a join matches b group by a.team_id, a.team_name order by num_points desc, team_id
select distinct a.team_id, a.team_name, sum(case when a.team_id = b.host_team and b.host_goals > b.guest_goals then 3 else 0 end) + sum(case when a.team_id = b.guest_team and b.guest_goals > b.host_goals then 3 else 0 end) + sum(case when a.team_id = b.host_team and b.host_goals = b.guest_goals then 1 else 0 end) + sum(case when a.team_id = b.guest_team and b.guest_goals = b.host_goals then 1 else 0 end) as num_points from teams a, matches b group by a.team_id, a.team_name order by num_points desc, team_id
select distinct t.team_id,t.team_name, ifnull(sum(sub.num_points)over(partition by sub.team_id),0) as num_points from ( select match_id, host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 end as num_points from matches union all select match_id, guest_team as team_id, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 end as num_points from matches)sub right join teams t on t.team_id = sub.team_id order by num_points desc, t.team_id asc
select main_team.team_id, main_team.team_name, ifnull(data_final.num_points,0) as 'num_points' from Teams main_team left join ( select data_host.team_id, (data_host.num_points + data_guest.num_points) as 'num_points' from ( select T.team_id, T.team_name, ifnull(T1.num_points,0) as 'num_points' from Teams T left join ( select host_team, sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as 'num_points' from Matches group by host_team ) as T1 on T.team_id = T1.host_team ) as data_host left join ( select T.team_id, T.team_name, ifnull(T2.num_points,0) as 'num_points' from Teams T left join ( select guest_team, sum(case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end) as 'num_points' from Matches group by guest_team ) as T2 on T.team_id = T2.guest_team ) as data_guest on data_host.team_id = data_guest.team_id ) as data_final on main_team.team_id = data_final.team_id order by num_points desc, main_team.team_id
select t.*, if(isnull(m1.host_team),0,sum(if(team_id<>(m1.host_team), case when m1.guest_goals>m1.host_goals then 3 when m1.guest_goals=m1.host_goals then 1 else 0 end, case when m1.guest_goals>m1.host_goals then 0 when m1.guest_goals=m1.host_goals then 1 else 3 end))) as num_points from teams t left join matches m1 on t.team_id = m1.host_team or t.team_id = m1.guest_team group by team_id order by num_points desc, team_id
select t.*, ifnull(x.num_points,0) num_points from (select team_id,sum(score) as num_points from (select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as score from Matches union all select guest_team as team_id, case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as score from Matches) x group by team_id) x right join Teams t on x.team_id=t.team_id order by num_points desc,team_id asc
select t.team_id ,t.team_name ,sum( case when host_goals > guest_goals and t.team_id = m.host_team then 3 when host_goals < guest_goals and t.team_id = m.guest_team then 3 when host_goals = guest_goals then 1 else 0 end ) as num_points from Teams t left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id ,t.team_name order by num_points desc ,t.team_id
select t.team_id ,t.team_name ,sum( case when host_goals > guest_goals and t.team_id = m.host_team then 3 when host_goals < guest_goals and t.team_id = m.guest_team then 3 when host_goals = guest_goals then 1 else 0 end ) as num_points from Teams t left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id order by num_points desc ,t.team_id
select t.team_id as team_id, t.team_name as team_name, sum(case when t.team_id = m.guest_team and m.guest_goals > m.host_goals then 3 when t.team_id = m.host_team and m.guest_goals < m.host_goals then 3 when m.guest_goals = m.host_goals then 1 else 0 end) as num_points from Teams t left join Matches m on t.team_id = m.guest_team or t.team_id = m.host_team group by t.team_id order by num_points DESC, t.team_id
select t.team_id as team_id, team_name, coalesce(sum(score),0) as num_points from (select match_id, host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as score from matches union select match_id, guest_team as team_id, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as score from matches) m right join teams t on m.team_id = t.team_id group by t.team_id, team_name order by num_points desc, team_id
select t.team_id as team_id,t.team_name,coalesce (sum(score),0) as num_points from ( select match_id,host_team as team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as score from matches h union select match_id,guest_team as team, case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as score from matches g ) a right join teams t on a.team=t.team_id group by 1 order by coalesce(num_points,0) desc,1
select t.team_id, t.team_name , sum(case when (t.team_id = host_team and host_goals > guest_goals) or (t.team_id = guest_team and host_goals < guest_goals) then 3 else 0 end) + sum(case when (t.team_id = host_team and host_goals = guest_goals) or (t.team_id = guest_team and host_goals = guest_goals) then 1 else 0 end) as num_points from Teams t, Matches m group by t.team_id, t.team_name order by num_points desc, t.team_id asc
select t.team_id, t.team_name, (sum(case when host_goals>guest_goals and t.team_id=m.host_team then 3 when host_goals<guest_goals and t.team_id=m.guest_team then 3 when host_goals=guest_goals then 1 else 0 end)) as num_points from teams t left join matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id,t.team_name order by num_points desc, team_id
select t.team_id, t.team_name, SUM(CASE WHEN t.team_id = m.host_team and m.host_goals > m.guest_goals THEN 3 WHEN t.team_id = m.guest_team and m.guest_goals > m.host_goals THEN 3 WHEN m.host_goals = m.guest_goals THEN 1 ELSE 0 END ) as num_points from teams t LEFT JOIN matches m on (t.team_id = m.host_team) or (t.team_id = m.guest_team) group by t.team_id, t.team_name order by num_points desc, team_id asc
select t.team_id, t.team_name, coalesce((select sum(case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) from Matches where host_team=t.team_id),0)+coalesce((select sum(case when host_goals>guest_goals then 0 when host_goals=guest_goals then 1 else 3 end) from Matches where guest_team=t.team_id),0) as num_points from Teams t order by num_points desc, team_id
select t.team_id, t.team_name, coalesce(cte2.num_points,0)as num_points from teams t left join (select team_id, sum(num_points)as num_points from (select host_team as team_id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end)as num_points from matches union all select guest_team as team_id, (case when guest_goals>host_goals then 3 when host_goals=guest_goals then 1 else 0 end)as num_points from matches)cte group by team_id)cte2 on t.team_id=cte2.team_id order by num_points desc, team_id asc
select t.team_id, t.team_name, coalesce(h.host_points, 0) + coalesce(g.guest_points, 0) as num_points from Teams as t left join( select host_team, sum(case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end) as host_points from Matches group by 1 ) as h on t.team_id = h.host_team left join( select guest_team, sum(case when host_goals > guest_goals then 0 when host_goals < guest_goals then 3 else 1 end) as guest_points from Matches group by 1 ) as g on t.team_id = g.guest_team order by num_points desc, team_id
select t.team_id, t.team_name, coalesce(sum( case when m.host_team = t.team_id then case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end when m.guest_team = t.team_id then case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end end ), 0) as num_points from Teams t left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id order by num_points desc, team_id asc
select t.team_id, t.team_name, coalesce(sum(t3.num_points),0) as num_points from teams t left join (select host_team as team_id, host_points as num_points from (select match_id, host_team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals<guest_goals then 0 end as host_points, guest_team, case when guest_goals>host_goals then 3 when host_goals=guest_goals then 1 when guest_goals<host_goals then 0 end as guest_points from matches) t1 union all select guest_team, guest_points from (select match_id, host_team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals<guest_goals then 0 end as host_points, guest_team, case when guest_goals>host_goals then 3 when host_goals=guest_goals then 1 when guest_goals<host_goals then 0 end as guest_points from matches) t2) t3 on t.team_id=t3.team_id group by t3.team_id, team_name order by num_points desc, team_id
select t.team_id, t.team_name, coalesce(wls, 0) num_points from teams t left join ( select team_id, sum(points) wls from ( select host_team team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from Matches union all select guest_team team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from Matches ) f group by 1 ) as k on t.team_id = k.team_id order by 3 DESC , t.team_id
select t.team_id, t.team_name, ifnull(sum(c.num_points),0) as num_points from teams t left join (select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from matches union all select guest_team as team_id, case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end as num_points from matches) c on t.team_id = c.team_id group by c.team_id, t.team_name order by num_points desc, team_id
select t.team_id, t.team_name, ifnull(sum(case when goal_host > goal_guest then 3 when goal_host = goal_guest then 1 else 0 end),0) as num_points from teams t left join (select 'host' as type, host_team as team_id, host_goals as goal_host, guest_goals as goal_guest from matches union all select 'guest' as type, guest_team as team_id, guest_goals as goal_host, host_goals as goal_guest from matches) m on t.team_id = m.team_id group by 1 order by num_points desc, 1
select t.team_id, t.team_name, ifnull(sum(case when t.team_id = m.host_team and host_goals > guest_goals then 3 when t.team_id = m.host_team and host_goals = guest_goals then 1 when t.team_id = m.guest_team and host_goals < guest_goals then 3 when t.team_id = m.guest_team and host_goals = guest_goals then 1 end) ,0) as num_points from Matches m right join Teams t on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id, t.team_name order by 3 desc,1 asc
select t.team_id, t.team_name, ifnull(sum(case when t.team_id = m.host_team and m.host_goals > m.guest_goals then 3 when t.team_id = m.host_team and m.host_goals = m.guest_goals then 1 when t.team_id = m.guest_team and m.host_goals < m.guest_goals then 3 when t.team_id = m.guest_team and m.host_goals = m.guest_goals then 1 else 0 end), 0) as num_points from Matches m right join Teams t on m.host_team = t.team_id or m.guest_team = t.team_id group by team_id, team_name order by num_points desc, team_id
select t.team_id, t.team_name, ifnull(sum(case when t.team_id=m.host_team and m.host_goals>m.guest_goals then 3 when t.team_id=m.host_team and m.host_goals=m.guest_goals then 1 when t.team_id=m.host_team and m.host_goals<m.guest_goals then 0 when t.team_id=m.guest_team and m.host_goals>m.guest_goals then 0 when t.team_id=m.guest_team and m.host_goals=m.guest_goals then 1 when t.team_id=m.guest_team and m.host_goals<m.guest_goals then 3 end),0) as num_points from Teams as t left join Matches as m on t.team_id=m.host_team or t.team_id=m.guest_team group by t.team_id order by num_points DESC, team_id ASC
select t.team_id, t.team_name, ifnull(sum(m.points),0) as num_points from Teams as t left join( select host_team as team, sum(host_points) as points from( select *, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'host_points', case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'guest_points' from Matches ) M1 group by host_team union all select guest_team as team, sum(guest_points) as points from( select *, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'host_points', case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'guest_points' from Matches ) M2 group by guest_team ) as m on m.team = t.team_id group by t.team_id order by num_points desc, t.team_id
select t.team_id, t.team_name, ifnull(sum(num_points),0) as num_points from Teams t left join ( select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals<guest_goals then 0 else 1 end as num_points from Matches union all select guest_team as team_id, case when host_goals>guest_goals then 0 when host_goals<guest_goals then 3 else 1 end as num_points from Matches) a on t.team_id=a.team_id group by t.team_id order by num_points desc, t.team_id
select t.team_id, t.team_name, ifnull(sum(point),0) as num_points from Teams t left join (select host_team as team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as point from Matches m1 union all select guest_team as team, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as point from Matches m2) tb on t.team_id = tb.team group by t.team_id order by num_points desc, t.team_id
select t.team_id, t.team_name, ifnull(sum(points), 0) as num_points from ( select sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as points, host_team as team_id from Matches group by host_team union all select sum(case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end) as points, guest_team as team_id from Matches group by guest_team ) a right join Teams t on a.team_id = t.team_id group by t.team_id order by num_points desc, team_id
select t.team_id, t.team_name, ifnull(sum(ss.points),0) as num_points from teams t left join ( select host_team as team ,case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select guest_team as team ,case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches ) as ss on t.team_id = ss.team group by t.team_id, t.team_name order by ifnull(sum(ss.points),0) desc, t.team_id asc
select t.team_id, t.team_name, ifnull(sum(tmp.team_points), 0) as num_points from teams t left join (( select host_team as team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as team_points from matches ) union all ( select guest_team as team, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as team_points from matches ))tmp on t.team_id = tmp.team group by t.team_id order by 3 desc, 1
select t.team_id, t.team_name, sUM(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = guest_team and guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end) as num_points from teams t left join matches m ON team_id=host_team OR team_id=guest_team group by t.team_id, t.team_name order by num_points desc, t.team_id asc
select t.team_id, t.team_name, sum( case when t.team_id = m.host_team and m.host_goals>m.guest_goals then 3 when t.team_id = m.host_team and m.host_goals=m.guest_goals then 1 when t.team_id = m.guest_team and m.host_goals<m.guest_goals then 3 when t.team_id = m.guest_team and m.host_goals=m.guest_goals then 1 else 0 end ) as num_points from Teams t left join Matches m on m.host_team = t.team_id or m.guest_team = t.team_id group by t.team_id order by num_points desc, team_id asc
select t.team_id, t.team_name, sum( case when u.host_goals > u.guest_goals then 3 when u.host_goals = u.guest_goals then 1 else 0 end ) num_points from (select host_team team_id, host_goals, guest_goals from matches union all select guest_team team_id, guest_goals host_goals, host_goals guest_goals from matches) u right join teams t using(team_id) group by t.team_id order by num_points desc, t.team_id
select t.team_id, t.team_name, sum(case when (t.team_id = M.host_team and M.host_goals > M.guest_goals) then 3 when (t.team_id = M.host_team and M.host_goals = M.guest_goals) then 1 when (t.team_id = M.guest_team and M.guest_goals > M.host_goals) then 3 when (t.team_id = M.guest_team and M.host_goals = M.guest_goals) then 1 else 0 end ) as num_points from Teams t left join Matches M on (t.team_id = M.host_team) or (t.team_id = M.guest_team) group by t.team_id,t.team_name order by Num_points desc, t.team_id
select t.team_id, t.team_name, sum(case when host_goals>guest_goals and t.team_id = m.host_team then 3 when guest_goals>host_goals and t.team_id = m.guest_team then 3 when guest_goals=host_goals then 1 else 0 end) as num_points from teams t left join matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id, t.team_name order by num_points desc, t.team_id
select t.team_id, t.team_name, sum(case when m.host_goals > m.guest_goals and t.team_id = m.host_team then 3 when m.host_goals < m.guest_goals and t.team_id = m.guest_team then 3 when m.host_goals = m.guest_goals then 1 else 0 end) as num_points from teams t left join matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by t.team_id order by num_points desc, t.team_id
select t.team_id, t.team_name, sum(case when m.host_goals>m.guest_goals then 3 when m.host_goals = m.guest_goals then 1 else 0 end) num_points from teams t left join (select host_team, guest_team, host_goals, guest_goals from matches union all select guest_team host_team, host_team guest_team, guest_goals host_goals, host_goals guest_goals from matches) m on m.host_team = t.team_id group by t.team_id order by num_points desc,t.team_id asc
select t.team_id, t.team_name, sum(case when t.team_id = m.host_team and host_goals > guest_goals then 3 when t.team_id = m.host_team and host_goals = guest_goals then 1 when t.team_id = m.guest_team and guest_goals > host_goals then 3 when t.team_id = m.guest_team and guest_goals = host_goals then 1 else 0 end) as num_points from Teams t left join Matches m on t.team_id=m.host_team or t.team_id = m.guest_team group by team_id order by num_points DESC, team_id ASC
select t.team_id, t.team_name, sum(case when t.team_id = m.host_team and m.host_goals > m.guest_goals then 3 when t.team_id = m.guest_team and m.host_goals < m.guest_goals then 3 when m.host_goals = m.guest_goals then 1 else 0 end) as num_points from teams t left join matches m ON team_id=host_team OR team_id=guest_team GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
select t.team_id, t.team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 else 0 end)+ sum(case when team_id = host_team and host_goals = guest_goals then 1 else 0 end) + sum(case when team_id = guest_team and guest_goals > host_goals then 3 else 0 end)+ sum(case when team_id = guest_team and guest_goals = host_goals then 1 else 0 end ) as num_points from Teams t left join Matches m on (t.team_id = m.host_team or t.team_id = m.guest_team) group by t.team_id,t.team_name order by num_points desc, t.team_id
select t.team_id, t.team_name, sum(ifnull(num_points,0)) as 'num_points' from teams t left join ( select host_team as 'team_id', case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 when host_goals < guest_goals then 0 end as 'num_points' from matches union all select guest_team as 'team_id', case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 when host_goals < guest_goals then 3 end as 'num_points' from matches) e on t.team_id = e.team_id group by t.team_id, t.team_name order by num_points desc, team_id
select t.team_id, t.team_name, sum(ifnull(score, 0)) as num_points from ( select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as score from matches union all select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as score from matches ) a right join teams t on a.team_id = t.team_id group by t.team_id order by num_points desc, t.team_id
select t.team_id, t.team_name,ifnull(sum(a.goals),0)as num_points from Teams t left join ( select host_team as team_id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 End)as goals from Matches union all select guest_team as team_id, (case when host_goals>guest_goals then 0 when host_goals=guest_goals then 1 else 3 End)as goals from Matches )a on a.team_id = t.team_id group by t.team_id order by num_points DESC, t.team_id
select t.team_id, team_name, coalesce(win_lose_score, 0) as num_points from teams t left join ( select distinct team_id, sum(points) as win_lose_score from ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches ) f group by 1 ) f on t.team_id = f.team_id order by 3 desc, 1
select t.team_id, team_name, coalesce(win_lose_score, 0) as num_points from teams t left join ( select team_id, sum(points) as win_lose_score from ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches ) f group by 1 ) f on t.team_id = f.team_id order by 3 desc, 1
select t.team_id, team_name, ifnull(sum(points),0) as num_points from ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as points from matches) p right join teams t on t.team_Id = p.team_id group by 1 order by 3 desc, 1
select t.team_id, team_name, ifnull(sum(score),0) 'num_points' from teams t left join (select match_id, host_team 'team_id', case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals<guest_goals then 0 end 'score' from matches union select match_id, guest_team 'team_id', case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 when host_goals>guest_goals then 0 end 'score' from matches) a on t.team_id=a.team_id group by team_name order by num_points desc, team_id
select t.team_id, team_name, ifnull(sum(score),0) as num_points from (select host_team as team, if(host_goals>guest_goals, 3, if(host_goals = guest_goals, 1, 0)) as score from matches union all select guest_team as team, if(host_goals>guest_goals, 0, if(host_goals = guest_goals, 1, 3)) as score from matches) as temp right join teams as t on temp.team = t.team_id group by team_id order by num_points desc, team_id
select t.team_id,t.team_name, sum(case when m.host_team=t.team_id and m.host_goals>m.guest_goals then 3 when m.guest_team=t.team_id and m.host_goals<m.guest_goals then 3 when m.host_goals=m.guest_goals then 1 else 0 end ) as num_points from teams as t left join matches as m on t.team_id=m.host_team or t.team_id=m.guest_team group by t.team_id, t.team_name order by num_points desc, t.team_id
select t.team_id,t.team_name,ifnull(sum(a.points),0) as num_points from Teams t left join ( select host_team as id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) points from Matches union all select guest_team as id, (case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) points from Matches ) a on t.team_id=a.id group by t.team_id,t.team_name order by num_points desc, t.team_id
select t.team_id,team_name,coalesce(sum(num_points),0) num_points from teams t left join ( with matches as (select match_id,host_team,guest_team,host_goals,guest_goals ,case when host_goals=guest_goals then 1 when host_goals >guest_goals then 3 when host_goals<guest_goals then 0 end as host_scores, case when guest_goals=host_goals then 1 when guest_goals >host_goals then 3 when guest_goals<host_goals then 0 end as guest_scores from matches) select host_team team_id,sum(host_scores) num_points from matches group by 1 union all select guest_team team_id,sum(guest_scores) num_points from matches group by 1)a on t.team_id = a.team_id group by 1,2 order by 3 desc,1
select t0.team_id, team_name, ifnull(num_points, 0) as num_points from Teams t0 left join (select team, sum(points) as num_points from (select host_team as team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from Matches union all select guest_team as team, case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end as points from Matches) t group by team) t1 on t0.team_id = t1.team order by num_points desc, team_id
select t1.team_id, t1.team_name, sum(case when t1.team_id=t2.host_team AND t2.host_goals > t2.guest_goals then 3 when t1.team_id=t2.host_team AND t2.host_goals = t2.guest_goals then 1 when t1.team_id=t2.host_team AND t2.host_goals < t2.guest_goals then 0 when t1.team_id=t2.guest_team AND t2.host_goals > t2.guest_goals then 0 when t1.team_id=t2.guest_team AND t2.host_goals = t2.guest_goals then 1 when t1.team_id=t2.guest_team AND t2.host_goals < t2.guest_goals then 3 else 0 end) as num_points from teams t1, Matches t2 group by team_id, team_name order by num_points desc, team_id
select t1.team_id,t1.team_name,coalesce(num_points,0) as num_points from teams t1 left join (select team_id,sum(scores) as num_points from (select host_team as team_id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as scores from matches union all select guest_team as team_id, (case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 end) as scores from matches )m group by m.team_id)f on t1.team_id=f.team_id order by num_points desc,t1.team_id
select t1.team_id,team_name, coalesce(sum(num_points),0) num_points from Teams t1 left join (select host_team team_id, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as num_points from Matches union all select guest_team team_id, case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as num_points from Matches) t2 on t1.team_id=t2.team_id group by 1,2 order by 3 desc,1
select team_id , team_name , sum(case when team_id=host_team AND host_goals>guest_goals then 3 else 0 end) + sum(case when team_id=guest_team AND host_goals<guest_goals then 3 else 0 end) + sum(case when team_id=host_team AND host_goals=guest_goals then 1 else 0 end) + sum(case when team_id=guest_team AND host_goals=guest_goals then 1 else 0 end) as num_points from Teams left join Matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc , team_id asc
select team_id , team_name , sum(ifnull(host_points,0)) as num_points from teams t left join (select host_team , case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_points from (select host_team, host_goals, guest_goals from matches union all select guest_team as host_team , guest_goals as host_goals , host_goals as guest_goals from matches ) temp1 ) temp2 on t.team_id = temp2.host_team group by 1,2 order by 3 desc, 1
select team_id, team_name, ( sum(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = host_team and host_goals = guest_goals then 1 when team_id = guest_team and host_goals < guest_goals then 3 when team_id = guest_team and host_goals = guest_goals then 1 else 0 end) )as num_points from teams t left join matches m on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id
select team_id, team_name, (sum(case when host_goals > guest_goals and team_id = host_team then 3 when host_goals < guest_goals and team_id = guest_team then 3 when (team_id = host_team or team_id = guest_team) and host_goals = guest_goals then 1 else 0 end)) as num_points from Teams join Matches group by team_id order by num_points desc, team_id asc
select team_id, team_name, (sum(case when host_team = team_id and host_goals > guest_goals then 3 when guest_team = team_id and guest_goals > host_goals then 3 when (guest_team = team_id or host_team = team_id) and host_goals = guest_goals then 1 ELSE 0 end) )as num_points from teams join matches group by team_id order by num_points desc, team_id asc
select team_id, team_name, (sum(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = guest_team and guest_goals > host_goals then 3 when (team_id = host_team or team_id = guest_team) and host_goals = guest_goals then 1 else 0 end)) as num_points from teams join matches group by team_id order by num_points desc, team_id asc
select team_id, team_name, (sum(if(host_goals>guest_goals AND team_id = host_team, 3, 0)) + sum(if(guest_goals>host_goals AND team_id = guest_team, 3, 0)) + sum(if(host_goals=guest_goals AND team_id = host_team, 1, 0)) + sum(if(host_goals=guest_goals AND team_id = guest_team, 1, 0))) as num_points from Teams left join Matches on Matches.host_team = Teams.team_id OR Matches.guest_team = Teams.team_id group by team_id order by num_points desc, team_id asc
select team_id, team_name, case when num_points is null then 0 else num_points end as num_points from( select t.team_id, t.team_name, sum(num_points) num_points from Teams t left join (select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as num_points from Matches Union all select guest_team as team_id, case when guest_goals > host_goals then 3 when guest_goals < host_goals then 0 else 1 end as num_points from Matches) a on a.team_id = t.team_id group by a.team_id, t.team_name) b order by num_points desc, team_id asc
select team_id, team_name, if(g_score is null,0,g_score)+if(h_score is null,0, h_score) as num_points from teams left join (select host_team, sum(if(host_goals>guest_goals, 3, if(host_goals=guest_goals,1,0))) as h_score from matches group by host_team) h_score on teams.team_id=h_score.host_team left join (select guest_team, sum(if(guest_goals>host_goals,3,if(host_goals=guest_goals,1,0))) as g_score from matches group by guest_team) g_score on teams.team_id=g_score.guest_team order by num_points desc, team_id
select team_id, team_name, ifnull(num_points, 0) as num_points from teams left join ( select host_team, sum(case when host_goals> guest_goals then 3 when host_goals <guest_goals then 0 else 1 end) as num_points from( select host_team,guest_team,host_goals,guest_goals from matches union all select guest_team, host_team,guest_goals,host_goals from matches ) as t group by 1) as s on s.host_team= teams.team_id order by 3 desc, 1
select team_id, team_name, ifnull(sum(case when team_id = host_team and host_goals > guest_goals then "3" when team_id = guest_team and guest_goals > host_goals then "3" when team_id = host_team and guest_goals = host_goals then "1" when team_id = guest_team and guest_goals = host_goals then "1" end),0) as "num_points" from matches m right join teams t on m.host_team = t.team_id or m.guest_team = t.team_id group by 1 order by num_points desc, team_id
select team_id, team_name, ifnull(sum(points), 0) num_points from (select match_id, host_team team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select match_id, guest_team team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches) as a right join teams using (team_id) group by team_id, team_name order by num_points desc, team_id
select team_id, team_name, ifnull(sum(points), 0) num_points from (select match_id, host_team team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union select match_id, guest_team team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches) as a right join teams using (team_id) group by team_id, team_name order by num_points desc, team_id
select team_id, team_name, sum( case when team_id = host_team and host_goals > guest_goals then 3 when team_id = host_team and host_goals = guest_goals then 1 when team_id = guest_team and host_goals < guest_goals then 3 when team_id = guest_team and host_goals = guest_goals then 1 else 0 end ) as num_points from teams t left join matches m on t.team_id = host_team or t.team_id = guest_team group by t.team_id, t.team_name order by num_points desc, t.team_id asc
select team_id, team_name, sum(case when host_goals > guest_goals and t.team_id = m.host_team then 3 when host_goals < guest_goals and t.team_id = m.guest_team then 3 when host_goals = guest_goals then 1 else 0 end) num_points from Teams t left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team group by 1 order by 3 desc, 1
select team_id, team_name, sum(case when t.team_id = m.host_team and host_goals > guest_goals then 3 when t.team_id = m.guest_team and guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end) as num_points from teams t left join matches m on m.host_team = t.team_id or m.guest_team = t.team_id group by 1,2 order by 3 desc, 1 asc
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 else 0 end) + sum(case when team_id = guest_team and guest_goals > host_goals then 3 else 0 end) + sum(case when team_id = host_team and guest_goals = host_goals then 1 else 0 end) + sum(case when team_id = guest_team and guest_goals = host_goals then 1 else 0 end) as num_points from teams left join Matches on teams.team_id = Matches.host_team or teams.team_id = Matches.guest_team group by team_id order by num_points desc,team_id asc
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 else 0 end) + sum(case when team_id = guest_team and guest_goals > host_goals then 3 else 0 end) + sum(case when team_id = host_team and host_goals = guest_goals then 1 else 0 end) + sum(case when team_id = guest_team and guest_goals = host_goals then 1 else 0 end) as num_points from Teams left join Matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id asc
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 else 0 end)+ sum(case when team_id = guest_team and guest_goals > host_goals then 3 else 0 end)+ sum(case when team_id = host_team and host_goals = guest_goals then 1 else 0 end)+ sum(case when team_id = guest_team and host_goals = guest_goals then 1 else 0 end) as num_points from Teams left join matches on team_id = host_team or team_id = guest_team group by team_id, team_name order by num_points desc, team_id
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = guest_team and guest_goals > host_goals then 3 when (team_id = host_team or team_id = guest_team) and host_goals = guest_goals then 1 else 0 end) as 'num_points' from teams left join matches on team_id = host_team or team_id = guest_team group by team_id, team_name order by num_points desc, team_id asc
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = guest_team and guest_goals > host_goals then 3 when (team_id = host_team or team_id = guest_team) and host_goals = guest_goals then 1 else 0 end) as num_points from teams join matches group by team_id order by num_points desc, team_id asc
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = guest_team and host_goals < guest_goals then 3 when (team_id = host_team or team_id = guest_team) and host_goals = guest_goals then 1 else 0 end) num_points from Teams join Matches group by team_id order by num_points desc, team_id
select team_id, team_name, sum(case when team_id = host_team and host_goals > guest_goals then 3 when team_id = host_team and host_goals = guest_goals then 1 when team_id = guest_team and guest_goals > host_goals then 3 when team_id = guest_team and guest_goals = host_goals then 1 else 0 end) as num_points FROM Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
select team_id, team_name, sum(case when team_id = host_team and host_goals>guest_goals then 3 ELSE 0 end)+ sum(case when team_id = host_team and host_goals<guest_goals then 0 ELSE 0 end)+ sum(case when team_id = host_team and host_goals=guest_goals then 1 ELSE 0 end)+ sum(case when team_id = guest_team and host_goals>guest_goals then 0 ELSE 0 end)+ sum(case when team_id = guest_team and host_goals<guest_goals then 3 ELSE 0 end)+ sum(case when team_id = guest_team and host_goals=guest_goals then 1 ELSE 0 end) as num_points from Teams LEFT JOIN Matches ON team_id=host_team OR team_id=guest_team GROUP BY team_id ORDER BY num_points DESC, team_id ASC
select team_id, team_name, sum(case when team_id = host_team and host_goals>guest_goals then 3 else 0 end) + sum(case when team_id = guest_team and host_goals<guest_goals then 3 else 0 end) + sum(case when team_id in (host_team, guest_team) and host_goals=guest_goals then 1 else 0 end) as num_points from teams t left join matches m on t.team_id = m.guest_team or t.team_id = m.host_team group by 1 order by num_points desc, team_id
select team_id, team_name, sum(case when team_id=host_team and host_goals > guest_goals then 3 else 0 end) + sum(case when team_id=guest_team and guest_goals > host_goals then 3 else 0 end) + sum(case when team_id=host_team and host_goals = guest_goals then 1 else 0 end) + sum(case when team_id=guest_team and host_goals = guest_goals then 1 else 0 end) as num_points from teams left join matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id
select team_id, team_name, sum(case when team_id=host_team and host_goals> guest_goals then 3 when team_id=host_team and host_goals=guest_goals then 1 else 0 end)+ sum(case when team_id=guest_team and guest_goals> host_goals then 3 when team_id=guest_team and guest_goals=host_goals then 1 else 0 end) as num_points from Teams a left join Matches b on a.team_id=b.host_team or a.team_id=b.guest_team group by team_id order by num_points desc, team_id
select team_id, team_name, sum(case when team_id=host_team and host_goals>guest_goals then 3 else 0 end) + sum(case when team_id = guest_team and guest_goals > host_goals then 3 else 0 end) + sum(case when team_id=host_team and host_goals = guest_goals then 1 else 0 end) + sum(case when team_id = guest_team and guest_goals = host_goals then 1 else 0 end) as num_points from Teams left join Matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id asc
select team_id, team_name, sum(case when team_id=host_team and host_goals>guest_goals then 3 when team_id=host_team and host_goals=guest_goals then 1 when team_id=host_team and host_goals<guest_goals then 0 when team_id=guest_team and guest_goals>host_goals then 3 when team_id=guest_team and guest_goals=host_goals then 1 when team_id=guest_team and guest_goals<host_goals then 0 else 0 end) as num_points from teams left join matches on teams.team_id=matches.host_team or teams.team_id=matches.guest_team group by 1,2 order by num_points desc, team_id
select team_id, team_name, sum(if(team_id=host_team and host_goals>guest_goals,3,0)) + sum(if(team_id=guest_team and guest_goals>host_goals,3,0))+sum(if(team_id=host_team and host_goals=guest_goals, 1,0))+sum(if(team_id=guest_team and host_goals=guest_goals, 1,0)) as num_points from teams left join matches on teams.team_id=matches.host_team or teams.team_id=matches.guest_team group by team_id order by num_points desc, team_id
select team_id,Team_name, sum( case when team_id=host_team and host_goals>guest_goals then 3 when team_id=guest_team and host_goals<guest_goals then 3 when (team_id=host_team or team_id=guest_team) and host_goals=guest_goals then 1 else 0 end) num_points from matches m right join teams t on (m.host_team=t.team_id or m.guest_team=t.team_id) group by 1 order by 3 desc, 1
select team_id,team_name, SUM( CASE WHEN team_id = host_team AND host_goals > guest_goals THEN 3 WHEN team_id = guest_team AND guest_goals > host_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END ) as num_points from teams left join matches on team_id=host_team or team_id=guest_team group by 1,2 order by 3 desc ,1
select team_id,team_name, SUM(CASE WHEN team_id = host_team AND host_goals>guest_goals THEN 3 WHEN team_id = guest_team AND host_goals<guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END ) as num_points from Teams t Left join Matches m on t.team_id = m.host_team or t.team_id = m.guest_team Group by team_id, team_name order by num_points desc , team_id
select team_id,team_name, ifnull(sum(num),0) as num_points from teams a left join (select host_team, case when host_goals < guest_goals then 0 when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 end as num from matches union all select guest_team, case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 end as num from matches) b on a.team_id = b.host_team group by team_id order by num_points desc, team_id asc
select team_id,team_name, sum(case when host_team=team_id and host_goals>guest_goals then 3 else 0 end)+ sum(case when guest_team=team_id and guest_goals>host_goals then 3 else 0 end)+ sum(case when host_team=team_id and host_goals=guest_goals then 1 else 0 end)+ sum(case when guest_team=team_id and host_goals=guest_goals then 1 else 0 end) as num_points from teams a left join matches b on a.team_id=b.host_team or a.team_id = b.guest_team group by team_id order by num_points desc,team_id
select team_id,team_name, sum(case when team_id = host_team and host_goals>guest_goals then 3 else 0 end) + sum(case when team_id = host_team and host_goals=guest_goals then 1 else 0 end) + sum(case when team_id = host_team and host_goals<guest_goals then 0 else 0 end) + sum(case when team_id = guest_team and host_goals>guest_goals then 0 else 0 end)+ sum(case when team_id = guest_team and host_goals=guest_goals then 1 else 0 end)+ sum(case when team_id = guest_team and host_goals<guest_goals then 3 else 0 end) as num_points from matches m right join teams t on t.team_id = m.host_team or t.team_id=m.guest_team group by team_id order by num_points desc, team_id asc
select team_id,team_name, sum(case when team_id=host_team and host_goals>guest_goals then 3 when team_id=guest_team and host_goals<guest_goals then 3 when (team_id=host_team or team_id=guest_team) and host_goals=guest_goals then 1 else 0 end) as num_points from Teams join Matches group by team_id order by num_points desc,team_id
select teams.team_id,teams.team_name, coalesce (sum(team_points),0) as num_points from (select match_id, host_team as team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as team_points from matches union all select match_id, guest_team as team, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as team_points from matches) as temp right outer join teams on temp.team = teams.team_id group by team,teams.team_name order by num_points desc, team_id
sum(case when team_id=host_team and host_goals>guest_goals then 3 else 0 end)+ sum(case when team_id=guest_team and guest_goals>host_goals then 3 else 0 end)+ sum(case when team_id=host_team and host_goals=guest_goals then 1 else 0 end)+ sum(case when team_id=guest_team and guest_goals=host_goals then 1 else 0 end) as num_points from teams left join matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id asc
with MatchesScores as( select *, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as 'host_team_score', case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 else 1 end as 'guest_team_score' from Matches ), TeamScores as ( (select host_team as team_id, host_team_score as num_points from MatchesScores where host_team_score <>0 ) union all (select guest_team as team_id, guest_team_score as num_points from MatchesScores where guest_team_score <>0) ) select a.team_id, a.team_name, ifnull(sum(num_points),0) as num_points from Teams a left join TeamScores b on a.team_id = b.team_id group by 1,2 order by num_points desc,a.team_id asc
with Scores as (select * , case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as host_team_score , case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 else 1 end as guest_team_score from Matches ) select t.team_id , t.team_name , ifnull(s1.tot, 0) as num_points from Teams t left join (select t3.team_id , sum(t3.score) as tot from (select t1.host_team as team_id , t1.host_team_score as score from Scores t1 union all select t2.guest_team as team_id , t2.guest_team_score as score from Scores t2) t3 group by 1) S1 on t.team_id = S1.team_id order by 3 desc, 1
with a as ( select host_team team_id, host_goals - guest_goals diff from matches union all select guest_team, - host_goals + guest_goals from matches ) select t.team_id, team_name, coalesce(sum(case when diff > 0 then 3 when diff = 0 then 1 else 0 end), 0) num_points from a right outer join teams t on (a.team_id = t.team_id) group by t.team_id, team_name order by num_points desc, team_id
with a as ( select match_id, host_team as team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as scores from matches union all select match_id, guest_team as team, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as scores from matches) select t.team_id, t.team_name, ifnull(sum(a.scores),0) as num_points from teams t left join a on t.team_id = a.team group by 1,2 order by 3 desc,1
with a as ( select team_id, sum(points) as points from ( select host_team as team_id, (case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end) as points from matches union all select guest_team as team_id, (case when guest_goals > host_goals then 3 when guest_goals < host_goals then 0 else 1 end) as point from matches )x group by team_id ) select t.team_id, team_name, ifnull(points, 0) as num_points from a right join teams t on a.team_id = t.team_id group by 1 order by 3 desc, 1 asc
with a as( select host_team, guest_team, host_rewards, guest_rewards from( select * , case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals<guest_goals then 0 end as host_rewards , case when host_goals>guest_goals then 0 when host_goals=guest_goals then 1 when host_goals<guest_goals then 3 end as guest_rewards from matches) as t ), b as ( select host_team as team, host_rewards as reward from a union all select guest_team as team, guest_rewards as reward from a) select t.team_id, team_name, ifnull(sum(reward), 0) as num_points from b right join teams as t on b.team=t.team_id group by t.team_id order by num_points desc, team_id asc
with all_team as (SELECT host_team as team_id, (case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as points from Matches UNION ALL SELECT guest_team as team_id, (case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end) as points from Matches) Select t.team_id,t.team_name, ifnull(sum(a.points),0) as num_points from Teams t left join all_team a on a.team_id = t.team_id group by t.team_id,t.team_name order by num_points desc, team_id asc
with cte as ( ( select tab1.team_id, tab1.team_name, sum( case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals < guest_goals then 0 else NULL end) as score from Teams tab1 left join Matches tab2 on tab1.team_id = tab2.host_team group by team_id, team_name ) union all ( select tab1.team_id, tab1.team_name, sum( case when host_goals>guest_goals then 0 when host_goals=guest_goals then 1 when host_goals < guest_goals then 3 else NULL end) as score from Teams tab1 left join Matches tab2 on tab1.team_id = tab2.guest_team group by team_id, team_name ) ) select team_id, team_name, num_points from ( select team_id, team_name, ifnull(sum(score),0) as num_points from cte group by team_name ) tmp order by num_points desc, team_id
with cte as ( ( select tab1.team_id, tab1.team_name, sum( case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals < guest_goals then 0 else Null end) as score from Teams tab1 left join Matches tab2 on tab1.team_id = tab2.host_team group by team_id, team_name ) union all ( select tab1.team_id, tab1.team_name, sum( case when host_goals>guest_goals then 0 when host_goals=guest_goals then 1 when host_goals < guest_goals then 3 else NULL end) as score from Teams tab1 left join Matches tab2 on tab1.team_id = tab2.guest_team group by team_id, team_name ) ) select team_id, team_name, num_points from ( select team_id, team_name, ifnull(sum(score),0) as num_points from cte group by team_name ) tmp order by num_points desc, team_id
with cte as ( select *, case when host_goals = guest_goals then 1 when host_goals > guest_goals then 3 else 0 end as point_host , case when host_goals = guest_goals then 1 when host_goals < guest_goals then 3 else 0 end as point_guest from matches) select b.team_id, b.team_name, case when a.points is null then 0 else sum(a.points)end as num_points from ( select host_team as team_id, point_host as points from cte union all select guest_team as team_id, point_guest as points from cte ) a right join teams b on a.team_id = b.team_id group by b.team_id order by num_points desc, b.team_id
with cte as ( select host_team 'team_id', sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) 'num_points' from Matches group by host_team ), target as ( select guest_team 'team_id', sum(case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end )'num_points' from Matches group by guest_team ), common as ( select * from cte union all select * from target ) select t.team_id, team_name, ifnull(num_points,0) num_points from Teams t left join (select team_id, sum(num_points) num_points from common group by team_id) p on (t.team_id = p.team_id) order by num_points desc, t.team_id
with cte as ( select host_team as team, guest_team as op, host_goals as team_goals, guest_goals as op_goals from matches union all select guest_team as team, host_team as op, guest_goals as team_goals, host_goals as op_goals from matches ) select t.team_id, t.team_name, sum(case when c.team_goals > c.op_goals then 3 when c.team_goals = c.op_goals then 1 else 0 end) as num_points from teams t left join cte c on t.team_id=c.team group by t.team_id order by num_points desc, t.team_id
with cte as ( select host_team as team_id, (case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as score from matches union all select guest_team as team_id, (case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end) as score from matches ) select t.team_id, team_name, ifnull(sum(score),0) as num_points from cte c right join teams t on c.team_id = t.team_id group by t.team_id order by 3 desc, 1 asc
with cte as ( select host_team as team_id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as point from matches union all select guest_team, (case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) from matches) select t.team_id, t.team_name, ifnull(sum(c.point),0) as num_points from teams t left join cte c on t.team_id=c.team_id group by 1,2 order by 3 desc, 1 asc
with cte as ( select host_team as team_id, (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as points from Matches union all select guest_team as team_id, (case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as points from Matches ), cte2 as ( select team_id, sum(points) as num_points from cte group by team_id ) select t.team_id, t.team_name,coalesce(num_points,0) as num_points from Teams t left join cte2 using(team_id) order by num_points desc, t.team_id
with cte as ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'num_points' from matches union all select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'num_points' from matches ) select t.team_id, t.team_name, ifnull(sum(c.num_points), 0) as 'num_points' from teams t left join cte c on t.team_id = c.team_id group by t.team_id, t.team_name order by num_points dESC, team_id
with cte as ( select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as num_points from matches union all select guest_team as team_id, case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as num_points from matches ) select teams.team_id,teams.team_name,ifnull(num_points,0) as num_points from teams left join ( select team_id,sum(num_points) as num_points from cte group by team_id)c on teams.team_id=c.team_id order by num_points desc, team_id asc
with cte as ( select host_team, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as points from Matches union all select guest_team, case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 else 1 end as points from Matches ), cte1 as ( select host_team,sum(points) as points from cte group by host_team ) select Teams.team_id as team_id,team_name,ifnull(points,0) as num_points from cte1 right join Teams on Teams.team_id = cte1.host_team order by num_points desc, Teams.team_id
with cte as ( select host_team, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as rt from matches union all select guest_team, case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 else 1 end as rt from matches), cte2 as ( select teams.team_id, teams.team_name, coalesce(score,0) as num_points from ( select host_team, sum(rt) as score from cte group by host_team)d right join teams on d.host_team = teams.team_id ) select * from cte2 order by num_points desc, team_id asc
with cte as ( select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_points, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as guest_points from Matches) select b.team_id as team_id, b.team_name, ifnull(sum(a.score), 0) as num_points from (select host_team as team, host_points as score from cte union all select guest_team as team, guest_points as score from cte) a right join Teams b on a.team = b.team_id group by 1,2 order by 3 desc, 1 asc
with cte as ( select host_team, guest_team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as host_points, case when host_goals>guest_goals then 0 when host_goals=guest_goals then 1 else 3 end as guest_points from Matches ), cte1 as ( select host_team as team_id, host_points as points from cte union all select guest_team, guest_points from cte ), cte2 as ( select team_id, sum(points) as num_points from cte1 group by 1 ) select Teams.team_id, Teams.team_name, ifnull(cte2.num_points,0) as num_points from cte2 right join Teams on cte2.team_id = Teams.team_id order by num_points desc, team_id
with cte as ( select match_id,host_team,guest_team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as host_points, case when guest_goals>host_goals then 3 when guest_goals=host_goals then 1 else 0 end as guest_points from matches ), demo as ( select host_team as team_id,host_points as points from cte union all select guest_team as team_id,guest_points as points from cte ) select t.team_id,t.team_name,coalesce(sum(points),0) as num_points from teams as t left join demo as d on d.team_id=t.team_id group by t.team_id order by num_points desc,t.team_id asc
with cte as ( select t.team_id,t.team_name,case when m.host_Goals > m.guest_goals then 3 when m.host_Goals = m.guest_goals then 1 else 0 end as num from Teams t left join Matches M On T.team_id = M.host_team union all select t.team_id,t.team_name,case when m2.host_Goals = m2.guest_goals then 1 when m2.host_Goals < m2.guest_goals then 3 else 0 end as num from Teams t left join Matches M2 On T.team_id = M2.guest_team ) select team_id,team_name,sum(num) as num_points from cte group by team_id,team_name order by num_points desc, team_id
with cte as ( select team_name,team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from Teams t left join Matches m on t.team_id = m.host_team union all select team_name,team_id, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as num_points from Teams t left join Matches m on t.team_id = m.guest_team) select team_id,team_name, sum(num_points) as num_points from cte group by 1,2 order by 3 desc, 1
with cte as (Select id,sum(num_points) as n from (Select host_team as id, SUM(CASE WHEN host_goals>guest_goals THEN 3 WHEN host_goals<guest_goals THEN 0 ELSE 1 END ) AS num_points FROM matches group by 1 UNION ALL Select guest_team as id, SUM(CASE WHEN host_goals>guest_goals THEN 0 WHEN host_goals<guest_goals THEN 3 ELSE 1 END ) AS num_points FROM matches group by 1 ) b group by id ) select team_id,team_name,coalesce(n,0) as num_points from teams t left join cte as c on t.team_id=c.id order by 3 desc,1
with cte as (select * , (case when host_goals > guest_goals then 3 when host_goals=guest_goals then 1 when host_goals < guest_goals then 0 end ) as hst_pts, (case when guest_goals > host_goals then 3 when host_goals=guest_goals then 1 when guest_goals < host_goals then 0 end ) as gst_pts from matches ), cte_host as (select host_team,sum(hst_pts) as hst_pts from cte group by host_team ), cte_guest as (select guest_team,sum(gst_pts) as gst_pts from cte group by guest_team) , team_pts as (select host_team as team_id,sum(hst_pts) as pts from (select a.* from cte_host a union all select b.* from cte_guest b) temp group by 1) select a.team_id,a.team_name,ifnull(b.pts,0) as num_points from teams a left join team_pts b on a.team_id=b.team_id order by num_points desc,team_id
with cte as (select *, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_score, case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end as guest_score from matches), cte2 as (select * from teams t left join (select host_team,sum(host_score) tot1 from cte group by 1) t1 on t.team_id = t1.host_team left join (select guest_team,sum(guest_score) tot2 from cte group by 1) t2 on t.team_id = t2.guest_team) select team_id, team_name , ifnull(tot1,0) + ifnull(tot2,0) as num_points from cte2 order by 3 desc,1
with cte as (select a.team_name as team_name, sum(a.score) as score from ( select host_team as team_name, 3 as score from Matches m1 where m1.host_goals > m1.guest_goals union all select guest_team as team_name, 3 as score from Matches m1 where m1.guest_goals > m1.host_goals union all select host_team as team_name, 1 as score from Matches m1 where m1.host_goals = m1.guest_goals union all select guest_team as team_name, 1 as score from Matches m1 where m1.host_goals = m1.guest_goals ) a group by a.team_name) select t.team_id as team_id, t.team_name as team_name, coalesce(e.score,0) as num_points from cte e right join Teams t on e.team_name=t.team_id order by num_points desc, team_id
with cte as (select host_team as team_id, case when host_goals> guest_goals then 3 when host_goals= guest_goals then 1 when host_goals< guest_goals then 0 end as total from matches union all select guest_team as team_id, case when host_goals< guest_goals then 3 when host_goals= guest_goals then 1 when host_goals> guest_goals then 0 end as total from matches ) select t.team_id, t.team_name , ifnull(sum(c.total),0)num_points from cte c right join teams t on t.team_id=c.team_id group by t.team_id order by num_points desc, t.team_id asc
with cte as (select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals<guest_goals then 0 else 1 end as points from matches union all select guest_team as team_id, case when host_goals<guest_goals then 3 when host_goals>guest_goals then 0 else 1 end as points from matches ) select teams.team_id,team_name,coalesce(sum(points),0) as num_points from cte right join teams on teams.team_id=cte.team_id group by cte.team_id,team_name order by num_points desc,teams.team_id asc
with cte as (select host_team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as host_score, guest_team, case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as guest_score from matches) select t.team_id, t.team_name, coalesce(sum(score),0) as num_points from (select c.host_team as id, c.host_score as score from cte c union all select c1.guest_team as id, c1.guest_score as socre from cte c1 ) temp right join teams t on temp.id=t.team_id group by t.team_id order by 3 desc, 1
with cte as (select host_team, guest_team, case when host_goals > guest_goals then '3' when host_goals = guest_goals then '1' else '0' end as pointhost, case when host_goals > guest_goals then '0' when host_goals = guest_goals then '1' else '3' end as pointguest from Matches ), cte2 as (select host_team as team_id, sum(pointhost) as num_points from cte group by host_team union all select guest_team as team_id, sum(pointguest) as num_points from cte group by guest_team ) select t.team_id, t.team_name, cast(ifnull(sum(cte2.num_points),0) as decimal) as num_points from Teams t left join cte2 on cte2.team_id = t.team_id group by t.team_id order by 3 desc, 1 asc
with cte as (select host_team, guest_team, case when host_goals > guest_goals then '3' when host_goals = guest_goals then '1' else '0' end as pointhost, case when host_goals > guest_goals then '0' when host_goals = guest_goals then '1' else '3' end as pointguest from Matches ), cte2 as (select host_team as team_id, sum(pointhost) as num_points from cte group by host_team union all select guest_team as team_id, sum(pointguest) as num_points from cte group by guest_team ) select t.team_id, t.team_name, ifnull(sum(cte2.num_points),0) as num_points from Teams t left join cte2 on cte2.team_id = t.team_id group by t.team_id order by 3 desc, 1 asc
with cte as (select m.host_team, m.guest_team, case when m.host_goals>m.guest_goals then 3 when m.host_goals=m.guest_goals then 1 else 0 end as host_score, case when m.host_goals<m.guest_goals then 3 when m.host_goals=m.guest_goals then 1 else 0 end as guest_score from Matches m ) select temp.team_id, temp.team_name, coalesce(sum(score),0) as num_points from (select t.team_id, t.team_name, cte.host_score as score from teams t left join cte on cte.host_team=t.team_id Union all SELECT t.team_id, t.team_name, cte.guest_score as score from teams t left join cte on cte.guest_team=t.team_id) temp group by temp.team_id order by 3 desc,team_id
with cte as (select match_id, host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_point, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as guest_point from Matches), cte2 as (select host_team as team_id, host_point as point from cte union all select guest_team as team_id, guest_point as point from cte) select team_id, team_name, ifnull(sum(point),0) as num_points from cte2 right join teams using (team_id) group by 1 order by num_points desc, team_id
with cte as( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as 'num_points' from Matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as 'num_points' from Matches ) select t.team_id,t.team_name,sum(ifnull(num_points,0)) num_points from teams as t left join cte c on t.team_id = c.team_id group by t.team_id order by num_points desc,t.team_id
with cte as( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches ) select t.team_id, t.team_name ,ifnull(sum(c.points),0)as num_points from cte c right join teams t on t.team_id = c.team_id group by t.team_id order by 3 desc, 1
with cte as( select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_points, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as guest_points from matches ) select t.team_id, team_name, ifnull(num_points,0) as num_points from ( select team_id, sum(points) as num_points from( select host_team as team_id, host_points as points from cte union all select guest_team as team_id, guest_points as points from cte ) sub group by team_id ) sub1 right join teams t on sub1.team_id = t.team_id order by num_points desc, team_id
with cte as( select host_team, guest_team, host_goals, guest_goals from matches union all select guest_team, host_team, guest_goals, host_goals from matches) select teams.team_id, team_name, ifnull(sum(points),0) as num_points from( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from cte )sub1 right join teams on sub1.team_id = teams.team_id group by 1,2 order by num_points desc, team_id asc
with cte as( select if(a.host_goals>b.guest_goals,a.host_team,NULL) as team, "3" as points from matches a join matches b on a.match_id = b.match_id UNION ALL select if(a.host_goals<b.guest_goals,a.GUEST_TEAM,NULL) as team, "3" as points from matches a join matches b on a.match_id = b.match_id UNION ALL select if(a.host_goals=b.guest_goals,a.HOST_TEAM,NULL) as team, "1" as points from matches a join matches b on a.match_id = b.match_id UNION ALL select if(a.host_goals=b.guest_goals,a.GUEST_TEAM,NULL) as team, "1" as points from matches a join matches b on a.match_id = b.match_id ) select t.team_id, t.team_name, cast(ifnull(sum(points),0) as decimal) as num_points from cte c right join teams t on t.team_id = c.team group by 1,2 order by 3 desc, 1
with cte as( select if(a.host_goals>b.guest_goals,a.host_team,NULL) as team, "3" as points from matches a, matches b where a.match_id = b.match_id UNION ALL select if(a.host_goals<b.guest_goals,a.GUEST_TEAM,NULL) as team, "3" as points from matches a, matches b where a.match_id = b.match_id UNION ALL select if(a.host_goals=b.guest_goals,a.HOST_TEAM,NULL) as team, "1" as points from matches a, matches b where a.match_id = b.match_id UNION ALL select if(a.host_goals=b.guest_goals,a.GUEST_TEAM,NULL) as team, "1" as points from matches a, matches b where a.match_id = b.match_id ) select t.team_id, t.team_name, cast(ifnull(sum(points),0) as decimal) as num_points from cte c right join teams t on t.team_id = c.team group by 1,2 order by 3 desc, 1
with cte as( select if(a.host_goals>b.guest_goals,a.host_team,NULL) as winning_team, "3" as points from matches a, matches b where a.match_id = b.match_id UNION ALL select if(a.host_goals<b.guest_goals,a.GUEST_TEAM,NULL) as winning_team, "3" as points from matches a, matches b where a.match_id = b.match_id UNION ALL select if(a.host_goals=b.guest_goals,a.HOST_TEAM,NULL) as winning_team, "1" as points from matches a, matches b where a.match_id = b.match_id UNION ALL select if(a.host_goals=b.guest_goals,a.GUEST_TEAM,NULL) as winning_team, "1" as points from matches a, matches b where a.match_id = b.match_id ) select t.team_id, t.team_name, cast(ifnull(sum(points),0) as decimal) as num_points from cte c right join teams t on t.team_id = c.winning_team group by 1,2 order by 3 desc, 1
with cte as( select t.team_id,t.team_name,sum(case when m.host_Goals > m.guest_goals then 3 when m.host_Goals = m.guest_goals then 1 else 0 end) as num from Teams t left join Matches M On T.team_id = M.host_team group by t.team_id,t.team_name order by num desc,t.team_id asc ) select t.team_id,t.team_name,num + sum(case when m2.host_Goals = m2.guest_goals then 1 when m2.host_Goals < m2.guest_goals then 3 else 0 end) as 'num_points' from cte t left join Matches M2 On T.team_id = M2.guest_team group by t.team_id,t.team_name order by num_points desc,t.team_id asc
with cte as(select host_team as team, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as point from matches union all select guest_team as team, case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 else 1 end as point from matches) select team_id, team_name, ifnull(sum(point),0) as num_points from teams a left join cte b on a.team_id = b.team group by team_id order by num_points desc, team_id asc
with cte as(select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as host_points, case when host_goals > guest_goals then 0 when host_goals < guest_goals then 3 else 1 end as guest_points from Matches), cte2 as(select host_team as team, host_points as num_points from cte union all select guest_team as team, guest_points as num_points from cte) select t.team_id, team_name, ifnull(sum(num_points),0) as num_points from cte2 right join Teams t on t.team_id = cte2.team group by t.team_id order by num_points desc, team_id
with cte as(select match_id, host_team as team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as score from Matches union select match_id, guest_team as team, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as score from Matches) select team_id, team_name, ifnull(sum(score),0) as num_points from teams t left join cte c on c.team = t.team_id group by 1,2 order by 3 desc,1
with cte as(select match_id, host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_score, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as guest_score from Matches) select y.team_id, y.team_name, ifnull(sum(score),0) as num_points from(select host_team as team, host_score as score from cte union all select guest_team as team, guest_score as score from cte) x right join Teams y on x.team = y.team_id group by 1,2 order by 3 desc, 1 asc
with cte1 as ( select match_id,host_team,guest_team, case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals<guest_goals then 0 end as host_score, case when guest_goals>host_goals then 3 when guest_goals=host_goals then 1 when guest_goals<host_goals then 0 end as guest_score from Matches ), cte2 as ( select host_team as team_id, sum(host_score) as num_points from cte1 group by host_team union all select guest_team as team_id, sum(guest_score) as num_points from cte1 group by guest_team ), cte3 as ( select team_id, sum(num_points) as num_points from cte2 group by team_id ) select a.team_id,a.team_name, COALESCE(b.num_points, 0 ) as num_points from Teams a left join cte3 b on a.team_id=b.team_id order by num_points desc, a.team_id asc
with cte1 as (select m.match_id, t.team_name as home, t2.team_name as away, m.host_goals as home_goals, m.guest_goals as away_goals from Matches m left join Teams t on m.host_team=t.team_id left join Teams t2 on m.guest_team=t2.team_id), cte2 as (select *, case when home_goals > away_goals then 3 when home_goals = away_goals then 1 when home_goals < away_goals then 0 end as home_pts, case when away_goals > home_goals then 3 when away_goals = home_goals then 1 when away_goals < home_goals then 0 end as away_pts from cte1) select t1.team_id, t1.team_name, ifnull(sum(t2.num_points),0) as num_points from Teams t1 left join (select home as team, sum(home_pts) as num_points from cte2 group by home union all select away as team, sum(away_pts) as num_points from cte2 group by away) t2 on t1.team_name=t2.team group by t1.team_name order by num_points desc, t1.team_id
with cte1 as (select sum(case when host_goals = guest_goals then 1 when host_goals > guest_goals then 3 else 0 end) as points, host_team as team_id from Matches group by host_team), cte2 as (select sum(case when host_goals = guest_goals then 1 when host_goals < guest_goals then 3 else 0 end) as points, guest_team as team_id from Matches group by guest_team), cte3 as (select * from cte1 union all select * from cte2) select Teams.team_id, team_name, ifnull(sum(points), 0) as num_points from cte3 right join Teams on Teams.team_id = cte3.team_id group by team_id order by num_points desc, Teams.team_id
with cte_1 as ( select host_team as team_id , if(host_goals > guest_goals, 3, if(host_goals = guest_goals, 1, 0)) as points from Matches union all select guest_team as team_id , if(host_goals < guest_goals, 3, if(host_goals = guest_goals, 1, 0)) as points from Matches ) select Teams.team_id , team_name , sum(coalesce(points, 0)) as num_points from Teams left join cte_1 using (team_id) group by 1, 2 order by 3 desc, 1 asc
with data_cte as ( select host_team as "team_id", (case when host_goals>guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) num_points from matches union all select guest_team as "team_id", (case when host_goals<guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) num_points from matches ) select t.team_id, t.team_name, coalesce(sum(num_points),0) as "num_points" from Teams t left join data_cte d on d.team_id = t.team_id group by t.team_id, t.team_name order by coalesce(sum(num_points),0) desc, t.team_id asc
with host as ( select host_team, sum(case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) pos from matches group by 1 ), guest as ( select guest_team, sum(case when guest_goals>host_goals then 3 when guest_goals=host_goals then 1 else 0 end) pos from matches group by 1 ) select t.team_id, t.team_name, case when h.pos is null and g.pos is null then 0 when h.pos is null and g.pos >= 0 then g.pos when g.pos is null and h.pos >= 0 then h.pos else h.pos + g.pos end as num_points from teams t left join host h on t.team_id = h.host_team left join guest g on t.team_id = g.guest_team order by 3 desc, 1
with host as( select match_id, host_team as team_id,3 as num_points from Matches where host_goals > guest_goals ), guest as ( select match_id, guest_team as team_id, 3 as num_points from Matches where host_goals < guest_goals ), equalguest as ( select match_id, guest_team as team_id, 1 as num_points from Matches where host_goals = guest_goals ), equalhost as ( select match_id, host_team as team_id, 1 as num_points from Matches where host_goals = guest_goals ) select Teams.team_id, team_name, sum(ifnull(num_points,0)) as num_points from Teams left outer join ( select team_id, num_points from host union all select team_id, num_points from guest union all select team_id, num_points from equalhost union all select team_id, num_points from equalguest ) as b on Teams.team_id = b.team_id group by team_id order by num_points DESC, team_id ASC
with host_points as (select team_id, team_name, coalesce(sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end),0) as num_points from Matches right join Teams on host_team = team_id group by team_id, team_name ) , guest_points as (select team_id, team_name, coalesce(sum(case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end),0) as num_points from Matches right join Teams on guest_team = team_id group by team_id, team_name ) , host_guest_comb as (select * from host_points union all select * from guest_points ) select team_id, team_name, sum(num_points) as num_points from host_guest_comb group by team_id, team_name order by num_points desc, team_id
with joined_cte as ( select b.team_name as host_team_name, c.team_name as guest_team_name, b.team_id as host_team, c.team_id as guest_team, a.host_goals, a.guest_goals from matches a left join teams b on a.host_team = b.team_id left join teams c on a.guest_team = c.team_id ) select a.team_id, a.team_name, sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end)num_points from teams a left join (select host_team, host_team_name, host_goals, guest_goals from joined_cte union all select guest_team, guest_team_name, guest_goals, host_goals from joined_cte )b on a.team_id = b.host_team group by 1, 2 order by 3 desc, 1
with mer as (select host_team, sum( case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as host_team_point from Matches group by host_team union all select guest_team, sum( case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end) as guest_team_point from Matches group by guest_team) select t.team_id as team_id, t.team_name, ifnull(sum(m.host_team_point),0) as num_points from Teams t left join mer m on t.team_id = m.host_team group by t.team_id order by num_points desc, team_id ASC
with new as( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from matches) select t.team_id, team_name, ifnull(sum(num_points),0) as num_points from teams as t left join new as n on t.team_id = n.team_id group by t.team_id order by num_points desc, team_id
with p_table AS (SELECT host_team AS team , CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT guest_team AS team , CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches) SELECT t.team_id, t.team_name, IFNULL(SUM(p.points),0) AS num_points FROM Teams t LEFT JOIN p_table p ON p.team = t.team_id GROUP BY t.team_id ORDER BY IFNULL(SUM(p.points),0) DESC, t.team_id ASC
with point_tab as ( select *, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_points, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as guest_points from Matches ), host_table as ( select t.team_id, t.team_name, sum(p.host_points) as num_points from Teams t left join point_tab p on t.team_id = p.host_team group by t.team_id ), guest_table as ( select t.team_id, t.team_name, sum(p.guest_points) as num_points from Teams t left join point_tab p on t.team_id = p.guest_team group by t.team_id ), union_tab as ( select * from guest_table union all select * from host_table ) select team_id, team_name, ifnull(sum(num_points),0) as num_points from union_tab group by team_id order by num_points desc, team_id asc
with points as ( select host_team as team_id, case when host_goals > guest_goals then 3 when guest_goals > host_goals then 0 else 1 end as points from matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when host_goals > guest_goals then 0 else 1 end as points from matches) select t.team_id, t.team_name, coalesce(sum(p.points), 0) as num_points from teams t left join points p on t.team_id = p.team_id group by t.team_id, t.team_name order by 3 desc, 1 asc
with points as ( select m.host_team as team, case when m.host_goals > m.guest_goals then 3 when m.host_goals = m.guest_goals then 1 else 0 end as points from matches m union all select m.guest_team as team, case when m.guest_goals > m.host_goals then 3 when m.host_goals = m.guest_goals then 1 else 0 end points from matches m ) select t.team_id, min(t.team_name) team_name, sum(p.points) num_points from points p inner join teams t on p.team = t.team_id group by t.team_id union all select t.team_id, t.team_name, 0 from teams t left join points p on p.team = t.team_id where p.points is null order by 3 desc, team_id
with points as ( select match_id, host_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_team_points, guest_team, case when guest_goals > host_goals then 3 when guest_goals = host_goals then 1 else 0 end as guest_team_points from Matches ), total as ( select host_team as team_id, sum(host_team_points) as num_points from ((select host_team, host_team_points from points) union all (select guest_team, guest_team_points from points)) a group by 1 ) select t1.team_id, t1.team_name, coalesce(t2.num_points, 0) as num_points from Teams t1 left join total t2 on t1.team_id = t2.team_id order by 3 desc, 1 asc
with points as (select *, case when host_goals>guest_goals then 3 when host_goals<guest_goals then 0 else 1 end as host_points, case when host_goals>guest_goals then 0 when host_goals<guest_goals then 3 else 1 end as guest_points from matches) select b.team_id,b.team_name,coalesce(sum(a.num_points),0) as num_points from (select host_team as team_id, sum(host_points) as num_points from points group by host_team union all select guest_team as team_id, sum(guest_points) as num_points from points group by guest_team) a right join teams b on a.team_id = b.team_id group by b.team_id order by num_points desc, b.team_id
with points1 as ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from Matches union all select guest_team as team_id, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from Matches ), points as ( select team_id, sum(num_points) as num_points from points1 group by team_id ) select Teams.team_id, team_name, coalesce(num_points, 0) as num_points from Teams left outer join points on Teams.team_id = points.team_id order by coalesce(num_points, 0) desc, Teams.team_id asc
with points_tbl as( select host_team as team_id, sum(case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as points from matches group by host_team union all select guest_team as team_id, sum(case when host_goals<guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) as points from matches group by guest_team) select t1.team_id,t1.team_name,coalesce(points_ttl,0) as num_points from teams t1 left join (select team_id,sum(points) as points_ttl from points_tbl group by team_id) t2 on t1.team_id=t2.team_id group by t1.team_id,t1.team_name order by coalesce(points_ttl,0) desc, t1.team_id asc
with pts as ((Select host_team, case When host_goals > guest_goals Then 3 When host_goals = guest_goals Then 1 Else 0 End AS host_score from Matches) Union all (Select guest_team, case When host_goals > guest_goals Then 0 When host_goals = guest_goals Then 1 Else 3 End as guest_score from Matches)) select t.team_id, t.team_name, ifnull(sum(p.host_score), 0) as num_points from pts p right join Teams t on p.host_team = t.team_id group by t.team_id order by num_points desc, team_id asc
with s as ( select host_team, (case when host_goals>guest_goals then 3 when host_goals<guest_goals then 0 else 1 end) as host_score from Matches union all select guest_team, (case when host_goals<guest_goals then 3 when host_goals>guest_goals then 0 else 1 end) as guest_score from Matches ) select t.team_id, t.team_name, ifnull(sum(host_score),0) as num_points from Teams t left join s on t.team_id = s.host_team group by 1 order by 3 desc,1
with s as ( select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_points, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as guest_points from matches ), h as ( select host_team as team_id, host_points as points from s ), g as ( select guest_team as team_id, guest_points as points from s ), u as ( select * from h union all select * from g ), j as ( select team_id, team_name, sum(points) as num_points from u join teams using(team_id) group by team_id order by sum(points) desc ) select team_id, t.team_name, ifnull(num_points,0) as num_points from teams t left join j using(team_id) order by num_points desc, team_id
with s1 as (select m1.host_team as team_id, sum(case when host_goals > guest_goals then 3 when host_goals=guest_goals then 1 else 0 ENd) as num_points from Matches m1 group by m1.host_team), s2 as(select m2.guest_team as team_id, sum(case when guest_goals >host_goals then 3 when host_goals=guest_goals then 1 else 0 ENd) as num_points from Matches m2 group by m2.guest_team) select Teams.team_id, Teams.team_name, ifnull(sum(s3.num_points),0) as num_points from Teams left join (select * from s1 union all select * from s2) as s3 on Teams.team_id = s3.team_id group by Teams.team_id order by num_points desc, team_id
with s1 as (select m1.host_team as team_id, sum(case when host_goals > guest_goals then 3 when host_goals=guest_goals then 1 else 0 ENd) as num_points from Matches m1 group by m1.host_team), s2 as(select m2.guest_team as team_id, sum(case when guest_goals >host_goals then 3 when host_goals=guest_goals then 1 else 0 ENd) as num_points from Matches m2 group by m2.guest_team) select Teams.team_id, Teams.team_name, ifnull(sum(s3.num_points),0) as num_points from Teams left join (select * from s1 union all select * from s2) as s3 on Teams.team_id = s3.team_id group by Teams.team_id order by num_points desc, team_id asc
with scores as ( select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from matches union all select guest_team as team_id, case when guest_goals>host_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from matches ) select r.team_id, r.team_name, ifnull(sum(s.num_points), 0) as num_points from scores s right join teams r on s.team_id = r.team_id group by r.team_id, r.team_name order by ifnull(sum(s.num_points), 0) desc, r.team_id asc
with scores as ( select match_id, host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as host_score, case when host_goals > guest_goals then 0 when host_goals < guest_goals then 3 else 1 end as guest_score from Matches ), host as ( select host_team, sum(host_score) as sum_host_score from scores group by host_team ), guest as ( select guest_team, sum(guest_score) as sum_guest_score from scores group by guest_team ) select Teams.team_id, team_name, ifnull(sum_guest_score,0) + ifnull(sum_host_score,0) as num_points from Teams left join host on host.host_team = Teams.team_id left join guest on guest.guest_team = Teams.team_id order by num_points desc, Teams.team_id
with t as ( SELECT *, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END As host_num_points, CASE WHEN guest_goals > host_goals THEN 3 WHEN guest_goals = host_goals THEN 1 ELSE 0 END As guest_num_points FROM Matches ) SELECT team_id, team_name, SUM(num_points) As num_points FROM ( SELECT t0.team_id, t0.team_name, IFNULL(SUM(t.host_num_points),0) As 'num_points' FROM Teams t0 LEFT JOIN t ON team_id = t.host_team GROUP BY t0.team_id, t0.team_name UNION ALL SELECT t0.team_id, t0.team_name, IFNULL(SUM(t.guest_num_points),0) As 'num_points' FROM Teams t0 LEFT JOIN t ON team_id = t.guest_team GROUP BY t0.team_id, t0.team_name ) As t1 GROUP BY team_id, team_name ORDER BY num_points DESC, team_id
with t as ( select *, (case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as host_scores, (case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end) as guest_scores from Matches ) select distinct Teams.team_id, Teams.team_name, sum(ifnull(t2.team_scores,0)) as num_points from Teams left join ( select host_team team_id, host_scores team_scores from t union all select guest_team team_id, guest_scores team_scores from t) t2 on Teams.team_id = t2.team_id group by Teams.team_id, Teams.team_name order by num_points desc, team_id asc
with t as ((select h.match_id, h.host_team as team, case when h.host_goals > h.guest_goals then 3 when h.host_goals = h.guest_goals then 1 else 0 end as score from matches h) union (select g.match_id, g.guest_team as team, case when g.guest_goals > g.host_goals then 3 when g.guest_goals = g.host_goals then 1 else 0 end as score from matches g)) , cte as( select t.team, sum(score) as num_points from t group by t.team) select t.team_id, t.team_name, coalesce(z.num_points,0) as num_points from teams t left join cte z on t.team_id= z.team order by coalesce(z.num_points,0) desc, t.team_id
with t as ((select h.match_id, h.host_team as team, case when h.host_goals > h.guest_goals then 3 when h.host_goals = h.guest_goals then 1 else 0 end as score from matches h) union (select g.match_id, g.guest_team as team, case when g.guest_goals > g.host_goals then 3 when g.guest_goals = g.host_goals then 1 else 0 end as score from matches g)) select t.team_id, t.team_name, coalesce(z.num_points,0) as num_points from teams t left join (select t.team, sum(score) as num_points from t group by t.team) z on t.team_id= z.team order by coalesce(z.num_points,0) desc, t.team_id
with t as ((select h.match_id, h.host_team as team, case when h.host_goals > h.guest_goals then 3 when h.host_goals = h.guest_goals then 1 else 0 end as score from matches h) union (select g.match_id, g.guest_team as team, case when g.guest_goals > g.host_goals then 3 when g.guest_goals = g.host_goals then 1 else 0 end as score from matches g)) select t.team_id, t.team_name, ifnull(z.num_points,0) as num_points from teams t left join (select t.team, sum(score) as num_points from t group by t.team) z on t.team_id= z.team order by coalesce(z.num_points,0) desc, t.team_id
with t1 as ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches ), t2 as ( select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches ), t3 as ( select team_id, points from t1 union all select team_id, points from t2 ) select team_id, team_name, ifnull(sum(points), 0) as num_points from teams left join t3 using(team_id) group by team_id order by num_points desc, team_id
with t1 as ( select host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_points, case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end as guest_points from matches ), t2 as ( (select host_team as team_id, host_points as points from t1 ) union all (select guest_team as team_id, guest_points as points from t1) ) select teams.team_id, teams.team_name, coalesce(sum(points), 0) as num_points from teams left join t2 on t2.team_id=teams.team_id group by teams.team_id, teams.team_name order by num_points desc, teams.team_id
with t1 as (select *, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as host_pts, case when guest_goals > host_goals then 3 when host_goals = guest_goals then 1 else 0 end as guest_pts from matches) select tm.team_id, tm.team_name, IFNULL(sum(t2.pts),0) as num_points from (select host_team as team_id, sum(host_pts) as pts from t1 group by host_team union all select guest_team as team_id, sum(guest_pts) as pts from t1 group by guest_team) t2 right join teams tm on tm.team_id = t2.team_id group by tm.team_id, tm.team_name order by num_points desc, tm.team_id
with t1 as( select host_team as team_id, (case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as num_points from matches union all select guest_team as team_id, (case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as num_points from matches ) select t.team_id, t.team_name, sum(ifnull(t1.num_points, 0)) as num_points from t1 right join teams as t on t1.team_id = t.team_id group by t.team_id order by num_points desc, t.team_id asc
with t1 as( select team, sum(points) as points from( select host_team as team, 3 as points from matches where host_goals > guest_goals) t group by team ), t2 as( select team, sum(points) as points from( select guest_team as team, 3 as points from matches where guest_goals > host_goals) t group by team ), t3 as( select team, sum(points) as points from ( select team, sum(points) as points from( select guest_team as team, 1 as points from matches where guest_goals = host_goals) t10 group by team union all select team, sum(points) as points from ( select host_team as team, 1 as points from matches where guest_goals = host_goals) t11 group by team ) t group by team ), t4 as ( select t1.team, t1.points from t1 union all select t2.team, t2.points from t2 union all select t3.team, t3.points from t3 ), t5 as( select team_id as team, 0 as points from teams where team_id not in (select distinct(team) from t4 as team_id) ), t6 as ( select t4.team, sum(t4.points) as points from t4 group by team union all select t5.team, sum(t5.points) as points from t5 group by team ) select t7.team_id, t7.team_name, t6.points as num_points from teams t7 inner join t6 on t7.team_id = t6.team order by num_points desc, team_id
with tab1 as (SELECT host_team as team, CASE WHEN host_goals > guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches UNION ALL SELECT guest_team as team, CASE WHEN host_goals < guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END AS points FROM Matches) SELECT team_id,team_name, COALESCE(SUM(points),0) as num_points FROM Teams LEFT JOIN tab1 ON tab1.team = team_id GROUP BY team_id ORDER BY num_points DESC, team_id ASC
with tbl as ( select match_id, host_team as team_id, case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 else 1 end as s_score from Matches union select match_id, guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals > guest_goals then 0 else 1 end as s_score from Matches ) select t.team_id, t.team_name, ifnull(sum(s_score), 0) as num_points from tbl right join Teams t on t.team_id = tbl.team_id group by 1,2 order by 3 desc, t.team_id asc
with team_matches as ( select match_id, host_team, guest_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 when host_goals < guest_goals then 0 end as host_score, case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 when host_goals < guest_goals then 3 end as guest_score from Matches) select T.team_id, T.team_name, ifnull(sum(TBL.team_score),0) as num_points from( select match_id, host_team as team_id, sum(host_score) as team_score from team_matches group by 1 union select match_id, guest_team as team_id, sum(guest_score) as team_score from team_matches group by 1 ) TBL right join Teams T on TBL.team_id = T.team_id group by 1,2 order by ifnull(sum(team_score),0) desc, team_id
with team_points as ( select host_team ,guest_team ,case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end host_points ,case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 else 3 end guest_points from Matches ) select teams.team_id ,teams.team_name ,ifnull(sum(tpoints.points),0) as num_points from Teams teams left join ( select host_team team_id ,host_points points from team_points union all select guest_team team_id ,guest_points points from team_points ) tpoints on teams.team_id = tpoints.team_id group by teams.team_id,teams.team_name order by num_points desc,team_id
with team_points as (select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches union all select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as points from matches), cumulative_points as (select team_id, sum(points) as num_points from team_points group by team_id) select a.team_id, a.team_name, coalesce(num_points,0) as num_points from teams a left join cumulative_points b on (a.team_id = b.team_id) order by coalesce(num_points,0) desc, a.team_id
with team_score as ( select host_team, guest_team , if(host_goals>guest_goals, 3, if(host_goals<guest_goals, 0, 1)) as host_score , if(host_goals<guest_goals, 3, if(host_goals>guest_goals, 0, 1)) as guest_score from matches ) select t.team_id, team_name, ifnull(sum(num_points), 0) as num_points from ( select host_team as team_id, host_score as num_points from team_score union all select guest_team, guest_score from team_score ) tmp right join teams t on t.team_id=tmp.team_id group by 1 order by num_points desc, team_id
with temp as ( ( select host_team as team_id, case when host_goals>guest_goals then 3 when host_goals<guest_goals then 0 else 1 end as points from matches ) union all ( select guest_team as team_id, case when host_goals<guest_goals then 3 when host_goals>guest_goals then 0 else 1 end as points from matches ) ) select t.team_id, team_name, ifnull(sum(points),0) as num_points from teams t left join temp p on t.team_id=p.team_id group by t.team_id, team_name order by num_points desc, team_id
with temp as ( select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from Matches union all select guest_team as team_id, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from Matches ), temp1 as ( select team_id, sum(num_points) as num_points from temp group by team_id) select t.team_id, team_name, case when temp1.num_points is NULL then 0 else temp1.num_points end as num_points from Teams as t left join temp1 on t.team_id = temp1.team_id order by num_points desc, team_id
with temp as ( select host_team as team_id, case when host_goals> guest_goals then 3 when host_goals< guest_goals then 0 else 1 end as points from matches union all select guest_team as team_id, case when host_goals> guest_goals then 0 when host_goals< guest_goals then 3 else 1 end as points from matches) select t.team_id, team_name, ifnull(sum(points),0) as num_points from temp right join teams as t using (team_id) group by 1,2 order by 3 desc, 1
with temp as ( select host_team as team_id, case when host_goals> guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as goals from matches union all select guest_team as team_id, case when host_goals< guest_goals then 3 when host_goals=guest_goals then 1 else 0 end as goals from matches) select teams.team_id, team_name , ifnull(sum(goals),0) as num_points from teams left join temp on temp.team_id = teams.team_id group by team_id order by num_points desc, team_id
with temp as (select host_team as team_id, ifnull(sum(case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 end),0) as points from matches group by 1 union all select guest_team as team_id, ifnull(sum(case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 end),0) as points from matches group by 1) select teams.team_id, team_name, ifnull(sum(points),0) as num_points from teams left join temp on teams.team_id = temp.team_id group by 1 order by 3 desc, 1 asc
with temp as (select match_id, host_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 when host_goals < guest_goals then 0 end as points, guest_team, case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 when host_goals > guest_goals then 0 end as guest_points from matches) , temp2 as (select host_team, points from temp union all (select guest_Team, guest_points from temp)) select teams.team_id, team_name, ifnull(t.num_points,0) as num_points from (select host_team as team_id, sum(points) as num_points from temp2 group by host_team) t right join teams on teams.team_id = t.team_id order by num_points desc, team_id
with temp as( select *, (case when host_goals > guest_goals then 3 when host_goals < guest_goals then 0 when host_goals = guest_goals then 1 end) as host_score, (case when host_goals > guest_goals then 0 when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 end) as guest_score from Matches) select Teams.team_id, Teams.team_name, sum(ifnull(score_table.team_score,0)) as num_points from ( select host_team as team_id, host_score as team_score from temp union all select guest_team as team_id, guest_score as team_score from temp ) as score_table right join Teams on score_table.team_id = Teams.team_id group by 1 order by 3 desc,1
with temp2 as ( select host_team, guest_team, case when host_goals>guest_goals then "home" when host_goals = guest_goals then "tie" when host_goals<guest_goals then "away" end as match_result from Matches ) ,temp3 as ( select team, sum(points) as points from ( select host_team as team, sum( case when match_result="home" then 3 when match_result="tie" then 1 else 0 end) as points from temp2 group by 1 union all select guest_team as team, sum( case when match_result="away" then 3 when match_result="tie" then 1 else 0 end) as points from temp2 group by 1 ) g group by 1 ) select Teams.team_id as team_id,team_name, coalesce(points,0) as num_points from Teams left outer join temp3 on Teams.team_id = temp3.team order by 3 desc, 1
with tmp as (select * from matches union all select match_id, guest_team as host_team, host_team as guest_team, guest_goals as host_goals, host_goals as guest_goals from matches ) select a.team_id, a.team_name, ifnull(sum(case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 when host_goals<guest_goals then 0 end),0) as num_points from teams a left join tmp b on a.team_id=b.host_team group by 1,2 order by 3 desc, 1
with tmp as (select host_team as team_id, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 when host_goals < guest_goals then 0 end as num_points from Matches union all select guest_team as team_id, case when host_goals > guest_goals then 0 when host_goals = guest_goals then 1 when host_goals < guest_goals then 3 end as num_points from Matches) select t2.team_id, t2.team_name, ifnull(sum(num_points),0) as num_points from Teams t2 left join tmp t1 on t1.team_id = t2.team_id group by 1,2 order by 3 desc , 1 asc
with tmp as( (select match_id, guest_team as host_team,host_team as guest_team, guest_goals as host_goals,host_goals as guest_goals from Matches) union all (select * from Matches)) select t.team_id as team_id, t.team_name, ifnull(sum(a.score),0) num_points from (select (case when host_goals>guest_goals then 3 when host_goals=guest_goals then 1 else 0 end) score, host_team from tmp)a right join Teams t on a.host_team = t.team_id group by t.team_id order by num_points desc, team_id asc
with total_matches as ( select * from matches m union all select match_id, guest_team, host_team, guest_goals, host_goals from matches m ) , match_points as( select host_team, case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end as num_points from total_matches t ) select t.team_id, t.team_name, coalesce(sum(num_points),0) as num_points from Teams t left join match_points m on m.host_team = t.team_id group by 1,2 order by 3 desc, 1
with u as (select host_team as team_id, case when host_goals=guest_goals then 1 when host_goals>guest_goals then 3 else 0 end as num_points from matches union all select guest_team as team_id, case when host_goals=guest_goals then 1 when host_goals<guest_goals then 3 else 0 end as num_points from matches) select t.team_id, team_name, coalesce(sum(num_points),0) as num_points from u right join teams t on u.team_id=t.team_id group by t.team_id order by num_points desc, team_id
with with_diff as( Select Matches.*, host_goals-guest_goals as difference from Matches ), teams_diff as( select host_team, difference from with_diff UNION ALL select guest_team, 0-difference from with_diff ), add_additional as ( select * from teams_diff UNION ALL (select team_id, -1 as with_diff from Teams where team_id not in (select host_team from teams_diff)) ) select d.host_team as team_id, t.team_name, sum(case when difference > 0 then 3 when difference < 0 then 0 else 1 end) as num_points from Teams t join add_additional d on t.team_id = d.host_team group by 1,2 order by 3 desc, 1 asc
with zte as (select host_team, guest_team, (case when host_goals > guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as host_score, (case when host_goals < guest_goals then 3 when host_goals = guest_goals then 1 else 0 end) as guest_score from Matches) select team_id,team_name, ifnull(num_points,0) as num_points from Teams left join (select team,sum(score) as num_points from(select host_team as team, host_score as score from zte union all select guest_team as team, guest_score as score from zte) temp group by 1) temp1 on Teams.team_id = temp1.team order by 3 desc, 1
