(SELECT order_id, MAX(quantity) AS maxqnt FROM OrdersDetails GROUP BY order_id), a AS (SELECT order_id, AVG(quantity) AS avgqnt FROM OrdersDetails GROUP by order_id) SELECT m.order_id FROM m WHERE maxqnt > (SELECT MAX(avgqnt) FROM a)
FROM OrdersDetails GROUP by order_id HAVING MAX(quantity) > (SELECT MAX(avg_q) FROM (SELECT order_id, AVG(quantity) AS avg_q FROM OrdersDetails GROUP BY order_id) a)
SELECT A. order_id from(SELECT order_id, MAX(quantity) as max_quantity FROM OrdersDetails GROUP BY order_id) as A WHERE A.max_quantity > (SELECT MAX(B.avg_quantity) from (SELECT order_id, AVG(quantity) as avg_quantity FROM OrdersDetails GROUP BY order_id) as B)
SELECT DISTINCT order_id FROM (SELECT order_id, max_quantity > Max(avg_order) OVER() AS flag FROM (SELECT order_id, Sum(quantity) / Count(DISTINCT product_id) AS avg_order, Max(quantity) AS max_quantity FROM ordersdetails GROUP BY order_id) a) b WHERE flag = 1
SELECT DISTINCT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT SUM(quantity) / COUNT(DISTINCT product_id) AS avg_qua FROM OrdersDetails GROUP BY order_id ORDER BY avg_qua DESC LIMIT 1)
SELECT DISTINCT order_id FROM OrdersDetails WHERE quantity > (SELECT MAX(mean) AS max_mean FROM (SELECT order_id, AVG(quantity) AS mean FROM OrdersDetails GROUP BY order_id) a)
SELECT OrdersDetails.order_id FROM OrdersDetails, (SELECT order_id, AVG(quantity) AS avg FROM OrdersDetails GROUP BY order_id) tmp GROUP BY order_id HAVING MAX(quantity) > MAX(tmp.avg)
SELECT a.order_id from (SELECT order_id, avg(quantity)as avgs,max(quantity)as maxs FROM OrdersDetails GROUP BY order_id )a join (SELECT order_id, avg(quantity)as avgs,max(quantity)as maxs FROM OrdersDetails GROUP BY order_id )b on a.maxs>b.avgs group by a.order_id having count(b.avgs)=(select count(distinct order_id) from OrdersDetails)
SELECT m.order_id FROM ( SELECT order_id ,AVG(quantity) AS average_quantity ,MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) m WHERE max_quantity > ( SELECT MAX(average_quantity) AS max_average_quantity FROM ( SELECT AVG(quantity) AS average_quantity FROM OrdersDetails GROUP BY order_id ) t )
SELECT order_id FROM ( SELECT order_id, MAX(SUM(quantity) / COUNT(product_id)) OVER () AS max_avg_count, MAX(quantity) AS max_quant FROM OrdersDetails GROUP BY order_id ) tmp WHERE max_quant > max_avg_count
SELECT order_id FROM ( SELECT order_id, MAX(quantity) AS maxq FROM OrdersDetails GROUP BY order_id ) a WHERE maxq > ( SELECT MAX(avgq) FROM ( SELECT order_id, AVG(quantity) AS avgq FROM OrdersDetails GROUP BY order_id ) b )
SELECT order_id FROM (SELECT order_id,MAX(quantity) maximum FROM OrdersDetails GROUP BY order_id) a WHERE maximum>(SELECT top FROM (SELECT avg(quantity) top FROM OrdersDetails GROUP BY order_id ORDER BY 1 DESC LIMIT 1) a)
SELECT order_id FROM ORdersDetails GROUP BY order_id having max(quantity) > (select max(avgQty) from (SELECT order_id ,avg(quantity) as avgQty FROM OrdersDetails GROUP BY order_id) a)
SELECT order_id FROM OrdersDetails GROUP BY 1 HAVING MAX(quantity) > (SELECT MAX(average_quantity) FROM (SELECT order_id, AVG(quantity) as average_quantity FROM OrdersDetails GROUP BY 1) t)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT MAX(average) FROM ( SELECT AVG(quantity) AS average FROM OrdersDetails GROUP BY order_id ) AS t )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT MAX(average) FROM ( SELECT order_id, SUM(quantity)/COUNT(product_id) as average FROM OrdersDetails GROUP BY order_id ) as T)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT MAX(avg_qty) FROM ( SELECT SUM(quantity) / COUNT(product_id) avg_qty FROM OrdersDetails GROUP BY order_id ) tmp )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT MAX(quantity) FROM ( SELECT AVG(quantity) AS quantity FROM OrdersDetails GROUP BY order_id) T )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT SUM(quantity) / COUNT(product_id) FROM OrdersDetails GROUP BY order_id ORDER BY 1 DESC LIMIT 1 )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT SUM(quantity)/COUNT(DISTINCT product_id) AS max_average FROM OrdersDetails GROUP BY order_id ORDER BY max_average DESC LIMIT 1 )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(A. avg_quantity) from (SELECT order_id, AVG(quantity) as avg_quantity FROM OrdersDetails GROUP BY order_id) AS A)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(AVE_Q) FROM (SELECT order_id, SUM(quantity)/COUNT(DISTINCT product_id) AS AVE_Q FROM OrdersDetails GROUP BY order_id ORDER BY 2 DESC) A)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(AVE_Q) FROM (SELECT order_id, SUM(quantity)/COUNT(DISTINCT product_id) AS AVE_Q FROM OrdersDetails GROUP BY order_id) A)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(AVG_Q) FROM(SELECT AVG(quantity) AVG_Q FROM OrdersDetails GROUP BY order_id) AS T)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(B.avg_quantity) from (SELECT order_id, AVG(quantity) as avg_quantity FROM OrdersDetails GROUP BY order_id) as B)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(avg_qty) FROM (SELECT order_id, AVG(quantity) AS avg_qty, MAX(quantity) AS max_qty FROM OrdersDetails GROUP BY order_id) t)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT SUM(quantity) / COUNT(product_id) FROM OrdersDetails GROUP BY order_id ORDER BY 1 DESC LIMIT 1)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL ( SELECT (SUM(quantity) / COUNT(DISTINCT product_id)) AS avg_q FROM OrdersDetails GROUP BY order_id ) ORDER BY order_id
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL ( SELECT (SUM(quantity) / COUNT(DISTINCT product_id)) AS avg_quant_order FROM OrdersDetails GROUP BY order_id )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL ( SELECT (SUM(quantity) / COUNT(DISTINCT product_id)) AS avg_quant_order FROM OrdersDetails GROUP BY order_id ) ORDER BY order_id ASC
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL ( SELECT (SUM(quantity)/COUNT(DISTINCT product_id)) AS avg_quant_order FROM OrdersDetails GROUP BY order_id ) ORDER BY order_id
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL ( SELECT AVG(quantity) FROM OrdersDetails GROUP BY order_id )
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL ( SELECT AVG(quantity) FROM OrdersDetails GROUP BY order_id)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > all (select avg(quantity) as quant from OrdersDetails group by order_id)
SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity)> ( SELECT SUM(quantity)/COUNT(*) FROM OrdersDetails GROUP BY order_id ORDER BY 1 DESC LIMIT 1 )
SELECT order_id from OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(avg_quantity) FROM (SELECT sum(quantity) / count(product_id) as avg_quantity FROM OrdersDetails GROUP BY order_id ) as t)
SELECT t.order_id FROM ( SELECT order_id, max(quantity) as maximum_quantity, max(avg(quantity)) over() as maxx FROM OrdersDetails group by order_id ) as t where t.maximum_quantity > t.maxx
SELECT t1.order_id FROM ( SELECT order_id , MAX(quantity) max_quantity , MAX(SUM(quantity)/COUNT(DISTINCT product_id)) OVER () avg_quantity FROM OrdersDetails GROUP BY 1) t1 WHERE t1.max_quantity > t1.avg_quantity
SELECT t1.order_id FROM ( SELECT order_id ,AVG(quantity) AS average_quantity ,MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) t1 ,( SELECT order_id ,AVG(quantity) AS average_quantity ,MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) t2 WHERE t1.max_quantity > t2.average_quantity GROUP BY t1.order_id, t1.max_quantity HAVING COUNT(t2.order_id) = (SELECT COUNT(DISTINCT order_id) FROM OrdersDetails)
SELECT x.order_id from (SELECT order_id, MAX(quantity) as m FROM ordersdetails GROUP BY 1) x JOIN (select order_id, sum(quantity)/count(product_id) as average FROM ordersdetails group by 1) y ON x.m>y.average group by 1 having count(distinct y.order_id)=(select count(distinct order_id) from ordersdetails)
Select distinct order_id from (Select max(quantity) m, order_id from OrdersDetails group by order_id ) t where m > all ( Select avg(quantity) from OrdersDetails group by order_id)
Select order_id from ( Select avg(quantity) a, max(quantity) m, order_id from OrdersDetails group by order_id ) t where m > all ( Select avg(quantity) from OrdersDetails group by order_id)
Select order_id from (select order_id, max(quantity) as m, max(sum(quantity)/count(product_id)) over() as ma from OrdersDetails group by 1) x where m > ma
Select order_id from OrdersDetails group by order_id having max(quantity) > all(Select avg(quantity) from OrdersDetails group by order_id)
WITH A AS( SELECT order_id, AVG(quantity) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM A WHERE max_quantity > (SELECT MAX(avg_quantity) AS max_avg_quantity FROM A) ORDER BY order_id ASC
WITH A AS(SELECT order_id, AVG(quantity) as ave FROM OrdersDetails GROUP BY 1), B AS (SELECT order_id, product_id, MAX(quantity) as maxi FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM (SELECT b.order_id, b.product_id, b.maxi, a.order_id as aorder,a.ave FROM B b CROSS JOIN A a WHERE maxi>ave) i GROUP BY 1 HAVING COUNT(*)= (SELECT COUNT(*) FROM b)
WITH AvgQty AS ( select order_id , (sum(quantity)/count(product_id)) as averageqty , max(quantity) as maxqty from OrdersDetails group by order_id ) SELECT order_id FROM AvgQty WHERE maxqty > (SELECT max(averageqty) from AvgQty)
WITH Avg_each AS (SELECT order_id, SUM(quantity)/COUNT(*) AS avg_p, MAX(quantity) AS mx FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM Avg_each WHERE mx > (SELECT MAX(avg_p) AS max_avg FROM Avg_each)
WITH CTE AS (SELECT AVG(quantity) mean FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(mean) FROM CTE)
WITH CTE AS (SELECT order_id, (SUM(quantity) / COUNT(DISTINCT product_id)) AS avg_quant_order, MAX(quantity) AS max_quant FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM CTE WHERE CTE.max_quant > ALL (SELECT avg_quant_order FROM CTE) ORDER BY order_id ASC
WITH CTE AS (SELECT order_id,SUM(quantity)/COUNT(DISTINCT product_id) AS ag, MAX(quantity) AS mx FROM OrdersDetails o GROUP BY 1) SELECT order_id FROM CTE WHERE mx>(SELECT MAX(ag) FROM CTE)
WITH CTE AS (select order_id, max(quantity) as max_qty, avg(quantity) as avg_qty from OrdersDetails GROUP BY order_id) Select c1.order_id from cte c1 where c1.max_qty > (select max(avg_qty) from cte)
WITH CTE1 AS ( SELECT order_id, AVG(quantity) as avg_quantity FROM OrdersDetails GROUP BY order_id ), CTE2 AS ( SELECT order_id, MAX(quantity) as max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT d2.order_id FROM CTE1 as d1 CROSS JOIN CTE2 as d2 WHERE d2.max_quantity > d1.avg_quantity GROUP BY d2.order_id HAVING COUNT(*) = (SELECT COUNT(DISTINCT order_id) FROM OrdersDetails)
WITH M1 AS ( SELECT MAX(O.q) AS q FROM (SELECT order_id, AVG(quantity) AS q FROM OrdersDetails GROUP BY order_id) O ), M2 AS ( SELECT order_id, MAX(quantity) AS mq FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM M2 WHERE mq > (SELECT q FROM M1)
WITH OrderStats AS ( SELECT order_id, (SUM(quantity) / COUNT(DISTINCT product_id)) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM OrderStats WHERE max_quantity > ALL( SELECT avg_quantity FROM OrderStats )
WITH S0 AS (SELECT order_id, AVG(quantity) AS avg_quantity FROM OrdersDetails GROUP BY order_id), S1 AS (SELECT order_id, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id) SELECT S0.order_id FROM S0 INNER JOIN S1 ON S0.order_id = S1.order_id CROSS JOIN (SELECT MAX(avg_quantity) AS thresh FROM S0) S2 WHERE max_quantity > thresh
WITH T1 AS (SELECT *, AVG(quantity) OVER (PARTITION BY order_id) AS average, MAX(quantity) OVER (PARTITION BY order_id) AS M FROM OrdersDetails), T2 AS (SELECT order_id, M, MAX(average) OVER () AS A2 FROM T1) SELECT DISTINCT order_id FROM T2 WHERE M > A2
WITH T1 AS( SELECT SUM(quantity)/COUNT(DISTINCT product_id) AVERAGE FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ALL (SELECT AVERAGE FROM T1)
WITH a AS ( SELECT order_id, AVG(quantity) AS avgq FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(avgq) FROM a)
WITH aggrecate_orders AS ( SELECT order_id, SUM(quantity)/COUNT(DISTINCT product_id) AS average_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM aggrecate_orders WHERE max_quantity > (SELECT MAX(average_quantity) FROM aggrecate_orders)
WITH avg_max AS ( SELECT order_id, AVG(quantity) AS average_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM avg_max WHERE max_quantity > (SELECT MAX(average_quantity) FROM avg_max)
WITH avg_orders AS (SELECT order_id,SUM(quantity)/COUNT(*) AS average_quantity FROM ordersdetails GROUP BY order_id), max_orders as (SELECT order_id, MAX(quantity) as max_quantity FROM ordersdetails GROUP BY order_id) SELECT order_id FROM max_orders WHERE max_quantity > (SELECT max(average_quantity) FROM avg_orders)
WITH avg_q AS ( SELECT order_id, SUM(quantity) / COUNT(DISTINCT product_id) AS avg_q FROM OrdersDetails GROUP BY order_id ) SELECT DISTINCT o.order_id FROM OrdersDetails o WHERE o.quantity > ( SELECT MAX(a.avg_q) FROM avg_q a )
WITH avg_quan AS ( SELECT order_id, SUM(quantity) / COUNT(order_id) AS aq FROM OrdersDetails GROUP BY 1 ), max_quan AS ( SELECT order_id, MAX(quantity) AS mq FROM OrdersDetails GROUP BY 1 ), res AS ( SELECT order_id FROM max_quan WHERE mq > ( SELECT MAX(aq) FROM avg_quan ) ) SELECT * FROM res
WITH avg_quan AS (SELECT order_id,AVG(quantity) OVER(PARTITION BY order_id) as mean_col, MAX(quantity) OVER(PARTITION BY order_id) as maxim FROM OrdersDetails) SELECT DISTINCT(order_id) FROM avg_quan WHERE maxim > (SELECT MAX( mean_col) FROM avg_quan)
WITH avg_quant AS ( SELECT order_id, SUM(quantity)/COUNT(DISTINCT product_id) as avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM avg_quant WHERE max_quantity > (SELECT MAX(avg_quantity) FROM avg_quant)
WITH avg_quantity AS ( SELECT order_id, sum(quantity)/count(product_id) AS avg_quantity FROM OrdersDetails GROUP BY order_id ), max_avg_quantity AS ( SELECT max(avg_quantity) as max_avg_quantity FROM avg_quantity ), max_quantity_per_order AS ( SELECT order_id, max(quantity) as max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM max_quantity_per_order JOIN max_avg_quantity WHERE max_quantity_per_order.max_quantity > max_avg_quantity.max_avg_quantity
WITH cte AS ( SELECT order_id, AVG(quantity) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM cte WHERE max_quantity > ( SELECT MAX(avg_quantity) AS max_avg_quantity FROM cte )
WITH cte AS (SELECT MAX(avg_orders) AS max_avg_order FROM (SELECT order_id, IFNULL(SUM(quantity), 0)/IFNULL(COUNT(DISTINCT product_id), 0) AS avg_orders FROM OrdersDetails GROUP BY 1) t) SELECT order_id FROM (SELECT order_id, MAX(quantity) AS max_qty FROM OrdersDetails GROUP BY 1) q GROUP BY order_id HAVING SUM(CASE WHEN max_qty > (SELECT max_avg_order FROM cte) THEN 1 ELSE 0 END) > 0 ORDER BY 1
WITH cte AS (SELECT order_id, AVG(quantity) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ORDER BY NULL) SELECT order_id FROM cte WHERE max_quantity > (SELECT MAX(avg_quantity) AS max_avg_quantity FROM cte)
WITH cte AS (SELECT order_id, MAX(quantity) AS maxi, MAX(SUM(quantity)/COUNT(product_id)) OVER() AS averg FROM OrdersDetails GROUP BY order_id) SELECT DISTINCT order_id FROM cte WHERE maxi>averg
WITH cte AS (SELECT order_id, MAX(quantity) AS maximum, AVG(quantity) AS average FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM cte WHERE maximum > (SELECT MAX(average) FROM cte)
WITH cte as (SELECT DISTINCT(order_id) as order_id,((SUM(quantity) OVER (PARTITION BY order_id))/(COUNT(product_id) OVER (PARTITION BY order_id))) AS average_quantity, MAX(quantity) OVER (PARTITION BY order_id) as max_quantity FROM OrdersDetails) SELECT order_id FROM cte WHERE max_quantity> (select MAX(average_quantity) from cte)
WITH find_avg AS( SELECT SUM(quantity) / COUNT(DISTINCT product_id) as avg_order FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(avg_order) FROM find_avg)
WITH getAverage AS ( SELECT order_id, ROUND(SUM(quantity)/COUNT(DISTINCT product_id),2) As average_quantity FROM OrdersDetails GROUP BY 1 ) SELECT order_id FROM OrdersDetails GROUP BY 1 HAVING MAX(quantity) > (SELECT MAX(average_quantity) FROM getAverage)
WITH main AS ( SELECT order_id, AVG(quantity) AS avg_qty, MAX(quantity) AS max_qty FROM OrdersDetails GROUP BY order_id ) SELECT M1.order_id AS order_id FROM main M1, main M2 GROUP BY M1.order_id HAVING SUM(M1.max_qty <= M2.avg_qty)= 0
WITH main AS ( SELECT order_id, AVG(quantity) AS avg_qty, MAX(quantity) AS max_qty FROM OrdersDetails GROUP BY order_id ) SELECT M1.order_id FROM main M1, main M2 GROUP BY M1.order_id HAVING SUM(M1.max_qty <= M2.avg_qty)= 0
WITH order_calc as ( SELECT order_id , cast(sum(quantity) as float) / count(product_id) as avg_quantity , max(quantity) as max_quantity FROM OrdersDetails GROUP BY order_id ) , avg_quant_max AS ( SELECT max(avg_quantity) as avg_q_max FROM order_calc ) SELECT order_id FROM order_calc o CROSS JOIN avg_quant_max a WHERE o.max_quantity > a.avg_q_max
WITH order_quantity AS ( SELECT order_id, SUM(quantity) / COUNT(product_id) AS average_quantity, MAX(quantity) AS maximum_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM order_quantity WHERE maximum_quantity > (SELECT MAX(average_quantity) FROM order_quantity)
WITH r AS( SELECT order_id, SUM(quantity)/COUNT(DISTINCT product_id) AS aqty FROM OrdersDetails GROUP BY 1 ) SELECT r2.order_id FROM( SELECT o.order_id, o.quantity FROM OrdersDetails o WHERE o.quantity IN (SELECT MAX(quantity) FROM OrdersDetails GROUP BY order_id) AND o.quantity > (SELECT MAX(aqty) FROM r) ) r2
WITH ref as (SELECT order_id, AVG(quantity) as avg_qty, MAX(quantity) as max_qty FROM OrdersDetails GROUP BY order_id) SELECT distinct order_id FROM ref WHERE max_qty> (SELECT MAX(avg_qty) FROM ref)
WITH stg AS ( SELECT order_id, MAX(quantity) AS max_quantity, MAX(AVG(quantity)) OVER() AS max_avg_q FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM stg WHERE max_quantity > max_avg_q
WITH t AS ( SELECT order_id, MAX(quantity) max_q, SUM(quantity)/COUNT(*) avg_q FROM ordersdetails GROUP BY order_id ) SELECT order_id FROM t WHERE max_q>(SELECT MAX(avg_q) FROM t)
WITH t as ( SELECT order_id, AVG(quantity) as quantity_avg FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > (SELECT MAX(quantity_avg) FROM t)
WITH t1 AS ( SELECT order_id, AVG(quantity) AS order_avg, MAX(quantity) AS order_max FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM t1 WHERE order_max > (SELECT MAX(order_avg) FROM t1)
WITH t1 As( SELECT SUM(quantity) / COUNT(*) AS mean_q FROM OrdersDetails GROUP BY order_id ), t2 AS( SELECT MAX(mean_q) AS max_q FROM t1 ), t3 AS( SELECT order_id, MAX(quantity) AS q FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM t3 WHERE q > (SELECT(max_q) FROM t2)
WITH table1 AS ( SELECT order_id, SUM(quantity)/COUNT(DISTINCT product_id) AS average_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM table1 WHERE max_quantity > (SELECT MAX(average_quantity) FROM table1)
WITH table1 AS( SELECT order_id, MAX(quantity)OVER(PARTITION BY order_id) AS max_order, AVG(quantity)OVER(PARTITION BY order_id) AS avg_order FROM OrdersDetails ) SELECT DISTINCT order_id FROM table1 WHERE max_order > (SELECT MAX(avg_order) FROM table1)
WITH table1 AS( SELECT order_id, MAX(quantity)OVER(PARTITION BY order_id) AS max_order, AVG(quantity)OVER(PARTITION BY order_id) AS avg_order FROM OrdersDetails ), table2 AS( SELECT order_id, max_order, avg_order, MAX(avg_order)OVER() AS max_avg_order FROM table1 ) SELECT DISTINCT order_id FROM table2 WHERE max_order > max_avg_order
WITH tb1 AS ( SELECT order_id, AVG(quantity) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM tb1 WHERE max_quantity > (SELECT MAX(avg_quantity) AS max_avg_quantity FROM tb1)
WITH tb1 AS ( SELECT order_id, AVG(quantity) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM tb1 WHERE max_quantity > (SELECT MAX(avg_quantity) FROM tb1)
WITH tb1 AS (SELECT order_id, AVG(quantity) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM tb1 WHERE max_quantity > (SELECT MAX(avg_quantity) AS max_avg_quantity FROM tb1 )
WITH tbl AS ( SELECT order_id , MAX(quantity) AS max_quant , AVG(quantity) AS avg_quant FROM ordersdetails GROUP BY order_id) SELECT order_id FROM tbl WHERE max_quant > (SELECT MAX(avg_quant) FROM tbl)
WITH temp AS ( SELECT order_id, MAX(AVG(quantity)) OVER () AS max_avg_quant, MAX(quantity) AS max_quant FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM temp WHERE max_quant > max_avg_quant
WITH temp AS ( SELECT order_id, MAX(SUM(quantity)/COUNT(product_id)) OVER () AS max_avg_quant, MAX(quantity) AS max_quant FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM temp WHERE max_quant > max_avg_quant
WITH temp AS (SELECT order_id, quantity, MAX(quantity) AS max_quantity, AVG(quantity) AS avg_quantity FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM temp WHERE max_quantity > (SELECT MAX(avg_quantity) FROM temp)
WITH temp AS( SELECT order_id, SUM(quantity)/COUNT(product_id) AS avg_quan, MAX(quantity) AS max_quan FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM temp WHERE max_quan > (SELECT MAX(avg_quan) FROM temp)
WITH temp as (SELECT SUM(o.quantity)/COUNT(*) as 'avgs' FROM OrdersDetails o GROUP BY o.order_id) SELECT o.order_id FROM OrdersDetails o GROUP BY o.order_id HAVING MAX(o.quantity) > (SELECT MAX(temp.avgs) FROM temp)
WITH tmp AS ( SELECT order_id, SUM(quantity)/COUNT(DISTINCT(product_id)) AS avg_quantity, MAX(quantity) AS max_quantity FROM OrdersDetails GROUP BY order_id ) SELECT DISTINCT(order_id) FROM tmp WHERE max_quantity > (SELECT MAX(avg_quantity) FROM tmp)
WITH total_quantity AS ( SELECT order_id, MAX(quantity) AS maximum_quantity, SUM(quantity) / COUNT(product_id) AS average_quantity FROM OrdersDetails GROUP BY order_id ) SELECT order_id FROM total_quantity WHERE maximum_quantity > (SELECT MAX(average_quantity) FROM total_quantity)
With cte AS (SELECT sum(quantity)/count(product_id) AS average, order_id FROM ordersdetails group by order_id), temp AS (SELECT max(quantity) AS max_quan, order_id FROM ordersdetails group by order_id) SELECT order_id FROM temp WHERE max_quan > (SELECT max(average) FROM cte)
With cte as( Select order_id, AVG(quantity) as average, max(quantity) as maxquantity From OrdersDetails Group by order_id) Select order_id From cte Where maxquantity > (Select max(average) from cte )
With orders as ( Select O.order_id, max(O.quantity) as Maxq, avg(O.quantity) as Avgq From OrdersDetails O Group by O.order_id) Select distinct OO.order_id FROM OrdersDetails OO JOIN orders OD ON OO.order_id= OD.order_id WHERE OD.Maxq> (SELECT max(Avgq) FROM orders)
from ordersDetails group by order_id having max(quantity) > (select m from (select (sum(quantity) / count(distinct product_id)) as m from ordersDetails group by order_id) a order by m desc limit 1)
select O.order_id from (select order_id, max(quantity) as quantity from OrdersDetails group by order_id) O join (select max(quantity) as quantity from (select order_id, avg(quantity) as quantity from OrdersDetails group by order_id) M) P on O.quantity > P.quantity
select a.order_id from (select order_id, max(quantity) as max_quan from OrdersDetails group by order_id)a where a.max_quan > (select max(avg_quan) from (select sum(quantity)/count(distinct product_id) as avg_quan from OrdersDetails group by order_id)b)
select a.order_id from OrdersDetails a group by a.order_id having max(a.quantity) > ( select avg(b.quantity) from OrdersDetails b group by b.order_id order by avg(b.quantity) DESC limit 1 )
select a.order_id from( select order_id, max(quantity) as q from OrdersDetails group by order_id) as a, ( select max(a.s/a.cnt) as max_avg from( select order_id, count(distinct(product_id)) as cnt, sum(quantity) as s from OrdersDetails group by order_id ) as a ) as b where a.q > b.max_avg
select b.order_id from ( select a.order_id,a.max_order, max(a.avg_qty) over () as max_avg_qty from ( select order_id, max(quantity) as max_order, avg(quantity) as avg_qty from OrdersDetails group by 1 )a )b where b.max_order > b.max_avg_qty
select distinct order_id from OrdersDetails group by order_id having max(quantity)> all(select avg(quantity) from OrdersDetails group by order_id)
select distinct order_id from ordersdetails group by order_id having max(quantity)> (select max(Avg_quantity) from (select sum(quantity)/count(distinct product_id) as Avg_quantity from ordersdetails group by order_id)t)
select distinct order_id from ordersdetails o where o.quantity> (select max(tb.q/tb.n) from (select order_id, count(distinct product_id) as n, sum(quantity) as q from ordersdetails group by 1) tb)
select distinct order_id from ordersdetails where quantity> (select max(Avg_quantity) from (select sum(quantity)/count(distinct product_id) as Avg_quantity from ordersdetails group by order_id)t)
select distinct(order_id) from OrdersDetails where quantity > (select max(a) from (select avg(quantity) a from OrdersDetails group by order_id) a1)
select order_id from ( select a.order_id, max_order, max(avg_order) over() as avg_max from (select order_id,max(quantity) as max_order from ordersdetails group by order_id) as a inner join (select order_id,avg(quantity) as avg_order from ordersdetails group by order_id) as b on a.order_id=b.order_id) as p where max_order>avg_max
select order_id from ( select order_id , max(quantity) as maxx from ordersDetails group by 1 ) tmp where tmp.maxx > all(select avg(quantity) from ordersDetails group by order_id)
select order_id from ( select order_id, max(ave_quant) over() as max_ave_quant, max_quant from ( select order_id, sum(quantity)/count(distinct product_id) as ave_quant, max(quantity) as max_quant from OrdersDetails group by order_id) a) aa where max_quant > max_ave_quant
select order_id from ( select order_id, max(quantity) as max_q,count(*) as num_o from OrdersDetails t group by order_id ) t where num_o > 1 and max_q > ( select max(avg_q) from ( select order_id, avg(quantity) as avg_q from OrdersDetails t group by order_id ) tmp )
select order_id from ( select order_id, max(quantity) as maxq from OrdersDetails group by order_id ) sq2 where maxq> ( select max(av) from ( select avg(quantity) as av from OrdersDetails group by order_id ) sq1 )
select order_id from ( select order_id,MAX(quantity) as max_quant from OrdersDetails group by order_id ) t where t.max_quant > ALL(select distinct (SUM(quantity)/count(distinct product_id)) as avg_quant from OrdersDetails group by order_id)
select order_id from ( select order_id,max(quantity) as maxQuat from ordersdetails group by order_id) B , (select max(avgV) maxavg from (select order_id, (sum(quantity)/count(distinct product_id)) as avgV from ordersdetails group by order_id ) A ) C where maxQuat>maxavg
select order_id from (select order_id ,max(quantity) as max_q from OrdersDetails group by 1) t where max_q > (select max(avg_q) as avg_q_max from (select sum(quantity)/count(distinct product_id) as avg_q from OrdersDetails group by order_id) t)
select order_id from (select order_id, ifnull(sum(quantity)/count(distinct product_id),0) as average_quant ,max(quantity) as max_quant from OrdersDetails group by order_id)a where max_quant>(select max(average_quant) from (select order_id, sum(quantity)/count(distinct product_id) as average_quant ,max(quantity) as max_quant from OrdersDetails group by order_id)a )
select order_id from (select order_id, max(quantity) as mq from ordersdetails group by order_id) a where mq > all (select sum(quantity)/count(product_id) as avg_orders from ordersdetails group by order_id)
select order_id from (select order_id, max(quantity) max_quant, max(avg(quantity)) over () as max_avg from ordersdetails group by order_id) o where max_quant>max_avg
select order_id from OrdersDetails group by 1 having max(quantity) > (select avg(quantity) from OrdersDetails group by order_id order by 1 desc limit 1)
select order_id from OrdersDetails group by 1 having max(quantity) > (select max(max_avg_quantity) from (select order_id, sum(quantity)/count(distinct product_id) as max_avg_quantity from OrdersDetails group by 1) t )
select order_id from OrdersDetails group by 1 having max(quantity)> (select max(temp.avg_qty) from (select avg(quantity) as avg_qty from OrdersDetails group by order_id) temp)
select order_id from OrdersDetails group by order_id having max(quantity) > ( select (sum(quantity)/count(product_id)) as maxavg from OrdersDetails group by order_id order by maxavg DESC limit 1)
select order_id from OrdersDetails group by order_id having max(quantity) > (select avg(quantity) from OrdersDetails group by order_id order by 1 desc limit 1)
select order_id from OrdersDetails group by order_id having max(quantity) > (select max(a.average) from (select order_id, avg(quantity) as average from OrdersDetails group by order_id) as a)
select order_id from OrdersDetails group by order_id having max(quantity) > (select max(avg_quantity) from (select order_id, sum(quantity)/count(product_id) as avg_quantity from OrdersDetails group by order_id)t)
select order_id from OrdersDetails group by order_id having max(quantity) > (select sum(quantity)/count(*) as z from OrdersDetails group by order_id order by z desc limit 1)
select order_id from OrdersDetails group by order_id having max(quantity) > (select sum(quantity)/count(order_id) as a from OrdersDetails group by order_id order by sum(quantity)/count(order_id) desc limit 1)
select order_id from OrdersDetails group by order_id having max(quantity) > all ( select avg(o.quantity) from OrdersDetails o group by o.order_id )
select order_id from OrdersDetails group by order_id having max(quantity) > all( select sum(quantity)/count(product_id) as average from OrdersDetails group by order_id )
select order_id from OrdersDetails o group by order_id having max(quantity) > ( select avg(quantity) avgg from OrdersDetails o group by order_id order by avgg desc limit 1 )
select order_id from Ordersdetails group by order_id having max(quantity) > (select max(avg_qty_order) from( select avg(quantity) as avg_qty_order from OrdersDetails group by order_id order by 1 desc) a)
select order_id from ordersDetails group by 1 having max(quantity) > all( select sum(quantity) / count(distinct product_id) from ordersDetails group by order_id )
select order_id from ordersdetails group by order_id having max(quantity) > ( select max(avg_quantity) from ( select sum(quantity) / count(distinct product_id) as avg_quantity from ordersdetails group by order_id ) as avg_quantities )
select order_id from ordersdetails group by order_id having max(quantity) > (select avg(quantity) from ordersdetails group by order_id order by 1 desc limit 1)
select order_id from ordersdetails group by order_id having max(quantity) > (select max(avg_qua) from ( select order_id, (sum(quantity)/count(product_id)) as avg_qua from ordersdetails group by order_id) a )
select order_id from ordersdetails group by order_id having max(quantity) > (select max(avgq) from (select order_id, max(quantity) 'maxi', sum(quantity)/count(product_id) 'avgq' from ordersdetails group by order_id) a)
select order_id from ordersdetails group by order_id having max(quantity) > all(select avg(quantity) from ordersdetails group by order_id)
select order_id from ordersdetails group by order_id having max(quantity)> all( select sum(quantity)/count(distinct product_id) as avgq from ordersdetails group by order_id) order by order_id
select order_id from ordersdetails group by order_id having max(quantity)>(select max(avgq) from (select order_id, sum(quantity)/count(distinct product_id) as avgq from ordersdetails group by order_id) t) order by order_id
select order_id from ordersdetails group by order_id having max(quantity)>ALL(select cast(sum(quantity)/count(distinct product_id) as float) as avg_quantity from ordersdetails group by order_id)
select order_id from ordersdetails where quantity > (select max(avg_quantity) from (select sum(quantity)/count(product_id) as avg_quantity from ordersdetails group by order_id)a ) group by order_id
select order_id from( select order_id, max(quantity) as maxquan, max(sum(quantity)/count(distinct product_id)) over() as avgquan from OrdersDetails group by order_id )a where maxquan>avgquan
select t.order_id from (select order_id, max(quantity) as max_quant from ordersdetails group by order_id) as t where t.max_quant > (select avg(quantity) from ordersdetails group by order_id order by avg(quantity) desc limit 1)
select t.order_id from (select order_id, max(quantity) as maximum_quantity, max(avg(quantity)) over () as maxx from ordersdetails group by order_id ) as t where t.maximum_quantity> t.maxx
select t.order_id from (select order_id, max(quantity) as maximum_quantity, max(avg(quantity)) over () as maxx from ordersdetails group by order_id) as t where t.maximum_quantity> t.maxx
select t1.order_id from (select order_id, max(quantity) cc from ordersdetails group by 1)t1 where t1.cc>(select max(t1.cc) from (select order_id, sum(quantity) /count(product_id) cc from ordersdetails group by 1)t1)
select temp.order_id from (select o.order_id, max(o.quantity) as or_max, max(avg(o.quantity)) over () max_overall from OrdersDetails o group by 1) temp where temp.or_max>temp.max_overall
select temp.order_id from (select order_id,max(quantity) as max_quantity from OrdersDetails group by order_id) temp where temp.max_quantity > all(select temp1.average_quantity from (select order_id,sum(quantity)/count(distinct product_id) as average_quantity from OrdersDetails group by order_id) temp1)
select temp.order_id from (select order_id,sum(quantity)/count(distinct product_id) as average_quantity,max(quantity) as max_quantity from OrdersDetails group by order_id) temp where temp.max_quantity > all(select temp1.average_quantity from (select order_id,sum(quantity)/count(distinct product_id) as average_quantity,max(quantity) as max_quantity from OrdersDetails group by order_id) temp1)
with CTE as ( select order_id, avg(quantity) as average, max(quantity) as max_quant from ordersdetails group by order_id ) select order_id from cte where max_quant > (select max(average) from cte)
with CTE as (SELECT o.order_id,MAX(quantity) as m, ROUND((SUM(quantity)* 1.0)/ Count(distinct product_id), 2) as v FROM OrdersDetails o GROUP BY 1 ) SELECT cte.order_id FROM CTE WHERE cte.m > (select max(cte.v) FROM CTE)
with CTE as( select *, Max(average) OVER() AS flag from( select max(quantity) as max_quantity, sum(quantity)/count(product_id) as average, order_id from OrdersDetails group by order_id )as d) select C1.order_id from CTE C1 where max_quantity>flag
with CTE1 as ( select order_id, MAX(SUM(quantity)/COUNT(product_id)) OVER() AS max_avg_quant,max(quantity) as quant from OrdersDetails group by order_id) select order_id from CTE1 where quant>max_avg_quant
with a as ( select max(avg_quantity) m from ( select avg(quantity) avg_quantity from OrdersDetails group by order_id ) tmp ) select order_id from OrdersDetails group by order_id having max(quantity) > (select m from a)
with a as ( select order_id, avg(quantity) as avg_q, max(quantity) as max_q from OrdersDetails group by 1 ) select order_id from a where max_q > (select max(avg_q) from a) order by 1
with a as ( select order_id, max(quantity) as max_qt, avg(quantity) as avg_qt from OrdersDetails group by order_id ) select a.order_id from a where a.max_qt > (select max(avg_qt) from a)
with a as ( select order_id, max(quantity) as maxi, avg(quantity) as avge from ordersdetails group by order_id) select order_id from a where maxi> (select max(avge) from a)
with a as (select order_id, max(sum(quantity)/count(distinct product_id)) over () as avg_qt, max(quantity) as max_qt from ordersdetails group by order_id) select order_id from a where max_qt>avg_qt
with a as (select order_id, sum(quantity)/count(product_id) as avg, max(quantity) as max from OrdersDetails group by order_id) select distinct a.order_id from a, (select max(avg) as maxAvg from a) as e where e.maxAvg < a.max
with average as( select distinct order_id, avg(quantity) as avgq, max(quantity) as m from ordersdetails group by order_id ) select order_id from average where m>(select max(avgq)from average) order by order_id
with average_order as ( select max(t.aver) as aver from (select order_id, (sum(quantity)/count(distinct product_id)) as aver from OrdersDetails group by order_id) t ) select order_id from OrdersDetails o group by order_id having max(quantity) > (select aver from average_order)
with avg as( select order_id, SUM(quantity)*1.0 /COUNT(product_id) as avg from OrdersDetails group by order_id), max as( select order_id, MAX(quantity) as max from OrdersDetails group by order_id ) select distinct max.order_id from max where max> (select max(avg) from avg)
with avg_max_orders as ( select order_id, sum(quantity)/count(product_id) as avg_qty, max(quantity) as max_qty from OrdersDetails group by order_id ) select order_id from avg_max_orders where max_qty > (select max(avg_qty) from avg_max_orders)
with avg_quant as (select order_id, SUM(quantity)/COUNT(DISTINCT product_id) as avg_quantity from OrdersDetails group by order_id), max_quant as (select order_id, max(quantity) as max_quant from OrdersDetails group by order_id) select distinct a.order_id from avg_quant a inner join max_quant m on a.order_id = m.order_id where m.max_quant > (select max(avg_quantity) from avg_quant)
with avg_quantity as ( select order_id , sum(quantity) / count(distinct product_id) as avg_quant from OrdersDetails group by 1 ) select od.order_id from OrdersDetails od group by order_id having max(od.quantity) > (select max(avg_quant) from avg_quantity)
with avg_table as ( select avg(quantity) as avg_q, order_id from OrdersDetails group by order_id ) select order_id from (select order_id, avg(quantity) as avg_q, max(quantity) as max_q from OrdersDetails group by order_id having max(quantity) > (select max(avg_q) from avg_table) ) a
with avgandmax as (select order_id, avg(quantity) avgq, max(quantity) mq from OrdersDetails group by order_id), withavgmax as (select max(avgq) mavgq from avgandmax ) select order_id from avgandmax,withavgmax where mq>mavgq
with avrg as( select order_id, max(quantity) as max1, avg(quantity) as avgr from ordersdetails group by 1) select order_id from avrg where max1>(select max(avgr) from avrg)
with cal as ( select order_id, avg(quantity) as avg_q, max(quantity) as max_q from OrdersDetails group by order_id) select order_id from cal where max_q > (select max(avg_q) from cal)
with cet as (select order_id, avg(quantity) a_q, max(quantity) m_q from ordersdetails group by order_id) select order_id from cet where m_q > (select max(a_q) from cet)
with cte as ( SELECT order_id, AVG(quantity) as avg_quantity, MAX(quantity) as max_quantity FROM OrdersDetails GROUP BY 1) SELECT order_id FROM cte WHERE max_quantity > (SELECT max(avg_quantity) FROM cte)
with cte as ( select *, (select sum(quantity)/count(product_id) as maxQ from OrdersDetails group by order_id order by maxQ desc limit 1 ) as Q from OrdersDetails ) select distinct order_id from (select order_id, case when quantity>Q then 1 else 0 end as flag from cte) t where flag>0
with cte as ( select a.order_id, maxq,avgq from ( (select order_id, max(quantity) as maxq from ordersdetails group by 1) a join (select order_id, avg(quantity) as avgq from ordersdetails group by 1) b on a.order_id = b.order_id) ) select order_id from cte where maxq > ALL (select avgq from cte)
with cte as ( select distinct order_id, avg(quantity) over (partition by order_id) as avg_quantity, max(quantity) over (partition by order_id) as max_quantity from OrdersDetails ) select a.order_id from ( (select order_id, (case when max_quantity > (select max(avg_quantity) from cte) then 1 else 0 end) as flag from cte) ) a where flag=1
with cte as ( select order_id , avg(quantity) as avg_qty , max(quantity) as max_qty from ordersdetails group by 1 ) select t1.order_id from cte t1 where max_qty > (select max(avg_qty) from cte)
with cte as ( select order_id , max(quantity) as max_qty , avg(quantity) as avg_qty from OrdersDetails group by 1) select order_id from cte where max_qty > (select max(avg_qty) from cte)
with cte as ( select order_id , sum(quantity)/count(distinct product_id) avg_quantity , max(quantity) max_quantity from OrdersDetails group by order_id ), cte2 as ( select order_id, max(avg_quantity) over () max_avg_quantity, max_quantity from cte ) select order_id from cte2 where max_avg_quantity<max_quantity
with cte as ( select order_id, (sum(quantity)/count(product_id)) as average, max(quantity) as maximum from OrdersDetails group by order_id ) select order_id from cte where maximum > (select max(average) from cte)
with cte as ( select order_id, avg(quantity) as avg from OrdersDetails group by order_id), cte2 as (select order_id, max(quantity) as fin from OrdersDetails group by order_id) select order_id from cte2 where fin > all(select avg from cte)
with cte as ( select order_id, avg(quantity) as avg_prod from OrdersDetails group by order_id) select distinct order_id from OrdersDetails inner join (select max(avg_prod) as mx_avg from cte)t on 1=1 where quantity > mx_avg
with cte as ( select order_id, avg(quantity) as avg_qty, max(quantity) as max_qty from ordersdetails group by order_id ) select order_id from cte where max_qty>(select max(avg_qty) from cte)
with cte as ( select order_id, avg(quantity) avg_quantity, max(quantity) max_quantity from ordersDetails group by order_id) select c1.order_id from cte c1 where max_quantity > (select max(avg_quantity) from cte c2)
with cte as ( select order_id, max(avg(quantity)) over() as max_avg_qty, max(quantity) as max_qty from ordersdetails group by order_id ) select order_id from cte where max_qty>max_avg_qty
with cte as ( select order_id, max(quantity) as max_num, avg(quantity) as ave from OrdersDetails group by order_id) select order_id from cte where max_num > (select max(ave) from cte)
with cte as ( select order_id, max(quantity) as max_quantity, avg(quantity) as average from ordersdetails group by 1 ) select order_id from cte where max_quantity > (select max(average) from cte) order by 1
with cte as ( select order_id, max(quantity) as maxq, avg(quantity) as avgq from ordersdetails group by 1 ) select order_id from cte where maxq > ALL (select avgq from cte)
with cte as ( select order_id, product_id, max(quantity) over (partition by order_id) maximum, sum(quantity) over (partition by order_id)/count(product_id) over (partition by order_id) average from OrdersDetails ) select distinct o.order_id from cte o join cte c on o.order_id = c.order_id and o.maximum > (select max(average) from cte)
with cte as ( select order_id, sum(quantity) / count(distinct product_id) as avg_qnt, max(quantity) as max_qnt from OrdersDetails group by order_id ) select a.order_id as order_id from cte a where a.max_qnt > (select max(avg_qnt) from cte )
with cte as ( select order_id, sum(quantity)/count(distinct product_id) as average, max(quantity) as maxq from OrdersDetails group by order_id ) select order_id from cte where maxq > (select max(cte.average) from cte)
with cte as ( select order_id, sum(quantity)/count(distinct product_id) as avg_q, max(quantity) as max_q from ordersDetails group by 1) select order_id from ( select c1.order_id, sum(case when c2.avg_q <c1.max_q then 1 else 0 end) as cnt from cte c1 cross join cte c2 group by 1 ) cte where cnt in (select count(distinct order_id) from ordersDetails)
with cte as ( select order_id, sum(quantity)/count(product_id) as average, max(quantity) as max_quantity from OrdersDetails group by 1) select order_id from cte where max_quantity > ( select max(average) from cte) order by 1
with cte as ( select order_id,avg(quantity) as avg_quantity from ordersdetails group by 1 ), cte2 as ( select order_id, max(quantity) as total from ordersdetails group by 1 ) select order_id from ordersdetails group by 1 having max(quantity) > all (select avg_quantity from cte)
with cte as ( select order_id,sum(quantity)/count(distinct product_id) as average_quantity, max(quantity) as max_quantity from OrdersDetails group by order_id order by order_id ) select order_id from cte where max_quantity>(select max(average_quantity) from cte)
with cte as ( select sum(quantity)/count(product_id) average from OrdersDetails group by order_id ) select order_id from OrdersDetails group by order_id having max(quantity) > all(select average from cte)
with cte as (select * ,avg(quantity) over(partition by order_id) as Avg_product, max(quantity) over(partition by order_id) as Max_Product_quantity from ordersDetails) select distinct order_id from cte where Max_Product_quantity > (select min(Avg_product) from cte) and Max_Product_quantity > (select max(Avg_product) from cte)
with cte as (select distinct order_id, avg(quantity) over (partition by order_id) as avg_quantity, max(quantity) over (partition by order_id) as max_quantity from ordersdetails) select order_id from cte where max_quantity>(select max(avg_quantity) from cte)
with cte as (select max(quan) as max_average from (select order_id, avg(quantity) as quan from OrdersDetails group by order_id) b ) select order_id from ( select order_id, max(quantity) as max_q from OrdersDetails group by order_id) a where max_q > (select max_average from cte)
with cte as (select order_id, avg(quantity) as avg_q from OrdersDetails group by 1), cte2 as( select order_id, max(quantity) as max_q from OrdersDetails group by 1) select cte2.order_id from cte2 where max_q > (select max(avg_q) from cte)
with cte as (select order_id, avg(quantity) as avg_quant, max(quantity) as max_quant from ordersdetails group by 1 ) select order_id from cte where (select max(avg_quant) from cte ) < max_quant
with cte as (select order_id, avg(quantity) as avgg , max(quantity) as maxx from OrdersDetails group by order_id) select order_id from cte where maxx>(select max(avgg) from cte)
with cte as (select order_id, avg(quantity) over (partition by order_id) as avg_no, max(quantity) over(partition by order_id) as max_no from OrdersDetails) select distinct order_id from cte where max_no > (select max(avg_no) from cte)
with cte as (select order_id, cast(sum(quantity) as float)/cast(count(distinct product_id) as float) as avg_, max(quantity) as max_ from OrdersDetails group by order_id ) select order_id from cte where max_ > (select max(avg_) from cte)
with cte as (select order_id, coalesce(max(quantity),0) a, coalesce(avg(quantity),0) b from ordersdetails group by order_id) select order_id from cte where a > (select max(b) from cte)
with cte as (select order_id, max(quantity) max_quant, sum(quantity)/count(distinct product_id) as average, max(sum(quantity)/count(distinct product_id)) over() as max_avg from ordersdetails group by order_id ) select order_id from cte where max_quant > max_avg
with cte as( select order_id, avg(quantity) 'avg_q', max(quantity) 'max_q' from ordersdetails group by order_id ) select order_id from cte where max_q > (select max(avg_q) from cte)
with cte as( select order_id, avg(quantity) as average, max(quantity) as maxi from ordersDetails group by order_id), cte2 as( select order_Id, max(average) as mavg from cte) select cte.order_id from cte, cte2 where maxi > mavg
with cte as( select order_id, avg(quantity) as avg_quantity, max(quantity) as max_quantity from OrdersDetails group by order_id ) select order_id from cte where max_quantity > (select max(avg_quantity) from cte)
with cte as( select order_id, max(avg(quantity)) over() as max_avg_qty, max(quantity) as max_qty from ordersdetails group by order_id ) select order_id from cte where max_qty > max_avg_qty
with cte as(select avg(quantity) as avg_quantity from OrdersDetails group by order_id order by avg_quantity desc limit 1) select distinct order_id from OrdersDetails group by order_id having(max(quantity)>(select avg_quantity from cte))
with cte as(select max(total_qua/total_pro) max_qua from(select sum(quantity) over(partition by order_id) total_qua, count(*) over(partition by order_id) total_pro from OrdersDetails )a) select order_id from(select order_id, quantity, rank() over(partition by order_id order by quantity desc) rnk from OrdersDetails ) t where rnk = 1 and quantity > (select max_qua from cte)
with cte as(select order_id,avg(quantity) as a,max(quantity)as m from ordersdetails group by order_id) select a.order_id from cte a join cte b where a.m>b.a group by a.order_id having count(a.order_id)=(select count(distinct order_id) from ordersdetails)
with cte1 as ( select distinct order_id, max(quantity) over(partition by order_id) as max_quant, sum(quantity) over(partition by order_id) as total_quant, count(product_id) over(partition by order_id) as diff_prod from ordersdetails), cte2 as (select avg_each from ( select avg_each , dense_rank() over(order by avg_each desc) as r1 from( select order_id, (total_quant/diff_prod) as avg_each from cte1) A ) B where r1 = 1) select distinct cte1.order_id from cte1, cte2 where max_quant > cte2.avg_each
with cte1 as ( select distinct order_id, sum(quantity) over (partition by order_id)/count(product_id) over (partition by order_id) as avg_quantity, max(quantity) over (partition by order_id) as max_quantity from OrdersDetails) select order_id from ( select order_id, max_quantity, max(avg_quantity) over () as m from cte1)z where max_quantity>m
with cte1 as ( select order_id, max(quantity) as max_quantity, avg(quantity) as avg_quantity from OrdersDetails group by order_id ) select order_id from cte1 where max_quantity > (select max(avg_quantity) from cte1)
with cte1 as ( select order_id, sum(quantity)/count(product_id) as avg_qty from ordersdetails group by order_id ), cte2 as ( select order_id, max(quantity) as max_qty from ordersdetails group by order_id ), cte3 as ( select max(avg_qty) as max_avg_qty from cte1 ) select order_id from cte2, cte3 where max_qty > max_avg_qty
with cte1 as (select order_id, avg(quantity) as av, max(quantity) as mx, max(order_id) as cn from ordersdetails group by order_id) select c1.order_id from cte1 c1 where c1.mx > (select max(c2.av) from cte1 c2)
with cte_max as ( select order_id, max(quantity) 'max', (sum(quantity)/count(distinct product_id)) 'avg' from OrdersDetails group by order_id ) , cte_avg as ( select order_id,max,sum(if(max>avg,0,1)) 'value' from (select order_id,max from cte_max) A cross join (select avg from cte_max) B group by order_id,max ) select order_id from cte_avg where value=0
with cte_user_agg as ( select order_id, sum(quantity) / count(product_id) as avg_quantity, max(quantity) as max_quantity from OrdersDetails group by 1 ), cte_filter as ( select order_id from cte_user_agg where max_quantity > ( select max(avg_quantity) from cte_user_agg ) ) select * from cte_filter
with max1 as ( select order_id, AVG(quantity) as avg from OrdersDetails group by 1 ) select order_id from ordersdetails group by order_id having max(quantity) > (select max(max1.avg) from max1)
with max_avg as ( Select max(ag)a from( Select order_id, avg(quantity) ag from OrdersDetails group by 1 )t ) Select distinct order_id from ( Select order_id, max(quantity)over(partition by order_id order by null)-a as p from OrdersDetails cross join max_avg ) t2 where t2.p>0
with max_avg as ( select max(avg_quantity) as threshold from (select avg(quantity) as avg_quantity from ordersdetails group by order_id) temp ) select distinct order_id from ordersdetails group by order_id having max(quantity) > (select * from max_avg)
with max_quant as ( select order_id, max(quantity) as maxval from OrdersDetails group by 1 ), avg_quant as ( select order_id, sum(quantity)/count(distinct product_id) as avgval from OrdersDetails group by 1 ) select order_id from max_quant where maxval > (select max(avgval) from avg_quant)
with max_quantity as ( select order_id, quantity, dense_rank()over (partition by order_id order by quantity desc) as 'max_quant_rnk' from OrdersDetails ) select order_id from max_quantity where max_quant_rnk = 1 and quantity > (select (sum(quantity)/ count(product_id)) as average_quantity from OrdersDetails group by order_id order by average_quantity desc limit 1)
with mq as ( select order_id, max(quantity) as max_quan from ordersdetails group by 1), aq as ( select order_id, sum(quantity)/count(distinct product_id) as avg_quan from ordersdetails group by 1) select mq.order_id from mq join aq where mq.order_id = aq.order_id and max_quan> (select max(avg_quan) from aq)
with num_of_products_in_order as ( select COUNT(product_id) as num_of_p, order_id from OrdersDetails o group by 2 ), total_quantity as ( select SUM(quantity) as total_quant, order_id from OrdersDetails o group by 2 ), max_product as ( select order_id, product_id, quantity as max_q from OrdersDetails ord where (quantity, order_id) in (select MAX(quantity), order_id from OrdersDetails o group by 2) ), final_tab as( select distinct ordd.order_id, num_of_p, total_quant, (total_quant/num_of_p) as avg_q, max_q from OrdersDetails ordd join num_of_products_in_order n on n.order_id = ordd.order_id join total_quantity tq on tq.order_id = ordd.order_id join max_product mp on mp.order_id = ordd.order_id ) select order_id from final_tab where max_q> (select max(avg_q) from final_tab)
with o AS ( SELECT order_id, SUM(quantity) OVER (PARTITION BY order_id)/COUNT(product_id) OVER (PARTITION BY order_id) AS avg_qty, MAX(quantity) OVER (PARTITION BY order_id) AS max_qty FROM ordersdetails ), maxi AS ( SELECT MAX(avg_qty) AS qty FROM o ) SELECT DISTINCT order_id FROM o WHERE max_qty > (SELECT qty FROM maxi)
with o as ( select order_id, avg(quantity) as average_quantity, max(quantity) as max_quantity from OrdersDetails group by order_id ), t as (select max(average_quantity) as max_avg_quantity from o) select order_id from o where o.max_quantity > (select t.max_avg_quantity from t)
with order_max as ( Select max(order_avg) as max_avg from ( Select order_id, round(sum(quantity)/count(DISTINCT product_id),2) as order_avg from OrdersDetails group by order_id) t ) Select DISTINCT o.order_id from OrdersDetails o, order_max om where o.quantity > om.max_avg
with order_quantity as ( SELECT order_id, max(quantity) as max_quantity, sum(quantity)/count(product_id) as average_quantity FROM ordersdetails GROUP BY order_id ) SELECT order_id from order_quantity a where max_quantity > ( select max(average_quantity) from order_quantity )
with orders AS ( SELECT order_id, SUM(quantity) OVER (PARTITION BY order_id)/COUNT(product_id) OVER (PARTITION BY order_id) AS avg_qty, MAX(quantity) OVER (PARTITION BY order_id) AS max_qty FROM ordersdetails ), maxi AS ( SELECT MAX(avg_qty) AS qty FROM orders ) SELECT DISTINCT order_id FROM orders WHERE max_qty > (SELECT qty FROM maxi)
with s0 as ( select order_id, avg(quantity) as avg_q, max(quantity) as max_q from ordersdetails group by 1) select order_id from s0 where max_q > (select max(avg_q) from s0)
with sql1 as (select order_id, sum(quantity)/count(distinct product_id) as Average_quantity, max(quantity) as Max_Quantity from OrdersDetails group by order_id), sql2 as (select order_id,Max_Quantity,max(Average_quantity) Over() as Max_average from sql1) select order_id from sql2 where Max_Quantity>Max_average
with t as ( select order_id, sum(quantity)/ count(distinct product_id) average, max(quantity) maximum from OrdersDetails group by order_id) select order_id from t where maximum > all (select average from t)
with t as ( select order_id,avg(quantity) as avg_q,max(quantity) as max_q from ordersdetails group by 1 ), t1 as ( select *,max(avg_q) over() as max_avg_q from t ) select order_id from t1 where max_q > max_avg_q
with t as (select order_id , avg(quantity) as aq, max(quantity) as mq from OrdersDetails group by order_id) select order_id from t where mq > (select max(aq) from t)
with t as (select order_id, max(quantity) max1 ,avg(quantity) avg1 from ordersdetails group by order_id ) select order_id from t where max1 > (select max(avg1) from t)
with t as (select order_id, max(quantity) order_max, avg(quantity) order_avg from OrdersDetails group by order_id) select order_id from t where order_max > (select max(order_avg) from t)
with t as(select order_id, avg(quantity)as ag, max(quantity) as mx from OrdersDetails group by 1) select order_id from t where mx > (select max(ag) from t)
with t1 as ( select order_id, max(quantity) as maximum, avg(quantity) as average from OrdersDetails group by order_id) select distinct order_id from t1 where maximum> (select max(average) from t1)
with t1 as ( select order_id, max(sum(quantity)/count(distinct product_id)) over () as avg_quan, max(quantity) as max_quan from ordersdetails group by 1 ) select order_id from t1 where max_quan > avg_quan
with t1 as ( select order_id,max(quantity) as maximum from OrdersDetails group by order_id), t2 as (select order_id, avg(quantity) as average from OrdersDetails group by order_id) select distinct order_id from t1 where maximum> (select max(average) from t2)
with t1 as (SELECT order_id, AVG(quantity) as avg_qty, MAX(quantity) as max_qty FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM OrdersDetails GROUP BY order_id HAVING MAX(quantity) > ( SELECT MAX(avg_qty) FROM t1)
with t1 as (select order_id, avg(quantity),max(quantity) max_q, max(avg(quantity)) over () as max_avg from OrdersDetails group by order_id order by order_id) select order_id from t1 where max_q > max_avg
with t1 as (select sum(quantity)/count(distinct product_id) as avg_q from ordersDetails group by order_id order by avg_q desc limit 1) select order_id from ordersDetails group by 1 having max(quantity) > (select avg_q from t1)
with t1 as( select max(avg_quantity) as mx_avg from (select cast(sum(quantity)/count(distinct product_id) as float) as avg_quantity from ordersdetails group by order_id)t ), t2 as ( select order_id, max(quantity) as mx from ordersdetails group by order_id ) select t2.order_id from t1, t2 where t2.mx> t1.mx_avg group by t2.order_id
with tbAvg as ( select order_id, sum(quantity)/count(distinct product_id) as avgQuanty from ordersdetails group by order_id ) select distinct order_id from ordersdetails where quantity > (select max(avgQuanty) from tbAvg)
with td as(select order_id, sum(quantity)/count(product_id) as avg_quan from OrdersDetails group by order_id ) select order_id from OrdersDetails group by order_id having max(quantity) > (select max(avg_quan) from td)
with temp as ( select max(avg_quantity) as max_avg from ( select order_id, sum(quantity)/count(distinct product_id) as avg_quantity from OrdersDetails group by order_id) a) select order_id from (select order_id, max(quantity) as max_quantity from OrdersDetails group by order_id) b cross join temp where max_quantity>max_avg
with temp as ( select order_id, avg(quantity) as average_quantity from ordersdetails group by 1 ) select order_id from ordersdetails group by 1 having max(quantity) > ( select max(average_quantity) from temp)
with temp as ( select order_id, avg(quantity) as average_quantity, max(quantity) as max_quantity from ordersdetails group by 1 ) select order_id from temp where max_quantity > ( select max(average_quantity) from temp)
with temp as ( select order_id, avg(quantity) as avg_qt, max(quantity) as max_qt from ordersdetails group by 1 ) select order_id from temp where max_qt > (select max(avg_qt) from temp)
with temp as ( select order_id, sum(quantity)/count(product_id) as avg_quan, max(quantity) as max_quan from OrdersDetails group by order_id ) select order_id from temp where max_quan > (select max(avg_quan) from temp)
with temp as (select avg(quantity) as average from OrdersDetails group by order_id) select order_id from OrdersDetails group by 1 having max(quantity) > (select max(average) from temp)
with temp as (select distinct order_id, avg(quantity) over (partition by order_id) avg_quan, max(quantity) over (partition by order_id) max_quan from OrdersDetails) select order_id from temp where max_quan > (select max(avg_quan) from temp)
with temp as (select order_id, count(product_id) as product_cnt, sum(quantity) as quantity_cnt, max(quantity) as highest_quantity from OrdersDetails group by 1 ), temp2 as (select max(quantity_cnt/product_cnt) as max_avg_quantity from temp) select order_id from temp t1 where highest_quantity > (select * from temp2)
with temp as (select order_id, max(quantity) as max_order_quant , avg(quantity) as avg_order_quant from OrdersDetails group by 1) select t1.order_id from temp t1 join temp t2 on t1.max_order_quant > t2.avg_order_quant group by 1 having sum(case when t2.order_id is not null then 1 else 0 end) = (select count(distinct order_id) from OrdersDetails)
with temp as( SELECT order_id, sum(quantity)/count(product_id) as avrg, max(quantity) as max_ FROM OrdersDetails GROUP BY order_id) SELECT order_id FROM temp where max_ > (select max(avrg) from temp)
with temp as( select order_id, sum(quantity) as sums, max(quantity) as maxm from ordersdetails group by order_id), temp1 as( select order_id, count(distinct product_id) as cnt from ordersdetails group by order_id), temp2 as( select t1.order_id, t1.sums, t2.cnt, t1.sums/t2.cnt as avgs, t1.maxm from temp t1 left join temp1 t2 on t1.order_id=t2.order_id) select order_id from temp2 where maxm>(select max(avgs) from temp2)
with temp1 as ( select order_id, avg(quantity) as avg1, max(quantity) as max1 from ordersdetails group by order_id) select order_id from temp1 where max1 > (select max(avg1) from temp1)
with temp1 as ( select order_id, max(avg(quantity)) over() as avg1, max(quantity) as max1 from ordersdetails group by order_id ) select order_id from temp1 where max1 > avg1
with temp1 as ( select order_id, sum(quantity)/count(product_id) as avg_quantity_order, max(quantity) as max_quantity from ordersDetails group by order_id), temp2 as ( select max(avg_quantity_order) as max_avg_quantity from temp1) select order_id from temp1 where max_quantity > (select max_avg_quantity from temp2)
with temp_avg as (select order_id, sum(quantity)/count(product_id) as avg_o from OrdersDetails group by 1), temp_max as (select order_id, max(quantity) as max_o from OrdersDetails group by 1) select order_id from temp_max where max_o > all(select avg_o from temp_avg)
with test as(select distinct(order_id), avg(quantity) over(partition by order_id order by order_id) as cc, max(quantity) over(partition by order_id) as mm from ordersdetails) select distinct(order_id) from test where mm>(select max(cc) from test)
with tmp as ( select distinct order_id, avg(quantity) over(partition by order_id) avg_quant_per_order, max(quantity) over(partition by order_id) max_quant_per_order from OrdersDetails ) select order_id from tmp where max_quant_per_order > (select max(avg_quant_per_order) from tmp)
with tmp as (select order_id, max(quantity) as max_qty, sum(quantity)/count(distinct product_id) as avg_qty from OrdersDetails group by 1 ) select order_id from tmp where max_qty>(select max(avg_qty) from tmp)
